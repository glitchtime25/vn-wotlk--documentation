<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CMaNGOS_WoTLK: AuthSocket.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CMaNGOS_WoTLK
   &#160;<span id="projectnumber">0b6ed145724bbfe54f426dc34e27de563eb3bc54</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('AuthSocket_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AuthSocket.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AuthSocket_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of the CMaNGOS Project. See AUTHORS file for Copyright information</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Common_8h.html">Common.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="HMACSHA1_8h.html">Auth/HMACSHA1.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="base32_8h.html">Auth/base32.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DatabaseEnv_8h.html">Database/DatabaseEnv.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Config_8h.html">Config/Config.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Log_8h.html">Log.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="RealmList_8h.html">RealmList.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AuthSocket_8h.html">AuthSocket.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="AuthCodes_8h.html">AuthCodes.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SRP6_8h.html">Auth/SRP6.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CommonDefines_8h.html">Util/CommonDefines.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;openssl/md5.h&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;ctime&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//#include &quot;Util/Util.h&quot; -- for commented utf8ToUpperOnlyLatin</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">extern</span> <a class="code" href="classDatabaseMysql.html">DatabaseType</a> <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#a23bad8f2ffee1800642899520f67d119">   44</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119">AccountFlags</a></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a34287a507b4770b6bc0fd3189bf380cd">   46</a></span>&#160;    <a class="code" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a34287a507b4770b6bc0fd3189bf380cd">ACCOUNT_FLAG_GM</a>         = 0x00000001,</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a26b4915525a102bd4e4d69648922e285">   47</a></span>&#160;    <a class="code" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a26b4915525a102bd4e4d69648922e285">ACCOUNT_FLAG_TRIAL</a>      = 0x00000008,</div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a4f1108d36673f24c7f00620b7385257b">   48</a></span>&#160;    <a class="code" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a4f1108d36673f24c7f00620b7385257b">ACCOUNT_FLAG_PROPASS</a>    = 0x00800000,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;};</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0">   51</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0">SecurityFlags</a></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a661aa371b0c8446ba0eb38da7db18b65">   53</a></span>&#160;    <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a661aa371b0c8446ba0eb38da7db18b65">SECURITY_FLAG_NONE</a>          = 0x00,</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a6fff4c7a8a46103c144c94c2959dc340">   54</a></span>&#160;    <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a6fff4c7a8a46103c144c94c2959dc340">SECURITY_FLAG_PIN</a>           = 0x01,</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0af36eddcde894beb9359bf4d10d7f7790">   55</a></span>&#160;    <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0af36eddcde894beb9359bf4d10d7f7790">SECURITY_FLAG_UNK</a>           = 0x02,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021">SECURITY_FLAG_AUTHENTICATOR</a> = 0x04</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021">   57</a></span>&#160;};</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160; </div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// GCC have alternative #pragma pack(N) syntax and old gcc version not support pack(push,N), also any gcc version not support it at some paltform</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#if defined( __GNUC__ )</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#pragma pack(1)</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#pragma pack(push,1)</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html">   66</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">AUTH_LOGON_CHALLENGE_C</a></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;{</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a296fd5746ea3ad8f5b341cd92ecb92a6">   68</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a296fd5746ea3ad8f5b341cd92ecb92a6">cmd</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a36a4e2114203cbec036c7f6c6ba1f11b">   69</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a36a4e2114203cbec036c7f6c6ba1f11b">error</a>;</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#aae293343b590c23405a32d2809887020">   70</a></span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>  <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#aae293343b590c23405a32d2809887020">size</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#ae6f5a1b7c4684bb96deaa51cb9cfc7bc">   71</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#ae6f5a1b7c4684bb96deaa51cb9cfc7bc">gamename</a>[4];</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#aa7a794d75e11e98aa9f88cb8e82be9e9">   72</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#aa7a794d75e11e98aa9f88cb8e82be9e9">version1</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#abe9218ee7ebdffa48dd404a2ad465ca4">   73</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#abe9218ee7ebdffa48dd404a2ad465ca4">version2</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a6a9e5088baf8c568916891a55e035db3">   74</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a6a9e5088baf8c568916891a55e035db3">version3</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">   75</a></span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>  <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">build</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#afc0d27e7213846988c0ee7ccc5e54ee0">   76</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#afc0d27e7213846988c0ee7ccc5e54ee0">platform</a>[4];</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#ad8c71a1e514e6b8f6d6a4681ba1db0c1">   77</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#ad8c71a1e514e6b8f6d6a4681ba1db0c1">os</a>[4];</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">   78</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">country</a>[4];</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a44cdd2733fb678966bc3252b6bef9d16">   79</a></span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>  <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a44cdd2733fb678966bc3252b6bef9d16">timezone_bias</a>;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a5993cfad4be8f9e457bd6067ced6bd2a">   80</a></span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>  <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5993cfad4be8f9e457bd6067ced6bd2a">ip</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a589c5dadf3e694ba5e3d9f1e5732426e">   81</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a589c5dadf3e694ba5e3d9f1e5732426e">I_len</a>;</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">   82</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">I</a>[1];</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#af2b75a713ab063d15c0f303555dab7c2">   83</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#af2b75a713ab063d15c0f303555dab7c2">sAuthLogonChallenge_C</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PIN__DATA__C.html">   85</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAUTH__LOGON__PIN__DATA__C.html">AUTH_LOGON_PIN_DATA_C</a></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;{</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PIN__DATA__C.html#abf73f728548012164dbe9645ce60c9df">   87</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="structAUTH__LOGON__PIN__DATA__C.html#abf73f728548012164dbe9645ce60c9df">salt</a>[16];</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PIN__DATA__C.html#ad96ad23fbc35574fa33fbc22146c259e">   88</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="structAUTH__LOGON__PIN__DATA__C.html#ad96ad23fbc35574fa33fbc22146c259e">hash</a>[20];</div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#a7ca873e23eb6f6b6994763b66b4cc382">   89</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#a7ca873e23eb6f6b6994763b66b4cc382">sAuthLogonPinData_C</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">// typedef sAuthLogonChallenge_C sAuthReconnectChallenge_C;</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">typedef struct</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    uint8   cmd;</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">    uint8   error;</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    uint8   unk2;</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">    uint8   B[32];</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">    uint8   g_len;</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    uint8   g[1];</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    uint8   N_len;</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">    uint8   N[32];</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">    uint8   s[32];</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">    uint8   unk3[16];</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">} sAuthLogonChallenge_S;</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html">  108</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAUTH__LOGON__PROOF__C.html">AUTH_LOGON_PROOF_C</a></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;{</div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html#a51b29f49e940bffa67988d9bc2b16aa4">  110</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__C.html#a51b29f49e940bffa67988d9bc2b16aa4">cmd</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html#a8d1b6da4090879fa479610f7b69806cc">  111</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__C.html#a8d1b6da4090879fa479610f7b69806cc">A</a>[32];</div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html#a1ce54d5c269d3e77c94010d29040c0e1">  112</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__C.html#a1ce54d5c269d3e77c94010d29040c0e1">M1</a>[20];</div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html#a4233534385acef9a41fd9181d9d35252">  113</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__C.html#a4233534385acef9a41fd9181d9d35252">crc_hash</a>[20];</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html#ad8f9f53d462f1abd5c81413e0ed8b0a7">  114</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__C.html#ad8f9f53d462f1abd5c81413e0ed8b0a7">number_of_keys</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__C.html#ae2ab466af9513c15cbcea7a20e97ddc5">  115</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__C.html#ae2ab466af9513c15cbcea7a20e97ddc5">securityFlags</a>;                                  <span class="comment">// 0x00-0x04</span></div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#ab50c6b56b4c56513ab11e4bee50a0116">  116</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#ab50c6b56b4c56513ab11e4bee50a0116">sAuthLogonProof_C</a>;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">typedef struct</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    uint16  unk1;</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">    uint32  unk2;</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">    uint8   unk3[4];</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">    uint16  unk4[20];</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">}  sAuthLogonProofKey_C;</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html">  126</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAUTH__LOGON__PROOF__S.html">AUTH_LOGON_PROOF_S</a></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html#a5846630b9df94b9f4784e59e7f320257">  128</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__S.html#a5846630b9df94b9f4784e59e7f320257">cmd</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html#a5cbbda99be5cd0549dd43fc0e546007e">  129</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__S.html#a5cbbda99be5cd0549dd43fc0e546007e">error</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html#ad47c715e53f6c7583b559170365652a2">  130</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__S.html#ad47c715e53f6c7583b559170365652a2">M2</a>[20];</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html#ac0a4fb839f6aaa5e2f07242af9b2ad6c">  131</a></span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>  <a class="code" href="structAUTH__LOGON__PROOF__S.html#ac0a4fb839f6aaa5e2f07242af9b2ad6c">accountFlags</a>;                                   <span class="comment">// see enum AccountFlags</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html#af5e62bc75f068b727367cfe00bf8bd35">  132</a></span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>  <a class="code" href="structAUTH__LOGON__PROOF__S.html#af5e62bc75f068b727367cfe00bf8bd35">surveyId</a>;                                       <span class="comment">// SurveyId</span></div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S.html#a38966a5c5563c87a1ff7a05ca820094c">  133</a></span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>  <a class="code" href="structAUTH__LOGON__PROOF__S.html#a38966a5c5563c87a1ff7a05ca820094c">unkFlags</a>;                                       <span class="comment">// some flags (AccountMsgAvailable = 0x01)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#a1241a754e900fac64f49cadc4e806321">  134</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#a1241a754e900fac64f49cadc4e806321">sAuthLogonProof_S</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html">  136</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html">AUTH_LOGON_PROOF_S_BUILD_6005</a></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#ace085e366eef6c3cc5a0f1bfdcfa0503">  138</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#ace085e366eef6c3cc5a0f1bfdcfa0503">cmd</a>;</div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a0f49d957165cdd3056cd617303bd4df6">  139</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a0f49d957165cdd3056cd617303bd4df6">error</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a662b072206cc87b06ef2db024c644c40">  140</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a662b072206cc87b06ef2db024c644c40">M2</a>[20];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">// uint32  unk1;</span></div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a6ec820d730f2c380c98af081c86cedba">  142</a></span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>  <a class="code" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a6ec820d730f2c380c98af081c86cedba">LoginFlags</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// uint16  unk3;</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#ac68cfe0714ca2055e4d76090071448f2">  144</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#ac68cfe0714ca2055e4d76090071448f2">sAuthLogonProof_S_BUILD_6005</a>;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="structAUTH__RECONNECT__PROOF__C.html">  146</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAUTH__RECONNECT__PROOF__C.html">AUTH_RECONNECT_PROOF_C</a></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;{</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structAUTH__RECONNECT__PROOF__C.html#a14df856ae931474a7c58d0e35caf6ad0">  148</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__RECONNECT__PROOF__C.html#a14df856ae931474a7c58d0e35caf6ad0">cmd</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structAUTH__RECONNECT__PROOF__C.html#a054648a96d1c66bae6fdb9a174e7b1e6">  149</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__RECONNECT__PROOF__C.html#a054648a96d1c66bae6fdb9a174e7b1e6">R1</a>[16];</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structAUTH__RECONNECT__PROOF__C.html#ae65e9c6ae7d7964fe56877eb0438e0fd">  150</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__RECONNECT__PROOF__C.html#ae65e9c6ae7d7964fe56877eb0438e0fd">R2</a>[20];</div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="structAUTH__RECONNECT__PROOF__C.html#ad296d79f9e0b658e719ba577e3eadd35">  151</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__RECONNECT__PROOF__C.html#ad296d79f9e0b658e719ba577e3eadd35">R3</a>[20];</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="structAUTH__RECONNECT__PROOF__C.html#aaa44734bb96b91894c038b3f34b4db0d">  152</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>   <a class="code" href="structAUTH__RECONNECT__PROOF__C.html#aaa44734bb96b91894c038b3f34b4db0d">number_of_keys</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#aef6ea8864e443cf0d192820bb670a8d8">  153</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#aef6ea8864e443cf0d192820bb670a8d8">sAuthReconnectProof_C</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structXFER__INIT.html">  155</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structXFER__INIT.html">XFER_INIT</a></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;{</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="structXFER__INIT.html#ad4c8231cf73fd42faa658a83c06e3188">  157</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="structXFER__INIT.html#ad4c8231cf73fd42faa658a83c06e3188">cmd</a>;                                              <span class="comment">// XFER_INITIATE</span></div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structXFER__INIT.html#a43898ab1d9f0aff091bbd5b9c1c01982">  158</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="structXFER__INIT.html#a43898ab1d9f0aff091bbd5b9c1c01982">fileNameLen</a>;                                      <span class="comment">// strlen(fileName);</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="structXFER__INIT.html#a46e14acdd28e77b3ab0ff60541662dd7">  159</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="structXFER__INIT.html#a46e14acdd28e77b3ab0ff60541662dd7">fileName</a>[5];                                      <span class="comment">// fileName[fileNameLen]</span></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="structXFER__INIT.html#acf790da02aa6f1af2fcf0cf3e75828b0">  160</a></span>&#160;    <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <a class="code" href="structXFER__INIT.html#acf790da02aa6f1af2fcf0cf3e75828b0">file_size</a>;                                       <span class="comment">// file size (bytes)</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structXFER__INIT.html#afd8d5b506d50ffce4708bf71c0cb9f1f">  161</a></span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="structXFER__INIT.html#afd8d5b506d50ffce4708bf71c0cb9f1f">md5</a>[MD5_DIGEST_LENGTH];                           <span class="comment">// MD5</span></div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#a2f20547d03b1332fb0fe018d608f1dd9">  162</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#a2f20547d03b1332fb0fe018d608f1dd9">XFER_INIT</a>;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structAuthHandler.html">  164</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structAuthHandler.html">AuthHandler</a></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;{</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structAuthHandler.html#a1073e291bacadf4202a88f27d5bbd14a">  166</a></span>&#160;    <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607b">eAuthCmd</a> <a class="code" href="structAuthHandler.html#a1073e291bacadf4202a88f27d5bbd14a">cmd</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="structAuthHandler.html#a2feaf8602d9937e452d0aab87fc7fd54">  167</a></span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="structAuthHandler.html#a2feaf8602d9937e452d0aab87fc7fd54">status</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="structAuthHandler.html#a0cb921a18c8cd1d26b327b74e29ea4b6">  168</a></span>&#160;    bool (<a class="code" href="classAuthSocket.html">AuthSocket</a>::*<a class="code" href="structAuthHandler.html#a0cb921a18c8cd1d26b327b74e29ea4b6">handler</a>)(void);</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#acf29ad85543a1d128b5b6bb662e4610a">  169</a></span>&#160;} <a class="code" href="AuthSocket_8cpp.html#acf29ad85543a1d128b5b6bb662e4610a">AuthHandler</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">// GCC have alternative #pragma pack() syntax and old gcc version not support pack(pop), also any gcc version not support it at some paltform</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#if defined( __GNUC__ )</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#pragma pack()</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#pragma pack(pop)</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">  178</a></span>&#160;std::array&lt;uint8, 16&gt; <a class="code" href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">VersionChallenge</a> = { { 0xBA, 0xA3, 0x1E, 0x99, 0xA0, 0x0B, 0x21, 0x57, 0xFC, 0x37, 0x3F, 0xB3, 0x69, 0xCD, 0xD2, 0xF1 } };</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a30ec5807044e390030466bd445155140">  181</a></span>&#160;<a class="code" href="classAuthSocket.html#a30ec5807044e390030466bd445155140">AuthSocket::AuthSocket</a>(boost::asio::io_service&amp; service, <a class="code" href="go__scripts_8cpp.html#af644fca167e62eaa31e0f48bb7d1946c">std::function</a>&lt;<span class="keywordtype">void</span> (Socket*)&gt; closeHandler)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    : Socket(service, <a class="code" href="namespacestd.html">std</a>::move(closeHandler)), _status(STATUS_CHALLENGE), _build(0), _accountSecurityLevel(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa5d534fd54528d86d0f997fa130159df0">SEC_PLAYER</a>), m_timeoutTimer(service)</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;{</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a3233c23e533fef61e14ddc7870521f02">  186</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a3233c23e533fef61e14ddc7870521f02">AuthSocket::Open</a>()</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="classAuthSocket.html#a061ce2e9c8a0a47a3bcda3b84a573798">m_timeoutTimer</a>.expires_from_now(boost::posix_time::seconds(30));</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classAuthSocket.html#a061ce2e9c8a0a47a3bcda3b84a573798">m_timeoutTimer</a>.async_wait([&amp;] (<span class="keyword">const</span> boost::system::error_code&amp; error)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="comment">// Timer was not cancelled, take necessary action.</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (error == boost::asio::error::operation_aborted)</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="comment">// Close socket if timer runs out</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classMaNGOS_1_1Socket.html#abf3df98f52f5bd99178ec41eebeda4c8">IsClosed</a>())</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#a7d1040587af18478de244c02aead195c">Close</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    });</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">return</span> Socket::Open();</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;}</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classAuthSocket.html#adaef22b052f07909c3618975e5c9e860">  204</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#adaef22b052f07909c3618975e5c9e860">AuthSocket::ProcessIncomingData</a>()</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// benchmarking has demonstrated that this lookup method is faster than std::map</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">const</span> <span class="keyword">static</span> <a class="code" href="structAuthHandler.html">AuthHandler</a> table[] =</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607baf1f5233caea83c7786c7f7fe5f543069">CMD_AUTH_LOGON_CHALLENGE</a>,     <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca24cd7be5d07b7f91c58ab07c6aa0b05a">STATUS_CHALLENGE</a>,   &amp;<a class="code" href="classAuthSocket.html#a6d5c1867a511279a6f1e59b9de2813c9">AuthSocket::_HandleLogonChallenge</a>      },</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>,         <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca9c6865343efa388ebdf57f83745cbd23">STATUS_LOGON_PROOF</a>, &amp;<a class="code" href="classAuthSocket.html#a3bbcd5fc1582a4b32e7caf57a159f159">AuthSocket::_HandleLogonProof</a>          },</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32b2d7c2c35ddb12a029ffbdec45dd1e">CMD_AUTH_RECONNECT_CHALLENGE</a>, <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca24cd7be5d07b7f91c58ab07c6aa0b05a">STATUS_CHALLENGE</a>,   &amp;<a class="code" href="classAuthSocket.html#a520c7c12512568090ac1998ddb0820f0">AuthSocket::_HandleReconnectChallenge</a>  },</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba81257bfbc2b946081cb1b8fcfc653419">CMD_AUTH_RECONNECT_PROOF</a>,     <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca47a34bb74328acf79893f5bbaa4fe706">STATUS_RECON_PROOF</a>, &amp;<a class="code" href="classAuthSocket.html#ade209ba287b12c740b092aeca2a62538">AuthSocket::_HandleReconnectProof</a>      },</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba67fee67fef01cda5a29c6e4076b8b2ef">CMD_REALM_LIST</a>,               <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cabcff47f6269eecf20ff824247e635a21">STATUS_AUTHED</a>,      &amp;<a class="code" href="classAuthSocket.html#a36eb350ec6fa5c42175a35539f7afa16">AuthSocket::_HandleRealmList</a>           },</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607baa0d4656e5e896b91167174ef4ee571ec">CMD_XFER_ACCEPT</a>,              <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca33274de9803fb85087ec1d4986090f49">STATUS_PATCH</a>,       &amp;<a class="code" href="classAuthSocket.html#a5ddd92e21fc2384f8f6fa7a55953a558">AuthSocket::_HandleXferAccept</a>          },</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba254b3a87afe0ac82f79f999d2d254fa3">CMD_XFER_RESUME</a>,              <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca33274de9803fb85087ec1d4986090f49">STATUS_PATCH</a>,       &amp;<a class="code" href="classAuthSocket.html#a38c7ecbde8cf6ab8e5ea44e60ec88b92">AuthSocket::_HandleXferResume</a>          },</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607bac3faf7eb22c45016905bcdf6f343d355">CMD_XFER_CANCEL</a>,              <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca33274de9803fb85087ec1d4986090f49">STATUS_PATCH</a>,       &amp;<a class="code" href="classAuthSocket.html#a669988b6ad12e324ceb353b7d7d15a7e">AuthSocket::_HandleXferCancel</a>          }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    };</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> tableLength = <span class="keyword">sizeof</span>(table) / <span class="keyword">sizeof</span>(<a class="code" href="structAuthHandler.html">AuthHandler</a>);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// the purpose of this loop is to handle multiple opcodes in the same tcp packet,</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// which presumably the client will never do, but lets support it anyway! \o/</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &gt; 0)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keyword">const</span> <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607b">eAuthCmd</a> cmd = <span class="keyword">static_cast&lt;</span><a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607b">eAuthCmd</a><span class="keyword">&gt;</span>(*<a class="code" href="classMaNGOS_1_1Socket.html#ab906a8d1f0d88acc16246b95df6f140b">InPeak</a>());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; tableLength; ++i)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">if</span> (table[i].cmd != cmd)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// unauthorized</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[Auth] Status %u, table status %u&quot;</span>, <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a>, table[i].status);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="keywordflow">if</span> (table[i].status != <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a>)</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[Auth] Received unauthorized command %u length %u&quot;</span>, cmd, <a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>());</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[Auth] Got data for cmd %u recv length %u&quot;</span>, cmd, <a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>());</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">if</span> (!(*this.*table[i].handler)())</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[Auth] Command handler failed for cmd %u recv length %u&quot;</span>, cmd, <a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>());</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="comment">// did we iterate over the entire command table, finding nothing? if so, punt!</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (i == tableLength)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        {</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[Auth] Got unknown packet %u&quot;</span>, cmd);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// if we reach here, it means that a valid opcode was found and the handler completed successfully</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="classAuthSocket.html#a061ce2e9c8a0a47a3bcda3b84a573798">m_timeoutTimer</a>.cancel();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;}</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classAuthSocket.html#aa68aa3a2281b1418acd3f52dcef4934b">  268</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAuthSocket.html#aa68aa3a2281b1418acd3f52dcef4934b">AuthSocket::SendProof</a>(<a class="code" href="classCryptoHash.html">Sha1Hash</a> sha)</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;{</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>)</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    {</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">case</span> 5875:                                          <span class="comment">// 1.12.1</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">case</span> 6005:                                          <span class="comment">// 1.12.2</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">case</span> 6141:                                          <span class="comment">// 1.12.3</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <a class="code" href="structAUTH__LOGON__PROOF__S__BUILD__6005.html">sAuthLogonProof_S_BUILD_6005</a> proof{};</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            memcpy(proof.M2, sha.<a class="code" href="classCryptoHash.html#a3158cb819f64595dc9091e46d573205d">GetDigest</a>(), 20);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            proof.cmd = <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            proof.error = 0;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            proof.LoginFlags = 0x00;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;proof, <span class="keyword">sizeof</span>(proof));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">case</span> 8606:                                          <span class="comment">// 2.4.3</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">case</span> 10505:                                         <span class="comment">// 3.2.2a</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">case</span> 11159:                                         <span class="comment">// 3.3.0a</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        <span class="keywordflow">case</span> 11403:                                         <span class="comment">// 3.3.2</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">case</span> 11723:                                         <span class="comment">// 3.3.3a</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">case</span> 12340:                                         <span class="comment">// 3.3.5a</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">default</span>:                                            <span class="comment">// or later</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="structAUTH__LOGON__PROOF__S.html">sAuthLogonProof_S</a> proof{};</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            memcpy(proof.M2, sha.<a class="code" href="classCryptoHash.html#a3158cb819f64595dc9091e46d573205d">GetDigest</a>(), 20);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            proof.cmd = <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            proof.error = 0;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            proof.accountFlags = <a class="code" href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a4f1108d36673f24c7f00620b7385257b">ACCOUNT_FLAG_PROPASS</a>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            proof.surveyId = 0x00000000;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            proof.unkFlags = 0x0000;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)&amp;proof, <span class="keyword">sizeof</span>(proof));</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;}</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a6d5c1867a511279a6f1e59b9de2813c9">  308</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a6d5c1867a511279a6f1e59b9de2813c9">AuthSocket::_HandleLogonChallenge</a>()</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleLogonChallenge&quot;</span>);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &lt; <span class="keyword">sizeof</span>(<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>))</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    std::vector&lt;uint8&gt; buf;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    buf.resize(4);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;buf[0], 4);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordtype">void</span>* pVoid = <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(&amp;buf[0]);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>* pUint16 = <span class="keyword">static_cast&lt;</span><a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>*<span class="keyword">&gt;</span>(pVoid);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(*pUint16);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a> remaining = ((<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>*)&amp;buf[0])-&gt;size;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] got header, body is %#04x bytes&quot;</span>, remaining);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> ((remaining &lt; <span class="keyword">sizeof</span>(<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>) - buf.size()) || (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &lt; remaining))</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cae4ed50e41f51e639b045f3e50328d104">STATUS_CLOSED</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// No big fear of memory outage (size is int16, i.e. &lt; 65536)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    buf.resize(remaining + buf.size() + 1);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    buf[buf.size() - 1] = 0;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>* ch = (<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>*)&amp;buf[0];</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;buf[4], remaining);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] got full packet, %#04x bytes&quot;</span>, ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#aae293343b590c23405a32d2809887020">size</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] name(%d): &#39;%s&#39;&quot;</span>, ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a589c5dadf3e694ba5e3d9f1e5732426e">I_len</a>, ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">I</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// BigEndian code, nop in little endian case</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// size already converted</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(*((<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>*)(&amp;ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#ae6f5a1b7c4684bb96deaa51cb9cfc7bc">gamename</a>[0])));</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">build</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(*((<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>*)(&amp;ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#afc0d27e7213846988c0ee7ccc5e54ee0">platform</a>[0])));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(*((<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>*)(&amp;ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#ad8c71a1e514e6b8f6d6a4681ba1db0c1">os</a>[0])));</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(*((<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>*)(&amp;ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">country</a>[0])));</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a44cdd2733fb678966bc3252b6bef9d16">timezone_bias</a>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5993cfad4be8f9e457bd6067ced6bd2a">ip</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="classByteBuffer.html">ByteBuffer</a> pkt;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a> = (<span class="keyword">const</span> <span class="keywordtype">char</span>*)ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">I</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a> = ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">build</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Convert uint8[4] to string, restore string order as its byte order is reversed</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#ad8c71a1e514e6b8f6d6a4681ba1db0c1">os</a>[3] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a> = (<span class="keywordtype">char</span>*)ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#ad8c71a1e514e6b8f6d6a4681ba1db0c1">os</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    std::reverse(<a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a>.begin(), <a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a>.end());</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#afc0d27e7213846988c0ee7ccc5e54ee0">platform</a>[3] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classAuthSocket.html#a1ebf33dec375d8785cceb035816bd4a7">m_platform</a> = (<span class="keywordtype">char</span>*)ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#afc0d27e7213846988c0ee7ccc5e54ee0">platform</a>;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    std::reverse(<a class="code" href="classAuthSocket.html#a1ebf33dec375d8785cceb035816bd4a7">m_platform</a>.begin(), <a class="code" href="classAuthSocket.html#a1ebf33dec375d8785cceb035816bd4a7">m_platform</a>.end());</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="classAuthSocket.html#aa7347457175a2f3188f1764fd10ee2f6">m_locale</a>.resize(<span class="keyword">sizeof</span>(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">country</a>));</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classAuthSocket.html#aa7347457175a2f3188f1764fd10ee2f6">m_locale</a>.assign(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">country</a>, (ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">country</a> + <span class="keyword">sizeof</span>(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">country</a>)));</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    std::reverse(<a class="code" href="classAuthSocket.html#aa7347457175a2f3188f1764fd10ee2f6">m_locale</a>.begin(), <a class="code" href="classAuthSocket.html#aa7347457175a2f3188f1764fd10ee2f6">m_locale</a>.end());</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// utf8ToUpperOnlyLatin(_login); -- client already send account in expected form</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// Escape the user input used in DB to avoid further SQL injection</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// Memory will be freed on AuthSocket object destruction</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a> = <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a3ae8fc1a519edd7205cdc708a8949d54">escape_string</a>(<a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>);</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="classAuthSocket.html#af96c3519a980b42b02aedf5b89b5ab7b">_safelocale</a> = <a class="code" href="classAuthSocket.html#aa7347457175a2f3188f1764fd10ee2f6">m_locale</a>;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a3ae8fc1a519edd7205cdc708a8949d54">escape_string</a>(<a class="code" href="classAuthSocket.html#af96c3519a980b42b02aedf5b89b5ab7b">_safelocale</a>);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a3ae8fc1a519edd7205cdc708a8949d54">escape_string</a>(<a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a>);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607baf1f5233caea83c7786c7f7fe5f543069">CMD_AUTH_LOGON_CHALLENGE</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0x00);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="comment">// No SQL injection possible (paste the IP address as passed by the socket)</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    std::unique_ptr&lt;QueryResult&gt; ip_banned_result(<a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT expires_at FROM ip_banned &quot;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="stringliteral">&quot;WHERE (expires_at = banned_at OR expires_at &gt; UNIX_TIMESTAMP()) AND ip = &#39;%s&#39;&quot;</span>, <a class="code" href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">m_address</a>.c_str()));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (ip_banned_result)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da13095592f9ea787641f66f94f53ed444">AUTH_LOGON_FAILED_FAIL_NOACCESS</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Banned ip %s tries to login!&quot;</span>, <a class="code" href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">m_address</a>.c_str());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// No SQL injection (escaped user name)</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT id,locked,lockedIp,gmlevel,v,s,token FROM account WHERE username = &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span> (result)</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordtype">bool</span> locked = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">if</span> (fields[1].GetUInt8() == 1)               <span class="comment">// if ip is locked</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account &#39;%s&#39; is locked to IP - &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str(), fields[2].<a class="code" href="classField.html#ab8c1a7e73265f7b14457ab37cf20681c">GetString</a>());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Player address is &#39;%s&#39;&quot;</span>, <a class="code" href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">m_address</a>.c_str());</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                <span class="keywordflow">if</span> (strcmp(fields[2].GetString(), <a class="code" href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">m_address</a>.c_str()))</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account IP differs&quot;</span>);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da8351fec1446ed32a654d8556c35388dd">AUTH_LOGON_FAILED_SUSPENDED</a>);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    locked = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                }</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account IP matches&quot;</span>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;            }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account &#39;%s&#39; is not locked to ip&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            std::string databaseV = fields[4].<a class="code" href="classField.html#ac3fe5bf9cdc61b5be66a4c79598cba5e">GetCppString</a>();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            std::string databaseS = fields[5].<a class="code" href="classField.html#ac3fe5bf9cdc61b5be66a4c79598cba5e">GetCppString</a>();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            <span class="keywordtype">bool</span> broken = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a6593b3dfdc4ee61217e9313685fb753d">SetVerifier</a>(databaseV.c_str()) || !<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a5c990f970e799c75dccc5179b180c946">SetSalt</a>(databaseS.c_str()))</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;            {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da13095592f9ea787641f66f94f53ed444">AUTH_LOGON_FAILED_FAIL_NOACCESS</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Broken v/s values in database for account %s!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                broken = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            }</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="keywordflow">if</span> (!locked &amp;&amp; !broken)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                <a class="code" href="classQueryResult.html">QueryResult</a>* banresult = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT banned_at,expires_at FROM account_banned WHERE &quot;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                         <span class="stringliteral">&quot;account_id = %u AND active = 1 AND (expires_at &gt; UNIX_TIMESTAMP() OR expires_at = banned_at)&quot;</span>, fields[0].GetUInt32());</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                <span class="keywordflow">if</span> (banresult)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="keywordflow">if</span> ((*banresult)[0].GetUInt64() == (*banresult)[1].GetUInt64())</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da31fb73a69dbc21f4f55ded7a5b4eb3ff">AUTH_LOGON_FAILED_BANNED</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Banned account %s tries to login!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                    {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da8351fec1446ed32a654d8556c35388dd">AUTH_LOGON_FAILED_SUSPENDED</a>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Temporarily banned account %s tries to login!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                    <span class="keyword">delete</span> banresult;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;database authentication values: v=&#39;%s&#39; s=&#39;%s&#39;&quot;</span>, databaseV.c_str(), databaseS.c_str());</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    <a class="code" href="classBigNumber.html">BigNumber</a> s;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    s.<a class="code" href="classBigNumber.html#af9f9038e53f3239e44c7331211951722">SetHexStr</a>(databaseS.c_str());</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#aca610d23a3c906601a514c049b75658d">CalculateHostPublicEphemeral</a>();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da353464e73c375c7003148dc0d155c955">AUTH_LOGON_SUCCESS</a>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="comment">// B may be calculated &lt; 32B so we force minimal length to 32B</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a4f49d7d0c6e33233dd2c02f776a1a766">GetHostPublicEphemeral</a>().<a class="code" href="classBigNumber.html#a15f3c90e40267c8d003e4650c045d00f">AsByteArray</a>(32));      <span class="comment">// 32 bytes</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(1);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#afae913818204de92ca32f43db40ee234">GetGeneratorModulo</a>().<a class="code" href="classBigNumber.html#a15f3c90e40267c8d003e4650c045d00f">AsByteArray</a>());</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(32);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a20f18ebac8ab4ec54dfb81c6ebdb6d50">GetPrime</a>().<a class="code" href="classBigNumber.html#a15f3c90e40267c8d003e4650c045d00f">AsByteArray</a>(32));</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(s.<a class="code" href="classBigNumber.html#a15f3c90e40267c8d003e4650c045d00f">AsByteArray</a>());<span class="comment">// 32 bytes</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(<a class="code" href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">VersionChallenge</a>.data(), <a class="code" href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">VersionChallenge</a>.size());</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> securityFlags = 0;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    <a class="code" href="classAuthSocket.html#ac87ad41040b9faaa26e368ce0d134c84">_token</a> = fields[6].<a class="code" href="classField.html#ac3fe5bf9cdc61b5be66a4c79598cba5e">GetCppString</a>();</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classAuthSocket.html#ac87ad41040b9faaa26e368ce0d134c84">_token</a>.empty() &amp;&amp; <a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a> &gt;= 8606) <span class="comment">// authenticator was added in 2.4.3</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                        securityFlags = <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021">SECURITY_FLAG_AUTHENTICATOR</a>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(securityFlags);                    <span class="comment">// security flags (0x0...0x04)</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                    <span class="keywordflow">if</span> (securityFlags &amp; <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a6fff4c7a8a46103c144c94c2959dc340">SECURITY_FLAG_PIN</a>)          <span class="comment">// PIN input</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                    }</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    <span class="keywordflow">if</span> (securityFlags &amp; <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0af36eddcde894beb9359bf4d10d7f7790">SECURITY_FLAG_UNK</a>)          <span class="comment">// Matrix input</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                    }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                    <span class="keywordflow">if</span> (securityFlags &amp; <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021">SECURITY_FLAG_AUTHENTICATOR</a>)    <span class="comment">// Authenticator input</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(1);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> secLevel = fields[3].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    <a class="code" href="classAuthSocket.html#a523fb1dc1550330422e697a6c23be543">_accountSecurityLevel</a> = secLevel &lt;= <a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa6a04b5fbbc52adb152bfb45b600db102">SEC_ADMINISTRATOR</a> ? <a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6f">AccountTypes</a>(secLevel) : <a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa6a04b5fbbc52adb152bfb45b600db102">SEC_ADMINISTRATOR</a>;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca9c6865343efa388ebdf57f83745cbd23">STATUS_LOGON_PROOF</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">else</span>                                                <span class="comment">// no account</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a>);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)pkt.<a class="code" href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">contents</a>(), pkt.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;}</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a3bbcd5fc1582a4b32e7caf57a159f159">  515</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a3bbcd5fc1582a4b32e7caf57a159f159">AuthSocket::_HandleLogonProof</a>()</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;{</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleLogonProof&quot;</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="structAUTH__LOGON__PROOF__C.html">sAuthLogonProof_C</a> lp{};</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;lp, <span class="keyword">sizeof</span>(<a class="code" href="structAUTH__LOGON__PROOF__C.html">sAuthLogonProof_C</a>)))</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cae4ed50e41f51e639b045f3e50328d104">STATUS_CLOSED</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group__realmd.html#gae4bf1972a0e7e0ab485781487b820634">FindBuildInfo</a>(<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>))</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="comment">// no patch found</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="classByteBuffer.html">ByteBuffer</a> pkt;</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607baf1f5233caea83c7786c7f7fe5f543069">CMD_AUTH_LOGON_CHALLENGE</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0x00);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43dae9a047729e3382be712c1ebd34a49ec7">AUTH_LOGON_FAILED_VERSION_INVALID</a>);</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account %s tried to login with invalid client version %u!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str(), <a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)pkt.<a class="code" href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">contents</a>(), pkt.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#ad94e5b8da1fbf8fee36a69faae99ed6e">CalculateSessionKey</a>(lp.A, 32))</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Session calculation failed for account %s!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a74776df90fbeb71eb4f630cb137103aa">HashSessionKey</a>();</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#ae9008d4d1e310598c7a74319a07ba3fd">CalculateProof</a>(<a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a673dd68aa7bf73cea3b70e4f2b33a093">Proof</a>(lp.M1, 20))</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="keywordflow">if</span> (lp.securityFlags &amp; <a class="code" href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021">SECURITY_FLAG_AUTHENTICATOR</a> || !<a class="code" href="classAuthSocket.html#ac87ad41040b9faaa26e368ce0d134c84">_token</a>.empty())</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> pinCount;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;pinCount, <span class="keyword">sizeof</span>(<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>)))</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> data[4] = { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>, <a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a>, 3, 0 };</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;            std::vector&lt;uint8&gt; keys(pinCount + 1);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)keys.data(), <span class="keyword">sizeof</span>(<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>) * pinCount))</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;            {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> data[4] = { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>, <a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a>, 3, 0 };</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            }</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            keys[pinCount] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            <span class="keyword">auto</span> ServerToken = <a class="code" href="classAuthSocket.html#a5e1b922a76d7926043171af4943899cf">generateToken</a>(<a class="code" href="classAuthSocket.html#ac87ad41040b9faaa26e368ce0d134c84">_token</a>.c_str());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            <span class="keyword">auto</span> clientToken = atoi((<span class="keyword">const</span> <span class="keywordtype">char</span>*)keys.data());</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;            <span class="keywordflow">if</span> (ServerToken != clientToken)</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account %s tried to login with wrong pincode! Given %u Expected %u Pin Count: %u&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str(), clientToken, ServerToken, pinCount);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> data[4] = { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>, <a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a>, 0, 0 };</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classAuthSocket.html#a262c5dc0ca59fc243c7b64c70ff268e2">VerifyVersion</a>(lp.A, <span class="keyword">sizeof</span>(lp.A), lp.crc_hash, <span class="keyword">false</span>))</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] Account %s tried to login with modified client!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> data[2] = { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>, <a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43dae9a047729e3382be712c1ebd34a49ec7">AUTH_LOGON_FAILED_VERSION_INVALID</a> };</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;User &#39;%s&#39; successfully authenticated&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="comment">// No SQL injection (escaped user input) and IP address as received by socket</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* K_hex = <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#aec4b02cee59c0a4b6a4ba41df470c833">GetStrongSessionKey</a>().<a class="code" href="classBigNumber.html#aee55a1b16c529876c6d0c2e4907c25ef">AsHexStr</a>();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE account SET sessionkey = &#39;%s&#39;, locale = &#39;%s&#39;, failed_logins = 0, os = &#39;%s&#39;, platform = &#39;%s&#39; WHERE username = &#39;%s&#39;&quot;</span>, K_hex, <a class="code" href="classAuthSocket.html#af96c3519a980b42b02aedf5b89b5ab7b">_safelocale</a>.c_str(), <a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a>.c_str(), <a class="code" href="classAuthSocket.html#a1ebf33dec375d8785cceb035816bd4a7">m_platform</a>.c_str(), <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str());</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        std::unique_ptr&lt;QueryResult&gt; loginfail(<a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT id FROM account WHERE username = &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str()));</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">if</span> (loginfail)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;INSERT INTO account_logons(accountId,ip,loginTime,loginSource) VALUES(&#39;%u&#39;,&#39;%s&#39;,NOW(),&#39;%u&#39;)&quot;</span>, loginfail-&gt;Fetch()[0].GetUInt32(), <a class="code" href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">m_address</a>.c_str(), <a class="code" href="CommonDefines_8h.html#a2d23c4249c4d0ef998c9309eeb084b17acdbd0cea23cc448b4d917904444001dd">LOGIN_TYPE_REALMD</a>);</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        OPENSSL_free((<span class="keywordtype">void</span>*)K_hex);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="classCryptoHash.html">Sha1Hash</a> sha;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a5f1a3de992f923d555c4199e2f8a18f8">Finalize</a>(sha);</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="classAuthSocket.html#aa68aa3a2281b1418acd3f52dcef4934b">SendProof</a>(sha);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cabcff47f6269eecf20ff824247e635a21">STATUS_AUTHED</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a> &gt; 6005)                                  <span class="comment">// &gt; 1.12.2</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> data[4] = { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>, <a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a>, 0, 0 };</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="comment">// 1.x not react incorrectly at 4-byte message use 3 as real error</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> data[2] = { <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a>, <a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a> };</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>(data, <span class="keyword">sizeof</span>(data));</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] account %s tried to login with wrong password!&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> MaxWrongPassCount = <a class="code" href="Config_8h.html#a6a9399e3a4b206a79bb911575ff3dae3">sConfig</a>.GetIntDefault(<span class="stringliteral">&quot;WrongPass.MaxCount&quot;</span>, 0);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">if</span> (MaxWrongPassCount &gt; 0)</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        {</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="comment">// Increment number of failed logins by one and if it reaches the limit temporarily ban that account or IP</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE account SET failed_logins = failed_logins + 1 WHERE username = &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str());</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classQueryResult.html">QueryResult</a>* loginfail = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT id, failed_logins FROM account WHERE username = &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str()))</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <a class="code" href="classField.html">Field</a>* fields = loginfail-&gt;Fetch();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> failed_logins = fields[1].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="keywordflow">if</span> (failed_logins &gt;= MaxWrongPassCount)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> WrongPassBanTime = <a class="code" href="Config_8h.html#a6a9399e3a4b206a79bb911575ff3dae3">sConfig</a>.GetIntDefault(<span class="stringliteral">&quot;WrongPass.BanTime&quot;</span>, 600);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                    <span class="keywordtype">bool</span> WrongPassBanType = <a class="code" href="Config_8h.html#a6a9399e3a4b206a79bb911575ff3dae3">sConfig</a>.GetBoolDefault(<span class="stringliteral">&quot;WrongPass.BanType&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <span class="keywordflow">if</span> (WrongPassBanType)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> acc_id = fields[0].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                        <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;INSERT INTO account_banned(account_id, banned_at, expires_at, banned_by, reason, active)&quot;</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                               <span class="stringliteral">&quot;VALUES (&#39;%u&#39;,UNIX_TIMESTAMP(),UNIX_TIMESTAMP()+&#39;%u&#39;,&#39;MaNGOS realmd&#39;,&#39;Failed login autoban&#39;,1)&quot;</span>,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                               acc_id, WrongPassBanTime);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] account %s got banned for &#39;%u&#39; seconds because it failed to authenticate &#39;%u&#39; times&quot;</span>,</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                  <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str(), WrongPassBanTime, failed_logins);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                        std::string current_ip = <a class="code" href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">m_address</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                        <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a3ae8fc1a519edd7205cdc708a8949d54">escape_string</a>(current_ip);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                        <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;INSERT INTO ip_banned VALUES (&#39;%s&#39;,UNIX_TIMESTAMP(),UNIX_TIMESTAMP()+&#39;%u&#39;,&#39;MaNGOS realmd&#39;,&#39;Failed login autoban&#39;)&quot;</span>,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                               current_ip.c_str(), WrongPassBanTime);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                        <a class="code" href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a>(<span class="stringliteral">&quot;[AuthChallenge] IP %s got banned for &#39;%u&#39; seconds because account %s failed to authenticate &#39;%u&#39; times&quot;</span>,</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                                  current_ip.c_str(), WrongPassBanTime, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str(), failed_logins);</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    }</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keyword">delete</span> loginfail;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;}</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a520c7c12512568090ac1998ddb0820f0">  672</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a520c7c12512568090ac1998ddb0820f0">AuthSocket::_HandleReconnectChallenge</a>()</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleReconnectChallenge&quot;</span>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &lt; <span class="keyword">sizeof</span>(<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>))</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    std::vector&lt;uint8&gt; buf;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    buf.resize(4);</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;buf[0], 4);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keywordtype">void</span>* pVoid = <span class="keyword">static_cast&lt;</span><span class="keywordtype">void</span>*<span class="keyword">&gt;</span>(&amp;buf[0]);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>* pUint16 = <span class="keyword">static_cast&lt;</span><a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>*<span class="keyword">&gt;</span>(pVoid);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(*pUint16);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a> remaining = ((<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>*)&amp;buf[0])-&gt;size;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[ReconnectChallenge] got header, body is %#04x bytes&quot;</span>, remaining);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    <span class="keywordflow">if</span> ((remaining &lt; <span class="keyword">sizeof</span>(<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>) - buf.size()) || (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &lt; remaining))</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cae4ed50e41f51e639b045f3e50328d104">STATUS_CLOSED</a>;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">// No big fear of memory outage (size is int16, i.e. &lt; 65536)</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    buf.resize(remaining + buf.size() + 1);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    buf[buf.size() - 1] = 0;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>* ch = (<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html">sAuthLogonChallenge_C</a>*)&amp;buf[0];</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;buf[4], remaining);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[ReconnectChallenge] got full packet, %#04x bytes&quot;</span>, ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#aae293343b590c23405a32d2809887020">size</a>);</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;[ReconnectChallenge] name(%d): &#39;%s&#39;&quot;</span>, ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a589c5dadf3e694ba5e3d9f1e5732426e">I_len</a>, ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">I</a>);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a> = (<span class="keyword">const</span> <span class="keywordtype">char</span>*)ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">I</a>;</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a> = <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#a3ae8fc1a519edd7205cdc708a8949d54">escape_string</a>(<a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <a class="code" href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a>(ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">build</a>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a> = ch-&gt;<a class="code" href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">build</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT sessionkey FROM account WHERE username = &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str());</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; </div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// Stop if the account is not found</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;[ERROR] user %s tried to login and we cannot find his session key in the database.&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <a class="code" href="classMaNGOS_1_1Socket.html#a7d1040587af18478de244c02aead195c">Close</a>();</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#a57b3b714f39e94b299fd5d90da61831e">SetStrongSessionKey</a>(fields[0].GetString());</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca47a34bb74328acf79893f5bbaa4fe706">STATUS_RECON_PROOF</a>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="classByteBuffer.html">ByteBuffer</a> pkt;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    pkt &lt;&lt; (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>)  <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32b2d7c2c35ddb12a029ffbdec45dd1e">CMD_AUTH_RECONNECT_CHALLENGE</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    pkt &lt;&lt; (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>)  0x00;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <a class="code" href="classAuthSocket.html#a987a68e0fe5256ce6b6d5e6647f68589">_reconnectProof</a>.<a class="code" href="classBigNumber.html#a29de18ae491024be0844fa4e3e02595d">SetRand</a>(16 * 8);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(<a class="code" href="classAuthSocket.html#a987a68e0fe5256ce6b6d5e6647f68589">_reconnectProof</a>.<a class="code" href="classBigNumber.html#a15f3c90e40267c8d003e4650c045d00f">AsByteArray</a>(16));        <span class="comment">// 16 bytes random</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    pkt.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(<a class="code" href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">VersionChallenge</a>.data(), <a class="code" href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">VersionChallenge</a>.size());</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)pkt.<a class="code" href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">contents</a>(), pkt.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;}</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="classAuthSocket.html#ade209ba287b12c740b092aeca2a62538">  743</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#ade209ba287b12c740b092aeca2a62538">AuthSocket::_HandleReconnectProof</a>()</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;{</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleReconnectProof&quot;</span>);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <a class="code" href="structAUTH__RECONNECT__PROOF__C.html">sAuthReconnectProof_C</a> lp;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">Read</a>((<span class="keywordtype">char</span>*)&amp;lp, <span class="keyword">sizeof</span>(<a class="code" href="structAUTH__RECONNECT__PROOF__C.html">sAuthReconnectProof_C</a>)))</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cae4ed50e41f51e639b045f3e50328d104">STATUS_CLOSED</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <a class="code" href="classBigNumber.html">BigNumber</a> K = <a class="code" href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">srp</a>.<a class="code" href="classSRP6.html#aec4b02cee59c0a4b6a4ba41df470c833">GetStrongSessionKey</a>();</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.empty() || !<a class="code" href="classAuthSocket.html#a987a68e0fe5256ce6b6d5e6647f68589">_reconnectProof</a>.<a class="code" href="classBigNumber.html#a375fb446549fb9472c879c8db0beaa91">GetNumBytes</a>() || !K.<a class="code" href="classBigNumber.html#a375fb446549fb9472c879c8db0beaa91">GetNumBytes</a>())</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classBigNumber.html">BigNumber</a> t1;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    t1.<a class="code" href="classBigNumber.html#ae565f1bc704940309f66a72e696e0c67">SetBinary</a>(lp.<a class="code" href="structAUTH__RECONNECT__PROOF__C.html#a054648a96d1c66bae6fdb9a174e7b1e6">R1</a>, 16);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="classCryptoHash.html">Sha1Hash</a> sha;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    sha.<a class="code" href="classCryptoHash.html#a36b91834c1eb241217c42671a619fd70">Initialize</a>();</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    sha.<a class="code" href="classCryptoHash.html#a5dfa99bee69279f472a004e4ae81436f">UpdateData</a>(<a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    sha.<a class="code" href="classCryptoHash.html#a35a40018d774f708a1340b7f9d0ad0e7">UpdateBigNumbers</a>(&amp;t1, &amp;<a class="code" href="classAuthSocket.html#a987a68e0fe5256ce6b6d5e6647f68589">_reconnectProof</a>, &amp;K, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    sha.<a class="code" href="classCryptoHash.html#a726c93fef6eb52889f6438c4daec6144">Finalize</a>();</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordflow">if</span> (!memcmp(sha.<a class="code" href="classCryptoHash.html#a3158cb819f64595dc9091e46d573205d">GetDigest</a>(), lp.<a class="code" href="structAUTH__RECONNECT__PROOF__C.html#ae65e9c6ae7d7964fe56877eb0438e0fd">R2</a>, <a class="code" href="classCryptoHash.html#a828fc61caad815134f0b404d80a24e62">Sha1Hash::GetLength</a>()))</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classAuthSocket.html#a262c5dc0ca59fc243c7b64c70ff268e2">VerifyVersion</a>(lp.<a class="code" href="structAUTH__RECONNECT__PROOF__C.html#a054648a96d1c66bae6fdb9a174e7b1e6">R1</a>, <span class="keyword">sizeof</span>(lp.<a class="code" href="structAUTH__RECONNECT__PROOF__C.html#a054648a96d1c66bae6fdb9a174e7b1e6">R1</a>), lp.<a class="code" href="structAUTH__RECONNECT__PROOF__C.html#ad296d79f9e0b658e719ba577e3eadd35">R3</a>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            <a class="code" href="classByteBuffer.html">ByteBuffer</a> pkt;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba81257bfbc2b946081cb1b8fcfc653419">CMD_AUTH_RECONNECT_PROOF</a>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43dae9a047729e3382be712c1ebd34a49ec7">AUTH_LOGON_FAILED_VERSION_INVALID</a>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)pkt.<a class="code" href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">contents</a>(), pkt.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        }</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <a class="code" href="classByteBuffer.html">ByteBuffer</a> pkt;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba81257bfbc2b946081cb1b8fcfc653419">CMD_AUTH_RECONNECT_PROOF</a>);</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da353464e73c375c7003148dc0d155c955">AUTH_LOGON_SUCCESS</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        pkt &lt;&lt; <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>(0x00);                                <span class="comment">// 2 bytes zeros</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)pkt.<a class="code" href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">contents</a>(), pkt.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <a class="code" href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">_status</a> = <a class="code" href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cabcff47f6269eecf20ff824247e635a21">STATUS_AUTHED</a>;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;[ERROR] user %s tried to login, but session invalid.&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#a7d1040587af18478de244c02aead195c">Close</a>();</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a36eb350ec6fa5c42175a35539f7afa16">  795</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a36eb350ec6fa5c42175a35539f7afa16">AuthSocket::_HandleRealmList</a>()</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;{</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleRealmList&quot;</span>);</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &lt; 5)</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#ad7d7b4513b04feb49c985101bb360499">ReadSkip</a>(5);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="comment">// No SQL injection (escaped user name)</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160; </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT id, gmlevel FROM account WHERE username = &#39;%s&#39;&quot;</span>, <a class="code" href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">_safelogin</a>.c_str());</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;[ERROR] user %s tried to login and we cannot find him in the database.&quot;</span>, <a class="code" href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">_login</a>.c_str());</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        <a class="code" href="classMaNGOS_1_1Socket.html#a7d1040587af18478de244c02aead195c">Close</a>();</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160; </div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="keywordtype">id</span> = (*result)[0].GetUInt32();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> accountSecurityLevel = (*result)[1].GetUInt8();</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <a class="code" href="RealmList_8cpp.html#a0c5082ef857ee63e0c7d3c7b0789a834">sRealmList</a>.<a class="code" href="classRealmList.html#a8ef22c6190216680d72d8d1fef6687a4">UpdateIfNeed</a>();</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    <a class="code" href="classByteBuffer.html">ByteBuffer</a> pkt;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <a class="code" href="classAuthSocket.html#af4d106456302f79b6a2caa40aa382919">LoadRealmlist</a>(pkt, <span class="keywordtype">id</span>, accountSecurityLevel);</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160; </div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <a class="code" href="classByteBuffer.html">ByteBuffer</a> hdr;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    hdr &lt;&lt; (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>) <a class="code" href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba67fee67fef01cda5a29c6e4076b8b2ef">CMD_REALM_LIST</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    hdr &lt;&lt; (<a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>)pkt.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>();</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    hdr.<a class="code" href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">append</a>(pkt);</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">Write</a>((<span class="keyword">const</span> <span class="keywordtype">char</span>*)hdr.<a class="code" href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">contents</a>(), hdr.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;}</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="classAuthSocket.html#af4d106456302f79b6a2caa40aa382919">  834</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classAuthSocket.html#af4d106456302f79b6a2caa40aa382919">AuthSocket::LoadRealmlist</a>(<a class="code" href="classByteBuffer.html">ByteBuffer</a>&amp; pkt, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> acctid, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> securityLevel)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;{</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>)</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    {</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">case</span> 5875:                                          <span class="comment">// 1.12.1</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">case</span> 6005:                                          <span class="comment">// 1.12.2</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">case</span> 6141:                                          <span class="comment">// 1.12.3</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                               <span class="comment">// unused value</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="classAuthSocket.html#a7a61138ce507879c30bb3d7f2c6a25d0">getEligibleRealmCount</a>(securityLevel));</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; i : <a class="code" href="RealmList_8cpp.html#a0c5082ef857ee63e0c7d3c7b0789a834">sRealmList</a>)</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> AmountOfCharacters;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                <span class="comment">// No SQL injection. id of realm is controlled by the database.</span></div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT numchars FROM realmcharacters WHERE realmid = &#39;%d&#39; AND acctid=&#39;%u&#39;&quot;</span>, i.second.m_ID, acctid);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <span class="keywordflow">if</span> (result)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                    <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                    AmountOfCharacters = fields[0].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                    AmountOfCharacters = 0;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="keywordtype">bool</span> ok_build = std::find(i.second.realmbuilds.begin(), i.second.realmbuilds.end(), <a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>) != i.second.realmbuilds.end();</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <a class="code" href="structRealmBuildInfo.html">RealmBuildInfo</a> <span class="keyword">const</span>* buildInfo = ok_build ? <a class="code" href="group__realmd.html#gae4bf1972a0e7e0ab485781487b820634">FindBuildInfo</a>(<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                <span class="keywordflow">if</span> (!buildInfo)</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                    buildInfo = &amp;i.second.realmBuildInfo;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2">RealmFlags</a> realmflags = i.second.realmflags;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <span class="comment">// Don&#39;t display higher security realms for players.</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                <span class="keywordflow">if</span> (!securityLevel &amp;&amp; i.second.allowedSecurityLevel &gt; 0)</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;                <span class="comment">// 1.x clients not support explicitly REALM_FLAG_SPECIFYBUILD, so manually form similar name as show in more recent clients</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                std::string name = i.first;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                <span class="keywordflow">if</span> (realmflags &amp; <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2afda7734169f8aad2549a0a0aa4c04903">REALM_FLAG_SPECIFYBUILD</a>)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;                    <span class="keywordtype">char</span> buf[20];</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                    snprintf(buf, 20, <span class="stringliteral">&quot; (%u,%u,%u)&quot;</span>, buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#a237b695624508a4e0bea0170dca25a6b">major_version</a>, buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#ae48da4158d7ae46a57c212a1ca2d4680">minor_version</a>, buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#ab511eda89095e6708c131cc3dfba9f32">bugfix_version</a>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                    name += buf;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                }</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160; </div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <span class="comment">// Show offline state for unsupported client builds and locked realms (1.x clients not support locked state show)</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                <span class="keywordflow">if</span> (!ok_build || (i.second.allowedSecurityLevel &gt; <a class="code" href="classAuthSocket.html#a523fb1dc1550330422e697a6c23be543">_accountSecurityLevel</a>))</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;                    realmflags = <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2">RealmFlags</a>(realmflags | <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2a728d61b0842461c34b1f6167e5dcdb68">REALM_FLAG_OFFLINE</a>);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(i.second.icon);              <span class="comment">// realm type</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(realmflags);                   <span class="comment">// realmflags</span></div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                pkt &lt;&lt; name;                                <span class="comment">// name</span></div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                pkt &lt;&lt; i.second.address;                   <span class="comment">// address</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                pkt &lt;&lt; float(i.second.populationLevel);</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(AmountOfCharacters);</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(i.second.timezone);           <span class="comment">// realm category</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0x00);                         <span class="comment">// unk, may be realm number/id?</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160; </div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>(0x0002);                          <span class="comment">// unused value (why 2?)</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160; </div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">case</span> 8606:                                          <span class="comment">// 2.4.3</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <span class="keywordflow">case</span> 10505:                                         <span class="comment">// 3.2.2a</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">case</span> 11159:                                         <span class="comment">// 3.3.0a</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">case</span> 11403:                                         <span class="comment">// 3.3.2</span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">case</span> 11723:                                         <span class="comment">// 3.3.3a</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">case</span> 12340:                                         <span class="comment">// 3.3.5a</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">default</span>:                                            <span class="comment">// and later</span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                               <span class="comment">// unused value</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>(<a class="code" href="classAuthSocket.html#a7a61138ce507879c30bb3d7f2c6a25d0">getEligibleRealmCount</a>(securityLevel));</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; i : <a class="code" href="RealmList_8cpp.html#a0c5082ef857ee63e0c7d3c7b0789a834">sRealmList</a>)</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> AmountOfCharacters;</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                <span class="comment">// No SQL injection. id of realm is controlled by the database.</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT numchars FROM realmcharacters WHERE realmid = &#39;%d&#39; AND acctid=&#39;%u&#39;&quot;</span>, i.second.m_ID, acctid);</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                <span class="keywordflow">if</span> (result)</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                {</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                    <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                    AmountOfCharacters = fields[0].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                }</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                    AmountOfCharacters = 0;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;                <span class="keywordtype">bool</span> ok_build = std::find(i.second.realmbuilds.begin(), i.second.realmbuilds.end(), <a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>) != i.second.realmbuilds.end();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                <a class="code" href="structRealmBuildInfo.html">RealmBuildInfo</a> <span class="keyword">const</span>* buildInfo = ok_build ? <a class="code" href="group__realmd.html#gae4bf1972a0e7e0ab485781487b820634">FindBuildInfo</a>(<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                <span class="keywordflow">if</span> (!buildInfo)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    buildInfo = &amp;i.second.realmBuildInfo;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="comment">// Don&#39;t display higher security realms for players.</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <span class="keywordflow">if</span> (!securityLevel &amp;&amp; i.second.allowedSecurityLevel &gt; 0)</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> lock = (i.second.allowedSecurityLevel &gt; <a class="code" href="classAuthSocket.html#a523fb1dc1550330422e697a6c23be543">_accountSecurityLevel</a>) ? 1 : 0;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2">RealmFlags</a> realmFlags = i.second.realmflags;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                <span class="comment">// Show offline state for unsupported client builds</span></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                <span class="keywordflow">if</span> (!ok_build)</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                    realmFlags = <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2">RealmFlags</a>(realmFlags | <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2a728d61b0842461c34b1f6167e5dcdb68">REALM_FLAG_OFFLINE</a>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                <span class="keywordflow">if</span> (!buildInfo)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    realmFlags = <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2">RealmFlags</a>(realmFlags &amp; ~<a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2afda7734169f8aad2549a0a0aa4c04903">REALM_FLAG_SPECIFYBUILD</a>);</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160; </div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(i.second.icon);               <span class="comment">// realm type (this is second column in Cfg_Configs.dbc)</span></div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(lock);                         <span class="comment">// flags, if 0x01, then realm locked</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(realmFlags);                   <span class="comment">// see enum RealmFlags</span></div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                pkt &lt;&lt; i.first;                            <span class="comment">// name</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                pkt &lt;&lt; i.second.address;                   <span class="comment">// address</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                pkt &lt;&lt; float(i.second.populationLevel);</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(AmountOfCharacters);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(i.second.timezone);           <span class="comment">// realm category (Cfg_Categories.dbc)</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0x2C);                         <span class="comment">// unk, may be realm number/id?</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;                <span class="keywordflow">if</span> (realmFlags &amp; <a class="code" href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2afda7734169f8aad2549a0a0aa4c04903">REALM_FLAG_SPECIFYBUILD</a>)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;                {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#a237b695624508a4e0bea0170dca25a6b">major_version</a>);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#ae48da4158d7ae46a57c212a1ca2d4680">minor_version</a>);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#ab511eda89095e6708c131cc3dfba9f32">bugfix_version</a>);</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;                    pkt &lt;&lt; <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>(<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                }</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            }</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            pkt &lt;&lt; <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a>(0x0010);                          <span class="comment">// unused value (why 10?)</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;}</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a7a61138ce507879c30bb3d7f2c6a25d0">  971</a></span>&#160;<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <a class="code" href="classAuthSocket.html#a7a61138ce507879c30bb3d7f2c6a25d0">AuthSocket::getEligibleRealmCount</a>(<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> accountSecurityLevel)</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;{</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> size = 0;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; i : <a class="code" href="RealmList_8cpp.html#a0c5082ef857ee63e0c7d3c7b0789a834">sRealmList</a>)</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">if</span> (i.second.allowedSecurityLevel &lt;= accountSecurityLevel)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            size++;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">return</span> size;</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;}</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a38c7ecbde8cf6ab8e5ea44e60ec88b92">  982</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a38c7ecbde8cf6ab8e5ea44e60ec88b92">AuthSocket::_HandleXferResume</a>()</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleXferResume&quot;</span>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">ReadLengthRemaining</a>() &lt; 9)</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#ad7d7b4513b04feb49c985101bb360499">ReadSkip</a>(9);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;}</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; </div>
<div class="line"><a name="l00995"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a669988b6ad12e324ceb353b7d7d15a7e">  995</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a669988b6ad12e324ceb353b7d7d15a7e">AuthSocket::_HandleXferCancel</a>()</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;{</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleXferCancel&quot;</span>);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#ad7d7b4513b04feb49c985101bb360499">ReadSkip</a>(1);</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#a7d1040587af18478de244c02aead195c">Close</a>();</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;}</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01006"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a5ddd92e21fc2384f8f6fa7a55953a558"> 1006</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a5ddd92e21fc2384f8f6fa7a55953a558">AuthSocket::_HandleXferAccept</a>()</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;{</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Entering _HandleXferAccept&quot;</span>);</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <a class="code" href="classMaNGOS_1_1Socket.html#ad7d7b4513b04feb49c985101bb360499">ReadSkip</a>(1);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;}</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160; </div>
<div class="line"><a name="l01015"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a5e1b922a76d7926043171af4943899cf"> 1015</a></span>&#160;<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> <a class="code" href="classAuthSocket.html#a5e1b922a76d7926043171af4943899cf">AuthSocket::generateToken</a>(<span class="keywordtype">char</span> <span class="keyword">const</span>* b32key)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;{</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordtype">size_t</span> keySize = strlen(b32key);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordtype">size_t</span> bufSize = (keySize + 7) / 8 * 5;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordtype">char</span>* encoded = <span class="keyword">new</span> <span class="keywordtype">char</span>[bufSize];</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    memset(encoded, 0, bufSize);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> hmac_result_size = <a class="code" href="group__realmd.html#gabb6b700654346497d2f5481be2f9a708">HMAC_RES_SIZE</a>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> hmac_result[<a class="code" href="group__realmd.html#gabb6b700654346497d2f5481be2f9a708">HMAC_RES_SIZE</a>];</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> timestamp = time(<span class="keyword">nullptr</span>) / 30;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> challenge[8];</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 8; i--; timestamp &gt;&gt;= 8)</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        challenge[i] = timestamp;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <a class="code" href="base32_8cpp.html#a7495baf09c04582866f0e5eda8f683cf">base32_decode</a>(b32key, encoded, bufSize);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    HMAC(EVP_sha1(), encoded, bufSize, challenge, 8, hmac_result, &amp;hmac_result_size);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> offset = hmac_result[19] &amp; 0xF;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> truncHash = (hmac_result[offset] &lt;&lt; 24) | (hmac_result[offset + 1] &lt;&lt; 16) | (hmac_result[offset + 2] &lt;&lt; 8) | (hmac_result[offset + 3]);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    truncHash &amp;= 0x7FFFFFFF;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keyword">delete</span>[] encoded;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">return</span> truncHash % 1000000;</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;}</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"><a class="line" href="classAuthSocket.html#a262c5dc0ca59fc243c7b64c70ff268e2"> 1040</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classAuthSocket.html#a262c5dc0ca59fc243c7b64c70ff268e2">AuthSocket::VerifyVersion</a>(<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <span class="keyword">const</span>* a, <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> aLength, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> <span class="keyword">const</span>* versionProof, <span class="keywordtype">bool</span> isReconnect)</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;{</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="Config_8h.html#a6a9399e3a4b206a79bb911575ff3dae3">sConfig</a>.GetBoolDefault(<span class="stringliteral">&quot;StrictVersionCheck&quot;</span>, <span class="keyword">false</span>))</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    std::array&lt;uint8, 20&gt; zeros = { {} };</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    std::array&lt;uint8, 20&gt; <span class="keyword">const</span>* versionHash = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (!isReconnect)</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <a class="code" href="structRealmBuildInfo.html">RealmBuildInfo</a> <span class="keyword">const</span>* buildInfo = <a class="code" href="group__realmd.html#gae4bf1972a0e7e0ab485781487b820634">FindBuildInfo</a>(<a class="code" href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">_build</a>);</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        <span class="keywordflow">if</span> (!buildInfo)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a> == <span class="stringliteral">&quot;Win&quot;</span>)</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            versionHash = &amp;buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#a96abd69a458dfc4363c4e545fc7fabab">WindowsHash</a>;</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">m_os</a> == <span class="stringliteral">&quot;OSX&quot;</span>)</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;            versionHash = &amp;buildInfo-&gt;<a class="code" href="structRealmBuildInfo.html#ad59772e86371318fe975760e303fa7d9">MacHash</a>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">if</span> (!versionHash)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        <span class="keywordflow">if</span> (!memcmp(versionHash-&gt;data(), zeros.data(), zeros.size()))</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;                                                            <span class="comment">// not filled serverside</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        versionHash = &amp;zeros;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <a class="code" href="classCryptoHash.html">Sha1Hash</a> version;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    version.<a class="code" href="classCryptoHash.html#a5dfa99bee69279f472a004e4ae81436f">UpdateData</a>(a, aLength);</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    version.<a class="code" href="classCryptoHash.html#a5dfa99bee69279f472a004e4ae81436f">UpdateData</a>(versionHash-&gt;data(), versionHash-&gt;size());</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    version.<a class="code" href="classCryptoHash.html#a726c93fef6eb52889f6438c4daec6144">Finalize</a>();</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">return</span> memcmp(versionProof, version.<a class="code" href="classCryptoHash.html#a3158cb819f64595dc9091e46d573205d">GetDigest</a>(), version.<a class="code" href="classCryptoHash.html#a828fc61caad815134f0b404d80a24e62">GetLength</a>()) == 0;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div>
<div class="ttc" id="aAuthCodes_8h_html"><div class="ttname"><a href="AuthCodes_8h.html">AuthCodes.h</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607b"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607b">eAuthCmd</a></div><div class="ttdeci">eAuthCmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00028">AuthCodes.h:29</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607ba254b3a87afe0ac82f79f999d2d254fa3"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba254b3a87afe0ac82f79f999d2d254fa3">CMD_XFER_RESUME</a></div><div class="ttdeci">@ CMD_XFER_RESUME</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00039">AuthCodes.h:39</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607ba32b2d7c2c35ddb12a029ffbdec45dd1e"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32b2d7c2c35ddb12a029ffbdec45dd1e">CMD_AUTH_RECONNECT_CHALLENGE</a></div><div class="ttdeci">@ CMD_AUTH_RECONNECT_CHALLENGE</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00032">AuthCodes.h:32</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba32bec4bcd3e3e927e7e789976a60c2e8">CMD_AUTH_LOGON_PROOF</a></div><div class="ttdeci">@ CMD_AUTH_LOGON_PROOF</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00031">AuthCodes.h:31</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607ba67fee67fef01cda5a29c6e4076b8b2ef"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba67fee67fef01cda5a29c6e4076b8b2ef">CMD_REALM_LIST</a></div><div class="ttdeci">@ CMD_REALM_LIST</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00034">AuthCodes.h:34</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607ba81257bfbc2b946081cb1b8fcfc653419"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607ba81257bfbc2b946081cb1b8fcfc653419">CMD_AUTH_RECONNECT_PROOF</a></div><div class="ttdeci">@ CMD_AUTH_RECONNECT_PROOF</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00033">AuthCodes.h:33</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607baa0d4656e5e896b91167174ef4ee571ec"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607baa0d4656e5e896b91167174ef4ee571ec">CMD_XFER_ACCEPT</a></div><div class="ttdeci">@ CMD_XFER_ACCEPT</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00038">AuthCodes.h:38</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607bac3faf7eb22c45016905bcdf6f343d355"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607bac3faf7eb22c45016905bcdf6f343d355">CMD_XFER_CANCEL</a></div><div class="ttdeci">@ CMD_XFER_CANCEL</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00041">AuthCodes.h:40</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a345cff35e97e1d164879db077b96607baf1f5233caea83c7786c7f7fe5f543069"><div class="ttname"><a href="AuthCodes_8h.html#a345cff35e97e1d164879db077b96607baf1f5233caea83c7786c7f7fe5f543069">CMD_AUTH_LOGON_CHALLENGE</a></div><div class="ttdeci">@ CMD_AUTH_LOGON_CHALLENGE</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00030">AuthCodes.h:30</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a511eb6b854747f82e0ca96f5cfa9f43da13095592f9ea787641f66f94f53ed444"><div class="ttname"><a href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da13095592f9ea787641f66f94f53ed444">AUTH_LOGON_FAILED_FAIL_NOACCESS</a></div><div class="ttdeci">@ AUTH_LOGON_FAILED_FAIL_NOACCESS</div><div class="ttdoc">Unable to connect.</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00075">AuthCodes.h:75</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a511eb6b854747f82e0ca96f5cfa9f43da31fb73a69dbc21f4f55ded7a5b4eb3ff"><div class="ttname"><a href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da31fb73a69dbc21f4f55ded7a5b4eb3ff">AUTH_LOGON_FAILED_BANNED</a></div><div class="ttdeci">@ AUTH_LOGON_FAILED_BANNED</div><div class="ttdoc">This &lt;game&gt; account has been closed and is no longer available for use. Please go to &lt;site&gt;/banned....</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00064">AuthCodes.h:64</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a511eb6b854747f82e0ca96f5cfa9f43da353464e73c375c7003148dc0d155c955"><div class="ttname"><a href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da353464e73c375c7003148dc0d155c955">AUTH_LOGON_SUCCESS</a></div><div class="ttdeci">@ AUTH_LOGON_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00061">AuthCodes.h:61</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6"><div class="ttname"><a href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da6228e9b4b33d35c9ad398e2044e414f6">AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</a></div><div class="ttdeci">@ AUTH_LOGON_FAILED_UNKNOWN_ACCOUNT</div><div class="ttdoc">The information you have entered is not valid. Please check the spelling of the account name and pass...</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00065">AuthCodes.h:65</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a511eb6b854747f82e0ca96f5cfa9f43da8351fec1446ed32a654d8556c35388dd"><div class="ttname"><a href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43da8351fec1446ed32a654d8556c35388dd">AUTH_LOGON_FAILED_SUSPENDED</a></div><div class="ttdeci">@ AUTH_LOGON_FAILED_SUSPENDED</div><div class="ttdoc">This &lt;game&gt; account has been temporarily suspended. Please go to &lt;site&gt;/banned.html for further infor...</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00074">AuthCodes.h:74</a></div></div>
<div class="ttc" id="aAuthCodes_8h_html_a511eb6b854747f82e0ca96f5cfa9f43dae9a047729e3382be712c1ebd34a49ec7"><div class="ttname"><a href="AuthCodes_8h.html#a511eb6b854747f82e0ca96f5cfa9f43dae9a047729e3382be712c1ebd34a49ec7">AUTH_LOGON_FAILED_VERSION_INVALID</a></div><div class="ttdeci">@ AUTH_LOGON_FAILED_VERSION_INVALID</div><div class="ttdoc">Unable to validate game version. This may be caused by file corruption or interference of another pro...</div><div class="ttdef"><b>Definition:</b> <a href="AuthCodes_8h_source.html#l00071">AuthCodes.h:71</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_a1241a754e900fac64f49cadc4e806321"><div class="ttname"><a href="AuthSocket_8cpp.html#a1241a754e900fac64f49cadc4e806321">sAuthLogonProof_S</a></div><div class="ttdeci">struct AUTH_LOGON_PROOF_S sAuthLogonProof_S</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_a242dcc388ff0edb5d5eca57953e61317"><div class="ttname"><a href="AuthSocket_8cpp.html#a242dcc388ff0edb5d5eca57953e61317">VersionChallenge</a></div><div class="ttdeci">std::array&lt; uint8, 16 &gt; VersionChallenge</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00178">AuthSocket.cpp:178</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_a2f20547d03b1332fb0fe018d608f1dd9"><div class="ttname"><a href="AuthSocket_8cpp.html#a2f20547d03b1332fb0fe018d608f1dd9">XFER_INIT</a></div><div class="ttdeci">struct XFER_INIT XFER_INIT</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_a7ca873e23eb6f6b6994763b66b4cc382"><div class="ttname"><a href="AuthSocket_8cpp.html#a7ca873e23eb6f6b6994763b66b4cc382">sAuthLogonPinData_C</a></div><div class="ttdeci">struct AUTH_LOGON_PIN_DATA_C sAuthLogonPinData_C</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_ab50c6b56b4c56513ab11e4bee50a0116"><div class="ttname"><a href="AuthSocket_8cpp.html#ab50c6b56b4c56513ab11e4bee50a0116">sAuthLogonProof_C</a></div><div class="ttdeci">struct AUTH_LOGON_PROOF_C sAuthLogonProof_C</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_abfc7d73e457d7b2083e9e4a7c406b4a0"><div class="ttname"><a href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0">SecurityFlags</a></div><div class="ttdeci">SecurityFlags</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00051">AuthSocket.cpp:52</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_abfc7d73e457d7b2083e9e4a7c406b4a0a661aa371b0c8446ba0eb38da7db18b65"><div class="ttname"><a href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a661aa371b0c8446ba0eb38da7db18b65">SECURITY_FLAG_NONE</a></div><div class="ttdeci">@ SECURITY_FLAG_NONE</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00053">AuthSocket.cpp:53</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_abfc7d73e457d7b2083e9e4a7c406b4a0a6fff4c7a8a46103c144c94c2959dc340"><div class="ttname"><a href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a6fff4c7a8a46103c144c94c2959dc340">SECURITY_FLAG_PIN</a></div><div class="ttdeci">@ SECURITY_FLAG_PIN</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00054">AuthSocket.cpp:54</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021"><div class="ttname"><a href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0a7884664dabab04da8faa6bffa54d3021">SECURITY_FLAG_AUTHENTICATOR</a></div><div class="ttdeci">@ SECURITY_FLAG_AUTHENTICATOR</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00057">AuthSocket.cpp:56</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_abfc7d73e457d7b2083e9e4a7c406b4a0af36eddcde894beb9359bf4d10d7f7790"><div class="ttname"><a href="AuthSocket_8cpp.html#abfc7d73e457d7b2083e9e4a7c406b4a0af36eddcde894beb9359bf4d10d7f7790">SECURITY_FLAG_UNK</a></div><div class="ttdeci">@ SECURITY_FLAG_UNK</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00055">AuthSocket.cpp:55</a></div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_ac68cfe0714ca2055e4d76090071448f2"><div class="ttname"><a href="AuthSocket_8cpp.html#ac68cfe0714ca2055e4d76090071448f2">sAuthLogonProof_S_BUILD_6005</a></div><div class="ttdeci">struct AUTH_LOGON_PROOF_S_BUILD_6005 sAuthLogonProof_S_BUILD_6005</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_acf29ad85543a1d128b5b6bb662e4610a"><div class="ttname"><a href="AuthSocket_8cpp.html#acf29ad85543a1d128b5b6bb662e4610a">AuthHandler</a></div><div class="ttdeci">struct AuthHandler AuthHandler</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_aef6ea8864e443cf0d192820bb670a8d8"><div class="ttname"><a href="AuthSocket_8cpp.html#aef6ea8864e443cf0d192820bb670a8d8">sAuthReconnectProof_C</a></div><div class="ttdeci">struct AUTH_RECONNECT_PROOF_C sAuthReconnectProof_C</div></div>
<div class="ttc" id="aAuthSocket_8cpp_html_af2b75a713ab063d15c0f303555dab7c2"><div class="ttname"><a href="AuthSocket_8cpp.html#af2b75a713ab063d15c0f303555dab7c2">sAuthLogonChallenge_C</a></div><div class="ttdeci">struct AUTH_LOGON_CHALLENGE_C sAuthLogonChallenge_C</div></div>
<div class="ttc" id="aAuthSocket_8h_html"><div class="ttname"><a href="AuthSocket_8h.html">AuthSocket.h</a></div></div>
<div class="ttc" id="aByteConverter_8h_html_a9d20b1e463a04f0a22d79ca802902be6"><div class="ttname"><a href="ByteConverter_8h.html#a9d20b1e463a04f0a22d79ca802902be6">EndianConvert</a></div><div class="ttdeci">void EndianConvert(T &amp;val)</div><div class="ttdef"><b>Definition:</b> <a href="ByteConverter_8h_source.html#l00049">ByteConverter.h:49</a></div></div>
<div class="ttc" id="aCommonDefines_8h_html"><div class="ttname"><a href="CommonDefines_8h.html">CommonDefines.h</a></div></div>
<div class="ttc" id="aCommonDefines_8h_html_a2d23c4249c4d0ef998c9309eeb084b17acdbd0cea23cc448b4d917904444001dd"><div class="ttname"><a href="CommonDefines_8h.html#a2d23c4249c4d0ef998c9309eeb084b17acdbd0cea23cc448b4d917904444001dd">LOGIN_TYPE_REALMD</a></div><div class="ttdeci">@ LOGIN_TYPE_REALMD</div><div class="ttdef"><b>Definition:</b> <a href="CommonDefines_8h_source.html#l00024">CommonDefines.h:24</a></div></div>
<div class="ttc" id="aCommon_8h_html"><div class="ttname"><a href="Common_8h.html">Common.h</a></div></div>
<div class="ttc" id="aCommon_8h_html_ace3f717ac43bef67791faeb2a0b2c1e2"><div class="ttname"><a href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2">RealmFlags</a></div><div class="ttdeci">RealmFlags</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00131">Common.h:132</a></div></div>
<div class="ttc" id="aCommon_8h_html_ace3f717ac43bef67791faeb2a0b2c1e2a728d61b0842461c34b1f6167e5dcdb68"><div class="ttname"><a href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2a728d61b0842461c34b1f6167e5dcdb68">REALM_FLAG_OFFLINE</a></div><div class="ttdeci">@ REALM_FLAG_OFFLINE</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00135">Common.h:135</a></div></div>
<div class="ttc" id="aCommon_8h_html_ace3f717ac43bef67791faeb2a0b2c1e2afda7734169f8aad2549a0a0aa4c04903"><div class="ttname"><a href="Common_8h.html#ace3f717ac43bef67791faeb2a0b2c1e2afda7734169f8aad2549a0a0aa4c04903">REALM_FLAG_SPECIFYBUILD</a></div><div class="ttdeci">@ REALM_FLAG_SPECIFYBUILD</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00136">Common.h:136</a></div></div>
<div class="ttc" id="aCommon_8h_html_ad02db78fbe7773265246ca3010f23f6f"><div class="ttname"><a href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6f">AccountTypes</a></div><div class="ttdeci">AccountTypes</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00121">Common.h:122</a></div></div>
<div class="ttc" id="aCommon_8h_html_ad02db78fbe7773265246ca3010f23f6fa5d534fd54528d86d0f997fa130159df0"><div class="ttname"><a href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa5d534fd54528d86d0f997fa130159df0">SEC_PLAYER</a></div><div class="ttdeci">@ SEC_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00123">Common.h:123</a></div></div>
<div class="ttc" id="aCommon_8h_html_ad02db78fbe7773265246ca3010f23f6fa6a04b5fbbc52adb152bfb45b600db102"><div class="ttname"><a href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa6a04b5fbbc52adb152bfb45b600db102">SEC_ADMINISTRATOR</a></div><div class="ttdeci">@ SEC_ADMINISTRATOR</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00126">Common.h:126</a></div></div>
<div class="ttc" id="aConfig_8h_html"><div class="ttname"><a href="Config_8h.html">Config.h</a></div></div>
<div class="ttc" id="aConfig_8h_html_a6a9399e3a4b206a79bb911575ff3dae3"><div class="ttname"><a href="Config_8h.html#a6a9399e3a4b206a79bb911575ff3dae3">sConfig</a></div><div class="ttdeci">#define sConfig</div><div class="ttdef"><b>Definition:</b> <a href="Config_8h_source.html#l00051">Config.h:51</a></div></div>
<div class="ttc" id="aDatabaseEnv_8h_html"><div class="ttname"><a href="DatabaseEnv_8h.html">DatabaseEnv.h</a></div></div>
<div class="ttc" id="aDefine_8h_html_a0bf9964a3ce962c07ad3d8b5432bbbcd"><div class="ttname"><a href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a></div><div class="ttdeci">std::int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00112">Define.h:112</a></div></div>
<div class="ttc" id="aDefine_8h_html_a15a8d014fadf85c99a2268d8cbd00767"><div class="ttname"><a href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a></div><div class="ttdeci">std::uint8_t uint8</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00118">Define.h:118</a></div></div>
<div class="ttc" id="aDefine_8h_html_a22f78cc9780bf32aff91ae17c3101c8d"><div class="ttname"><a href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a></div><div class="ttdeci">std::uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00116">Define.h:116</a></div></div>
<div class="ttc" id="aDefine_8h_html_ac4dd6ce78ce3b840c53bd4b3c63ed09b"><div class="ttname"><a href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a></div><div class="ttdeci">std::uint64_t uint64</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00115">Define.h:115</a></div></div>
<div class="ttc" id="aDefine_8h_html_ad9c79638db63f1dfe2b085743b5cbf7b"><div class="ttname"><a href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a></div><div class="ttdeci">std::uint16_t uint16</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00117">Define.h:117</a></div></div>
<div class="ttc" id="aHMACSHA1_8h_html"><div class="ttname"><a href="HMACSHA1_8h.html">HMACSHA1.h</a></div></div>
<div class="ttc" id="aLog_8h_html"><div class="ttname"><a href="Log_8h.html">Log.h</a></div></div>
<div class="ttc" id="aLog_8h_html_a21a2c7330a04ac78200a986f66609369"><div class="ttname"><a href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a></div><div class="ttdeci">#define DEBUG_LOG(...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00262">Log.h:262</a></div></div>
<div class="ttc" id="aLog_8h_html_a66ee45c2c4582addc7fba4147eb4741c"><div class="ttname"><a href="Log_8h.html#a66ee45c2c4582addc7fba4147eb4741c">BASIC_LOG</a></div><div class="ttdeci">#define BASIC_LOG(...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00238">Log.h:238</a></div></div>
<div class="ttc" id="aLog_8h_html_ab5487500f5b4b12072043104b916d582"><div class="ttname"><a href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a></div><div class="ttdeci">#define sLog</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00236">Log.h:236</a></div></div>
<div class="ttc" id="aRealmList_8cpp_html_a0c5082ef857ee63e0c7d3c7b0789a834"><div class="ttname"><a href="RealmList_8cpp.html#a0c5082ef857ee63e0c7d3c7b0789a834">sRealmList</a></div><div class="ttdeci">RealmList &amp; sRealmList</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8cpp_source.html#l00088">RealmList.cpp:89</a></div></div>
<div class="ttc" id="aRealmList_8h_html"><div class="ttname"><a href="RealmList_8h.html">RealmList.h</a></div></div>
<div class="ttc" id="aSRP6_8h_html"><div class="ttname"><a href="SRP6_8h.html">SRP6.h</a></div></div>
<div class="ttc" id="abase32_8cpp_html_a7495baf09c04582866f0e5eda8f683cf"><div class="ttname"><a href="base32_8cpp.html#a7495baf09c04582866f0e5eda8f683cf">base32_decode</a></div><div class="ttdeci">int base32_decode(char const *encoded, char *result, int bufSize)</div><div class="ttdef"><b>Definition:</b> <a href="base32_8cpp_source.html#l00022">base32.cpp:22</a></div></div>
<div class="ttc" id="abase32_8h_html"><div class="ttname"><a href="base32_8h.html">base32.h</a></div></div>
<div class="ttc" id="aclassAuthSocket_html"><div class="ttname"><a href="classAuthSocket.html">AuthSocket</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00040">AuthSocket.h:41</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a061ce2e9c8a0a47a3bcda3b84a573798"><div class="ttname"><a href="classAuthSocket.html#a061ce2e9c8a0a47a3bcda3b84a573798">AuthSocket::m_timeoutTimer</a></div><div class="ttdeci">boost::asio::deadline_timer m_timeoutTimer</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00093">AuthSocket.h:93</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a0dda56465c6c87c3fc9949371767f862"><div class="ttname"><a href="classAuthSocket.html#a0dda56465c6c87c3fc9949371767f862">AuthSocket::_status</a></div><div class="ttdeci">eStatus _status</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00081">AuthSocket.h:81</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a1c34212dcbff07e6a3111713ac84e1c2"><div class="ttname"><a href="classAuthSocket.html#a1c34212dcbff07e6a3111713ac84e1c2">AuthSocket::_build</a></div><div class="ttdeci">uint16 _build</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00090">AuthSocket.h:90</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a1ebf33dec375d8785cceb035816bd4a7"><div class="ttname"><a href="classAuthSocket.html#a1ebf33dec375d8785cceb035816bd4a7">AuthSocket::m_platform</a></div><div class="ttdeci">std::string m_platform</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00087">AuthSocket.h:87</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a262c5dc0ca59fc243c7b64c70ff268e2"><div class="ttname"><a href="classAuthSocket.html#a262c5dc0ca59fc243c7b64c70ff268e2">AuthSocket::VerifyVersion</a></div><div class="ttdeci">bool VerifyVersion(uint8 const *a, int32 aLength, uint8 const *versionProof, bool isReconnect)</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l01040">AuthSocket.cpp:1040</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a30ec5807044e390030466bd445155140"><div class="ttname"><a href="classAuthSocket.html#a30ec5807044e390030466bd445155140">AuthSocket::AuthSocket</a></div><div class="ttdeci">AuthSocket(boost::asio::io_service &amp;service, std::function&lt; void(Socket *)&gt; closeHandler)</div><div class="ttdoc">Constructor - set the N and g values for SRP6.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00181">AuthSocket.cpp:181</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a3233c23e533fef61e14ddc7870521f02"><div class="ttname"><a href="classAuthSocket.html#a3233c23e533fef61e14ddc7870521f02">AuthSocket::Open</a></div><div class="ttdeci">bool Open() override</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00186">AuthSocket.cpp:186</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a36eb350ec6fa5c42175a35539f7afa16"><div class="ttname"><a href="classAuthSocket.html#a36eb350ec6fa5c42175a35539f7afa16">AuthSocket::_HandleRealmList</a></div><div class="ttdeci">bool _HandleRealmList()</div><div class="ttdoc">Realm List command handler</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00795">AuthSocket.cpp:795</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a38c7ecbde8cf6ab8e5ea44e60ec88b92"><div class="ttname"><a href="classAuthSocket.html#a38c7ecbde8cf6ab8e5ea44e60ec88b92">AuthSocket::_HandleXferResume</a></div><div class="ttdeci">bool _HandleXferResume()</div><div class="ttdoc">Resume patch transfer.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00982">AuthSocket.cpp:982</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a3bbcd5fc1582a4b32e7caf57a159f159"><div class="ttname"><a href="classAuthSocket.html#a3bbcd5fc1582a4b32e7caf57a159f159">AuthSocket::_HandleLogonProof</a></div><div class="ttdeci">bool _HandleLogonProof()</div><div class="ttdoc">Logon Proof command handler.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00515">AuthSocket.cpp:515</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a520c7c12512568090ac1998ddb0820f0"><div class="ttname"><a href="classAuthSocket.html#a520c7c12512568090ac1998ddb0820f0">AuthSocket::_HandleReconnectChallenge</a></div><div class="ttdeci">bool _HandleReconnectChallenge()</div><div class="ttdoc">Reconnect Challenge command handler.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00672">AuthSocket.cpp:672</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a523fb1dc1550330422e697a6c23be543"><div class="ttname"><a href="classAuthSocket.html#a523fb1dc1550330422e697a6c23be543">AuthSocket::_accountSecurityLevel</a></div><div class="ttdeci">AccountTypes _accountSecurityLevel</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00091">AuthSocket.h:91</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a5ddd92e21fc2384f8f6fa7a55953a558"><div class="ttname"><a href="classAuthSocket.html#a5ddd92e21fc2384f8f6fa7a55953a558">AuthSocket::_HandleXferAccept</a></div><div class="ttdeci">bool _HandleXferAccept()</div><div class="ttdoc">Accept patch transfer.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l01006">AuthSocket.cpp:1006</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a5e1b922a76d7926043171af4943899cf"><div class="ttname"><a href="classAuthSocket.html#a5e1b922a76d7926043171af4943899cf">AuthSocket::generateToken</a></div><div class="ttdeci">int32 generateToken(char const *b32key)</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l01015">AuthSocket.cpp:1015</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a669988b6ad12e324ceb353b7d7d15a7e"><div class="ttname"><a href="classAuthSocket.html#a669988b6ad12e324ceb353b7d7d15a7e">AuthSocket::_HandleXferCancel</a></div><div class="ttdeci">bool _HandleXferCancel()</div><div class="ttdoc">Cancel patch transfer.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00995">AuthSocket.cpp:995</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a690068dd53b76ffac5bc01707c35ac4e"><div class="ttname"><a href="classAuthSocket.html#a690068dd53b76ffac5bc01707c35ac4e">AuthSocket::_safelogin</a></div><div class="ttdeci">std::string _safelogin</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00084">AuthSocket.h:84</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a6d5c1867a511279a6f1e59b9de2813c9"><div class="ttname"><a href="classAuthSocket.html#a6d5c1867a511279a6f1e59b9de2813c9">AuthSocket::_HandleLogonChallenge</a></div><div class="ttdeci">bool _HandleLogonChallenge()</div><div class="ttdoc">Logon Challenge command handler.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00308">AuthSocket.cpp:308</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a7a61138ce507879c30bb3d7f2c6a25d0"><div class="ttname"><a href="classAuthSocket.html#a7a61138ce507879c30bb3d7f2c6a25d0">AuthSocket::getEligibleRealmCount</a></div><div class="ttdeci">uint8 getEligibleRealmCount(uint8 accountSecurityLevel)</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00971">AuthSocket.cpp:971</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_a987a68e0fe5256ce6b6d5e6647f68589"><div class="ttname"><a href="classAuthSocket.html#a987a68e0fe5256ce6b6d5e6647f68589">AuthSocket::_reconnectProof</a></div><div class="ttdeci">BigNumber _reconnectProof</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00079">AuthSocket.h:79</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aa68aa3a2281b1418acd3f52dcef4934b"><div class="ttname"><a href="classAuthSocket.html#aa68aa3a2281b1418acd3f52dcef4934b">AuthSocket::SendProof</a></div><div class="ttdeci">void SendProof(Sha1Hash sha)</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00268">AuthSocket.cpp:268</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aa7347457175a2f3188f1764fd10ee2f6"><div class="ttname"><a href="classAuthSocket.html#aa7347457175a2f3188f1764fd10ee2f6">AuthSocket::m_locale</a></div><div class="ttdeci">std::string m_locale</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00088">AuthSocket.h:88</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aae7d1f8233af9234fbf0616dcc1d250ca24cd7be5d07b7f91c58ab07c6aa0b05a"><div class="ttname"><a href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca24cd7be5d07b7f91c58ab07c6aa0b05a">AuthSocket::STATUS_CHALLENGE</a></div><div class="ttdeci">@ STATUS_CHALLENGE</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00070">AuthSocket.h:70</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aae7d1f8233af9234fbf0616dcc1d250ca33274de9803fb85087ec1d4986090f49"><div class="ttname"><a href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca33274de9803fb85087ec1d4986090f49">AuthSocket::STATUS_PATCH</a></div><div class="ttdeci">@ STATUS_PATCH</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00073">AuthSocket.h:73</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aae7d1f8233af9234fbf0616dcc1d250ca47a34bb74328acf79893f5bbaa4fe706"><div class="ttname"><a href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca47a34bb74328acf79893f5bbaa4fe706">AuthSocket::STATUS_RECON_PROOF</a></div><div class="ttdeci">@ STATUS_RECON_PROOF</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00072">AuthSocket.h:72</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aae7d1f8233af9234fbf0616dcc1d250ca9c6865343efa388ebdf57f83745cbd23"><div class="ttname"><a href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250ca9c6865343efa388ebdf57f83745cbd23">AuthSocket::STATUS_LOGON_PROOF</a></div><div class="ttdeci">@ STATUS_LOGON_PROOF</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00071">AuthSocket.h:71</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aae7d1f8233af9234fbf0616dcc1d250cabcff47f6269eecf20ff824247e635a21"><div class="ttname"><a href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cabcff47f6269eecf20ff824247e635a21">AuthSocket::STATUS_AUTHED</a></div><div class="ttdeci">@ STATUS_AUTHED</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00074">AuthSocket.h:74</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aae7d1f8233af9234fbf0616dcc1d250cae4ed50e41f51e639b045f3e50328d104"><div class="ttname"><a href="classAuthSocket.html#aae7d1f8233af9234fbf0616dcc1d250cae4ed50e41f51e639b045f3e50328d104">AuthSocket::STATUS_CLOSED</a></div><div class="ttdeci">@ STATUS_CLOSED</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00076">AuthSocket.h:75</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_ab4040a680a0af19e0ce9a7e3f1a7974d"><div class="ttname"><a href="classAuthSocket.html#ab4040a680a0af19e0ce9a7e3f1a7974d">AuthSocket::m_os</a></div><div class="ttdeci">std::string m_os</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00086">AuthSocket.h:86</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_ac87ad41040b9faaa26e368ce0d134c84"><div class="ttname"><a href="classAuthSocket.html#ac87ad41040b9faaa26e368ce0d134c84">AuthSocket::_token</a></div><div class="ttdeci">std::string _token</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00085">AuthSocket.h:85</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_ad16d531e4d4a0b36b5faf8450e62073d"><div class="ttname"><a href="classAuthSocket.html#ad16d531e4d4a0b36b5faf8450e62073d">AuthSocket::_login</a></div><div class="ttdeci">std::string _login</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00083">AuthSocket.h:83</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_adaef22b052f07909c3618975e5c9e860"><div class="ttname"><a href="classAuthSocket.html#adaef22b052f07909c3618975e5c9e860">AuthSocket::ProcessIncomingData</a></div><div class="ttdeci">virtual bool ProcessIncomingData() override</div><div class="ttdoc">Read the packet from the client.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00204">AuthSocket.cpp:204</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_ade209ba287b12c740b092aeca2a62538"><div class="ttname"><a href="classAuthSocket.html#ade209ba287b12c740b092aeca2a62538">AuthSocket::_HandleReconnectProof</a></div><div class="ttdeci">bool _HandleReconnectProof()</div><div class="ttdoc">Reconnect Proof command handler.</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00743">AuthSocket.cpp:743</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_aedac77a0c2672ed3db2caa27b5f477c0"><div class="ttname"><a href="classAuthSocket.html#aedac77a0c2672ed3db2caa27b5f477c0">AuthSocket::srp</a></div><div class="ttdeci">SRP6 srp</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00078">AuthSocket.h:78</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_af4d106456302f79b6a2caa40aa382919"><div class="ttname"><a href="classAuthSocket.html#af4d106456302f79b6a2caa40aa382919">AuthSocket::LoadRealmlist</a></div><div class="ttdeci">void LoadRealmlist(ByteBuffer &amp;pkt, uint32 acctid, uint8 accountSecurityLevel=0)</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00834">AuthSocket.cpp:834</a></div></div>
<div class="ttc" id="aclassAuthSocket_html_af96c3519a980b42b02aedf5b89b5ab7b"><div class="ttname"><a href="classAuthSocket.html#af96c3519a980b42b02aedf5b89b5ab7b">AuthSocket::_safelocale</a></div><div class="ttdeci">std::string _safelocale</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00089">AuthSocket.h:89</a></div></div>
<div class="ttc" id="aclassBigNumber_html"><div class="ttname"><a href="classBigNumber.html">BigNumber</a></div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8h_source.html#l00027">BigNumber.h:28</a></div></div>
<div class="ttc" id="aclassBigNumber_html_a15f3c90e40267c8d003e4650c045d00f"><div class="ttname"><a href="classBigNumber.html#a15f3c90e40267c8d003e4650c045d00f">BigNumber::AsByteArray</a></div><div class="ttdeci">std::vector&lt; uint8 &gt; AsByteArray(int minSize=0, bool reverse=true) const</div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8cpp_source.html#l00160">BigNumber.cpp:160</a></div></div>
<div class="ttc" id="aclassBigNumber_html_a29de18ae491024be0844fa4e3e02595d"><div class="ttname"><a href="classBigNumber.html#a29de18ae491024be0844fa4e3e02595d">BigNumber::SetRand</a></div><div class="ttdeci">void SetRand(int numbits)</div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8cpp_source.html#l00073">BigNumber.cpp:73</a></div></div>
<div class="ttc" id="aclassBigNumber_html_a375fb446549fb9472c879c8db0beaa91"><div class="ttname"><a href="classBigNumber.html#a375fb446549fb9472c879c8db0beaa91">BigNumber::GetNumBytes</a></div><div class="ttdeci">int GetNumBytes(void) const</div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8cpp_source.html#l00145">BigNumber.cpp:145</a></div></div>
<div class="ttc" id="aclassBigNumber_html_ae565f1bc704940309f66a72e696e0c67"><div class="ttname"><a href="classBigNumber.html#ae565f1bc704940309f66a72e696e0c67">BigNumber::SetBinary</a></div><div class="ttdeci">void SetBinary(const uint8 *bytes, int len)</div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8cpp_source.html#l00060">BigNumber.cpp:60</a></div></div>
<div class="ttc" id="aclassBigNumber_html_aee55a1b16c529876c6d0c2e4907c25ef"><div class="ttname"><a href="classBigNumber.html#aee55a1b16c529876c6d0c2e4907c25ef">BigNumber::AsHexStr</a></div><div class="ttdeci">const char * AsHexStr() const</div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8cpp_source.html#l00181">BigNumber.cpp:181</a></div></div>
<div class="ttc" id="aclassBigNumber_html_af9f9038e53f3239e44c7331211951722"><div class="ttname"><a href="classBigNumber.html#af9f9038e53f3239e44c7331211951722">BigNumber::SetHexStr</a></div><div class="ttdeci">int SetHexStr(const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="BigNumber_8cpp_source.html#l00068">BigNumber.cpp:68</a></div></div>
<div class="ttc" id="aclassByteBuffer_html"><div class="ttname"><a href="classByteBuffer.html">ByteBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00049">ByteBuffer.h:50</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a34c70c1643043147e6994b8c82614867"><div class="ttname"><a href="classByteBuffer.html#a34c70c1643043147e6994b8c82614867">ByteBuffer::contents</a></div><div class="ttdeci">const uint8 * contents() const</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00363">ByteBuffer.h:363</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_ab71feec2acb9ff88a5c7c7d0adaa7653"><div class="ttname"><a href="classByteBuffer.html#ab71feec2acb9ff88a5c7c7d0adaa7653">ByteBuffer::append</a></div><div class="ttdeci">void append(const std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00381">ByteBuffer.h:381</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_ac06a598447807d32f6594a97a32bce94"><div class="ttname"><a href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">ByteBuffer::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00365">ByteBuffer.h:365</a></div></div>
<div class="ttc" id="aclassCryptoHash_html"><div class="ttname"><a href="classCryptoHash.html">CryptoHash&lt; EVP_sha1, SHA_DIGEST_LENGTH &gt;</a></div></div>
<div class="ttc" id="aclassCryptoHash_html_a3158cb819f64595dc9091e46d573205d"><div class="ttname"><a href="classCryptoHash.html#a3158cb819f64595dc9091e46d573205d">CryptoHash::GetDigest</a></div><div class="ttdeci">uint8 * GetDigest()</div><div class="ttdef"><b>Definition:</b> <a href="CryptoHash_8h_source.html#l00097">CryptoHash.h:97</a></div></div>
<div class="ttc" id="aclassCryptoHash_html_a35a40018d774f708a1340b7f9d0ad0e7"><div class="ttname"><a href="classCryptoHash.html#a35a40018d774f708a1340b7f9d0ad0e7">CryptoHash::UpdateBigNumbers</a></div><div class="ttdeci">void UpdateBigNumbers(BigNumber *bn0,...)</div><div class="ttdef"><b>Definition:</b> <a href="CryptoHash_8h_source.html#l00077">CryptoHash.h:77</a></div></div>
<div class="ttc" id="aclassCryptoHash_html_a36b91834c1eb241217c42671a619fd70"><div class="ttname"><a href="classCryptoHash.html#a36b91834c1eb241217c42671a619fd70">CryptoHash::Initialize</a></div><div class="ttdeci">int Initialize()</div><div class="ttdef"><b>Definition:</b> <a href="CryptoHash_8h_source.html#l00094">CryptoHash.h:94</a></div></div>
<div class="ttc" id="aclassCryptoHash_html_a5dfa99bee69279f472a004e4ae81436f"><div class="ttname"><a href="classCryptoHash.html#a5dfa99bee69279f472a004e4ae81436f">CryptoHash::UpdateData</a></div><div class="ttdeci">int UpdateData(const uint8 *data, int len)</div><div class="ttdef"><b>Definition:</b> <a href="CryptoHash_8h_source.html#l00090">CryptoHash.h:90</a></div></div>
<div class="ttc" id="aclassCryptoHash_html_a726c93fef6eb52889f6438c4daec6144"><div class="ttname"><a href="classCryptoHash.html#a726c93fef6eb52889f6438c4daec6144">CryptoHash::Finalize</a></div><div class="ttdeci">int Finalize()</div><div class="ttdef"><b>Definition:</b> <a href="CryptoHash_8h_source.html#l00095">CryptoHash.h:95</a></div></div>
<div class="ttc" id="aclassCryptoHash_html_a828fc61caad815134f0b404d80a24e62"><div class="ttname"><a href="classCryptoHash.html#a828fc61caad815134f0b404d80a24e62">CryptoHash&lt; EVP_sha1, SHA_DIGEST_LENGTH &gt;::GetLength</a></div><div class="ttdeci">constexpr static size_t GetLength()</div><div class="ttdef"><b>Definition:</b> <a href="CryptoHash_8h_source.html#l00098">CryptoHash.h:98</a></div></div>
<div class="ttc" id="aclassDatabaseMysql_html"><div class="ttname"><a href="classDatabaseMysql.html">DatabaseMysql</a></div><div class="ttdef"><b>Definition:</b> <a href="DatabaseMysql_8h_source.html#l00092">DatabaseMysql.h:93</a></div></div>
<div class="ttc" id="aclassDatabase_html_a1379d88f95a689d8b6f7ff0fd9215b4d"><div class="ttname"><a href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">Database::PExecute</a></div><div class="ttdeci">bool PExecute(const char *format,...) ATTR_PRINTF(2</div><div class="ttdef"><b>Definition:</b> <a href="Database_8cpp_source.html#l00348">Database.cpp:348</a></div></div>
<div class="ttc" id="aclassDatabase_html_a3ae8fc1a519edd7205cdc708a8949d54"><div class="ttname"><a href="classDatabase.html#a3ae8fc1a519edd7205cdc708a8949d54">Database::escape_string</a></div><div class="ttdeci">void escape_string(std::string &amp;str)</div><div class="ttdef"><b>Definition:</b> <a href="Database_8cpp_source.html#l00204">Database.cpp:204</a></div></div>
<div class="ttc" id="aclassDatabase_html_ae9332e6ba803852091f432bc329a62bc"><div class="ttname"><a href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">Database::PQuery</a></div><div class="ttdeci">QueryResult * PQuery(const char *format,...) ATTR_PRINTF(2</div><div class="ttdef"><b>Definition:</b> <a href="Database_8cpp_source.html#l00286">Database.cpp:286</a></div></div>
<div class="ttc" id="aclassField_html"><div class="ttname"><a href="classField.html">Field</a></div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00024">Field.h:25</a></div></div>
<div class="ttc" id="aclassField_html_a090beafdf8b41555058a87d00443498a"><div class="ttname"><a href="classField.html#a090beafdf8b41555058a87d00443498a">Field::GetUInt8</a></div><div class="ttdeci">uint8 GetUInt8() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00056">Field.h:56</a></div></div>
<div class="ttc" id="aclassField_html_ab8c1a7e73265f7b14457ab37cf20681c"><div class="ttname"><a href="classField.html#ab8c1a7e73265f7b14457ab37cf20681c">Field::GetString</a></div><div class="ttdeci">const char * GetString() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00045">Field.h:45</a></div></div>
<div class="ttc" id="aclassField_html_ac3fe5bf9cdc61b5be66a4c79598cba5e"><div class="ttname"><a href="classField.html#ac3fe5bf9cdc61b5be66a4c79598cba5e">Field::GetCppString</a></div><div class="ttdeci">std::string GetCppString() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00049">Field.h:49</a></div></div>
<div class="ttc" id="aclassField_html_af71c97fd38da328f4d9590b112f859c4"><div class="ttname"><a href="classField.html#af71c97fd38da328f4d9590b112f859c4">Field::GetUInt32</a></div><div class="ttdeci">uint32 GetUInt32() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00059">Field.h:59</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_a349c70325d7681aa34ac282782a378f0"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#a349c70325d7681aa34ac282782a378f0">MaNGOS::Socket::Read</a></div><div class="ttdeci">bool Read(char *buffer, int length)</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8cpp_source.html#l00162">Socket.cpp:162</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_a5b6389efad4934d36c57b2c802207509"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#a5b6389efad4934d36c57b2c802207509">MaNGOS::Socket::m_address</a></div><div class="ttdeci">const std::string m_address</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8hpp_source.html#l00080">Socket.hpp:80</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_a7d1040587af18478de244c02aead195c"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#a7d1040587af18478de244c02aead195c">MaNGOS::Socket::Close</a></div><div class="ttdeci">void Close()</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8cpp_source.html#l00064">Socket.cpp:64</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_ab906a8d1f0d88acc16246b95df6f140b"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#ab906a8d1f0d88acc16246b95df6f140b">MaNGOS::Socket::InPeak</a></div><div class="ttdeci">const uint8 * InPeak() const</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8hpp_source.html#l00087">Socket.hpp:87</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_abc13050b11f8dc2d09746bdf0364d685"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#abc13050b11f8dc2d09746bdf0364d685">MaNGOS::Socket::Write</a></div><div class="ttdeci">void Write(const char *buffer, int length)</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8cpp_source.html#l00189">Socket.cpp:189</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_abf3df98f52f5bd99178ec41eebeda4c8"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#abf3df98f52f5bd99178ec41eebeda4c8">MaNGOS::Socket::IsClosed</a></div><div class="ttdeci">bool IsClosed() const</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8hpp_source.html#l00100">Socket.hpp:100</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_ad7d7b4513b04feb49c985101bb360499"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#ad7d7b4513b04feb49c985101bb360499">MaNGOS::Socket::ReadSkip</a></div><div class="ttdeci">void ReadSkip(int length)</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8hpp_source.html#l00104">Socket.hpp:104</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1Socket_html_af4f72e226c152f2066d9acc8a426075a"><div class="ttname"><a href="classMaNGOS_1_1Socket.html#af4f72e226c152f2066d9acc8a426075a">MaNGOS::Socket::ReadLengthRemaining</a></div><div class="ttdeci">int ReadLengthRemaining() const</div><div class="ttdef"><b>Definition:</b> <a href="Socket_8hpp_source.html#l00089">Socket.hpp:89</a></div></div>
<div class="ttc" id="aclassQueryResult_html"><div class="ttname"><a href="classQueryResult.html">QueryResult</a></div><div class="ttdef"><b>Definition:</b> <a href="QueryResult_8h_source.html#l00026">QueryResult.h:27</a></div></div>
<div class="ttc" id="aclassQueryResult_html_ae59bcb12d59b9a369953be91ddb5c446"><div class="ttname"><a href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">QueryResult::Fetch</a></div><div class="ttdeci">Field * Fetch() const</div><div class="ttdef"><b>Definition:</b> <a href="QueryResult_8h_source.html#l00036">QueryResult.h:36</a></div></div>
<div class="ttc" id="aclassRealmList_html_a8ef22c6190216680d72d8d1fef6687a4"><div class="ttname"><a href="classRealmList.html#a8ef22c6190216680d72d8d1fef6687a4">RealmList::UpdateIfNeed</a></div><div class="ttdeci">void UpdateIfNeed()</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8cpp_source.html#l00142">RealmList.cpp:142</a></div></div>
<div class="ttc" id="aclassSRP6_html_a20f18ebac8ab4ec54dfb81c6ebdb6d50"><div class="ttname"><a href="classSRP6.html#a20f18ebac8ab4ec54dfb81c6ebdb6d50">SRP6::GetPrime</a></div><div class="ttdeci">BigNumber GetPrime(void)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8h_source.html#l00105">SRP6.h:105</a></div></div>
<div class="ttc" id="aclassSRP6_html_a4f49d7d0c6e33233dd2c02f776a1a766"><div class="ttname"><a href="classSRP6.html#a4f49d7d0c6e33233dd2c02f776a1a766">SRP6::GetHostPublicEphemeral</a></div><div class="ttdeci">BigNumber GetHostPublicEphemeral(void)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8h_source.html#l00103">SRP6.h:103</a></div></div>
<div class="ttc" id="aclassSRP6_html_a57b3b714f39e94b299fd5d90da61831e"><div class="ttname"><a href="classSRP6.html#a57b3b714f39e94b299fd5d90da61831e">SRP6::SetStrongSessionKey</a></div><div class="ttdeci">void SetStrongSessionKey(const char *new_K)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8h_source.html#l00112">SRP6.h:112</a></div></div>
<div class="ttc" id="aclassSRP6_html_a5c990f970e799c75dccc5179b180c946"><div class="ttname"><a href="classSRP6.html#a5c990f970e799c75dccc5179b180c946">SRP6::SetSalt</a></div><div class="ttdeci">bool SetSalt(const char *new_s)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00195">SRP6.cpp:195</a></div></div>
<div class="ttc" id="aclassSRP6_html_a5f1a3de992f923d555c4199e2f8a18f8"><div class="ttname"><a href="classSRP6.html#a5f1a3de992f923d555c4199e2f8a18f8">SRP6::Finalize</a></div><div class="ttdeci">void Finalize(Sha1Hash &amp;sha)</div><div class="ttdoc">generate hash for proof of strong session key (K)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00188">SRP6.cpp:188</a></div></div>
<div class="ttc" id="aclassSRP6_html_a6593b3dfdc4ee61217e9313685fb753d"><div class="ttname"><a href="classSRP6.html#a6593b3dfdc4ee61217e9313685fb753d">SRP6::SetVerifier</a></div><div class="ttdeci">bool SetVerifier(const char *new_v)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00201">SRP6.cpp:201</a></div></div>
<div class="ttc" id="aclassSRP6_html_a673dd68aa7bf73cea3b70e4f2b33a093"><div class="ttname"><a href="classSRP6.html#a673dd68aa7bf73cea3b70e4f2b33a093">SRP6::Proof</a></div><div class="ttdeci">bool Proof(uint8 *lp_M, int l)</div><div class="ttdoc">compares proof (M) of strong session key (K)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00165">SRP6.cpp:165</a></div></div>
<div class="ttc" id="aclassSRP6_html_a74776df90fbeb71eb4f630cb137103aa"><div class="ttname"><a href="classSRP6.html#a74776df90fbeb71eb4f630cb137103aa">SRP6::HashSessionKey</a></div><div class="ttdeci">void HashSessionKey(void)</div><div class="ttdoc">generates a strong session key (K) of session key (S)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00133">SRP6.cpp:133</a></div></div>
<div class="ttc" id="aclassSRP6_html_aca610d23a3c906601a514c049b75658d"><div class="ttname"><a href="classSRP6.html#aca610d23a3c906601a514c049b75658d">SRP6::CalculateHostPublicEphemeral</a></div><div class="ttdeci">void CalculateHostPublicEphemeral(void)</div><div class="ttdoc">calculates the host public ephemeral (B)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00031">SRP6.cpp:31</a></div></div>
<div class="ttc" id="aclassSRP6_html_ad94e5b8da1fbf8fee36a69faae99ed6e"><div class="ttname"><a href="classSRP6.html#ad94e5b8da1fbf8fee36a69faae99ed6e">SRP6::CalculateSessionKey</a></div><div class="ttdeci">bool CalculateSessionKey(uint8 *lp_A, int l)</div><div class="ttdoc">calculates a session key (S) based on client public ephemeral (A)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00073">SRP6.cpp:73</a></div></div>
<div class="ttc" id="aclassSRP6_html_ae9008d4d1e310598c7a74319a07ba3fd"><div class="ttname"><a href="classSRP6.html#ae9008d4d1e310598c7a74319a07ba3fd">SRP6::CalculateProof</a></div><div class="ttdeci">void CalculateProof(std::string username)</div><div class="ttdoc">calculates proof (M) of the strong session key (K)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8cpp_source.html#l00040">SRP6.cpp:40</a></div></div>
<div class="ttc" id="aclassSRP6_html_aec4b02cee59c0a4b6a4ba41df470c833"><div class="ttname"><a href="classSRP6.html#aec4b02cee59c0a4b6a4ba41df470c833">SRP6::GetStrongSessionKey</a></div><div class="ttdeci">BigNumber GetStrongSessionKey(void)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8h_source.html#l00108">SRP6.h:108</a></div></div>
<div class="ttc" id="aclassSRP6_html_afae913818204de92ca32f43db40ee234"><div class="ttname"><a href="classSRP6.html#afae913818204de92ca32f43db40ee234">SRP6::GetGeneratorModulo</a></div><div class="ttdeci">BigNumber GetGeneratorModulo(void)</div><div class="ttdef"><b>Definition:</b> <a href="SRP6_8h_source.html#l00104">SRP6.h:104</a></div></div>
<div class="ttc" id="ago__scripts_8cpp_html_af644fca167e62eaa31e0f48bb7d1946c"><div class="ttname"><a href="go__scripts_8cpp.html#af644fca167e62eaa31e0f48bb7d1946c">function</a></div><div class="ttdeci">std::function&lt; bool(Unit *)&gt; function</div><div class="ttdef"><b>Definition:</b> <a href="go__scripts_8cpp_source.html#l00956">go_scripts.cpp:956</a></div></div>
<div class="ttc" id="agroup__mangosd_html_ga8dc09682b17696c62c0fae61abccbdb1"><div class="ttname"><a href="group__mangosd.html#ga8dc09682b17696c62c0fae61abccbdb1">LoginDatabase</a></div><div class="ttdeci">DatabaseType LoginDatabase</div><div class="ttdoc">Accessor to the realm/login database.</div><div class="ttdef"><b>Definition:</b> <a href="mangosd_2Main_8cpp_source.html#l00063">mangosd/Main.cpp:63</a></div></div>
<div class="ttc" id="agroup__realmd_html_gabb6b700654346497d2f5481be2f9a708"><div class="ttname"><a href="group__realmd.html#gabb6b700654346497d2f5481be2f9a708">HMAC_RES_SIZE</a></div><div class="ttdeci">#define HMAC_RES_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8h_source.html#l00038">AuthSocket.h:38</a></div></div>
<div class="ttc" id="agroup__realmd_html_gae4bf1972a0e7e0ab485781487b820634"><div class="ttname"><a href="group__realmd.html#gae4bf1972a0e7e0ab485781487b820634">FindBuildInfo</a></div><div class="ttdeci">RealmBuildInfo const  * FindBuildInfo(uint16 _build)</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8cpp_source.html#l00069">RealmList.cpp:69</a></div></div>
<div class="ttc" id="agroup__u2w_html_ga23bad8f2ffee1800642899520f67d119"><div class="ttname"><a href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119">AccountFlags</a></div><div class="ttdeci">AccountFlags</div><div class="ttdef"><b>Definition:</b> <a href="WorldSession_8h_source.html#l00196">WorldSession.h:197</a></div></div>
<div class="ttc" id="agroup__u2w_html_ga23bad8f2ffee1800642899520f67d119a26b4915525a102bd4e4d69648922e285"><div class="ttname"><a href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a26b4915525a102bd4e4d69648922e285">ACCOUNT_FLAG_TRIAL</a></div><div class="ttdeci">@ ACCOUNT_FLAG_TRIAL</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00047">AuthSocket.cpp:47</a></div></div>
<div class="ttc" id="agroup__u2w_html_ga23bad8f2ffee1800642899520f67d119a34287a507b4770b6bc0fd3189bf380cd"><div class="ttname"><a href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a34287a507b4770b6bc0fd3189bf380cd">ACCOUNT_FLAG_GM</a></div><div class="ttdeci">@ ACCOUNT_FLAG_GM</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00046">AuthSocket.cpp:46</a></div></div>
<div class="ttc" id="agroup__u2w_html_ga23bad8f2ffee1800642899520f67d119a4f1108d36673f24c7f00620b7385257b"><div class="ttname"><a href="group__u2w.html#ga23bad8f2ffee1800642899520f67d119a4f1108d36673f24c7f00620b7385257b">ACCOUNT_FLAG_PROPASS</a></div><div class="ttdeci">@ ACCOUNT_FLAG_PROPASS</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00048">AuthSocket.cpp:48</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00261">ObjectGuid.h:262</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html">AUTH_LOGON_CHALLENGE_C</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00066">AuthSocket.cpp:67</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a296fd5746ea3ad8f5b341cd92ecb92a6"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a296fd5746ea3ad8f5b341cd92ecb92a6">AUTH_LOGON_CHALLENGE_C::cmd</a></div><div class="ttdeci">uint8 cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00068">AuthSocket.cpp:68</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a36a4e2114203cbec036c7f6c6ba1f11b"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a36a4e2114203cbec036c7f6c6ba1f11b">AUTH_LOGON_CHALLENGE_C::error</a></div><div class="ttdeci">uint8 error</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00069">AuthSocket.cpp:69</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a44cdd2733fb678966bc3252b6bef9d16"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a44cdd2733fb678966bc3252b6bef9d16">AUTH_LOGON_CHALLENGE_C::timezone_bias</a></div><div class="ttdeci">uint32 timezone_bias</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00079">AuthSocket.cpp:79</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a48ed2eb4f17a62d033320b981fe9d07c"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a48ed2eb4f17a62d033320b981fe9d07c">AUTH_LOGON_CHALLENGE_C::I</a></div><div class="ttdeci">uint8 I[1]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00082">AuthSocket.cpp:82</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a4c2989e284a86a7257c3f4a7b507265c"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a4c2989e284a86a7257c3f4a7b507265c">AUTH_LOGON_CHALLENGE_C::build</a></div><div class="ttdeci">uint16 build</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00075">AuthSocket.cpp:75</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a5391c693d5aee76e67001f648b108792"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a5391c693d5aee76e67001f648b108792">AUTH_LOGON_CHALLENGE_C::country</a></div><div class="ttdeci">uint8 country[4]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00078">AuthSocket.cpp:78</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a589c5dadf3e694ba5e3d9f1e5732426e"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a589c5dadf3e694ba5e3d9f1e5732426e">AUTH_LOGON_CHALLENGE_C::I_len</a></div><div class="ttdeci">uint8 I_len</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00081">AuthSocket.cpp:81</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a5993cfad4be8f9e457bd6067ced6bd2a"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a5993cfad4be8f9e457bd6067ced6bd2a">AUTH_LOGON_CHALLENGE_C::ip</a></div><div class="ttdeci">uint32 ip</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00080">AuthSocket.cpp:80</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_a6a9e5088baf8c568916891a55e035db3"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#a6a9e5088baf8c568916891a55e035db3">AUTH_LOGON_CHALLENGE_C::version3</a></div><div class="ttdeci">uint8 version3</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00074">AuthSocket.cpp:74</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_aa7a794d75e11e98aa9f88cb8e82be9e9"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#aa7a794d75e11e98aa9f88cb8e82be9e9">AUTH_LOGON_CHALLENGE_C::version1</a></div><div class="ttdeci">uint8 version1</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00072">AuthSocket.cpp:72</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_aae293343b590c23405a32d2809887020"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#aae293343b590c23405a32d2809887020">AUTH_LOGON_CHALLENGE_C::size</a></div><div class="ttdeci">uint16 size</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00070">AuthSocket.cpp:70</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_abe9218ee7ebdffa48dd404a2ad465ca4"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#abe9218ee7ebdffa48dd404a2ad465ca4">AUTH_LOGON_CHALLENGE_C::version2</a></div><div class="ttdeci">uint8 version2</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00073">AuthSocket.cpp:73</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_ad8c71a1e514e6b8f6d6a4681ba1db0c1"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#ad8c71a1e514e6b8f6d6a4681ba1db0c1">AUTH_LOGON_CHALLENGE_C::os</a></div><div class="ttdeci">uint8 os[4]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00077">AuthSocket.cpp:77</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_ae6f5a1b7c4684bb96deaa51cb9cfc7bc"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#ae6f5a1b7c4684bb96deaa51cb9cfc7bc">AUTH_LOGON_CHALLENGE_C::gamename</a></div><div class="ttdeci">uint8 gamename[4]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00071">AuthSocket.cpp:71</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__CHALLENGE__C_html_afc0d27e7213846988c0ee7ccc5e54ee0"><div class="ttname"><a href="structAUTH__LOGON__CHALLENGE__C.html#afc0d27e7213846988c0ee7ccc5e54ee0">AUTH_LOGON_CHALLENGE_C::platform</a></div><div class="ttdeci">uint8 platform[4]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00076">AuthSocket.cpp:76</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PIN__DATA__C_html"><div class="ttname"><a href="structAUTH__LOGON__PIN__DATA__C.html">AUTH_LOGON_PIN_DATA_C</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00085">AuthSocket.cpp:86</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PIN__DATA__C_html_abf73f728548012164dbe9645ce60c9df"><div class="ttname"><a href="structAUTH__LOGON__PIN__DATA__C.html#abf73f728548012164dbe9645ce60c9df">AUTH_LOGON_PIN_DATA_C::salt</a></div><div class="ttdeci">uint8 salt[16]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00087">AuthSocket.cpp:87</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PIN__DATA__C_html_ad96ad23fbc35574fa33fbc22146c259e"><div class="ttname"><a href="structAUTH__LOGON__PIN__DATA__C.html#ad96ad23fbc35574fa33fbc22146c259e">AUTH_LOGON_PIN_DATA_C::hash</a></div><div class="ttdeci">uint8 hash[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00088">AuthSocket.cpp:88</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html">AUTH_LOGON_PROOF_C</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00108">AuthSocket.cpp:109</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html_a1ce54d5c269d3e77c94010d29040c0e1"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html#a1ce54d5c269d3e77c94010d29040c0e1">AUTH_LOGON_PROOF_C::M1</a></div><div class="ttdeci">uint8 M1[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00112">AuthSocket.cpp:112</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html_a4233534385acef9a41fd9181d9d35252"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html#a4233534385acef9a41fd9181d9d35252">AUTH_LOGON_PROOF_C::crc_hash</a></div><div class="ttdeci">uint8 crc_hash[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00113">AuthSocket.cpp:113</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html_a51b29f49e940bffa67988d9bc2b16aa4"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html#a51b29f49e940bffa67988d9bc2b16aa4">AUTH_LOGON_PROOF_C::cmd</a></div><div class="ttdeci">uint8 cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00110">AuthSocket.cpp:110</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html_a8d1b6da4090879fa479610f7b69806cc"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html#a8d1b6da4090879fa479610f7b69806cc">AUTH_LOGON_PROOF_C::A</a></div><div class="ttdeci">uint8 A[32]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00111">AuthSocket.cpp:111</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html_ad8f9f53d462f1abd5c81413e0ed8b0a7"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html#ad8f9f53d462f1abd5c81413e0ed8b0a7">AUTH_LOGON_PROOF_C::number_of_keys</a></div><div class="ttdeci">uint8 number_of_keys</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00114">AuthSocket.cpp:114</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__C_html_ae2ab466af9513c15cbcea7a20e97ddc5"><div class="ttname"><a href="structAUTH__LOGON__PROOF__C.html#ae2ab466af9513c15cbcea7a20e97ddc5">AUTH_LOGON_PROOF_C::securityFlags</a></div><div class="ttdeci">uint8 securityFlags</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00115">AuthSocket.cpp:115</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S__BUILD__6005_html"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S__BUILD__6005.html">AUTH_LOGON_PROOF_S_BUILD_6005</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00136">AuthSocket.cpp:137</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S__BUILD__6005_html_a0f49d957165cdd3056cd617303bd4df6"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a0f49d957165cdd3056cd617303bd4df6">AUTH_LOGON_PROOF_S_BUILD_6005::error</a></div><div class="ttdeci">uint8 error</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00139">AuthSocket.cpp:139</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S__BUILD__6005_html_a662b072206cc87b06ef2db024c644c40"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a662b072206cc87b06ef2db024c644c40">AUTH_LOGON_PROOF_S_BUILD_6005::M2</a></div><div class="ttdeci">uint8 M2[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00140">AuthSocket.cpp:140</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S__BUILD__6005_html_a6ec820d730f2c380c98af081c86cedba"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#a6ec820d730f2c380c98af081c86cedba">AUTH_LOGON_PROOF_S_BUILD_6005::LoginFlags</a></div><div class="ttdeci">uint32 LoginFlags</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00142">AuthSocket.cpp:142</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S__BUILD__6005_html_ace085e366eef6c3cc5a0f1bfdcfa0503"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S__BUILD__6005.html#ace085e366eef6c3cc5a0f1bfdcfa0503">AUTH_LOGON_PROOF_S_BUILD_6005::cmd</a></div><div class="ttdeci">uint8 cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00138">AuthSocket.cpp:138</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html">AUTH_LOGON_PROOF_S</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00126">AuthSocket.cpp:127</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html_a38966a5c5563c87a1ff7a05ca820094c"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html#a38966a5c5563c87a1ff7a05ca820094c">AUTH_LOGON_PROOF_S::unkFlags</a></div><div class="ttdeci">uint16 unkFlags</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00133">AuthSocket.cpp:133</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html_a5846630b9df94b9f4784e59e7f320257"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html#a5846630b9df94b9f4784e59e7f320257">AUTH_LOGON_PROOF_S::cmd</a></div><div class="ttdeci">uint8 cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00128">AuthSocket.cpp:128</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html_a5cbbda99be5cd0549dd43fc0e546007e"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html#a5cbbda99be5cd0549dd43fc0e546007e">AUTH_LOGON_PROOF_S::error</a></div><div class="ttdeci">uint8 error</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00129">AuthSocket.cpp:129</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html_ac0a4fb839f6aaa5e2f07242af9b2ad6c"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html#ac0a4fb839f6aaa5e2f07242af9b2ad6c">AUTH_LOGON_PROOF_S::accountFlags</a></div><div class="ttdeci">uint32 accountFlags</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00131">AuthSocket.cpp:131</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html_ad47c715e53f6c7583b559170365652a2"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html#ad47c715e53f6c7583b559170365652a2">AUTH_LOGON_PROOF_S::M2</a></div><div class="ttdeci">uint8 M2[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00130">AuthSocket.cpp:130</a></div></div>
<div class="ttc" id="astructAUTH__LOGON__PROOF__S_html_af5e62bc75f068b727367cfe00bf8bd35"><div class="ttname"><a href="structAUTH__LOGON__PROOF__S.html#af5e62bc75f068b727367cfe00bf8bd35">AUTH_LOGON_PROOF_S::surveyId</a></div><div class="ttdeci">uint32 surveyId</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00132">AuthSocket.cpp:132</a></div></div>
<div class="ttc" id="astructAUTH__RECONNECT__PROOF__C_html"><div class="ttname"><a href="structAUTH__RECONNECT__PROOF__C.html">AUTH_RECONNECT_PROOF_C</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00146">AuthSocket.cpp:147</a></div></div>
<div class="ttc" id="astructAUTH__RECONNECT__PROOF__C_html_a054648a96d1c66bae6fdb9a174e7b1e6"><div class="ttname"><a href="structAUTH__RECONNECT__PROOF__C.html#a054648a96d1c66bae6fdb9a174e7b1e6">AUTH_RECONNECT_PROOF_C::R1</a></div><div class="ttdeci">uint8 R1[16]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00149">AuthSocket.cpp:149</a></div></div>
<div class="ttc" id="astructAUTH__RECONNECT__PROOF__C_html_a14df856ae931474a7c58d0e35caf6ad0"><div class="ttname"><a href="structAUTH__RECONNECT__PROOF__C.html#a14df856ae931474a7c58d0e35caf6ad0">AUTH_RECONNECT_PROOF_C::cmd</a></div><div class="ttdeci">uint8 cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00148">AuthSocket.cpp:148</a></div></div>
<div class="ttc" id="astructAUTH__RECONNECT__PROOF__C_html_aaa44734bb96b91894c038b3f34b4db0d"><div class="ttname"><a href="structAUTH__RECONNECT__PROOF__C.html#aaa44734bb96b91894c038b3f34b4db0d">AUTH_RECONNECT_PROOF_C::number_of_keys</a></div><div class="ttdeci">uint8 number_of_keys</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00152">AuthSocket.cpp:152</a></div></div>
<div class="ttc" id="astructAUTH__RECONNECT__PROOF__C_html_ad296d79f9e0b658e719ba577e3eadd35"><div class="ttname"><a href="structAUTH__RECONNECT__PROOF__C.html#ad296d79f9e0b658e719ba577e3eadd35">AUTH_RECONNECT_PROOF_C::R3</a></div><div class="ttdeci">uint8 R3[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00151">AuthSocket.cpp:151</a></div></div>
<div class="ttc" id="astructAUTH__RECONNECT__PROOF__C_html_ae65e9c6ae7d7964fe56877eb0438e0fd"><div class="ttname"><a href="structAUTH__RECONNECT__PROOF__C.html#ae65e9c6ae7d7964fe56877eb0438e0fd">AUTH_RECONNECT_PROOF_C::R2</a></div><div class="ttdeci">uint8 R2[20]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00150">AuthSocket.cpp:150</a></div></div>
<div class="ttc" id="astructAuthHandler_html"><div class="ttname"><a href="structAuthHandler.html">AuthHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00164">AuthSocket.cpp:165</a></div></div>
<div class="ttc" id="astructAuthHandler_html_a0cb921a18c8cd1d26b327b74e29ea4b6"><div class="ttname"><a href="structAuthHandler.html#a0cb921a18c8cd1d26b327b74e29ea4b6">AuthHandler::handler</a></div><div class="ttdeci">bool(AuthSocket::* handler)(void)</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00168">AuthSocket.cpp:168</a></div></div>
<div class="ttc" id="astructAuthHandler_html_a1073e291bacadf4202a88f27d5bbd14a"><div class="ttname"><a href="structAuthHandler.html#a1073e291bacadf4202a88f27d5bbd14a">AuthHandler::cmd</a></div><div class="ttdeci">eAuthCmd cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00166">AuthSocket.cpp:166</a></div></div>
<div class="ttc" id="astructAuthHandler_html_a2feaf8602d9937e452d0aab87fc7fd54"><div class="ttname"><a href="structAuthHandler.html#a2feaf8602d9937e452d0aab87fc7fd54">AuthHandler::status</a></div><div class="ttdeci">uint32 status</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00167">AuthSocket.cpp:167</a></div></div>
<div class="ttc" id="astructRealmBuildInfo_html"><div class="ttname"><a href="structRealmBuildInfo.html">RealmBuildInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8h_source.html#l00029">RealmList.h:30</a></div></div>
<div class="ttc" id="astructRealmBuildInfo_html_a237b695624508a4e0bea0170dca25a6b"><div class="ttname"><a href="structRealmBuildInfo.html#a237b695624508a4e0bea0170dca25a6b">RealmBuildInfo::major_version</a></div><div class="ttdeci">int major_version</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8h_source.html#l00032">RealmList.h:32</a></div></div>
<div class="ttc" id="astructRealmBuildInfo_html_a96abd69a458dfc4363c4e545fc7fabab"><div class="ttname"><a href="structRealmBuildInfo.html#a96abd69a458dfc4363c4e545fc7fabab">RealmBuildInfo::WindowsHash</a></div><div class="ttdeci">std::array&lt; uint8, 20 &gt; WindowsHash</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8h_source.html#l00036">RealmList.h:36</a></div></div>
<div class="ttc" id="astructRealmBuildInfo_html_ab511eda89095e6708c131cc3dfba9f32"><div class="ttname"><a href="structRealmBuildInfo.html#ab511eda89095e6708c131cc3dfba9f32">RealmBuildInfo::bugfix_version</a></div><div class="ttdeci">int bugfix_version</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8h_source.html#l00034">RealmList.h:34</a></div></div>
<div class="ttc" id="astructRealmBuildInfo_html_ad59772e86371318fe975760e303fa7d9"><div class="ttname"><a href="structRealmBuildInfo.html#ad59772e86371318fe975760e303fa7d9">RealmBuildInfo::MacHash</a></div><div class="ttdeci">std::array&lt; uint8, 20 &gt; MacHash</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8h_source.html#l00037">RealmList.h:37</a></div></div>
<div class="ttc" id="astructRealmBuildInfo_html_ae48da4158d7ae46a57c212a1ca2d4680"><div class="ttname"><a href="structRealmBuildInfo.html#ae48da4158d7ae46a57c212a1ca2d4680">RealmBuildInfo::minor_version</a></div><div class="ttdeci">int minor_version</div><div class="ttdef"><b>Definition:</b> <a href="RealmList_8h_source.html#l00033">RealmList.h:33</a></div></div>
<div class="ttc" id="astructXFER__INIT_html"><div class="ttname"><a href="structXFER__INIT.html">XFER_INIT</a></div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00155">AuthSocket.cpp:156</a></div></div>
<div class="ttc" id="astructXFER__INIT_html_a43898ab1d9f0aff091bbd5b9c1c01982"><div class="ttname"><a href="structXFER__INIT.html#a43898ab1d9f0aff091bbd5b9c1c01982">XFER_INIT::fileNameLen</a></div><div class="ttdeci">uint8 fileNameLen</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00158">AuthSocket.cpp:158</a></div></div>
<div class="ttc" id="astructXFER__INIT_html_a46e14acdd28e77b3ab0ff60541662dd7"><div class="ttname"><a href="structXFER__INIT.html#a46e14acdd28e77b3ab0ff60541662dd7">XFER_INIT::fileName</a></div><div class="ttdeci">uint8 fileName[5]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00159">AuthSocket.cpp:159</a></div></div>
<div class="ttc" id="astructXFER__INIT_html_acf790da02aa6f1af2fcf0cf3e75828b0"><div class="ttname"><a href="structXFER__INIT.html#acf790da02aa6f1af2fcf0cf3e75828b0">XFER_INIT::file_size</a></div><div class="ttdeci">uint64 file_size</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00160">AuthSocket.cpp:160</a></div></div>
<div class="ttc" id="astructXFER__INIT_html_ad4c8231cf73fd42faa658a83c06e3188"><div class="ttname"><a href="structXFER__INIT.html#ad4c8231cf73fd42faa658a83c06e3188">XFER_INIT::cmd</a></div><div class="ttdeci">uint8 cmd</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00157">AuthSocket.cpp:157</a></div></div>
<div class="ttc" id="astructXFER__INIT_html_afd8d5b506d50ffce4708bf71c0cb9f1f"><div class="ttname"><a href="structXFER__INIT.html#afd8d5b506d50ffce4708bf71c0cb9f1f">XFER_INIT::md5</a></div><div class="ttdeci">uint8 md5[MD5_DIGEST_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="AuthSocket_8cpp_source.html#l00161">AuthSocket.cpp:161</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5e48ddfb4e05b9852f22863cf45c80b0.html">realmd</a></li><li class="navelem"><a class="el" href="AuthSocket_8cpp.html">AuthSocket.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
