<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CMaNGOS_WoTLK: BattleGroundMgr.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CMaNGOS_WoTLK
   &#160;<span id="projectnumber">0b6ed145724bbfe54f426dc34e27de563eb3bc54</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('BattleGroundMgr_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">BattleGroundMgr.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="BattleGroundMgr_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of the CMaNGOS Project. See AUTHORS file for Copyright information</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Common_8h.html">Common.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SharedDefines_8h.html">Globals/SharedDefines.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Player_8h.html">Entities/Player.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundMgr_8h.html">BattleGroundMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundAV_8h.html">BattleGroundAV.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundAB_8h.html">BattleGroundAB.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundEY_8h.html">BattleGroundEY.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundWS_8h.html">BattleGroundWS.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundNA_8h.html">BattleGroundNA.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundBE_8h.html">BattleGroundBE.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundRL_8h.html">BattleGroundRL.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundSA_8h.html">BattleGroundSA.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundDS_8h.html">BattleGroundDS.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundRV_8h.html">BattleGroundRV.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGroundIC_8h.html">BattleGroundIC.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MapManager_8h.html">Maps/MapManager.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Map_8h.html">Maps/Map.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObjectMgr_8h.html">Globals/ObjectMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProgressBar_8h.html">Util/ProgressBar.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chat_8h.html">Chat/Chat.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ArenaTeam_8h.html">Arena/ArenaTeam.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="World_8h.html">World/World.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="WorldPacket_8h.html">Server/WorldPacket.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GameEventMgr_8h.html">GameEvents/GameEventMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Formulas_8h.html">Tools/Formulas.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Mail_8h.html">Mails/Mail.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LootMgr_8h.html">Loot/LootMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Singleton_8h.html">Policies/Singleton.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="BattleGroundMgr_8cpp.html#aba15c4b26c1f1d8ab7ceefb35f7949b3">   49</a></span>&#160;<a class="code" href="BattleGroundMgr_8cpp.html#aba15c4b26c1f1d8ab7ceefb35f7949b3">INSTANTIATE_SINGLETON_1</a>(<a class="code" href="classBattleGroundMgr.html">BattleGroundMgr</a>);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">/***            BATTLEGROUND QUEUE SYSTEM              ***/</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a8eb51f824e6d65b6567388317038db67">   55</a></span>&#160;<a class="code" href="classBattleGroundQueue.html#a8eb51f824e6d65b6567388317038db67">BattleGroundQueue::BattleGroundQueue</a>()</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>; ++i)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> j = 0; j &lt; <a class="code" href="DBCEnums_8h.html#a5201a522ecfb21f8b94bcab8b2ba2f8c">MAX_BATTLEGROUND_BRACKETS</a>; ++j)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a5fe6153dbc84016dc15f149fb9826314">m_sumOfWaitTimes</a>[i][j] = 0;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a1255a24104fcc3636463b07dee12ee27">m_waitTimeLastPlayer</a>[i][j] = 0;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> k = 0; k &lt; <a class="code" href="BattleGroundMgr_8h.html#acdd9d5422fecea59405438851a2d1f7c">COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME</a>; ++k)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;                <a class="code" href="classBattleGroundQueue.html#a220dc1527cfe4c1f362b373b2cd3de3a">m_waitTimes</a>[i][j][k] = 0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#ace4e82d788dc6ba44b32804a006b6e2c">   70</a></span>&#160;<a class="code" href="classBattleGroundQueue.html#ace4e82d788dc6ba44b32804a006b6e2c">BattleGroundQueue::~BattleGroundQueue</a>()</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.clear();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; m_queuedGroup : <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> j = 0; j &lt; <a class="code" href="BattleGroundMgr_8h.html#a5ea6ed78f78489fadc9d98c363702e0d">BG_QUEUE_GROUP_TYPES_COUNT</a>; ++j)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordflow">for</span> (GroupsQueueType::iterator itr = m_queuedGroup[j].begin(); itr != m_queuedGroup[j].end(); ++itr)</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <span class="keyword">delete</span> (*itr);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            m_queuedGroup[j].clear();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/***      BATTLEGROUND QUEUE SELECTION POOLS           ***/</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">// selection pool initialization, used to clean up from prev selection</span></div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">   90</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">BattleGroundQueue::SelectionPool::Init</a>()</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.clear();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ac0da40d743fb0f392e779f7d74efa796">playerCount</a> = 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="classBattleGroundQueue_1_1SelectionPool.html#a567436725c2f1316b54b03595a5c87b4">  104</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a567436725c2f1316b54b03595a5c87b4">BattleGroundQueue::SelectionPool::KickGroup</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> size)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// find maxgroup or LAST group with size == size and kick it</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    GroupsQueueType::iterator groupToKick = selectedGroups.begin();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> (GroupsQueueType::iterator itr = groupToKick; itr != selectedGroups.end(); ++itr)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    {</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="keywordflow">if</span> (abs((<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)((*itr)-&gt;players.size() - size)) &lt;= 1)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            groupToKick = itr;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!found &amp;&amp; (*itr)-&gt;players.size() &gt;= (*groupToKick)-&gt;players.size())</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;            groupToKick = itr;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// if pool is empty, do nothing</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (GetPlayerCount())</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <span class="comment">// update player count</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo = (*groupToKick);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        selectedGroups.erase(groupToKick);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        playerCount -= queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.size();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="comment">// return false if we kicked smaller group or there are enough players in selection pool</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.size() &lt;= size + 1)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    }</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">  144</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">BattleGroundQueue::SelectionPool::AddGroup</a>(<a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> desiredCount, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> bgInstanceId)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="comment">// if group is larger than desired count - don&#39;t allow to add it to pool</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">if</span> (!queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a> &amp;&amp;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        (!queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a7d4926c899369f6d039f9938a3e3afea">desiredInstanceId</a> || queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a7d4926c899369f6d039f9938a3e3afea">desiredInstanceId</a> == bgInstanceId) &amp;&amp;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        (desiredCount &gt;= playerCount + queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.size()))</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        selectedGroups.push_back(queueInfo);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="comment">// increase selected players count</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        playerCount += queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.size();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> playerCount &lt; desiredCount;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;}</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">/***               BATTLEGROUND QUEUES                 ***/</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a101e4b94f69ef76275db4eec15bdb58e">  178</a></span>&#160;<a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* <a class="code" href="classBattleGroundQueue.html#a101e4b94f69ef76275db4eec15bdb58e">BattleGroundQueue::AddGroup</a>(<a class="code" href="classPlayer.html">Player</a>* leader, <a class="code" href="classGroup.html">Group</a>* group, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="structPvPDifficultyEntry.html">PvPDifficultyEntry</a> <span class="keyword">const</span>*  bracketEntry, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType, <span class="keywordtype">bool</span> isRated, <span class="keywordtype">bool</span> isPremade, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> instanceId, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaRating, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaTeamId)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId =  bracketEntry-&gt;<a class="code" href="structPvPDifficultyEntry.html#a6e491b5202e2af6675eba8d4372274a1">GetBracketId</a>();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="comment">// create new ginfo</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo = <span class="keyword">new</span> <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a5fd92196f972af5b47b8cae4eff66089">bgTypeId</a>                  = bgTypeId;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>                 = arenaType;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a7d68836a2a2d30f5ecf4e67f45685459">arenaTeamId</a>               = arenaTeamId;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">isRated</a>                   = isRated;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a> = 0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#ac5e508ed18408ce91fb9b2dab3a69265">joinTime</a>                  = <a class="code" href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a>();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aeb62b4617f24b10d24dd85c0bb48626f">removeInviteTime</a>          = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a>                 = leader-&gt;<a class="code" href="classPlayer.html#af984d68ab11bb3f4081e0965593fbc9b">GetTeam</a>();</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a7d4926c899369f6d039f9938a3e3afea">desiredInstanceId</a>         = instanceId;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">arenaTeamRating</a>           = arenaRating;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4ff35b16fbe254f2b308ea307e32d0b5">opponentsTeamRating</a>       = 0;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.clear();</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// compute index (if group is premade or joined a rated match) to queues</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> index = 0;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (!isRated &amp;&amp; !isPremade)</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        index += <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>;                            <span class="comment">// BG_QUEUE_PREMADE_* -&gt; BG_QUEUE_NORMAL_*</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a> == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>)</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        ++index;                                            <span class="comment">// BG_QUEUE_*_ALLIANCE -&gt; BG_QUEUE_*_HORDE</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Adding Group to BattleGroundQueue bgTypeId : %u, bracket_id : %u, index : %u&quot;</span>, bgTypeId, bracketId, index);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> lastOnlineTime = <a class="code" href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a>();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// announce world (this don&#39;t need mutex)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordflow">if</span> (isRated &amp;&amp; <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cdaba3d0b1ae01ff3f2223c4a6f0819bc56">CONFIG_BOOL_ARENA_QUEUE_ANNOUNCER_JOIN</a>))</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51af853c9db3f02033af95ff598f69308f6">LANG_ARENA_QUEUE_ANNOUNCE_WORLD_JOIN</a>, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">arenaTeamRating</a>);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// add players from group to ginfo</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">// std::lock_guard&lt;std::recursive_mutex&gt; guard(m_Lock);</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (group)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classGroupReference.html">GroupReference</a>* itr = group-&gt;<a class="code" href="classGroup.html#a39cc0707e5c157b6ff4851e133b0a9dc">GetFirstMember</a>(); itr != <span class="keyword">nullptr</span>; itr = itr-&gt;<a class="code" href="classGroupReference.html#a05b946c0952db094a696093283308cb1">next</a>())</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* member = itr-&gt;getSource();</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keywordflow">if</span> (!member)</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    <span class="keywordflow">continue</span>;   <span class="comment">// this should never happen</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <a class="code" href="structPlayerQueueInfo.html">PlayerQueueInfo</a>&amp; playerInfo = <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>[member-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()];</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                playerInfo.<a class="code" href="structPlayerQueueInfo.html#a8cb99eb641027a390825a854dd0dbc35">lastOnlineTime</a>   = lastOnlineTime;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                playerInfo.<a class="code" href="structPlayerQueueInfo.html#a1963b711ca37c7d28c8e0043f14b72c4">groupInfo</a>        = queueInfo;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="comment">// add the pinfo to ginfo&#39;s list</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>[member-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()]  = &amp;playerInfo;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <a class="code" href="structPlayerQueueInfo.html">PlayerQueueInfo</a>&amp; playerInfo = <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>[leader-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()];</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            playerInfo.<a class="code" href="structPlayerQueueInfo.html#a8cb99eb641027a390825a854dd0dbc35">lastOnlineTime</a>   = lastOnlineTime;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            playerInfo.<a class="code" href="structPlayerQueueInfo.html#a1963b711ca37c7d28c8e0043f14b72c4">groupInfo</a>        = queueInfo;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>[leader-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()]  = &amp;playerInfo;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="comment">// add GroupInfo to m_QueuedGroups</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][index].push_back(queueInfo);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="comment">// announce to world, this code needs mutex</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (arenaType == <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a> &amp;&amp; !isRated &amp;&amp; !isPremade &amp;&amp; <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a4b5028ad5ecd90ec5acedb83cf5fc160">CONFIG_UINT32_BATTLEGROUND_QUEUE_ANNOUNCER_JOIN</a>))</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGroundTemplate(queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a5fd92196f972af5b47b8cae4eff66089">bgTypeId</a>))</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keywordtype">char</span> <span class="keyword">const</span>* bgName = bg-&gt;GetName();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayers = bg-&gt;GetMinPlayersPerTeam();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> qHorde = 0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> qAlliance = 0;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> qMinLevel = bracketEntry-&gt;<a class="code" href="structPvPDifficultyEntry.html#acd07e8d759af1b73ec7543f6e70df242">minLevel</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> qMaxLevel = bracketEntry-&gt;<a class="code" href="structPvPDifficultyEntry.html#a1385166568239f2118b65377df8b4b55">maxLevel</a>;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                GroupsQueueType::const_iterator itr;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                <span class="keywordflow">for</span> (itr = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>].begin(); itr != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>].end(); ++itr)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    <span class="keywordflow">if</span> (!(*itr)-&gt;isInvitedToBgInstanceGuid)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                        qAlliance += (*itr)-&gt;players.size();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">for</span> (itr = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d">BG_QUEUE_NORMAL_HORDE</a>].begin(); itr != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d">BG_QUEUE_NORMAL_HORDE</a>].end(); ++itr)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    <span class="keywordflow">if</span> (!(*itr)-&gt;isInvitedToBgInstanceGuid)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                        qHorde += (*itr)-&gt;players.size();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="comment">// Show queue status to player only (when joining queue)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a4b5028ad5ecd90ec5acedb83cf5fc160">CONFIG_UINT32_BATTLEGROUND_QUEUE_ANNOUNCER_JOIN</a>) == 1)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    <a class="code" href="classChatHandler.html">ChatHandler</a>(leader).<a class="code" href="classChatHandler.html#aa2c513be476b7a698afb71c7d271650b">PSendSysMessage</a>(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51ac4b197f5667a5282a6e3809c46b27cb6">LANG_BG_QUEUE_ANNOUNCE_SELF</a>, bgName, qMinLevel, qMaxLevel, qAlliance, (minPlayers &gt; qAlliance) ? minPlayers - qAlliance : (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0, qHorde, (minPlayers &gt; qHorde) ? minPlayers - qHorde : (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="comment">// System message</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51ad41adc4f06593e856a2b271a894404cc">LANG_BG_QUEUE_ANNOUNCE_WORLD</a>, bgName, qMinLevel, qMaxLevel, qAlliance, (minPlayers &gt; qAlliance) ? minPlayers - qAlliance : (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0, qHorde, (minPlayers &gt; qHorde) ? minPlayers - qHorde : (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// release mutex</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keywordflow">return</span> queueInfo;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;}</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a85f386312cd712dd9e05f6d6f4360e46">  285</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundQueue.html#a85f386312cd712dd9e05f6d6f4360e46">BattleGroundQueue::PlayerInvitedToBgUpdateAverageWaitTime</a>(<a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId)</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;{</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> timeInQueue = <a class="code" href="classWorldTimer.html#ac3e0aef4f8477912d3dc1b44332848cc">WorldTimer::getMSTimeDiff</a>(queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#ac5e508ed18408ce91fb9b2dab3a69265">joinTime</a>, <a class="code" href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a>());</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> teamIndex = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>;                     <span class="comment">// default set to BG_TEAM_ALLIANCE - or non rated arenas!</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a> == <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a>)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a> == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>)</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            teamIndex = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">isRated</a>)</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            teamIndex = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;                     <span class="comment">// for rated arenas use BG_TEAM_HORDE</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// store pointer to arrayindex of player that was added first</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>* lastPlayerAddedPointer = &amp;(<a class="code" href="classBattleGroundQueue.html#a1255a24104fcc3636463b07dee12ee27">m_waitTimeLastPlayer</a>[teamIndex][bracketId]);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="comment">// remove his time from sum</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="classBattleGroundQueue.html#a5fe6153dbc84016dc15f149fb9826314">m_sumOfWaitTimes</a>[teamIndex][bracketId] -= <a class="code" href="classBattleGroundQueue.html#a220dc1527cfe4c1f362b373b2cd3de3a">m_waitTimes</a>[teamIndex][bracketId][(*lastPlayerAddedPointer)];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// set average time to new</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <a class="code" href="classBattleGroundQueue.html#a220dc1527cfe4c1f362b373b2cd3de3a">m_waitTimes</a>[teamIndex][bracketId][(*lastPlayerAddedPointer)] = timeInQueue;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// add new time to sum</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <a class="code" href="classBattleGroundQueue.html#a5fe6153dbc84016dc15f149fb9826314">m_sumOfWaitTimes</a>[teamIndex][bracketId] += timeInQueue;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">// set index of last player added to next one</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    (*lastPlayerAddedPointer)++;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    (*lastPlayerAddedPointer) %= <a class="code" href="BattleGroundMgr_8h.html#acdd9d5422fecea59405438851a2d1f7c">COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#aaad0b13ecd75f91d2f80302d2d5d6644">  324</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classBattleGroundQueue.html#aaad0b13ecd75f91d2f80302d2d5d6644">BattleGroundQueue::GetAverageQueueWaitTime</a>(<a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId)</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;{</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> teamIndex = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>;                     <span class="comment">// default set to BG_TEAM_ALLIANCE - or non rated arenas!</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a> == <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a>)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a> == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;            teamIndex = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    }</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span> (queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">isRated</a>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            teamIndex = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;                     <span class="comment">// for rated arenas use BG_TEAM_HORDE</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    }</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// check if there is enought values(we always add values &gt; 0)</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a220dc1527cfe4c1f362b373b2cd3de3a">m_waitTimes</a>[teamIndex][bracketId][<a class="code" href="BattleGroundMgr_8h.html#acdd9d5422fecea59405438851a2d1f7c">COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME</a> - 1])</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="classBattleGroundQueue.html#a5fe6153dbc84016dc15f149fb9826314">m_sumOfWaitTimes</a>[teamIndex][bracketId] / <a class="code" href="BattleGroundMgr_8h.html#acdd9d5422fecea59405438851a2d1f7c">COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME</a>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// if there aren&#39;t enough values return 0 - not available</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a66bc6553872e49dd56133fda5a94c575">  352</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundQueue.html#a66bc6553872e49dd56133fda5a94c575">BattleGroundQueue::RemovePlayer</a>(<a class="code" href="classObjectGuid.html">ObjectGuid</a> guid, <span class="keywordtype">bool</span> decreaseInvitedCount)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;{</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="comment">// Player *plr = sObjectMgr.GetPlayer(guid);</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// std::lock_guard&lt;std::recursive_mutex&gt; guard(m_Lock);</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> bracketId = -1;                                   <span class="comment">// signed for proper for-loop finish</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// remove player from map, if he&#39;s there</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    QueuedPlayersMap::iterator itr = <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.find(guid);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <span class="keywordflow">if</span> (itr == <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.end())</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGroundQueue: couldn&#39;t find for remove: %s&quot;</span>, guid.<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str());</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* group = itr-&gt;second.groupInfo;</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    GroupsQueueType::iterator group_itr;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// mostly people with the highest levels are in battlegrounds, thats why</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// we count from MAX_BATTLEGROUND_QUEUES - 1 to 0</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// variable index removes useless searching in other team&#39;s queue</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> index = <a class="code" href="SharedDefines_8h.html#ad7f5fd5081848acc23f05d510d50dd96">GetTeamIndexByTeamId</a>(group-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a>);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a3bb8a71f4ae9af551f71e9eb2c9c3325">int8</a> bracketIdTmp = <a class="code" href="DBCEnums_8h.html#a5201a522ecfb21f8b94bcab8b2ba2f8c">MAX_BATTLEGROUND_BRACKETS</a> - 1; bracketIdTmp &gt;= 0 &amp;&amp; bracketId == -1; --bracketIdTmp)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="comment">// we must check premade and normal team&#39;s queue - because when players from premade are joining bg,</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="comment">// they leave groupinfo so we can&#39;t use its players size to find out index</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> j = index; j &lt; <a class="code" href="BattleGroundMgr_8h.html#a5ea6ed78f78489fadc9d98c363702e0d">BG_QUEUE_GROUP_TYPES_COUNT</a>; j += <a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">for</span> (GroupsQueueType::iterator group_itr_tmp = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketIdTmp][j].begin(); group_itr_tmp != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketIdTmp][j].end(); ++group_itr_tmp)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keywordflow">if</span> ((*group_itr_tmp) == group)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                    bracketId = bracketIdTmp;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                    group_itr = group_itr_tmp;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <span class="comment">// we must store index to be able to erase iterator</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    index = j;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                }</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// player can&#39;t be in queue without group, but just in case</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">if</span> (bracketId == -1)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGroundQueue: ERROR Cannot find groupinfo for %s&quot;</span>, guid.<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str());</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    }</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;BattleGroundQueue: Removing %s, from bracket_id %u&quot;</span>, guid.<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str(), (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)bracketId);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// ALL variables are correctly set</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// We can ignore leveling up in queue - it should not cause crash</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// remove player from group</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// if only one player there, remove group</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// remove player queue info from group queue info</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    GroupQueueInfoPlayers::iterator pitr = group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.find(guid);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordflow">if</span> (pitr != group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.end())</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.erase(pitr);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// if invited to bg, and should decrease invited count, then do it</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">if</span> (decreaseInvitedCount &amp;&amp; group-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a>)</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGround(group-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a>, group-&gt;<a class="code" href="structGroupQueueInfo.html#a5fd92196f972af5b47b8cae4eff66089">bgTypeId</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <span class="keywordflow">if</span> (bg)</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            bg-&gt;<a class="code" href="classBattleGround.html#a899ece38db310b6a4418c86b5c9bdb92">DecreaseInvitedCount</a>(group-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a>);</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// remove player queue info</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.erase(itr);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="comment">// announce to world if arena team left queue for rated match, show only once</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (group-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a> != <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a> &amp;&amp; group-&gt;<a class="code" href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">isRated</a> &amp;&amp; group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.empty() &amp;&amp; <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda6c3441c6bac1b06978eb977de437f7ad">CONFIG_BOOL_ARENA_QUEUE_ANNOUNCER_EXIT</a>))</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a4ed413b1da3c24f3f3f17bb1c3732213">LANG_ARENA_QUEUE_ANNOUNCE_WORLD_EXIT</a>, group-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>, group-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>, group-&gt;<a class="code" href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">arenaTeamRating</a>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// if player leaves queue and he is invited to rated arena match, then he have to loose</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (group-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a> &amp;&amp; group-&gt;<a class="code" href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">isRated</a> &amp;&amp; decreaseInvitedCount)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <a class="code" href="classArenaTeam.html">ArenaTeam</a>* at = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamById(group-&gt;<a class="code" href="structGroupQueueInfo.html#a7d68836a2a2d30f5ecf4e67f45685459">arenaTeamId</a>);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">if</span> (at)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        {</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;UPDATING memberLost&#39;s personal arena rating for %s by opponents rating: %u&quot;</span>, guid.<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str(), group-&gt;<a class="code" href="structGroupQueueInfo.html#a4ff35b16fbe254f2b308ea307e32d0b5">opponentsTeamRating</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <a class="code" href="classPlayer.html">Player</a>* plr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(guid);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span> (plr)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                at-&gt;<a class="code" href="classArenaTeam.html#a2b26ff5371a9bb4f76cce0f6ab8f1fba">MemberLost</a>(plr, group-&gt;<a class="code" href="structGroupQueueInfo.html#a4ff35b16fbe254f2b308ea307e32d0b5">opponentsTeamRating</a>);</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                at-&gt;<a class="code" href="classArenaTeam.html#a8d2ad09abaedf2ef7523b62680149f04">OfflineMemberLost</a>(guid, group-&gt;<a class="code" href="structGroupQueueInfo.html#a4ff35b16fbe254f2b308ea307e32d0b5">opponentsTeamRating</a>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;            at-&gt;<a class="code" href="classArenaTeam.html#a549becb60e18b88deaefbf498a7b23b5">SaveToDB</a>();</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// remove group queue info if needed</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.empty())</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][index].erase(group_itr);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keyword">delete</span> group;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">// if group wasn&#39;t empty, so it wasn&#39;t deleted, and player have left a rated</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// queue -&gt; everyone from the group should leave too</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// don&#39;t remove recursively if already invited to bg!</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!group-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a> &amp;&amp; group-&gt;<a class="code" href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">isRated</a>)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    {</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="comment">// remove next player, this is recursive</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        <span class="comment">// first send removal information</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* plr2 = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.begin()-&gt;first))</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;            <a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGroundTemplate(group-&gt;<a class="code" href="structGroupQueueInfo.html#a5fd92196f972af5b47b8cae4eff66089">bgTypeId</a>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId = <a class="code" href="classBattleGroundMgr.html#a2626e64e4c8c5ebb515da8a94c5e6188">BattleGroundMgr::BgQueueTypeId</a>(group-&gt;<a class="code" href="structGroupQueueInfo.html#a5fd92196f972af5b47b8cae4eff66089">bgTypeId</a>, group-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> queueSlot = plr2-&gt;GetBattleGroundQueueIndex(bgQueueTypeId);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            plr2-&gt;RemoveBattleGroundQueueId(bgQueueTypeId); <span class="comment">// must be called this way, because if you move this call to</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            <span class="comment">// queue-&gt;removeplayer, it causes bugs</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            <a class="code" href="classWorldPacket.html">WorldPacket</a> data;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.BuildBattleGroundStatusPacket(data, bg, queueSlot, <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaa7ff6fbf30c889d48bea1d98b74dc408">STATUS_NONE</a>, 0, 0, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a>, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a66bbf321f9fe6b3387090eb97e230c68">TEAM_NONE</a>);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            plr2-&gt;GetSession()-&gt;SendPacket(data);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="comment">// then actually delete, this may delete the group as well!</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="classBattleGroundQueue.html#a66bc6553872e49dd56133fda5a94c575">RemovePlayer</a>(group-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.begin()-&gt;first, decreaseInvitedCount);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;}</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a74cb1a78fa60d7a870e4a1a2e2380866">  483</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue.html#a74cb1a78fa60d7a870e4a1a2e2380866">BattleGroundQueue::IsPlayerInvited</a>(<a class="code" href="classObjectGuid.html">ObjectGuid</a> playerGuid, <span class="keyword">const</span> <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> bgInstanceGuid, <span class="keyword">const</span> <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> removeTime)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;{</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// std::lock_guard&lt;std::recursive_mutex&gt; g(m_Lock);</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    QueuedPlayersMap::const_iterator qItr = <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.find(playerGuid);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">return</span> (qItr != <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.end()</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            &amp;&amp; qItr-&gt;second.groupInfo-&gt;isInvitedToBgInstanceGuid == bgInstanceGuid</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            &amp;&amp; qItr-&gt;second.groupInfo-&gt;removeInviteTime == removeTime);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#aea14887d570348f613f562492e60a755">  499</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue.html#aea14887d570348f613f562492e60a755">BattleGroundQueue::GetPlayerGroupInfoData</a>(<a class="code" href="classObjectGuid.html">ObjectGuid</a> guid, <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;{</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// std::lock_guard&lt;std::recursive_mutex&gt; g(m_Lock);</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    QueuedPlayersMap::const_iterator qItr = <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.find(guid);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">if</span> (qItr == <a class="code" href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">m_queuedPlayers</a>.end())</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    *queueInfo = *(qItr-&gt;second.groupInfo);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;}</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">  517</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">BattleGroundQueue::InviteGroupToBg</a>(<a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* queueInfo, <a class="code" href="classBattleGround.html">BattleGround</a>* bg, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a> team)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;{</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="comment">// set side if needed</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordflow">if</span> (team == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a> || team == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>)</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a> = team;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">if</span> (!queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a>)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="comment">// not yet invited</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="comment">// set invitation</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a> = bg-&gt;<a class="code" href="classBattleGround.html#a72477d06bf9c16a116ed66d2f7eb77b7">GetInstanceId</a>();</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId = bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId = <a class="code" href="classBattleGroundMgr.html#a2626e64e4c8c5ebb515da8a94c5e6188">BattleGroundMgr::BgQueueTypeId</a>(bgTypeId, bg-&gt;<a class="code" href="classBattleGround.html#abcbde26976ecd6b28f3a5d0d7c4b4eb2">GetArenaType</a>());</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracket_id = bg-&gt;<a class="code" href="classBattleGround.html#add0834abfb4a5647628ad9ca49d06f39">GetBracketId</a>();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">// set ArenaTeamId for rated matches</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <span class="keywordflow">if</span> (bg-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>() &amp;&amp; bg-&gt;<a class="code" href="classBattleGround.html#a3f8170a5d81f660f9fae6c28337d356b">IsRated</a>())</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            bg-&gt;<a class="code" href="classBattleGround.html#a2724ec2c0ee6fed5f53fab5346274804">SetArenaTeamIdForTeam</a>(queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a>, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a7d68836a2a2d30f5ecf4e67f45685459">arenaTeamId</a>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aeb62b4617f24b10d24dd85c0bb48626f">removeInviteTime</a> = <a class="code" href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a>() + <a class="code" href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05a1b0d93b746ae2d960bd33172a070c365">INVITE_ACCEPT_WAIT_TIME</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="comment">// loop through the players</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">for</span> (GroupQueueInfoPlayers::iterator itr = queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.begin(); itr != queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">players</a>.end(); ++itr)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <span class="comment">// get the player</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            <a class="code" href="classPlayer.html">Player</a>* plr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(itr-&gt;first);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">// if offline, skip him, this should not happen - player is removed from queue when he logs out</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <span class="keywordflow">if</span> (!plr)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment">// invite the player</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a85f386312cd712dd9e05f6d6f4360e46">PlayerInvitedToBgUpdateAverageWaitTime</a>(queueInfo, bracket_id);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            <span class="comment">// sBattleGroundMgr.InvitePlayer(plr, bg, ginfo-&gt;Team);</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="comment">// set invited player counters</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            bg-&gt;<a class="code" href="classBattleGround.html#a045e4dd53abe44038888108e8a4b5aec">IncreaseInvitedCount</a>(queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">groupTeam</a>);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            plr-&gt;<a class="code" href="classPlayer.html#a84d23ac8815a25b0d532e93e6e1d7a9c">SetInviteForBattleGroundQueueType</a>(bgQueueTypeId, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            <span class="comment">// create remind invite events</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <a class="code" href="classBgQueueInviteEvent.html">BgQueueInviteEvent</a>* inviteEvent = <span class="keyword">new</span> <a class="code" href="classBgQueueInviteEvent.html">BgQueueInviteEvent</a>(plr-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>(), queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a>, bgTypeId, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aeb62b4617f24b10d24dd85c0bb48626f">removeInviteTime</a>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            plr-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">AddEvent</a>(inviteEvent, plr-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a1a92f983f1dd415146c2875f80cba433">CalculateTime</a>(<a class="code" href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05afa97b69bd50d943b0d6fcb4fb6b0b0f1">INVITATION_REMIND_TIME</a>));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <span class="comment">// create automatic remove events</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;            <a class="code" href="classBgQueueRemoveEvent.html">BgQueueRemoveEvent</a>* removeEvent = <span class="keyword">new</span> <a class="code" href="classBgQueueRemoveEvent.html">BgQueueRemoveEvent</a>(plr-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>(), queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">isInvitedToBgInstanceGuid</a>, bgTypeId, bgQueueTypeId, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aeb62b4617f24b10d24dd85c0bb48626f">removeInviteTime</a>);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            plr-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">AddEvent</a>(removeEvent, plr-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a1a92f983f1dd415146c2875f80cba433">CalculateTime</a>(<a class="code" href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05a1b0d93b746ae2d960bd33172a070c365">INVITE_ACCEPT_WAIT_TIME</a>));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            <a class="code" href="classWorldPacket.html">WorldPacket</a> data;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> queueSlot = plr-&gt;<a class="code" href="classPlayer.html#ac0b1b01da51987e47b563832a6d92b87">GetBattleGroundQueueIndex</a>(bgQueueTypeId);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Battleground: invited %s to BG instance %u queueindex %u bgtype %u, I can&#39;t help it if they don&#39;t press the enter battle button.&quot;</span>, plr-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str(), bg-&gt;<a class="code" href="classBattleGround.html#a72477d06bf9c16a116ed66d2f7eb77b7">GetInstanceId</a>(), queueSlot, bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>());</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;            <span class="comment">// send status packet</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;            <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.BuildBattleGroundStatusPacket(data, bg, queueSlot, <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaf0b95a17deaea4fc8f467eaacaa515b2">STATUS_WAIT_JOIN</a>, <a class="code" href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05a1b0d93b746ae2d960bd33172a070c365">INVITE_ACCEPT_WAIT_TIME</a>, 0, queueInfo-&gt;<a class="code" href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">arenaType</a>, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a66bbf321f9fe6b3387090eb97e230c68">TEAM_NONE</a>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            plr-&gt;<a class="code" href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">GetSession</a>()-&gt;<a class="code" href="classWorldSession.html#a15a10b125d9f54c3945a3daf319b228f">SendPacket</a>(data);</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        }</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;}</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#ace7dd1fbaee6e506eebbcec071225e61">  589</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundQueue.html#ace7dd1fbaee6e506eebbcec071225e61">BattleGroundQueue::FillPlayersToBg</a>(<a class="code" href="classBattleGround.html">BattleGround</a>* bg, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId)</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;{</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> hordeFree = bg-&gt;<a class="code" href="classBattleGround.html#aba75ff9ec15240bc746ce95b1ddeb932">GetFreeSlotsForTeam</a>(<a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> aliFree   = bg-&gt;<a class="code" href="classBattleGround.html#aba75ff9ec15240bc746ce95b1ddeb932">GetFreeSlotsForTeam</a>(<a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a>);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <span class="comment">// iterator for iterating through bg queue</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    GroupsQueueType::const_iterator Ali_itr = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>].begin();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="comment">// count of groups in queue - used to stop cycles</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> aliCount = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>].size();</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="comment">// index to queue which group is current</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> aliIndex = 0;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="keywordflow">for</span> (; aliIndex &lt; aliCount &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*Ali_itr), aliFree, bg-&gt;<a class="code" href="classBattleGround.html#af22363ba2055213ac1591b39ad0e32fc">GetClientInstanceId</a>()); ++aliIndex)</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        ++Ali_itr;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">// the same thing for horde</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    GroupsQueueType::const_iterator Horde_itr = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d">BG_QUEUE_NORMAL_HORDE</a>].begin();</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> hordeCount = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d">BG_QUEUE_NORMAL_HORDE</a>].size();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> hordeIndex = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">for</span> (; hordeIndex &lt; hordeCount &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*Horde_itr), hordeFree, bg-&gt;<a class="code" href="classBattleGround.html#af22363ba2055213ac1591b39ad0e32fc">GetClientInstanceId</a>()); ++hordeIndex)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        ++Horde_itr;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">// if ofc like BG queue invitation is set in config, then we are happy</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a1166408853acad43f8dcbe56da26e585">CONFIG_UINT32_BATTLEGROUND_INVITATION_TYPE</a>) == 0)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment">    if we reached this code, then we have to solve NP - complete problem called Subset sum problem</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">    So one solution is to check all possible invitation subgroups, or we can use these conditions:</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">    1. Last time when BattleGroundQueue::Update was executed we invited all possible players - so there is only small possibility</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">        that we will invite now whole queue, because only 1 change has been made to queues from the last BattleGroundQueue::Update call</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">    2. Other thing we should consider is group order in queue</span></div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="comment">// At first we need to compare free space in bg and our selection pool</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> diffAli   = aliFree   - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount());</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> diffHorde = hordeFree - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount());</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    <span class="keywordflow">while</span> (abs(diffAli - diffHorde) &gt; 1 &amp;&amp; (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount() &gt; 0 || <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount() &gt; 0))</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="comment">// each cycle execution we need to kick at least 1 group</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        <span class="keywordflow">if</span> (diffAli &lt; diffHorde)</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="comment">// kick alliance group, add to pool new group if needed</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].KickGroup(diffHorde - diffAli))</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">for</span> (; aliIndex &lt; aliCount &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*Ali_itr), (aliFree &gt;= diffHorde) ? aliFree - diffHorde : 0, bg-&gt;<a class="code" href="classBattleGround.html#af22363ba2055213ac1591b39ad0e32fc">GetClientInstanceId</a>()); ++aliIndex)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                    ++Ali_itr;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            <span class="comment">// if ali selection is already empty, then kick horde group, but if there are less horde than ali in bg - break;</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount())</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="keywordflow">if</span> (aliFree &lt;= diffHorde + 1)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a567436725c2f1316b54b03595a5c87b4">KickGroup</a>(diffHorde - diffAli);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        }</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <span class="comment">// kick horde group, add to pool new group if needed</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].KickGroup(diffAli - diffHorde))</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="keywordflow">for</span> (; hordeIndex &lt; hordeCount &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*Horde_itr), (hordeFree &gt;= diffAli) ? hordeFree - diffAli : 0, bg-&gt;<a class="code" href="classBattleGround.html#af22363ba2055213ac1591b39ad0e32fc">GetClientInstanceId</a>()); ++hordeIndex)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    ++Horde_itr;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount())</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;            {</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                <span class="keywordflow">if</span> (hordeFree &lt;= diffAli + 1)</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a567436725c2f1316b54b03595a5c87b4">KickGroup</a>(diffAli - diffHorde);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="comment">// count diffs after small update</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        diffAli   = aliFree   - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount());</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        diffHorde = hordeFree - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount());</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    }</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;}</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a73a0ef682508d3cfd13e2dc3e685b169">  675</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue.html#a73a0ef682508d3cfd13e2dc3e685b169">BattleGroundQueue::CheckPremadeMatch</a>(<a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayersPerTeam, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxPlayersPerTeam)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;{</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="comment">// check match</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].empty() &amp;&amp; !<a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].empty())</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="comment">// start premade match</span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        <span class="comment">// if groups aren&#39;t invited</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        GroupsQueueType::const_iterator ali_group, horde_group;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">for</span> (ali_group = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].begin(); ali_group != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].end(); ++ali_group)</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordflow">if</span> (!(*ali_group)-&gt;isInvitedToBgInstanceGuid)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keywordflow">for</span> (horde_group = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].begin(); horde_group != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].end(); ++horde_group)</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            <span class="keywordflow">if</span> (!(*horde_group)-&gt;isInvitedToBgInstanceGuid)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">if</span> (ali_group != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].end() &amp;&amp; horde_group != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].end())</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*ali_group), maxPlayersPerTeam, 0);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*horde_group), maxPlayersPerTeam, 0);</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="comment">// add groups/players from normal queue to size of bigger group</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxPlayers = std::max(<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount(), <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount());</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>; ++i)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            {</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                <span class="keywordflow">for</span> (GroupsQueueType::const_iterator itr = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + i].begin(); itr != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + i].end(); ++itr)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    <span class="comment">// if itr can join BG and player count is less that maxPlayers, then add group to selectionpool</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    <span class="keywordflow">if</span> (!(*itr)-&gt;isInvitedToBgInstanceGuid &amp;&amp; !<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[i].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*itr), maxPlayers, 0))</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;            }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;            <span class="comment">// premade selection pools are set</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="comment">// now check if we can move group from Premade queue to normal queue (timer has expired) or group size lowered!!</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="comment">// this could be 2 cycles but i&#39;m checking only first team in queue - it can cause problem -</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="comment">// if first is invited to BG and seconds timer expired, but we can ignore it, because players have only 80 seconds to click to enter bg</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">// and when they click or after 80 seconds the queue info is removed from queue</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> time_before = <a class="code" href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a>() - <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a7a1c7fff342dfcb57f657430f70b95e0">CONFIG_UINT32_BATTLEGROUND_PREMADE_GROUP_WAIT_FOR_MATCH</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>; ++i)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a> + i].empty())</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            GroupsQueueType::iterator itr = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a> + i].begin();</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordflow">if</span> (!(*itr)-&gt;isInvitedToBgInstanceGuid &amp;&amp; ((*itr)-&gt;joinTime &lt; time_before || (*itr)-&gt;players.size() &lt; minPlayersPerTeam))</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                <span class="comment">// we must insert group to normal queue and erase pointer from premade queue</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + i].push_front((*itr));</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a> + i].erase(itr);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        }</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="comment">// selection pools are not set</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;}</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#a0be1825f0fe29ecdc439525ad9ee6ef9">  743</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue.html#a0be1825f0fe29ecdc439525ad9ee6ef9">BattleGroundQueue::CheckNormalMatch</a>(<a class="code" href="classBattleGround.html">BattleGround</a>* bgTemplate, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayers, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxPlayers)</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;{</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    GroupsQueueType::const_iterator itr_team[<a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>];</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>; ++i)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        itr_team[i] = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + i].begin();</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordflow">for</span> (; itr_team[i] != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + i].end(); ++(itr_team[i]))</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;        {</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">if</span> (!(*(itr_team[i]))-&gt;isInvitedToBgInstanceGuid)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[i].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>(*(itr_team[i]), maxPlayers, 0);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[i].GetPlayerCount() &gt;= minPlayers)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; </div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="comment">// try to invite same number of players - this cycle may cause longer wait time even if there are enough players in queue, but we want ballanced bg</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> j = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount() &lt; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>())</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        j = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a1166408853acad43f8dcbe56da26e585">CONFIG_UINT32_BATTLEGROUND_INVITATION_TYPE</a>) != 0</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>() &gt;= minPlayers &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>() &gt;= minPlayers)</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="comment">// we will try to invite more groups to team with less players indexed by j</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        ++(itr_team[j]);                                    <span class="comment">// this will not cause a crash, because for cycle above reached break;</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordflow">for</span> (; itr_team[j] != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + j].end(); ++(itr_team[j]))</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <span class="keywordflow">if</span> (!(*(itr_team[j]))-&gt;isInvitedToBgInstanceGuid)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[j].<a class="code" href="classBattleGroundQueue.html#a101e4b94f69ef76275db4eec15bdb58e">AddGroup</a>(*(itr_team[j]), <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[(j + 1) % <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>].GetPlayerCount(), 0))</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="comment">// do not allow to start bg with more than 2 players more on 1 faction</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> (abs((<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)(<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>() - <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>())) &gt; 2)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    }</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">// allow 1v0 if debug bg</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.IsTesting() &amp;&amp; bgTemplate-&gt;<a class="code" href="classBattleGround.html#aae6d6881ab4cb39901420f43834eef98">IsBattleGround</a>() &amp;&amp; (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>() || <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>()))</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="comment">// return true if there are enough players in selection pools - enable to work .debug bg command correctly</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>() &gt;= minPlayers &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>() &gt;= minPlayers;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#ad75c02c80265e8d4ee67cadf62d60959">  795</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundQueue.html#ad75c02c80265e8d4ee67cadf62d60959">BattleGroundQueue::CheckSkirmishForSameFaction</a>(<a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayersPerTeam)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;{</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount() &lt; minPlayersPerTeam &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount() &lt; minPlayersPerTeam)</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73">PvpTeamIndex</a> teamIdx = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73">PvpTeamIndex</a> otherTeamIdx = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a> otherTeamId = <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount() == minPlayersPerTeam)</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    {</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        teamIdx = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        otherTeamIdx = <a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        otherTeamId = <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="comment">// clear other team&#39;s selection</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[otherTeamIdx].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    <span class="comment">// store last ginfo pointer</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* ginfo = <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[teamIdx].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.back();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// set itr_team to group that was added to selection pool latest</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    GroupsQueueType::iterator itr_team = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + teamIdx].begin();</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">for</span> (; itr_team != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + teamIdx].end(); ++itr_team)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <span class="keywordflow">if</span> (ginfo == *itr_team)</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    <span class="keywordflow">if</span> (itr_team == <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + teamIdx].end())</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    GroupsQueueType::iterator itr_team2 = itr_team;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    ++itr_team2;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    <span class="comment">// invite players to other selection pool</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    <span class="keywordflow">for</span> (; itr_team2 != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + teamIdx].end(); ++itr_team2)</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="comment">// if selection pool is full then break;</span></div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">if</span> (!(*itr_team2)-&gt;isInvitedToBgInstanceGuid &amp;&amp; !<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[otherTeamIdx].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>(*itr_team2, minPlayersPerTeam, 0))</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160; </div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[otherTeamIdx].GetPlayerCount() != minPlayersPerTeam)</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="comment">// here we have correct 2 selections and we need to change one teams team and move selection pool teams to other team&#39;s queue</span></div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">for</span> (GroupsQueueType::iterator itr = <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[otherTeamIdx].selectedGroups.begin(); itr != <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[otherTeamIdx].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.end(); ++itr)</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="comment">// set correct team</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        (*itr)-&gt;groupTeam = otherTeamId;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        <span class="comment">// add team to other queue</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + otherTeamIdx].push_front(*itr);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="comment">// remove team from old queue</span></div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        GroupsQueueType::iterator itr2 = itr_team;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        ++itr2;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">for</span> (; itr2 != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + teamIdx].end(); ++itr2)</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <span class="keywordflow">if</span> (*itr2 == *itr)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a> + teamIdx].erase(itr2);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            }</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        }</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;}</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno"><a class="line" href="classBattleGroundQueue.html#af7b20fca70ffededaf59d29df058a6c7">  872</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundQueue.html#af7b20fca70ffededaf59d29df058a6c7">BattleGroundQueue::Update</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType, <span class="keywordtype">bool</span> isRated, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaRating)</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;{</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="comment">// std::lock_guard&lt;std::recursive_mutex&gt; guard(m_Lock);</span></div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    <span class="comment">// if no players in queue - do nothing</span></div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].empty() &amp;&amp;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].empty() &amp;&amp;</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>].empty() &amp;&amp;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;            <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d">BG_QUEUE_NORMAL_HORDE</a>].empty())</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">// battleground with free slot for player should be always in the beggining of the queue</span></div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="comment">// maybe it would be better to create bgfreeslotqueue for each bracket_id</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    BgFreeSlotQueueType::iterator next;</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    <span class="keywordflow">for</span> (BgFreeSlotQueueType::iterator itr = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.BgFreeSlotQueue[bgTypeId].begin(); itr != <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.BgFreeSlotQueue[bgTypeId].end(); itr = next)</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        next = itr;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        ++next;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="comment">// DO NOT allow queue manager to invite new player to arena</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        <span class="keywordflow">if</span> ((*itr)-&gt;IsBattleGround() &amp;&amp; (*itr)-&gt;GetTypeId() == bgTypeId &amp;&amp; (*itr)-&gt;GetBracketId() == bracketId &amp;&amp;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                (*itr)-&gt;GetStatus() &gt; <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0ea91aabae633323f9e31059e42e9ea5240">STATUS_WAIT_QUEUE</a> &amp;&amp; (*itr)-&gt;GetStatus() &lt; <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8">STATUS_WAIT_LEAVE</a>)</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <a class="code" href="classBattleGround.html">BattleGround</a>* bg = *itr; <span class="comment">// we have to store battleground pointer here, because when battleground is full, it is removed from free queue (not yet implemented!!)</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="comment">// and iterator is invalid</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="comment">// clear selection pools</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="comment">// call a function that does the job for us</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;            <a class="code" href="classBattleGroundQueue.html#ace7dd1fbaee6e506eebbcec071225e61">FillPlayersToBg</a>(bg, bracketId);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            <span class="comment">// now everything is set, invite players</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keywordflow">for</span> (GroupsQueueType::const_iterator citr = <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].selectedGroups.begin(); citr != <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.end(); ++citr)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">InviteGroupToBg</a>((*citr), bg, (*citr)-&gt;groupTeam);</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">for</span> (GroupsQueueType::const_iterator citr = <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].selectedGroups.begin(); citr != <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.end(); ++citr)</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">InviteGroupToBg</a>((*citr), bg, (*citr)-&gt;groupTeam);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            <span class="keywordflow">if</span> (!bg-&gt;<a class="code" href="classBattleGround.html#a9098ac7a9630a28f039be2c8b7f5569d">HasFreeSlots</a>())</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            {</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                <span class="comment">// remove BG from BGFreeSlotQueue</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                bg-&gt;<a class="code" href="classBattleGround.html#a280ed4b0edce428eed83af0497f76930">RemoveFromBgFreeSlotQueue</a>();</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            }</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; </div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <span class="comment">// finished iterating through the bgs with free slots, maybe we need to create a new bg</span></div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="classBattleGround.html">BattleGround</a>* bgTemplate = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGroundTemplate(bgTypeId);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    <span class="keywordflow">if</span> (!bgTemplate)</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Battleground: Update: bg template not found for %u&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160; </div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <a class="code" href="structPvPDifficultyEntry.html">PvPDifficultyEntry</a> <span class="keyword">const</span>* bracketEntry = <a class="code" href="DBCStores_8cpp.html#abce58e30e684067135e87797c3dc3d08">GetBattlegroundBracketById</a>(bgTemplate-&gt;<a class="code" href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">GetMapId</a>(), bracketId);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordflow">if</span> (!bracketEntry)</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Battleground: Update: bg bracket entry not found for map %u bracket id %u&quot;</span>, bgTemplate-&gt;<a class="code" href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">GetMapId</a>(), bracketId);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="comment">// get the min. players per team, properly for larger arenas as well. (must have full teams for arena matches!)</span></div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayersPerTeam = bgTemplate-&gt;<a class="code" href="classBattleGround.html#ad187c9e07479c1f63bdce36438bc01f4">GetMinPlayersPerTeam</a>();</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxPlayersPerTeam = bgTemplate-&gt;<a class="code" href="classBattleGround.html#a31cbe1ab6942f9b3d4199ea5918d49f7">GetMaxPlayersPerTeam</a>();</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.IsTesting())</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        minPlayersPerTeam = 1;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">if</span> (bgTemplate-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>())</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.IsArenaTesting())</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            maxPlayersPerTeam = 1;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            minPlayersPerTeam = 1;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        }</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <span class="comment">// this switch can be much shorter</span></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            maxPlayersPerTeam = arenaType;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            minPlayersPerTeam = arenaType;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <span class="comment">/*switch(arenaType)</span></div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="comment">            {</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="comment">            case ARENA_TYPE_2v2:</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="comment">                MaxPlayersPerTeam = 2;</span></div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="comment">                MinPlayersPerTeam = 2;</span></div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">            case ARENA_TYPE_3v3:</span></div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">                MaxPlayersPerTeam = 3;</span></div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="comment">                MinPlayersPerTeam = 3;</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">            case ARENA_TYPE_5v5:</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="comment">                MaxPlayersPerTeam = 5;</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="comment">                MinPlayersPerTeam = 5;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="comment">                break;</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="comment">            }*/</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <span class="keywordflow">if</span> (bgTemplate-&gt;<a class="code" href="classBattleGround.html#aae6d6881ab4cb39901420f43834eef98">IsBattleGround</a>())</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">// check if there is premade against premade match</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a73a0ef682508d3cfd13e2dc3e685b169">CheckPremadeMatch</a>(bracketId, minPlayersPerTeam, maxPlayersPerTeam))</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        {</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;            <span class="comment">// create new battleground</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <a class="code" href="classBattleGround.html">BattleGround</a>* bg2 = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.CreateNewBattleGround(bgTypeId, bracketEntry, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <span class="keywordflow">if</span> (!bg2)</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            {</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGroundQueue::Update - Cannot create battleground: %u&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            <span class="comment">// invite those selection pools</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>; ++i)</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="keywordflow">for</span> (GroupsQueueType::const_iterator citr = <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a> + i].selectedGroups.begin(); citr != <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a> + i].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.end(); ++citr)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">InviteGroupToBg</a>((*citr), bg2, (*citr)-&gt;groupTeam);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;            <span class="comment">// start bg</span></div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            bg2-&gt;<a class="code" href="classBattleGround.html#a8da15b689f8837f8ab9400787733113d">StartBattleGround</a>();</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;            <span class="comment">// clear structures</span></div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">Init</a>();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;        }</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="comment">// now check if there are in queues enough players to start new game of (normal battleground, or non-rated arena)</span></div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">if</span> (!isRated)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    {</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <span class="comment">// if there are enough players in pools, start new battleground or non rated arena</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a0be1825f0fe29ecdc439525ad9ee6ef9">CheckNormalMatch</a>(bgTemplate, bracketId, minPlayersPerTeam, maxPlayersPerTeam)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                || (bgTemplate-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>() &amp;&amp; <a class="code" href="classBattleGroundQueue.html#ad75c02c80265e8d4ee67cadf62d60959">CheckSkirmishForSameFaction</a>(bracketId, minPlayersPerTeam)))</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;        {</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;            <span class="comment">// we successfully created a pool</span></div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            <a class="code" href="classBattleGround.html">BattleGround</a>* bg2 = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.CreateNewBattleGround(bgTypeId, bracketEntry, arenaType, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;            <span class="keywordflow">if</span> (!bg2)</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;            {</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGroundQueue::Update - Cannot create battleground: %u&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="comment">// invite those selection pools</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>; ++i)</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                <span class="keywordflow">for</span> (GroupsQueueType::const_iterator citr = <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a> + i].selectedGroups.begin(); citr != <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a> + i].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">selectedGroups</a>.end(); ++citr)</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                    <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">InviteGroupToBg</a>((*citr), bg2, (*citr)-&gt;groupTeam);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="comment">// start bg</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            bg2-&gt;<a class="code" href="classBattleGround.html#a8da15b689f8837f8ab9400787733113d">StartBattleGround</a>();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    }</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bgTemplate-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>())</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    {</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        <span class="comment">// found out the minimum and maximum ratings the newly added team should battle against</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="comment">// arenaRating is the rating of the latest joined team, or 0</span></div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;        <span class="comment">// 0 is on (automatic update call) and we must set it to team&#39;s with longest wait time</span></div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;        <span class="keywordflow">if</span> (!arenaRating)</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;            <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* front1 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;            <a class="code" href="structGroupQueueInfo.html">GroupQueueInfo</a>* front2 = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].empty())</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;            {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                front1 = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].front();</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                arenaRating = front1-&gt;<a class="code" href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">arenaTeamRating</a>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            }</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].empty())</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;            {</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                front2 = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].front();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                arenaRating = front2-&gt;<a class="code" href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">arenaTeamRating</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;            }</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;            <span class="keywordflow">if</span> (front1 &amp;&amp; front2)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;            {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                <span class="keywordflow">if</span> (front1-&gt;<a class="code" href="structGroupQueueInfo.html#ac5e508ed18408ce91fb9b2dab3a69265">joinTime</a> &lt; front2-&gt;<a class="code" href="structGroupQueueInfo.html#ac5e508ed18408ce91fb9b2dab3a69265">joinTime</a>)</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                    arenaRating = front1-&gt;<a class="code" href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">arenaTeamRating</a>;</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;            }</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!front1 &amp;&amp; !front2)</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">// queues are empty</span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        }</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;        <span class="comment">// set rating range</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaMinRating = (arenaRating &lt;= <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetMaxRatingDifference()) ? 0 : arenaRating - <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetMaxRatingDifference();</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaMaxRating = arenaRating + <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetMaxRatingDifference();</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="comment">// if max rating difference is set and the time past since server startup is greater than the rating discard time</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        <span class="comment">// (after what time the ratings aren&#39;t taken into account when making teams) then</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="comment">// the discard time is current_time - time_to_discard, teams that joined after that, will have their ratings taken into account</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="comment">// else leave the discard time on 0, this way all ratings will be discarded</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> discardTime = <a class="code" href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a>() - <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetRatingDiscardTimer();</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="comment">// we need to find 2 teams which will play next game</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        GroupsQueueType::iterator itr_team[<a class="code" href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a>];</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <span class="comment">// optimalization : --- we dont need to use selection_pools - each update we select max 2 groups</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = <a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>; i &lt; <a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a>; ++i)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        {</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;            <span class="comment">// take the group that joined first</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;            itr_team[i] = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][i].begin();</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            <span class="keywordflow">for</span> (; itr_team[i] != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][i].end(); ++(itr_team[i]))</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            {</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                <span class="comment">// if group match conditions, then add it to pool</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                <span class="keywordflow">if</span> (!(*itr_team[i])-&gt;isInvitedToBgInstanceGuid</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;                        &amp;&amp; (((*itr_team[i])-&gt;arenaTeamRating &gt;= arenaMinRating &amp;&amp; (*itr_team[i])-&gt;arenaTeamRating &lt;= arenaMaxRating)</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;                            || (*itr_team[i])-&gt;joinTime &lt; discardTime))</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                {</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;                    <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[i].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*itr_team[i]), maxPlayersPerTeam, 0);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                    <span class="comment">// break for cycle to be able to start selecting another group from same faction queue</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;                }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;            }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        }</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="comment">// now we are done if we have 2 groups - ali vs horde!</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <span class="comment">// if we don&#39;t have, we must try to continue search in same queue</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="comment">// tmp variables are correctly set</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="comment">// this code isn&#39;t much userfriendly - but it is supposed to continue search for mathing group in HORDE queue</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount() == 0 &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>())</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>] = itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>];</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            ++itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>];</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            <span class="keywordflow">for</span> (; itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>] != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].end(); ++(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]))</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                <span class="keywordflow">if</span> (!(*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>])-&gt;isInvitedToBgInstanceGuid</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                        &amp;&amp; (((*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>])-&gt;arenaTeamRating &gt;= arenaMinRating &amp;&amp; (*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>])-&gt;arenaTeamRating &lt;= arenaMaxRating)</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                            || (*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>])-&gt;joinTime &lt; discardTime))</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;                {</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                    <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]), maxPlayersPerTeam, 0);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        }</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        <span class="comment">// this code isn&#39;t much userfriendly - but it is supposed to continue search for mathing group in ALLIANCE queue</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].GetPlayerCount() == 0 &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>())</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>] = itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>];</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            ++itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>];</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160; </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <span class="keywordflow">for</span> (; itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>] != <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].end(); ++(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]))</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <span class="keywordflow">if</span> (!(*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>])-&gt;isInvitedToBgInstanceGuid</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        &amp;&amp; (((*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>])-&gt;arenaTeamRating &gt;= arenaMinRating &amp;&amp; (*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>])-&gt;arenaTeamRating &lt;= arenaMaxRating)</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                            || (*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>])-&gt;joinTime &lt; discardTime))</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                {</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                    <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">AddGroup</a>((*itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]), maxPlayersPerTeam, 0);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160; </div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="comment">// if we have 2 teams, then start new arena and invite players!</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>].GetPlayerCount() &amp;&amp; <a class="code" href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">m_selectionPools</a>[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>].<a class="code" href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">GetPlayerCount</a>())</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        {</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <a class="code" href="classBattleGround.html">BattleGround</a>* arena = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.CreateNewBattleGround(bgTypeId, bracketEntry, arenaType, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;            <span class="keywordflow">if</span> (!arena)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;            {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattlegroundQueue::Update couldn&#39;t create arena instance for rated arena match!&quot;</span>);</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;            }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]))-&gt;opponentsTeamRating = (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]))-&gt;arenaTeamRating;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;setting oposite teamrating for team %u to %u&quot;</span>, (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]))-&gt;arenaTeamId, (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]))-&gt;opponentsTeamRating);</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;            (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]))-&gt;opponentsTeamRating = (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]))-&gt;arenaTeamRating;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;setting oposite teamrating for team %u to %u&quot;</span>, (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]))-&gt;arenaTeamId, (*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]))-&gt;opponentsTeamRating);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160; </div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;            <span class="comment">// now we must move team if we changed its faction to another faction queue, because then we will spam log by errors in Queue::RemovePlayer</span></div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">if</span> ((*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]))-&gt;groupTeam != <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a>)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                <span class="comment">// add to alliance queue</span></div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].push_front(*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]));</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                <span class="comment">// erase from horde queue</span></div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].erase(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>] = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].begin();</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;            <span class="keywordflow">if</span> ((*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]))-&gt;groupTeam != <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>)</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;            {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].push_front(*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]));</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a>].erase(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>] = <a class="code" href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">m_queuedGroups</a>[bracketId][<a class="code" href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a>].begin();</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;            <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">InviteGroupToBg</a>(*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a>]), arena, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a>);</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            <a class="code" href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">InviteGroupToBg</a>(*(itr_team[<a class="code" href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a>]), arena, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>);</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Starting rated arena match!&quot;</span>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            arena-&gt;<a class="code" href="classBattleGround.html#a8da15b689f8837f8ab9400787733113d">StartBattleGround</a>();</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;}</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="comment">/***            BATTLEGROUND QUEUE EVENTS              ***/</span></div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"><a class="line" href="classBgQueueInviteEvent.html#ad89a92e47d237513c06673c7870fe1cb"> 1172</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBgQueueInviteEvent.html#ad89a92e47d237513c06673c7870fe1cb">BgQueueInviteEvent::Execute</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <span class="comment">/*e_time*/</span>, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="comment">/*p_time*/</span>)</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;{</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.GetMessager().AddMessage([event = *<span class="keyword">this</span>](<a class="code" href="classWorld.html">World</a>* <span class="comment">/*world*/</span>)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* plr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(event.m_playerGuid);</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        <span class="comment">// player logged off (we should do nothing, he is correctly removed from queue in another procedure)</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        if (!plr)</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGround(event.m_bgInstanceGuid, event.m_bgTypeId);</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <span class="comment">// if battleground ended and its instance deleted - do nothing</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;        if (!bg)</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId = <a class="code" href="classBattleGroundMgr.html#a2626e64e4c8c5ebb515da8a94c5e6188">BattleGroundMgr::BgQueueTypeId</a>(bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>(), bg-&gt;<a class="code" href="classBattleGround.html#abcbde26976ecd6b28f3a5d0d7c4b4eb2">GetArenaType</a>());</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> queueSlot = plr-&gt;<a class="code" href="classPlayer.html#ac0b1b01da51987e47b563832a6d92b87">GetBattleGroundQueueIndex</a>(bgQueueTypeId);</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordflow">if</span> (queueSlot &lt; <a class="code" href="SharedDefines_8h.html#ae00102953affc07f8aa49666d1b97c3c">PLAYER_MAX_BATTLEGROUND_QUEUES</a>)         <span class="comment">// player is in queue or in battleground</span></div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        {</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            <span class="comment">// check if player is invited to this bg</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;            <a class="code" href="classBattleGroundQueue.html">BattleGroundQueue</a>&amp; bgQueue = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.m_battleGroundQueues[bgQueueTypeId];</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            <span class="keywordflow">if</span> (bgQueue.<a class="code" href="classBattleGroundQueue.html#a74cb1a78fa60d7a870e4a1a2e2380866">IsPlayerInvited</a>(event.m_playerGuid, event.m_bgInstanceGuid, event.m_removeTime))</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;            {</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                <a class="code" href="classWorldPacket.html">WorldPacket</a> data;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                <span class="comment">// we must send remaining time in queue</span></div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.BuildBattleGroundStatusPacket(data, bg, queueSlot, <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaf0b95a17deaea4fc8f467eaacaa515b2">STATUS_WAIT_JOIN</a>, <a class="code" href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05a1b0d93b746ae2d960bd33172a070c365">INVITE_ACCEPT_WAIT_TIME</a> - <a class="code" href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05afa97b69bd50d943b0d6fcb4fb6b0b0f1">INVITATION_REMIND_TIME</a>, 0, event.m_arenaType, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a66bbf321f9fe6b3387090eb97e230c68">TEAM_NONE</a>);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                plr-&gt;<a class="code" href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">GetSession</a>()-&gt;<a class="code" href="classWorldSession.html#a15a10b125d9f54c3945a3daf319b228f">SendPacket</a>(data);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;            }</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    });</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;                                            <span class="comment">// event will be deleted</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;}</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"><a class="line" href="classBgQueueInviteEvent.html#aa83a13d03d7e57f49263f7f8fa47899f"> 1204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBgQueueInviteEvent.html#aa83a13d03d7e57f49263f7f8fa47899f">BgQueueInviteEvent::Abort</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <span class="comment">/*e_time*/</span>)</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;{</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="comment">// do nothing</span></div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;}</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01219"></a><span class="lineno"><a class="line" href="classBgQueueRemoveEvent.html#abdf64fcf29c2d818e92cad38b64d3131"> 1219</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBgQueueRemoveEvent.html#abdf64fcf29c2d818e92cad38b64d3131">BgQueueRemoveEvent::Execute</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <span class="comment">/*e_time*/</span>, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="comment">/*p_time*/</span>)</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;{</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.GetMessager().AddMessage([event = *<span class="keyword">this</span>](<a class="code" href="classWorld.html">World</a>* <span class="comment">/*world*/</span>)</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    {</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* plr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(event.m_playerGuid);</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        if (!plr)</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;            <span class="comment">// player logged off (we should do nothing, he is correctly removed from queue in another procedure)</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160; </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGround(event.m_bgInstanceGuid, event.m_bgTypeId);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="comment">// battleground can be deleted already when we are removing queue info</span></div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <span class="comment">// bg pointer can be nullptr! so use it carefully!</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> queueSlot = plr-&gt;<a class="code" href="classPlayer.html#ac0b1b01da51987e47b563832a6d92b87">GetBattleGroundQueueIndex</a>(event.m_bgQueueTypeId);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        if (queueSlot &lt; <a class="code" href="SharedDefines_8h.html#ae00102953affc07f8aa49666d1b97c3c">PLAYER_MAX_BATTLEGROUND_QUEUES</a>)         <span class="comment">// player is in queue, or in Battleground</span></div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="comment">// check if player is in queue for this BG and if we are removing his invite event</span></div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            <a class="code" href="classBattleGroundQueue.html">BattleGroundQueue</a>&amp; bgQueue = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.m_battleGroundQueues[<span class="keyword">event</span>.m_bgQueueTypeId];</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordflow">if</span> (bgQueue.<a class="code" href="classBattleGroundQueue.html#a74cb1a78fa60d7a870e4a1a2e2380866">IsPlayerInvited</a>(event.m_playerGuid, event.m_bgInstanceGuid, event.m_removeTime))</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;            {</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;                DEBUG_LOG(<span class="stringliteral">&quot;Battleground: removing player %u from bg queue for instance %u because of not pressing enter battle in time.&quot;</span>, plr-&gt;GetGUIDLow(), event.m_bgInstanceGuid);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                plr-&gt;RemoveBattleGroundQueueId(event.m_bgQueueTypeId);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                bgQueue.RemovePlayer(event.m_playerGuid, true);</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                <span class="comment">// update queues if battleground isn&#39;t ended</span></div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;                if (bg &amp;&amp; bg-&gt;IsBattleGround() &amp;&amp; bg-&gt;GetStatus() != STATUS_WAIT_LEAVE)</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;                    sBattleGroundMgr.ScheduleQueueUpdate(0, ARENA_TYPE_NONE, event.m_bgQueueTypeId, event.m_bgTypeId, bg-&gt;GetBracketId());</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                WorldPacket data;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;                sBattleGroundMgr.BuildBattleGroundStatusPacket(data, bg, queueSlot, STATUS_NONE, 0, 0, ARENA_TYPE_NONE, TEAM_NONE);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;                plr-&gt;GetSession()-&gt;SendPacket(data);</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;            }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        }</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;    });</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160; </div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="comment">// event will be deleted</span></div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;}</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160; </div>
<div class="line"><a name="l01259"></a><span class="lineno"><a class="line" href="classBgQueueRemoveEvent.html#ace7f37c0190c9f6736fdae532ffcd671"> 1259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBgQueueRemoveEvent.html#ace7f37c0190c9f6736fdae532ffcd671">BgQueueRemoveEvent::Abort</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <span class="comment">/*e_time*/</span>)</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;{</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">// do nothing</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;}</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160; </div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">/***            BATTLEGROUND MANAGER                   ***/</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">/*********************************************************/</span></div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160; </div>
<div class="line"><a name="l01268"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#ae7d08202c53b50d58221160e99a27c9f"> 1268</a></span>&#160;<a class="code" href="classBattleGroundMgr.html#ae7d08202c53b50d58221160e99a27c9f">BattleGroundMgr::BattleGroundMgr</a>() : m_nextAutoDistributionTime(0), m_autoDistributionTimeChecker(0), m_arenaTesting(false)</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;{</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8748942e38a5e4140daf8e10cb08f0c7">BATTLEGROUND_TYPE_NONE</a>; i &lt; <a class="code" href="SharedDefines_8h.html#add6e677d0cfd3f1eff02a4dd3b90b95c">MAX_BATTLEGROUND_TYPE_ID</a>; ++i)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[i].clear();</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <a class="code" href="classBattleGroundMgr.html#ab36bb5c81b3f2ac36804cc97b3849555">m_nextRatingDiscardUpdate</a> = <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a9af243abbc26eb5bbc0bcb04f9f4c641">CONFIG_UINT32_ARENA_RATING_DISCARD_TIMER</a>);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <a class="code" href="classBattleGroundMgr.html#aa324ba8f05f6b2f8cd57f76045ee26d8">m_testing</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;}</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160; </div>
<div class="line"><a name="l01276"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a8dadadd0b5e6016a558f394a293fb205"> 1276</a></span>&#160;<a class="code" href="classBattleGroundMgr.html#a8dadadd0b5e6016a558f394a293fb205">BattleGroundMgr::~BattleGroundMgr</a>()</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;{</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <a class="code" href="classBattleGroundMgr.html#aa05d72771e50f0a581cf04fb031db0d2">DeleteAllBattleGrounds</a>();</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;}</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#aa05d72771e50f0a581cf04fb031db0d2"> 1284</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#aa05d72771e50f0a581cf04fb031db0d2">BattleGroundMgr::DeleteAllBattleGrounds</a>()</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;{</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">// will also delete template bgs:</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8748942e38a5e4140daf8e10cb08f0c7">BATTLEGROUND_TYPE_NONE</a>; i &lt; <a class="code" href="SharedDefines_8h.html#add6e677d0cfd3f1eff02a4dd3b90b95c">MAX_BATTLEGROUND_TYPE_ID</a>; ++i)</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    {</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="keywordflow">for</span> (BattleGroundSet::iterator itr = <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[i].begin(); itr != <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[i].end();)</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            <a class="code" href="classBattleGround.html">BattleGround</a>* bg = itr-&gt;second;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            ++itr;                                          <span class="comment">// step from invalidate iterator pos in result element remove in ~BattleGround call</span></div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keyword">delete</span> bg;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;}</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a36d5b734fedd9a5959321c48004a3e70"> 1303</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a36d5b734fedd9a5959321c48004a3e70">BattleGroundMgr::Update</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> diff)</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;{</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <span class="comment">// update scheduled queues</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundMgr.html#a3d9d5237b37f14e063fd7a1e1fc078f4">m_queueUpdateScheduler</a>.empty())</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        std::vector&lt;uint64&gt; scheduled;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;        {</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            <span class="comment">// create mutex</span></div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="comment">// std::lock_guard&lt;std::mutex&gt; guard(SchedulerLock);</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            <span class="comment">// copy vector and clear the other</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;            scheduled = std::vector&lt;uint64&gt;(<a class="code" href="classBattleGroundMgr.html#a3d9d5237b37f14e063fd7a1e1fc078f4">m_queueUpdateScheduler</a>);</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;            <a class="code" href="classBattleGroundMgr.html#a3d9d5237b37f14e063fd7a1e1fc078f4">m_queueUpdateScheduler</a>.clear();</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="comment">// release lock</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;        }</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160; </div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i : scheduled)</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        {</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaRating = i &gt;&gt; 32;</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType = <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a>(i &gt;&gt; 24 &amp; 255);</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;            <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId = <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a>(i &gt;&gt; 16 &amp; 255);</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a>((i &gt;&gt; 8) &amp; 255);</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;            <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracket_id = <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a>(i &amp; 255);</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            <a class="code" href="classBattleGroundMgr.html#abaa0819870ac4863dfa3955d3c50e6da">m_battleGroundQueues</a>[bgQueueTypeId].<a class="code" href="classBattleGroundQueue.html#af7b20fca70ffededaf59d29df058a6c7">Update</a>(bgTypeId, bracket_id, arenaType, arenaRating &gt; 0, arenaRating);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        }</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">// if rating difference counts, maybe force-update queues</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232ad3546d2bc7feb4e62b51c51767df1e03">CONFIG_UINT32_ARENA_MAX_RATING_DIFFERENCE</a>) &amp;&amp; <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a9af243abbc26eb5bbc0bcb04f9f4c641">CONFIG_UINT32_ARENA_RATING_DISCARD_TIMER</a>))</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="comment">// it&#39;s time to force update</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundMgr.html#ab36bb5c81b3f2ac36804cc97b3849555">m_nextRatingDiscardUpdate</a> &lt; diff)</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        {</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;            <span class="comment">// forced update for rated arenas (scan all, but skipped non rated)</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;BattleGroundMgr: UPDATING ARENA QUEUES&quot;</span>);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> qtype = <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a02779ae5e6ae1a94636450f7e012bc6c">BATTLEGROUND_QUEUE_2v2</a>; qtype &lt;= <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a6b9cb096b2108333789c9435dcff1191">BATTLEGROUND_QUEUE_5v5</a>; ++qtype)</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> bracket = <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525fa6491ce72b44414af538f648d5388fc34">BG_BRACKET_ID_FIRST</a>; bracket &lt; <a class="code" href="DBCEnums_8h.html#a5201a522ecfb21f8b94bcab8b2ba2f8c">MAX_BATTLEGROUND_BRACKETS</a>; ++bracket)</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                    <a class="code" href="classBattleGroundMgr.html#abaa0819870ac4863dfa3955d3c50e6da">m_battleGroundQueues</a>[qtype].<a class="code" href="classBattleGroundMgr.html#a36d5b734fedd9a5959321c48004a3e70">Update</a>(</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                        <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a>(bracket),</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                        <a class="code" href="classBattleGroundMgr.html#ad40d2889a679f4ed9faed31e1be3fc01">BattleGroundMgr::BgArenaType</a>(<a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a>(qtype)), <span class="keyword">true</span>, 0);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            <a class="code" href="classBattleGroundMgr.html#ab36bb5c81b3f2ac36804cc97b3849555">m_nextRatingDiscardUpdate</a> = <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a9af243abbc26eb5bbc0bcb04f9f4c641">CONFIG_UINT32_ARENA_RATING_DISCARD_TIMER</a>);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            <a class="code" href="classBattleGroundMgr.html#ab36bb5c81b3f2ac36804cc97b3849555">m_nextRatingDiscardUpdate</a> -= diff;</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda941de37043fd9e75ad8a719281f22690">CONFIG_BOOL_ARENA_AUTO_DISTRIBUTE_POINTS</a>))</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundMgr.html#ad26b90f8ea503b81a8e1af2434160ec1">m_autoDistributionTimeChecker</a> &lt; diff)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        {</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.GetGameTime() &gt; <a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a>)</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            {</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                <a class="code" href="classBattleGroundMgr.html#a809ed86411a3d3e5ef983747590982bf">DistributeArenaPoints</a>();</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;                <a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a> = time_t(<a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a> + <a class="code" href="BattleGroundMgr_8h.html#a0ce5868c633756e71b53b763c925b124">BATTLEGROUND_ARENA_POINT_DISTRIBUTION_DAY</a> * <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232ade6a14406c661a78fe5d4fca6d7b5116">CONFIG_UINT32_ARENA_AUTO_DISTRIBUTE_INTERVAL_DAYS</a>));</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;                <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE saved_variables SET NextArenaPointDistributionTime = &#39;&quot;</span> <a class="code" href="Common_8h.html#a12f54e09a2fe86ecb7dc821868e5aaf9">UI64FMTD</a> <span class="stringliteral">&quot;&#39;&quot;</span>, <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(<a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a>));</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <a class="code" href="classBattleGroundMgr.html#ad26b90f8ea503b81a8e1af2434160ec1">m_autoDistributionTimeChecker</a> = 600000; <span class="comment">// check 10 minutes</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;        }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <a class="code" href="classBattleGroundMgr.html#ad26b90f8ea503b81a8e1af2434160ec1">m_autoDistributionTimeChecker</a> -= diff;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;    }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;}</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#aa093ad05f391e79d11dd64b98b8b43da"> 1379</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#aa093ad05f391e79d11dd64b98b8b43da">BattleGroundMgr::BuildBattleGroundStatusPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="classBattleGround.html">BattleGround</a>* bg, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> queueSlot, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> statusId, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> time1, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> time2, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType, <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a> arenaTeam)<span class="keyword"> const</span></div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="comment">// we can be in 2 queues in same time...</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="keywordflow">if</span> (statusId == 0 || !bg)</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    {</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;        data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca23e69a1dd0f74081bc248b7c5056bad9">SMSG_BATTLEFIELD_STATUS</a>, 4 + 8);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(queueSlot);                         <span class="comment">// queue id (0...1)</span></div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;    }</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca23e69a1dd0f74081bc248b7c5056bad9">SMSG_BATTLEFIELD_STATUS</a>, (4 + 8 + 1 + 1 + 4 + 1 + 4 + 4 + 4));</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(queueSlot);                             <span class="comment">// queue id (0...1) - player can be in 2 queues in time</span></div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    <span class="comment">// uint64 in client</span></div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(arenaType) | (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0D) &lt;&lt; 8) | (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>()) &lt;&lt; 16) | (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x1F90) &lt;&lt; 48));</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(bg-&gt;<a class="code" href="classBattleGround.html#aa5192bced3c38cbdfe0c9ec24804b6e5">GetMinLevel</a>());</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(bg-&gt;<a class="code" href="classBattleGround.html#a8dd6dd20f583b3e0a7ec6a67cab93e3e">GetMaxLevel</a>());</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(bg-&gt;<a class="code" href="classBattleGround.html#af22363ba2055213ac1591b39ad0e32fc">GetClientInstanceId</a>());</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    <span class="comment">// alliance/horde for BG and skirmish/rated for Arenas</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="comment">// following displays the minimap-icon 0 = faction icon 1 = arenaicon</span></div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(bg-&gt;<a class="code" href="classBattleGround.html#a3f8170a5d81f660f9fae6c28337d356b">IsRated</a>());</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(statusId);                              <span class="comment">// status</span></div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">switch</span> (statusId)</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0ea91aabae633323f9e31059e42e9ea5240">STATUS_WAIT_QUEUE</a>:                             <span class="comment">// status_in_queue</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(time1);                         <span class="comment">// average wait time, milliseconds</span></div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(time2);                         <span class="comment">// time in queue, updated every minute!, milliseconds</span></div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaf0b95a17deaea4fc8f467eaacaa515b2">STATUS_WAIT_JOIN</a>:                              <span class="comment">// status_invite</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(bg-&gt;<a class="code" href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">GetMapId</a>());                <span class="comment">// map id</span></div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);                             <span class="comment">// 3.3.5, unknown</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(time1);                         <span class="comment">// time to remove from queue, milliseconds</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eafaf0b6349b8a93b543f64c744e321d5a">STATUS_IN_PROGRESS</a>:                            <span class="comment">// status_in_progress</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(bg-&gt;<a class="code" href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">GetMapId</a>());                <span class="comment">// map id</span></div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);                             <span class="comment">// 3.3.5, unknown</span></div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(time1);                         <span class="comment">// time to bg auto leave, 0 at bg start, 120000 after bg end, milliseconds</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(time2);                         <span class="comment">// time from bg start, milliseconds</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(arenaTeam == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a> ? 1 : 0);  <span class="comment">// arenaTeam (0 for horde, 1 for alliance)</span></div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Unknown BG status!&quot;</span>);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    }</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;}</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#accca20f2f5911050839113eb74dd7c81"> 1433</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#accca20f2f5911050839113eb74dd7c81">BattleGroundMgr::BuildPvpLogDataPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="classBattleGround.html">BattleGround</a>* bg)<span class="keyword"> const</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> type = (bg-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>() ? 1 : 0);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;    <span class="comment">// last check on 3.0.3</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca453a1c6742bb2e88150a8abe969be502">MSG_PVP_LOG_DATA</a>, (1 + 1 + 4 + 40 * bg-&gt;<a class="code" href="classBattleGround.html#ac76706d80992d887d1dbee0c94f3fb2b">GetPlayerScoresSize</a>()));</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(type);                                   <span class="comment">// type (battleground=0/arena=1)</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    <span class="keywordflow">if</span> (type)                                               <span class="comment">// arena</span></div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    {</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;        <span class="comment">// it seems this must be according to BG_WINNER_A/H and _NOT_ BG_TEAM_A/H</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a3bb8a71f4ae9af551f71e9eb2c9c3325">int8</a> i = 1; i &gt;= 0; --i)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> pointsLost = bg-&gt;<a class="code" href="classBattleGround.html#a8c48da7691e3702b2c5a94044aaa7454">m_arenaTeamRatingChanges</a>[i] &lt; 0 ? abs(bg-&gt;<a class="code" href="classBattleGround.html#a8c48da7691e3702b2c5a94044aaa7454">m_arenaTeamRatingChanges</a>[i]) : 0;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> pointsGained = bg-&gt;<a class="code" href="classBattleGround.html#a8c48da7691e3702b2c5a94044aaa7454">m_arenaTeamRatingChanges</a>[i] &gt; 0 ? bg-&gt;<a class="code" href="classBattleGround.html#a8c48da7691e3702b2c5a94044aaa7454">m_arenaTeamRatingChanges</a>[i] : 0;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160; </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(pointsLost);                    <span class="comment">// Rating Lost</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(pointsGained);                  <span class="comment">// Rating gained</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                             <span class="comment">// Matchmaking Value</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;rating change: %d&quot;</span>, bg-&gt;<a class="code" href="classBattleGround.html#a8c48da7691e3702b2c5a94044aaa7454">m_arenaTeamRatingChanges</a>[i]);</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        }</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160; </div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a3bb8a71f4ae9af551f71e9eb2c9c3325">int8</a> i = 1; i &gt;= 0; --i)</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> at_id = bg-&gt;<a class="code" href="classBattleGround.html#ac0d4150ea2cea10de52503499c8bfad1">m_arenaTeamIds</a>[i];</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;            <a class="code" href="classArenaTeam.html">ArenaTeam</a>* at = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamById(at_id);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <span class="keywordflow">if</span> (at)</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;                data &lt;&lt; at-&gt;<a class="code" href="classArenaTeam.html#a6bf6796c43b39725f62ee1f7c6f77677">GetName</a>();</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>)0;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    }</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">if</span> (bg-&gt;<a class="code" href="classBattleGround.html#a252b10c72b1a28b0534db1c4cbd55829">GetStatus</a>() != <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8">STATUS_WAIT_LEAVE</a>)</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);                                  <span class="comment">// bg not ended</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(1);                                  <span class="comment">// bg ended</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(bg-&gt;<a class="code" href="classBattleGround.html#a4d43283dc3c9cbf5430c01d8c4a3e38a">GetWinner</a>());                    <span class="comment">// who won</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)(bg-&gt;<a class="code" href="classBattleGround.html#ac76706d80992d887d1dbee0c94f3fb2b">GetPlayerScoresSize</a>());</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160; </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="keywordflow">for</span> (BattleGround::BattleGroundScoreMap::const_iterator itr = bg-&gt;<a class="code" href="classBattleGround.html#a4a599d0991c5f98660322d75895f6330">GetPlayerScoresBegin</a>(); itr != bg-&gt;<a class="code" href="classBattleGround.html#ad0703f439c2f254a7a5e823d4d7df62e">GetPlayerScoresEnd</a>(); ++itr)</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    {</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        <span class="keyword">const</span> <a class="code" href="classBattleGroundScore.html">BattleGroundScore</a>* score = itr-&gt;second;</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        data &lt;&lt; <a class="code" href="classObjectGuid.html">ObjectGuid</a>(itr-&gt;first);</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)score-&gt;<a class="code" href="classBattleGroundScore.html#a9399d364334990250f22938e545065d8">killingBlows</a>;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        if (type == 0)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)score-&gt;<a class="code" href="classBattleGroundScore.html#ae9040175a753866df505d1fa11c6f353">honorableKills</a>;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)score-&gt;<a class="code" href="classBattleGroundScore.html#a76cd7869c5ecd95e263adaf3b08cce0d">deaths</a>;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;            data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)(score-&gt;<a class="code" href="classBattleGroundScore.html#a8d2f7d7a6b515596ce4a92635cfe5d68">bonusHonor</a>);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;        {</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a> team = bg-&gt;<a class="code" href="classBattleGround.html#a928a22c556c89666337bf636671c90e1">GetPlayerTeam</a>(itr-&gt;first);</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;            <span class="keywordflow">if</span> (team != <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a> &amp;&amp; team != <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* player = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(itr-&gt;first))</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;                    team = bg-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>() ? <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a>(itr-&gt;second-&gt;Team) : player-&gt;GetTeam();</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(team == <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a> ? 1 : 0); <span class="comment">// green or yellow</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;        }</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;        data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)score-&gt;<a class="code" href="classBattleGroundScore.html#a5913069e620539c59880fe1ffc65c372">damageDone</a>;            <span class="comment">// damage done</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)score-&gt;<a class="code" href="classBattleGroundScore.html#a88de911478192716adeb7bbba9640636">healingDone</a>;           <span class="comment">// healing done</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keywordflow">switch</span> (bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>())                            <span class="comment">// battleground specific things</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>:</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0x00000005;                <span class="comment">// count of next fields</span></div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundAVScore.html">BattleGroundAVScore</a>*)score)-&gt;graveyardsAssaulted;  <span class="comment">// GraveyardsAssaulted</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundAVScore.html">BattleGroundAVScore</a>*)score)-&gt;graveyardsDefended;   <span class="comment">// GraveyardsDefended</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundAVScore.html">BattleGroundAVScore</a>*)score)-&gt;towersAssaulted;      <span class="comment">// TowersAssaulted</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundAVScore.html">BattleGroundAVScore</a>*)score)-&gt;towersDefended;       <span class="comment">// TowersDefended</span></div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundAVScore.html">BattleGroundAVScore</a>*)score)-&gt;secondaryObjectives;  <span class="comment">// SecondaryObjectives - free some of the Lieutnants</span></div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>:</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0x00000002;                <span class="comment">// count of next fields</span></div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundWGScore.html">BattleGroundWGScore</a>*)score)-&gt;flagCaptures;         <span class="comment">// flag captures</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundWGScore.html">BattleGroundWGScore</a>*)score)-&gt;flagReturns;          <span class="comment">// flag returns</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>:</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0x00000002;                <span class="comment">// count of next fields</span></div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundABScore.html">BattleGroundABScore</a>*)score)-&gt;basesAssaulted;       <span class="comment">// bases asssulted</span></div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundABScore.html">BattleGroundABScore</a>*)score)-&gt;basesDefended;        <span class="comment">// bases defended</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>:</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0x00000001;                <span class="comment">// count of next fields</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundEYScore.html">BattleGroundEYScore</a>*)score)-&gt;flagCaptures;         <span class="comment">// flag captures</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>:                          <span class="comment">// wotlk</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)0x00000002;                <span class="comment">// count of next fields</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundSAScore.html">BattleGroundSAScore</a>*)score)-&gt;demolishersDestroyed; <span class="comment">// demolishers destroyed</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)((<a class="code" href="classBattleGroundSAScore.html">BattleGroundSAScore</a>*)score)-&gt;gatesDestroyed;       <span class="comment">// gates destroyed</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a>:                           <span class="comment">// wotlk</span></div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0x00000002);                 <span class="comment">// count of next fields</span></div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(((<a class="code" href="classBattleGroundICScore.html">BattleGroundICScore</a>*)score)-&gt;basesAssaulted);       <span class="comment">// bases asssulted</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(((<a class="code" href="classBattleGroundICScore.html">BattleGroundICScore</a>*)score)-&gt;basesDefended);        <span class="comment">// bases defended</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a>:</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a>:</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>:</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a>:</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a>:                           <span class="comment">// wotlk</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a>:                           <span class="comment">// wotlk</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>:                           <span class="comment">// wotlk</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)0;                          <span class="comment">// 0</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Unhandled MSG_PVP_LOG_DATA for BG id %u&quot;</span>, bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>());</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                data &lt;&lt; (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)0;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160; </div>
<div class="line"><a name="l01557"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a99302a2a0e78a27b22ba192b70e3be21"> 1557</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a99302a2a0e78a27b22ba192b70e3be21">BattleGroundMgr::BuildGroupJoinedBattlegroundPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="BattleGround_8h.html#a270b85294546331d63097ac665c16408">GroupJoinBattlegroundResult</a> result)<span class="keyword"> const</span></div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca0b4708d07fe8318f0a87a8e24c7ac7cb">SMSG_GROUP_JOINED_BATTLEGROUND</a>, 4);</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(result);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    <span class="keywordflow">if</span> (result == <a class="code" href="BattleGround_8h.html#a270b85294546331d63097ac665c16408a0371438cee9cd3dd26e4b3921e4ea180">ERR_BATTLEGROUND_JOIN_TIMED_OUT</a> || result == <a class="code" href="BattleGround_8h.html#a270b85294546331d63097ac665c16408a11f3937262a81d72f1c3ce29cc078961">ERR_BATTLEGROUND_JOIN_FAILED</a>)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);                                 <span class="comment">// player guid</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;}</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a9496486e3066cd0eb8a4cd399d3724a4"> 1572</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a9496486e3066cd0eb8a4cd399d3724a4">BattleGroundMgr::BuildUpdateWorldStatePacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> field, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> value)<span class="keyword"> const</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca7ffb25a5bf6639c2fef2bf2a79ec3c05">SMSG_UPDATE_WORLD_STATE</a>, 4 + 4);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(field);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(value);</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;}</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01585"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a0c4dc70bd058c67d35cd51e596f06441"> 1585</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a0c4dc70bd058c67d35cd51e596f06441">BattleGroundMgr::BuildPlaySoundPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> soundId)<span class="keyword"> const</span></div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca9ecbc0808c5e2e15978e7127f4e1930f">SMSG_PLAY_SOUND</a>, 4);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(soundId);</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;}</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#afa1e255be00efde32b18b8808c032d35"> 1597</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#afa1e255be00efde32b18b8808c032d35">BattleGroundMgr::BuildPlayerLeftBattleGroundPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="classObjectGuid.html">ObjectGuid</a> guid)<span class="keyword"> const</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacac7cd27ed3678566826415657f484a656">SMSG_BATTLEGROUND_PLAYER_LEFT</a>, 8);</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    data &lt;&lt; <a class="code" href="classObjectGuid.html">ObjectGuid</a>(guid);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;}</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01609"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a261d503c2fe3cf2a7edcd1d4c37e66f9"> 1609</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a261d503c2fe3cf2a7edcd1d4c37e66f9">BattleGroundMgr::BuildPlayerJoinedBattleGroundPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="classPlayer.html">Player</a>* player)<span class="keyword"> const</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacae6dad235c681e7970a84c5c20cb0d55a">SMSG_BATTLEGROUND_PLAYER_JOINED</a>, 8);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    data &lt;&lt; player-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;}</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a3a3bb90886fd82d7910a67a655b3e28a"> 1621</a></span>&#160;<a class="code" href="classBattleGround.html">BattleGround</a>* <a class="code" href="classBattleGroundMgr.html#a3a3bb90886fd82d7910a67a655b3e28a">BattleGroundMgr::GetBattleGroundThroughClientInstance</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> instanceId, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;{</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// cause at HandleBattleGroundJoinOpcode the clients sends the instanceid he gets from</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="comment">// SMSG_BATTLEFIELD_LIST we need to find the battleground with this clientinstance-id</span></div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    <a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9">GetBattleGroundTemplate</a>(bgTypeId);</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;    <span class="keywordflow">if</span> (!bg)</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="keywordflow">if</span> (bg-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>())</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classBattleGroundMgr.html#a3d03a58137de7e085237a4327a9c7b31">GetBattleGround</a>(instanceId, bgTypeId);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; itr : <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[bgTypeId])</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    {</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">if</span> (itr.second-&gt;GetClientInstanceId() == instanceId)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;            <span class="keywordflow">return</span> itr.second;</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;}</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a3d03a58137de7e085237a4327a9c7b31"> 1647</a></span>&#160;<a class="code" href="classBattleGround.html">BattleGround</a>* <a class="code" href="classBattleGroundMgr.html#a3d03a58137de7e085237a4327a9c7b31">BattleGroundMgr::GetBattleGround</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> instanceId, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;{</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="comment">// search if needed</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    BattleGroundSet::iterator itr;</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <span class="keywordflow">if</span> (bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8748942e38a5e4140daf8e10cb08f0c7">BATTLEGROUND_TYPE_NONE</a>)</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>; i &lt; <a class="code" href="SharedDefines_8h.html#add6e677d0cfd3f1eff02a4dd3b90b95c">MAX_BATTLEGROUND_TYPE_ID</a>; ++i)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            itr = <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[i].find(instanceId);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;            <span class="keywordflow">if</span> (itr != <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[i].end())</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                <span class="keywordflow">return</span> itr-&gt;second;</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;        }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    }</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160; </div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    itr = <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[bgTypeId].find(instanceId);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">return</span> ((itr != <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[bgTypeId].end()) ? itr-&gt;second : <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;}</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9"> 1671</a></span>&#160;<a class="code" href="classBattleGround.html">BattleGround</a>* <a class="code" href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9">BattleGroundMgr::GetBattleGroundTemplate</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;{</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="comment">// map is sorted and we can be sure that lowest instance id has only BG template</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[bgTypeId].empty() ? nullptr : <a class="code" href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">m_battleGrounds</a>[bgTypeId].begin()-&gt;second;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;}</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#aa4dd9379ea4fbb04a68f9961a421be01"> 1683</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classBattleGroundMgr.html#aa4dd9379ea4fbb04a68f9961a421be01">BattleGroundMgr::CreateClientVisibleInstanceId</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;{</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundMgr.html#a669ae70091f8092ba8aa6c909e30d8f8">IsArenaType</a>(bgTypeId))</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">return</span> 0;                                           <span class="comment">// arenas don&#39;t have client-instanceids</span></div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="comment">// we create here an instanceid, which is just for</span></div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    <span class="comment">// displaying this to the client and without any other use..</span></div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="comment">// the client-instanceIds are unique for each battleground-type</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="comment">// the instance-id just needs to be as low as possible, beginning with 1</span></div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    <span class="comment">// the following works, because std::set is default ordered with &quot;&lt;&quot;</span></div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    <span class="comment">// the optimalization would be to use as bitmask std::vector&lt;uint32&gt; - but that would only make code unreadable</span></div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> lastId = 0;</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="classBattleGroundMgr.html#a4b2148f7acf0f7424cc8ff791a921951">ClientBattleGroundIdSet</a>&amp; ids = <a class="code" href="classBattleGroundMgr.html#abd238d9c4b982cf368d9875401e014c6">m_clientBattleGroundIds</a>[bgTypeId][bracketId];</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;    <span class="keywordflow">for</span> (ClientBattleGroundIdSet::const_iterator itr = ids.begin(); itr != ids.end();)</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    {</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">if</span> ((++lastId) != *itr)                             <span class="comment">// if there is a gap between the ids, we will break..</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        lastId = *itr;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    }</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;    ids.insert(lastId + 1);</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">return</span> lastId + 1;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;}</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a8c2aee4bdf49393a4d8fb24c88541aa1"> 1716</a></span>&#160;<a class="code" href="classBattleGround.html">BattleGround</a>* <a class="code" href="classBattleGroundMgr.html#a8c2aee4bdf49393a4d8fb24c88541aa1">BattleGroundMgr::CreateNewBattleGround</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="structPvPDifficultyEntry.html">PvPDifficultyEntry</a> <span class="keyword">const</span>* bracketEntry, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType, <span class="keywordtype">bool</span> isRated)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;{</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <span class="comment">// get the template BG</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;    <a class="code" href="classBattleGround.html">BattleGround</a>* bgTemplate = <a class="code" href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9">GetBattleGroundTemplate</a>(bgTypeId);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <span class="keywordflow">if</span> (!bgTemplate)</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    {</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGround: CreateNewBattleGround - bg template not found for %u&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    }</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160; </div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="comment">// for arenas there is random map used</span></div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    <span class="keywordflow">if</span> (bgTemplate-&gt;<a class="code" href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">IsArena</a>())</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    {</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> arenas[] = { <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a> };</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;        bgTypeId = arenas[<a class="code" href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a>(0, <a class="code" href="Common_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(arenas) - 1)];</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        bgTemplate = <a class="code" href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9">GetBattleGroundTemplate</a>(bgTypeId);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        <span class="keywordflow">if</span> (!bgTemplate)</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        {</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGround: CreateNewBattleGround - bg template not found for %u&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordtype">bool</span> isRandom = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgRandomTypeId = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a>(0);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keywordflow">if</span> (bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> battlegrounds[] = { <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a>};</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        bgTypeId = battlegrounds[<a class="code" href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a>(0, <a class="code" href="Common_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a>(battlegrounds) - 1)];</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160; </div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        bgRandomTypeId = bgTypeId;</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;        bgTemplate = <a class="code" href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9">GetBattleGroundTemplate</a>(bgTypeId);</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        <span class="keywordflow">if</span> (!bgTemplate)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;        {</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;BattleGround: CreateNewBattleGround - bg template not found for %u&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;        }</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        isRandom = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    }</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="classBattleGround.html">BattleGround</a>* bg;</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="comment">// create a copy of the BG template</span></div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">switch</span> (bgTypeId)</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    {</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>:</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundAV.html">BattleGroundAV</a>(*(<a class="code" href="classBattleGroundAV.html">BattleGroundAV</a>*)bgTemplate);</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>:</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundWS.html">BattleGroundWS</a>(*(<a class="code" href="classBattleGroundWS.html">BattleGroundWS</a>*)bgTemplate);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>:</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundAB.html">BattleGroundAB</a>(*(<a class="code" href="classBattleGroundAB.html">BattleGroundAB</a>*)bgTemplate);</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a>:</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundNA.html">BattleGroundNA</a>(*(<a class="code" href="classBattleGroundNA.html">BattleGroundNA</a>*)bgTemplate);</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a>:</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundBE.html">BattleGroundBE</a>(*(<a class="code" href="classBattleGroundBE.html">BattleGroundBE</a>*)bgTemplate);</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>:</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundEY.html">BattleGroundEY</a>(*(<a class="code" href="classBattleGroundEY.html">BattleGroundEY</a>*)bgTemplate);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a>:</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundRL.html">BattleGroundRL</a>(*(<a class="code" href="classBattleGroundRL.html">BattleGroundRL</a>*)bgTemplate);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>:</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundSA.html">BattleGroundSA</a>(*(<a class="code" href="classBattleGroundSA.html">BattleGroundSA</a>*)bgTemplate);</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a>:</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundDS.html">BattleGroundDS</a>(*(<a class="code" href="classBattleGroundDS.html">BattleGroundDS</a>*)bgTemplate);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a>:</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundRV.html">BattleGroundRV</a>(*(<a class="code" href="classBattleGroundRV.html">BattleGroundRV</a>*)bgTemplate);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a>:</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundIC.html">BattleGroundIC</a>(*(<a class="code" href="classBattleGroundIC.html">BattleGroundIC</a>*)bgTemplate);</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>:</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>:</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            <span class="comment">// error, but it is handled few lines above</span></div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    }</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160; </div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">// must occur before CreateBgMap - used to detect difficulty of BG</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a079219992af20076d06d9453cc049a25">SetBracket</a>(bracketEntry);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    bgTypeId = isRandom ? <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a> : bgTypeId;</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160; </div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    <span class="comment">// will also set m_bgMap, instanceid</span></div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;    <a class="code" href="MapManager_8h.html#a9132749f8376c48b0ca7212eb3293905">sMapMgr</a>.CreateBgMap(bg-&gt;<a class="code" href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">GetMapId</a>(), bg);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#aff315457ce3c289f1a51e32a578fddd1">SetClientInstanceId</a>(<a class="code" href="classBattleGroundMgr.html#aa4dd9379ea4fbb04a68f9961a421be01">CreateClientVisibleInstanceId</a>(bgTypeId, bracketEntry-&gt;<a class="code" href="structPvPDifficultyEntry.html#a6e491b5202e2af6675eba8d4372274a1">GetBracketId</a>()));</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    <span class="comment">// reset the new bg (set status to status_wait_queue from status_none)</span></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#abf7822226a49df5d9893262a539b5f16">Reset</a>();</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <span class="comment">// start the joining of the bg</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#ac6a7eff67f6b86fdf8deab465ef6f383">SetStatus</a>(<a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaf0b95a17deaea4fc8f467eaacaa515b2">STATUS_WAIT_JOIN</a>);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a566dbd1bc93724071ceda9aef0fd40c4">SetArenaType</a>(arenaType);</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#acf53bf94ac3786067e55dee819a24f52">SetRated</a>(isRated);</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a99286a44ebf4d93ecfccf2724f70420c">SetRandom</a>(isRandom);</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#ae53fc3217e685e5eb26938833f9b4699">SetTypeId</a>(bgTypeId);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a4bd4b3610f0cd717c01f827db79cd120">SetRandomTypeId</a>(bgRandomTypeId);</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; </div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="keywordflow">return</span> bg;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;}</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a37eec221fa4b0d79ca034f9790750363"> 1848</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classBattleGroundMgr.html#a37eec221fa4b0d79ca034f9790750363">BattleGroundMgr::CreateBattleGround</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <span class="keywordtype">bool</span> IsArena, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayersPerTeam, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxPlayersPerTeam, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> levelMin, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> levelMax, <span class="keywordtype">char</span> <span class="keyword">const</span>* battleGroundName, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mapId, <span class="keywordtype">float</span> team1StartLocX, <span class="keywordtype">float</span> team1StartLocY, <span class="keywordtype">float</span> team1StartLocZ, <span class="keywordtype">float</span> team1StartLocO, <span class="keywordtype">float</span> team2StartLocX, <span class="keywordtype">float</span> team2StartLocY, <span class="keywordtype">float</span> team2StartLocZ, <span class="keywordtype">float</span> team2StartLocO, <span class="keywordtype">float</span> startMaxDist, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> playerSkinReflootId)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;{</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="comment">// Create the BG</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;    <a class="code" href="classBattleGround.html">BattleGround</a>* bg;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">switch</span> (bgTypeId)</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    {</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundAV.html">BattleGroundAV</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundWS.html">BattleGroundWS</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundAB.html">BattleGroundAB</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundNA.html">BattleGroundNA</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundBE.html">BattleGroundBE</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundEY.html">BattleGroundEY</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundRL.html">BattleGroundRL</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundSA.html">BattleGroundSA</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundDS.html">BattleGroundDS</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundRV.html">BattleGroundRV</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGroundIC.html">BattleGroundIC</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGround.html">BattleGround</a>;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>: bg = <span class="keyword">new</span> <a class="code" href="classBattleGround.html">BattleGround</a>;   <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="keywordflow">default</span>:              bg = <span class="keyword">new</span> <a class="code" href="classBattleGround.html">BattleGround</a>;   <span class="keywordflow">break</span>;                           <span class="comment">// placeholder for non implemented BG</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#ab67e4e9d4b19576522b99d1dedf3b850">SetMapId</a>(mapId);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#ae53fc3217e685e5eb26938833f9b4699">SetTypeId</a>(bgTypeId);</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a3c2b4629969b3c55a02918ee9cb3aa1d">SetArenaorBGType</a>(IsArena);</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a6b4f03ff10353177437b435964384edd">SetMinPlayersPerTeam</a>(minPlayersPerTeam);</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a97adf01f21b2b87025f03f493cdd623b">SetMaxPlayersPerTeam</a>(maxPlayersPerTeam);</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a5dccc4e6c706f6e71c77f23f21b08afb">SetMinPlayers</a>(minPlayersPerTeam * 2);</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#af337c8140386e213f6bbef03b14b01b4">SetMaxPlayers</a>(maxPlayersPerTeam * 2);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#ae5654a88574ef06bc497e1de99ee03ff">SetName</a>(battleGroundName);</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#afed1dac8f1d63700f0bdf1c6c84b6c9b">SetTeamStartLoc</a>(<a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a>, team1StartLocX, team1StartLocY, team1StartLocZ, team1StartLocO);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#afed1dac8f1d63700f0bdf1c6c84b6c9b">SetTeamStartLoc</a>(<a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a>,    team2StartLocX, team2StartLocY, team2StartLocZ, team2StartLocO);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a0d03e64051f46948fba2dd8f90b2742b">SetStartMaxDist</a>(startMaxDist);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#af0bb2b507ef9c0507693ccb9ce4d9413">SetLevelRange</a>(levelMin, levelMax);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;    bg-&gt;<a class="code" href="classBattleGround.html#a18317f163274ee46b43d3ebbaec5bfde">SetPlayerSkinRefLootId</a>(playerSkinReflootId);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;    <span class="comment">// add bg to update list</span></div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <a class="code" href="classBattleGroundMgr.html#a25f1e316566e8e78d867ed6586b69da3">AddBattleGround</a>(bg-&gt;<a class="code" href="classBattleGround.html#a72477d06bf9c16a116ed66d2f7eb77b7">GetInstanceId</a>(), bg-&gt;<a class="code" href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">GetTypeId</a>(), bg);</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160; </div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;    <span class="comment">// return some not-null value, bgTypeId is good enough for me</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keywordflow">return</span> bgTypeId;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;}</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a586b5add4c230eb4dfea20c9234239e4"> 1894</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a586b5add4c230eb4dfea20c9234239e4">BattleGroundMgr::CreateInitialBattleGrounds</a>()</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;{</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 0;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;    <span class="comment">//                                                0   1                 2                 3                4             5             6</span></div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#gae551ea020f187b038a84473d48d9e14b">WorldDatabase</a>.<a class="code" href="classDatabase.html#a23b35412451da3ca1bb5c714b727a1f5">Query</a>(<span class="stringliteral">&quot;SELECT id, MinPlayersPerTeam,MaxPlayersPerTeam,AllianceStartLoc,HordeStartLoc,StartMaxDist, PlayerSkinReflootId FROM battleground_template&quot;</span>);</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160; </div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;    {</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <a class="code" href="classBarGoLink.html">BarGoLink</a> bar(1);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        bar.<a class="code" href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">step</a>();</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;&gt;&gt; Loaded 0 battlegrounds. DB table `battleground_template` is empty.&quot;</span>);</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString();</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    }</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160; </div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;    <a class="code" href="classBarGoLink.html">BarGoLink</a> bar(result-&gt;<a class="code" href="classQueryResult.html#af92312138c98bbceeeddca74ae6029fe">GetRowCount</a>());</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    {</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;        <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;        bar.<a class="code" href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">step</a>();</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> resultedBgTypeId = fields[0].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160; </div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;        <span class="comment">// can be overwrite by values from DB</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;        <a class="code" href="structBattlemasterListEntry.html">BattlemasterListEntry</a> <span class="keyword">const</span>* bl = <a class="code" href="DBCStores_8cpp.html#a57f0243638964eea9aea45639d53b3df">sBattlemasterListStore</a>.LookupEntry(resultedBgTypeId);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;        <span class="keywordflow">if</span> (!bl)</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;        {</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Battleground ID %u not found in BattlemasterList.dbc. Battleground not created.&quot;</span>, resultedBgTypeId);</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;        }</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a>(resultedBgTypeId);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;        <span class="keywordtype">bool</span> isArena = (bl-&gt;<a class="code" href="structBattlemasterListEntry.html#a647669b97599d7edf02b5a38dd1d5116">type</a> == <a class="code" href="BattleGround_8h.html#a7e06c7377f6a6ba19e39c6534b207a7fae01a6bdc4b7d444e84bd1e77e3006e6e">TYPE_ARENA</a>);</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> minPlayersPerTeam = fields[1].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxPlayersPerTeam = fields[2].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <span class="comment">// check values from DB</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        <span class="keywordflow">if</span> (maxPlayersPerTeam == 0)</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        {</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Table `battleground_template` for id %u doesn&#39;t allow any player per team settings. BG not created.&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        }</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160; </div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="keywordflow">if</span> (minPlayersPerTeam &gt; maxPlayersPerTeam)</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            minPlayersPerTeam = maxPlayersPerTeam;</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Table `battleground_template` for id %u has min players &gt; max players per team settings. Min players will use same value as max players.&quot;</span>, bgTypeId);</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        }</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160; </div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="keywordtype">float</span> allianceStartLoc[4];</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordtype">float</span> hordeStartLoc[4];</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160; </div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> start1 = fields[3].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160; </div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <a class="code" href="structWorldSafeLocsEntry.html">WorldSafeLocsEntry</a> <span class="keyword">const</span>* start = <a class="code" href="SQLStorages_8cpp.html#a0ec65b3e31a5da3aa9d4def398f4ad10">sWorldSafeLocsStore</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structWorldSafeLocsEntry.html">WorldSafeLocsEntry</a>&gt;(start1);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span> (start)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            allianceStartLoc[0] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#a2309f388c48a169148932c758d0afaf5">x</a>;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            allianceStartLoc[1] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#a4f38fe21bea4dcbacb1cc25e1a209561">y</a>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            allianceStartLoc[2] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#a4690a5a8f5c1598e5115d2e6f2f6debf">z</a>;</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            allianceStartLoc[3] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#aa3138280f78f53756f1d49cf37b65201">o</a>;</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;        }</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a> || bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>)</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            allianceStartLoc[0] = 0;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            allianceStartLoc[1] = 0;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;            allianceStartLoc[2] = 0;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            allianceStartLoc[3] = 0;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        {</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Table `battleground_template` for id %u have nonexistent WorldSafeLocs.dbc id %u in field `AllianceStartLoc`. BG not created.&quot;</span>, bgTypeId, start1);</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        }</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> start2 = fields[4].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160; </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        start = <a class="code" href="SQLStorages_8cpp.html#a0ec65b3e31a5da3aa9d4def398f4ad10">sWorldSafeLocsStore</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structWorldSafeLocsEntry.html">WorldSafeLocsEntry</a>&gt;(start2);</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">if</span> (start)</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;            hordeStartLoc[0] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#a2309f388c48a169148932c758d0afaf5">x</a>;</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            hordeStartLoc[1] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#a4f38fe21bea4dcbacb1cc25e1a209561">y</a>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            hordeStartLoc[2] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#a4690a5a8f5c1598e5115d2e6f2f6debf">z</a>;</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            hordeStartLoc[3] = start-&gt;<a class="code" href="structWorldSafeLocsEntry.html#aa3138280f78f53756f1d49cf37b65201">o</a>;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a> || bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>)</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        {</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;            hordeStartLoc[0] = 0;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            hordeStartLoc[1] = 0;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            hordeStartLoc[2] = 0;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            hordeStartLoc[3] = 0;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        }</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        {</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Table `battleground_template` for id %u have nonexistent WorldSafeLocs.dbc id %u in field `HordeStartLoc`. BG not created.&quot;</span>, bgTypeId, start2);</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;        }</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;        <span class="keywordtype">float</span> startMaxDist = fields[5].<a class="code" href="classField.html#a8b05a34c3d0cb92a9d2c0f298aa11dea">GetFloat</a>();</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> playerSkinReflootId = fields[6].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="keywordflow">if</span> (playerSkinReflootId &amp;&amp; !<a class="code" href="LootMgr_8h.html#ab8f8fff84ad092dddff5018ed76690d2">sLootMgr</a>.ExistsRefLootTemplate(playerSkinReflootId))</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        {</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            playerSkinReflootId = 0;</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Table `battleground_template` for id %u associated with nonexistent refloot id %u. Setting to 0.&quot;</span>, bgTypeId, playerSkinReflootId);</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        }</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;        <span class="keywordflow">if</span> (playerSkinReflootId)</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            <a class="code" href="classBattleGroundMgr.html#aa0389afbe68b5c94779c02f8192c1f9e">m_usedRefloot</a>.insert(playerSkinReflootId);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="comment">// sLog.outDetail(&quot;Creating battleground %s, %u-%u&quot;, bl-&gt;name[sWorld.GetDBClang()], MinLvl, MaxLvl);</span></div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classBattleGroundMgr.html#a37eec221fa4b0d79ca034f9790750363">CreateBattleGround</a>(bgTypeId, isArena, minPlayersPerTeam, maxPlayersPerTeam, bl-&gt;<a class="code" href="structBattlemasterListEntry.html#a6f95f35c741b22a94eb29dba9c50e679">minLevel</a>, bl-&gt;<a class="code" href="structBattlemasterListEntry.html#a814e1d226c3d3edc66389e74fe059cc7">maxLevel</a>, bl-&gt;<a class="code" href="structBattlemasterListEntry.html#a48cb0452213d79c5d45913bf031e5e18">name</a>[<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.GetDefaultDbcLocale()], bl-&gt;<a class="code" href="structBattlemasterListEntry.html#a11e1326eeb24b436b10db53acc323c13">mapid</a>[0], allianceStartLoc[0], allianceStartLoc[1], allianceStartLoc[2], allianceStartLoc[3], hordeStartLoc[0], hordeStartLoc[1], hordeStartLoc[2], hordeStartLoc[3], startMaxDist, playerSkinReflootId))</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        ++count;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keywordflow">while</span> (result-&gt;<a class="code" href="classQueryResult.html#a8f1f135d431fe357bf2b9373dc8d59be">NextRow</a>());</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160; </div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString(<span class="stringliteral">&quot;&gt;&gt; Loaded %u battlegrounds&quot;</span>, count);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString();</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;}</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a19ee65a0f3d7fe9aa2dccbd6870a950e"> 2024</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a19ee65a0f3d7fe9aa2dccbd6870a950e">BattleGroundMgr::InitAutomaticArenaPointDistribution</a>()</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;{</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda941de37043fd9e75ad8a719281f22690">CONFIG_BOOL_ARENA_AUTO_DISTRIBUTE_POINTS</a>))</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;        <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a23b35412451da3ca1bb5c714b727a1f5">Query</a>(<span class="stringliteral">&quot;SELECT NextArenaPointDistributionTime FROM saved_variables&quot;</span>);</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;        <span class="keywordtype">bool</span> save = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;        <span class="keywordtype">bool</span> insert = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;        <span class="keywordflow">if</span> (!result) <span class="comment">// if not set generate time for next wednesday</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;            insert = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        {</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;            <a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a> = time_t((*result)[0].GetUInt64());</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a> == 0) <span class="comment">// uninitialized</span></div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;                save = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// if time already exists - check for config changes</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;            {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                tm distribTime = *localtime(&amp;<a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;                <span class="keywordflow">if</span> (distribTime.tm_hour != <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232abf1a4b8420382ebfc9de9cb062f31767">CONFIG_UINT32_QUEST_DAILY_RESET_HOUR</a>))</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;                {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;                    <span class="keywordflow">if</span> (time(<span class="keyword">nullptr</span>) &gt;= <a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a>) <span class="comment">// if it already expired, do not save and only adjust hour</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;                    {</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                        distribTime.tm_hour = <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232abf1a4b8420382ebfc9de9cb062f31767">CONFIG_UINT32_QUEST_DAILY_RESET_HOUR</a>);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;                        <a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a> = mktime(&amp;distribTime);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                    }</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;                        save = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;            }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;            <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;        }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <span class="keywordflow">if</span> (save || insert)</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        {</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;            <span class="comment">// generate time by config on first server launch</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;            time_t curTime = time(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;            tm localTm = *localtime(&amp;curTime);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;            localTm.tm_hour = <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232abf1a4b8420382ebfc9de9cb062f31767">CONFIG_UINT32_QUEST_DAILY_RESET_HOUR</a>);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;            localTm.tm_min = 0;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            localTm.tm_sec = 0;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;            localTm.tm_mday += ((7 - localTm.tm_wday + <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a4abebec67671887171fac3bd0d3c08eb">CONFIG_UINT32_ARENA_FIRST_RESET_DAY</a>)) % 7);</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;            localTm.tm_isdst = -1;</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a> = mktime(&amp;localTm);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160; </div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;            <span class="keywordflow">if</span> (insert)</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;INSERT INTO saved_variables (NextArenaPointDistributionTime) VALUES (&#39;&quot;</span> <a class="code" href="Common_8h.html#a12f54e09a2fe86ecb7dc821868e5aaf9">UI64FMTD</a> <span class="stringliteral">&quot;&#39;)&quot;</span>, <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(<a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a>));</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            <span class="keywordflow">if</span> (save)</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;                <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE saved_variables SET NextArenaPointDistributionTime = &#39;&quot;</span> <a class="code" href="Common_8h.html#a12f54e09a2fe86ecb7dc821868e5aaf9">UI64FMTD</a> <span class="stringliteral">&quot;&#39;&quot;</span>, <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(<a class="code" href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">m_nextAutoDistributionTime</a>));</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        }</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160; </div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        <span class="comment">//uint32 dayofweek = sWorld.getConfig(CONFIG_UINT32_ARENA_AUTO_DISTRIBUTE_INTERVAL_DAYS);</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    }</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;}</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a809ed86411a3d3e5ef983747590982bf"> 2080</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a809ed86411a3d3e5ef983747590982bf">BattleGroundMgr::DistributeArenaPoints</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <span class="comment">// used to distribute arena points based on last week&#39;s stats</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a756c0228ae5b2b3da41eba015bf03d34">LANG_DIST_ARENA_POINTS_START</a>);</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a73a4d4753015938060662b51318f7b77">LANG_DIST_ARENA_POINTS_ONLINE_START</a>);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160; </div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <span class="comment">// temporary structure for storing maximum points to add values for all players</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;    std::map&lt;uint32, uint32&gt; PlayerPoints;</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="comment">// at first update all points for all team members</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">for</span> (ObjectMgr::ArenaTeamMap::iterator team_itr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapBegin(); team_itr != <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapEnd(); ++team_itr)</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;    {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classArenaTeam.html">ArenaTeam</a>* at = team_itr-&gt;second)</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;            at-&gt;UpdateArenaPointsHelper(PlayerPoints);</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        }</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    }</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;    <span class="comment">// cycle that gives points to all players</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; PlayerPoint : PlayerPoints)</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;        <span class="comment">// update to database</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;        <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE characters SET arenaPoints = arenaPoints + &#39;%u&#39; WHERE guid = &#39;%u&#39;&quot;</span>, PlayerPoint.second, PlayerPoint.first);</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;        <span class="comment">// add points if player is online</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* pl = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(<a class="code" href="classObjectGuid.html">ObjectGuid</a>(<a class="code" href="ObjectGuid_8h.html#abe8666ac87665ba963053cdd2b014750ac30cd6a15de9e7763b2bcea91be46eb3">HIGHGUID_PLAYER</a>, PlayerPoint.first)))</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            pl-&gt;ModifyArenaPoints(PlayerPoint.second);</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;    }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160; </div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;    PlayerPoints.clear();</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51ae1cbbd544f2432cf396d039743c0142c">LANG_DIST_ARENA_POINTS_ONLINE_END</a>);</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160; </div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a3b9590c12e77aa4bcdb7b9014a9c8ed7">LANG_DIST_ARENA_POINTS_TEAM_START</a>);</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    <span class="keywordflow">for</span> (ObjectMgr::ArenaTeamMap::iterator titr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapBegin(); titr != <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapEnd(); ++titr)</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classArenaTeam.html">ArenaTeam</a>* at = titr-&gt;second)</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        {</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            at-&gt;FinishWeek();                              <span class="comment">// set played this week etc values to 0 in memory, too</span></div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            at-&gt;SaveToDB();                                <span class="comment">// save changes</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            at-&gt;NotifyStatsChanged();                      <span class="comment">// notify the players of the changes</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        }</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    }</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a93d9b2bd40c78033f6071b05bf3bd000">LANG_DIST_ARENA_POINTS_TEAM_END</a>);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160; </div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51aa669aaba8a7f5c52330b934194ff2948">LANG_DIST_ARENA_POINTS_END</a>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;}</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"><a class="line" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b"> 2136</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a>(<a class="code" href="classArenaTeam.html">ArenaTeam</a>* team, std::map&lt;ObjectGuid, uint32&gt;&amp; playerRanks, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> rank)</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;{</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="structArenaTeamMember.html">ArenaTeamMember</a>&amp; member : team-&gt;<a class="code" href="classArenaTeam.html#a6258cada2d9eccaa0c1ee5785dc4c974">GetMembers</a>())</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        <span class="comment">// Has personal rating within 100 of team rating and played at least 20% of games of given team</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        <span class="keywordflow">if</span> (std::abs(<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(member.personal_rating) - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(team-&gt;<a class="code" href="classArenaTeam.html#a2132399761d198722d1c1711a8266762">GetStats</a>().<a class="code" href="structArenaTeamStats.html#a9401e96424f770f226b8fdb61cf6ded9">rating</a>)) &lt;= 100 &amp;&amp; member.games_season &gt; (team-&gt;<a class="code" href="classArenaTeam.html#a2132399761d198722d1c1711a8266762">GetStats</a>().<a class="code" href="structArenaTeamStats.html#a703cb423a8eaa9fc0efdd56555522758">games_season</a> * 20 / 100))</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        {</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            <span class="keyword">auto</span> itr = playerRanks.find(member.guid);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;            <span class="keywordflow">if</span> (itr != playerRanks.end())</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                <span class="keywordflow">if</span> (itr-&gt;second &gt; rank)</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                    itr-&gt;second = rank;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            }</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                playerRanks.emplace(member.guid, rank);</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        }</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;}</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"><a class="line" href="BattleGroundMgr_8cpp.html#a7ecb6f3468146290c3e0f844bf0c8a9d"> 2162</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="BattleGroundMgr_8cpp.html#a7ecb6f3468146290c3e0f844bf0c8a9d">SetTitleValues</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; first, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; second, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> titleId)</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;{</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    <span class="keywordflow">switch</span> (titleId)</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        <span class="keywordflow">case</span> 42: first |= 0x20000000; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;        <span class="keywordflow">case</span> 43: first |= 0x40000000; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;        <span class="keywordflow">case</span> 44: first |= 0x80000000; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;        <span class="keywordflow">case</span> 45: second |= 0x00000001; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        <span class="keywordflow">case</span> 62: second |= 0x00000020; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        <span class="keywordflow">case</span> 71: second |= 0x00000100; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>; <span class="comment">// cant award gladiator</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;    }</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;}</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160; </div>
<div class="line"><a name="l02181"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#af70713ed455320190b384670ff27f6d2"> 2181</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#af70713ed455320190b384670ff27f6d2">BattleGroundMgr::RewardArenaSeason</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> seasonId)</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;{</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a7501732cb7eb651a15c52cfbd53ed8d4">LANG_DIST_ARENA_REWARDS_START</a>, seasonId);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;    std::vector&lt;ArenaTeam*&gt; sortedTeams[3];</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keywordflow">for</span> (ObjectMgr::ArenaTeamMap::iterator titr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapBegin(); titr != <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapEnd(); ++titr)</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classArenaTeam.html">ArenaTeam</a>* at = titr-&gt;second)</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        {</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;            <span class="comment">// team needs minimum of 10 games played during season to be part of ladders for rewards</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            <span class="comment">// this number is unproven - in later expansions it may be 50 games min</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            <span class="keywordflow">if</span> (at-&gt;GetStats().games_season &gt;= 10)</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                <span class="keywordflow">switch</span> (at-&gt;GetType())</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                {</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aba8dd9984d50b5a179ebf2dec66d8c01">ARENA_TYPE_2v2</a>:</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                        sortedTeams[0].push_back(at);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aa98d0a1c6432cd3013d20e83937726be">ARENA_TYPE_3v3</a>:</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                        sortedTeams[1].push_back(at);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a49cde50538e418258d292c3c2f7df512">ARENA_TYPE_5v5</a>:</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                        sortedTeams[2].push_back(at);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                    <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                }</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            }</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160; </div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    <span class="comment">// first sort teams based on rating</span></div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        std::sort(sortedTeams[i].begin(), sortedTeams[i].end(), [](<a class="code" href="classArenaTeam.html">ArenaTeam</a>* first, <a class="code" href="classArenaTeam.html">ArenaTeam</a>* second)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    {</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="keywordflow">return</span> first-&gt;<a class="code" href="classArenaTeam.html#a2132399761d198722d1c1711a8266762">GetStats</a>().rating &gt; second-&gt;<a class="code" href="classArenaTeam.html#a2132399761d198722d1c1711a8266762">GetStats</a>().<a class="code" href="structArenaTeamStats.html#a9401e96424f770f226b8fdb61cf6ded9">rating</a>;</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;    });</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> gladiatorCount[3], duelistCount[3], rivalCount[3], challengerCount[3];</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        gladiatorCount[i]       = std::max(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(sortedTeams[i].size()) * 5 / 1000, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(1));</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        duelistCount[i]         = std::max(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(sortedTeams[i].size()) * 3 / 100, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(1));</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        rivalCount[i]           = std::max(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(sortedTeams[i].size()) * 10 / 100, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(1));</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        challengerCount[i]      = std::max(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(sortedTeams[i].size()) * 35 / 100, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(1));</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;    }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160; </div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    std::map&lt;ObjectGuid, uint32&gt; playerRanks;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; 3; ++i)</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> k = 0; k &lt; sortedTeams[i].size(); ++k)</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;        {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            <a class="code" href="classArenaTeam.html">ArenaTeam</a>* team = sortedTeams[i][k];</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;            <span class="keywordflow">if</span> (k &lt; 1)</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                <a class="code" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a>(team, playerRanks, 0);</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; gladiatorCount[i])</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                <a class="code" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a>(team, playerRanks, 1);</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; duelistCount[i])</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                <a class="code" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a>(team, playerRanks, 2);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; rivalCount[i])</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                <a class="code" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a>(team, playerRanks, 3);</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (k &lt; challengerCount[i])</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                <a class="code" href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a>(team, playerRanks, 4);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    }</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160; </div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mountId;</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> titles[5];</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    titles[1] = 42; <span class="comment">// Gladiator</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    titles[2] = 43; <span class="comment">// Duelist</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    titles[3] = 44; <span class="comment">// Rival</span></div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    titles[4] = 45; <span class="comment">// Challenger</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">switch</span> (seasonId)</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    {</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        <span class="keywordflow">default</span>: mountId = 30609; titles[0] = 42; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        <span class="keywordflow">case</span> 2: mountId = 34092; titles[0] = 62; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="keywordflow">case</span> 3: mountId = 37676; titles[0] = 71; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        <span class="keywordflow">case</span> 4: mountId = 43516; titles[0] = 80; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="keywordflow">case</span> 5: mountId = 46708; titles[0] = 157; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        <span class="keywordflow">case</span> 6: mountId = 46171; titles[0] = 167; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;        <span class="keywordflow">case</span> 7: mountId = 47840; titles[0] = 169; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;        <span class="keywordflow">case</span> 8: mountId = 50435; titles[0] = 177; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;    }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="structCharTitlesEntry.html">CharTitlesEntry</a> <span class="keyword">const</span>* titleEntries[5]; <span class="comment">// optimization</span></div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; 5; ++i)</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        titleEntries[i] = <a class="code" href="DBCStores_8cpp.html#a2997cbe20d462fdb8cee8e14230725e2">sCharTitlesStore</a>.LookupEntry(titles[i]);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;    <span class="comment">// Remove titles from online players</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    <span class="comment">// Only Rank 1 titles are permanent</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;    <a class="code" href="ObjectAccessor_8h.html#a1ac403f083ed153106723d43e093bfff">sObjectAccessor</a>.ExecuteOnAllPlayers([&amp;](<a class="code" href="classPlayer.html">Player</a>* player)</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a1e807120767272c266a2bef0ac5b06e0">SetTitle</a>(titleEntries[1], <span class="keyword">true</span>);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a1e807120767272c266a2bef0ac5b06e0">SetTitle</a>(titleEntries[2], <span class="keyword">true</span>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a1e807120767272c266a2bef0ac5b06e0">SetTitle</a>(titleEntries[3], <span class="keyword">true</span>);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a1e807120767272c266a2bef0ac5b06e0">SetTitle</a>(titleEntries[4], <span class="keyword">true</span>);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a4599b778fbc3e2e4ee1b0c9e7490887b">SaveTitles</a>();</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a092c3de4a1ae7720ecd24ec4fcc6f72e">ModifyHonorPoints</a>(player-&gt;<a class="code" href="classPlayer.html#a25cf1fdb2e61f6229ca63c2ad5b78e1d">GetArenaPoints</a>() * 4);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a3ab026e1c8ff1c957f84dcbc7ad0cfd2">SetArenaPoints</a>(0);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    });</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="comment">/* TODO: Fix removal of old titles in wotlk due to 6x uint32 values</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">    // Remove Gladiator, Duelist and Rival from every offline player</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="comment">    CharacterDatabase.PExecute(&quot;UPDATE characters a SET knownTitles=&quot;</span></div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="comment">        &quot;CONCAT(CAST(TRIM(SUBSTRING_INDEX(knownTitles, &#39; &#39;, 1))  AS UNSIGNED) &amp;~0xE0000000, &#39; &#39;, SUBSTR(knownTitles, LOCATE(&#39; &#39;, knownTitles)))&quot;</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">        &quot;WHERE(CAST(TRIM(SUBSTRING_INDEX(knownTitles, &#39; &#39;, 1))  AS UNSIGNED) &amp; 0xE0000000) != 0&quot;);</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="comment">    // Remove Challenger from every offline player</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="comment">    CharacterDatabase.PExecute(&quot;UPDATE characters a SET knownTitles =&quot;</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="comment">        &quot;CONCAT(SUBSTRING_INDEX(knownTitles, &#39; &#39;, 1), &#39; &#39;, CAST(TRIM(SUBSTR(knownTitles, LOCATE(&#39; &#39;, knownTitles)))  AS UNSIGNED) &amp;~0x00000001)&quot;</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="comment">        &quot;WHERE(CAST(TRIM(SUBSTR(knownTitles, LOCATE(&#39; &#39;, knownTitles)))  AS UNSIGNED) &amp; 0x00000001) != 0&quot;);</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160; </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE characters SET totalHonorPoints=4*arenaPoints,arenaPoints=0&quot;</span>);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; data : playerRanks)</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;    {</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* player = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(data.first);</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;        <span class="keywordflow">if</span> (data.second &lt;= 1) <span class="comment">// gladiator reward</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;        {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <a class="code" href="classMailDraft.html">MailDraft</a> draft;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            draft.<a class="code" href="classMailDraft.html#a7a5153edf5907d5cd012358a3450d9d5">SetSubjectAndBody</a>(<span class="stringliteral">&quot;Season Rewards&quot;</span>, <span class="stringliteral">&quot;On behalf of the Steamwheedle Fighting Circuit, we congratulate you for your successes in this arena season. In recognition of your skill and savagery, we hereby bestow upon you this Nether Drake. May it serve you well.&quot;</span>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            <a class="code" href="classItem.html">Item</a>* item = <a class="code" href="classItem.html#afa31c834b8cab84e5d7e27d971293da1">Item::CreateItem</a>(mountId, 1, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            item-&gt;<a class="code" href="classItem.html#aec8277f266581dd7bdd88eb9ccbb1ae1">SaveToDB</a>();                               <span class="comment">// save for prevent lost at next mail load, if send fail then item will deleted</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            draft.<a class="code" href="group__mailing.html#gae0c2b4bac4dd8f2a8c53608c45cbb11a">AddItem</a>(item);</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            <a class="code" href="classMailSender.html">MailSender</a> sender;</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            draft.<a class="code" href="group__mailing.html#gaf1f4156c2ab653e42f25cbfa38464afd">SendMailTo</a>(<a class="code" href="classMailReceiver.html">MailReceiver</a>(player, data.first), sender);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        }</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">if</span> (player)</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            player-&gt;<a class="code" href="classPlayer.html#a1e807120767272c266a2bef0ac5b06e0">SetTitle</a>(titleEntries[data.second]);</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            player-&gt;<a class="code" href="classPlayer.html#a4599b778fbc3e2e4ee1b0c9e7490887b">SaveTitles</a>();</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;        }</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        {</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;            <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">PQuery</a>(<span class="stringliteral">&quot;SELECT knownTitles FROM characters WHERE guid = &#39;%u&#39;&quot;</span>, data.first.GetCounter());</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            <span class="keywordflow">if</span> (result)</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            {</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> titleValueCount = 2;</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> titleValues[2];</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;                std::string titlesData = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>()[0].<a class="code" href="classField.html#ac3fe5bf9cdc61b5be66a4c79598cba5e">GetCppString</a>();</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;                <a class="code" href="Util_8h.html#aa816f7b7c0f08ceeecaf357e31b3a544">Tokens</a> tokens = <a class="code" href="Util_8cpp.html#a524fe58d98e273af8b0fc7729bcb51f7">StrSplit</a>(titlesData, <span class="stringliteral">&quot; &quot;</span>);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;                <span class="keywordflow">if</span> (tokens.size() != titleValueCount)</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                Tokens::iterator iter;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> index;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                <span class="keywordflow">for</span> (iter = tokens.begin(), index = 0; index &lt; titleValueCount; ++iter, ++index)</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                    titleValues[index] = std::stoul((*iter).c_str());</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                <a class="code" href="BattleGroundMgr_8cpp.html#a7ecb6f3468146290c3e0f844bf0c8a9d">SetTitleValues</a>(titleValues[0], titleValues[1], titles[data.second]);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                std::string newTitleData = std::to_string(titleValues[0]) + <span class="stringliteral">&quot; &quot;</span> + std::to_string(titleValues[1]) + <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;                <a class="code" href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a>.<a class="code" href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">PExecute</a>(<span class="stringliteral">&quot;UPDATE characters SET knownTitles=&#39;%s&#39; WHERE guid = &#39;%u&#39;&quot;</span>, newTitleData.data(), data.first.GetCounter());</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;                <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        }</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    }</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160; </div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <a class="code" href="classBattleGroundMgr.html#a7da687f187053c09819549e9b58b2d2a">ResetAllArenaData</a>();</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160; </div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldTextToAboveSecurity(<a class="code" href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a>, <a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51adb1aea6b886487042b9780fd7faaaf82">LANG_DIST_ARENA_REWARDS_END</a>);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;}</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a7da687f187053c09819549e9b58b2d2a"> 2345</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a7da687f187053c09819549e9b58b2d2a">BattleGroundMgr::ResetAllArenaData</a>()</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;{</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;    <span class="keywordflow">for</span> (ObjectMgr::ArenaTeamMap::iterator titr = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapBegin(); titr != <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetArenaTeamMapEnd(); ++titr)</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    {</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classArenaTeam.html">ArenaTeam</a>* at = titr-&gt;second)</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;        {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            at-&gt;FinishSeason();                            <span class="comment">// set all values back to default</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            at-&gt;SaveToDB();                                <span class="comment">// save changes</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;            at-&gt;NotifyStatsChanged();                      <span class="comment">// notify the players of the changes</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;        }</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;    }</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;}</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a751661a870f7e55b2984128e27edefcc"> 2367</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a751661a870f7e55b2984128e27edefcc">BattleGroundMgr::BuildBattleGroundListPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data, <a class="code" href="classObjectGuid.html">ObjectGuid</a> guid, <a class="code" href="classPlayer.html">Player</a>* player, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> fromWhere)<span class="keyword"> const</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;    <span class="keywordflow">if</span> (!player)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> winKills  = player-&gt;<a class="code" href="classPlayer.html#a272d7b889a3e211289389ff9616fdebc">HasWonRandomBattleground</a>() ? <a class="code" href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa280954f0640a635b9a1097f0e2a16604">BG_REWARD_WINNER_HONOR_LAST</a> : <a class="code" href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aac8159825b474ee01a0e2bf02d30ff494">BG_REWARD_WINNER_HONOR_FIRST</a>;</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> winArena  = player-&gt;<a class="code" href="classPlayer.html#a272d7b889a3e211289389ff9616fdebc">HasWonRandomBattleground</a>() ? <a class="code" href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa26739fc24e4bffd58441ea789ca6464a">BG_REWARD_WINNER_ARENA_LAST</a> : <a class="code" href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aaeaa309be5f5931a2cc3491b4894b5670">BG_REWARD_WINNER_ARENA_FIRST</a>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> loseKills = player-&gt;<a class="code" href="classPlayer.html#a272d7b889a3e211289389ff9616fdebc">HasWonRandomBattleground</a>() ? <a class="code" href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa8de0c0ffbb6f998efb1b96257bb09bdd">BG_REWARD_LOOSER_HONOR_LAST</a> : <a class="code" href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa9ecf35de7ccb54ca226b6ad72af7a068">BG_REWARD_LOOSER_HONOR_FIRST</a>;</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    winKills  = (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)<a class="code" href="namespaceMaNGOS_1_1Honor.html#a249974b98a142bca70c8c8d8e9e69a3e">MaNGOS::Honor::hk_honor_at_level</a>(player-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>(), winKills * 4);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    loseKills = (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)<a class="code" href="namespaceMaNGOS_1_1Honor.html#a249974b98a142bca70c8c8d8e9e69a3e">MaNGOS::Honor::hk_honor_at_level</a>(player-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>(), loseKills * 4);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca156c546c3ed9661a9731321423226c77">SMSG_BATTLEFIELD_LIST</a>);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    data &lt;&lt; guid;                                          <span class="comment">// battlemaster guid</span></div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(fromWhere);                              <span class="comment">// from where you joined</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(bgTypeId);                              <span class="comment">// battleground id</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);                                      <span class="comment">// unk</span></div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);                                      <span class="comment">// unk</span></div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;    <span class="comment">// Rewards</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(player-&gt;<a class="code" href="classPlayer.html#a272d7b889a3e211289389ff9616fdebc">HasWonRandomBattleground</a>());     <span class="comment">// 3.3.3 hasWin</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(winKills);                              <span class="comment">// 3.3.3 winHonor</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(winArena);                              <span class="comment">// 3.3.3 winArena</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(loseKills);                             <span class="comment">// 3.3.3 lossHonor</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> isRandom = bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(isRandom);                               <span class="comment">// 3.3.3 isRandom</span></div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="keywordflow">if</span> (isRandom)</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    {</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;        <span class="comment">// Rewards (random)</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(player-&gt;<a class="code" href="classPlayer.html#a272d7b889a3e211289389ff9616fdebc">HasWonRandomBattleground</a>()); <span class="comment">// 3.3.3 hasWin_Random</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(winKills);                          <span class="comment">// 3.3.3 winHonor_Random</span></div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(winArena);                          <span class="comment">// 3.3.3 winArena_Random</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(loseKills);                         <span class="comment">// 3.3.3 lossHonor_Random</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;    }</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;    <span class="keywordflow">if</span> (bgTypeId == <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>)                       <span class="comment">// arena</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    {</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                                 <span class="comment">// arena - no instances showed</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    }</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;    <span class="keywordflow">else</span>                                                   <span class="comment">// battleground</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    {</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;        <span class="keywordtype">size_t</span> count_pos = data.<a class="code" href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">wpos</a>();</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 0;</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                                 <span class="comment">// number of bg instances</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classBattleGround.html">BattleGround</a>* bgTemplate = <a class="code" href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a>.GetBattleGroundTemplate(bgTypeId))</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        {</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <span class="comment">// expected bracket entry</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structPvPDifficultyEntry.html">PvPDifficultyEntry</a> <span class="keyword">const</span>* bracketEntry = <a class="code" href="DBCStores_8cpp.html#a09e088516eb11f5c7014a7432f2f8597">GetBattlegroundBracketByLevel</a>(bgTemplate-&gt;GetMapId(), player-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>()))</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            {</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId = bracketEntry-&gt;GetBracketId();</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                <a class="code" href="classBattleGroundMgr.html#a4b2148f7acf0f7424cc8ff791a921951">ClientBattleGroundIdSet</a> <span class="keyword">const</span>&amp; ids = <a class="code" href="classBattleGroundMgr.html#abd238d9c4b982cf368d9875401e014c6">m_clientBattleGroundIds</a>[bgTypeId][bracketId];</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="keywordtype">id</span> : ids)</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                {</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                    ++count;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;                }</div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;                data.<a class="code" href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">put</a>&lt;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&gt;(count_pos, count);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;            }</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        }</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;    }</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;}</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160; </div>
<div class="line"><a name="l02438"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a116949aa8882c704a38602d8e2f2bebf"> 2438</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a116949aa8882c704a38602d8e2f2bebf">BattleGroundMgr::SendToBattleGround</a>(<a class="code" href="classPlayer.html">Player</a>* player, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> instanceId, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;{</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;    <a class="code" href="classBattleGround.html">BattleGround</a>* bg = <a class="code" href="classBattleGroundMgr.html#a3d03a58137de7e085237a4327a9c7b31">GetBattleGround</a>(instanceId, bgTypeId);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;    <span class="keywordflow">if</span> (bg)</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;    {</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mapid = bg-&gt;<a class="code" href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">GetMapId</a>();</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <span class="keywordtype">float</span> x, y, z, O;</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;        <a class="code" href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a> team = player-&gt;<a class="code" href="classPlayer.html#af002dd6bf131244d4357338c4a2f1204">GetBGTeam</a>();</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;        <span class="keywordflow">if</span> (team == 0)</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            team = player-&gt;<a class="code" href="classPlayer.html#af984d68ab11bb3f4081e0965593fbc9b">GetTeam</a>();</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;        bg-&gt;<a class="code" href="classBattleGround.html#a16d50f6f034ab259d61ca71305020a93">GetTeamStartLoc</a>(team, x, y, z, O);</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160; </div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <a class="code" href="Log_8h.html#adbee991aac31d91a88ae6276d32ba9f6">DETAIL_LOG</a>(<span class="stringliteral">&quot;BATTLEGROUND: Sending %s to map %u, X %f, Y %f, Z %f, O %f&quot;</span>, player-&gt;<a class="code" href="classWorldObject.html#af60e24425abfff16a925c7b5808d8b38">GetName</a>(), mapid, x, y, z, O);</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;        player-&gt;<a class="code" href="classPlayer.html#a0ee06e278ecf1ca41c3052e9eb72f13c">TeleportTo</a>(mapid, x, y, z, O);</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;    }</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;    {</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;player %u trying to port to nonexistent bg instance %u&quot;</span>, player-&gt;<a class="code" href="classObject.html#a4777844356842a389621c1bad1433109">GetGUIDLow</a>(), instanceId);</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    }</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;}</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a669ae70091f8092ba8aa6c909e30d8f8"> 2464</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundMgr.html#a669ae70091f8092ba8aa6c909e30d8f8">BattleGroundMgr::IsArenaType</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;{</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;    <span class="keywordflow">switch</span> (bgTypeId)</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    {</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a>:</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a>:</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a>:</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a>:</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a>:</div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>:</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    }</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;}</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160; </div>
<div class="line"><a name="l02486"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a2626e64e4c8c5ebb515da8a94c5e6188"> 2486</a></span>&#160;<a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> <a class="code" href="classBattleGroundMgr.html#a2626e64e4c8c5ebb515da8a94c5e6188">BattleGroundMgr::BgQueueTypeId</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType)</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;{</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    <span class="keywordflow">switch</span> (bgTypeId)</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    {</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>:</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a83643b6b6cf0df0babd743dfda8858de">BATTLEGROUND_QUEUE_WS</a>;</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>:</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a4780d3038e9e37db485a99c4175deee5">BATTLEGROUND_QUEUE_AB</a>;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>:</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a89d452c10b2a7a98006539d02229a76d">BATTLEGROUND_QUEUE_AV</a>;</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>:</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771aaefe474c1c4434f3cbfc4c4e23f6ae0c">BATTLEGROUND_QUEUE_EY</a>;</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>:</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a3ed02e4cd7d03d251b41054d17f3fcf6">BATTLEGROUND_QUEUE_SA</a>;</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a>:</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771afeec1d52b1fc2808eabff28facde8b59">BATTLEGROUND_QUEUE_IC</a>;</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>:</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a28ee92c83e56a441fcae56fb5546f431">BATTLEGROUND_QUEUE_RB</a>;</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>:</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a>:</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a>:</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a>:</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a>:</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a>:</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;            <span class="keywordflow">switch</span> (arenaType)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;            {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aba8dd9984d50b5a179ebf2dec66d8c01">ARENA_TYPE_2v2</a>:</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a02779ae5e6ae1a94636450f7e012bc6c">BATTLEGROUND_QUEUE_2v2</a>;</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aa98d0a1c6432cd3013d20e83937726be">ARENA_TYPE_3v3</a>:</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771ae1e81cfb41b8136ade30b98400ac84fd">BATTLEGROUND_QUEUE_3v3</a>;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a49cde50538e418258d292c3c2f7df512">ARENA_TYPE_5v5</a>:</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a6b9cb096b2108333789c9435dcff1191">BATTLEGROUND_QUEUE_5v5</a>;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771af067a2df3fe97694d3ee3669ef9afbe3">BATTLEGROUND_QUEUE_NONE</a>;</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;            }</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771af067a2df3fe97694d3ee3669ef9afbe3">BATTLEGROUND_QUEUE_NONE</a>;</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;    }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;}</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160; </div>
<div class="line"><a name="l02531"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#ae4041f739e64d134313b327e6f73d899"> 2531</a></span>&#160;<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> <a class="code" href="classBattleGroundMgr.html#ae4041f739e64d134313b327e6f73d899">BattleGroundMgr::BgTemplateId</a>(<a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId)</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;{</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="keywordflow">switch</span> (bgQueueTypeId)</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    {</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a83643b6b6cf0df0babd743dfda8858de">BATTLEGROUND_QUEUE_WS</a>:</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>;</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a4780d3038e9e37db485a99c4175deee5">BATTLEGROUND_QUEUE_AB</a>:</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>;</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a89d452c10b2a7a98006539d02229a76d">BATTLEGROUND_QUEUE_AV</a>:</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>;</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771aaefe474c1c4434f3cbfc4c4e23f6ae0c">BATTLEGROUND_QUEUE_EY</a>:</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>;</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a3ed02e4cd7d03d251b41054d17f3fcf6">BATTLEGROUND_QUEUE_SA</a>:</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>;</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771afeec1d52b1fc2808eabff28facde8b59">BATTLEGROUND_QUEUE_IC</a>:</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a>;</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a28ee92c83e56a441fcae56fb5546f431">BATTLEGROUND_QUEUE_RB</a>:</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a>;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a02779ae5e6ae1a94636450f7e012bc6c">BATTLEGROUND_QUEUE_2v2</a>:</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771ae1e81cfb41b8136ade30b98400ac84fd">BATTLEGROUND_QUEUE_3v3</a>:</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a6b9cb096b2108333789c9435dcff1191">BATTLEGROUND_QUEUE_5v5</a>:</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a>;</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a>(0);                   <span class="comment">// used for unknown template (it exist and do nothing)</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;    }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;}</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02563"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#ad40d2889a679f4ed9faed31e1be3fc01"> 2563</a></span>&#160;<a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> <a class="code" href="classBattleGroundMgr.html#ad40d2889a679f4ed9faed31e1be3fc01">BattleGroundMgr::BgArenaType</a>(<a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId)</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;{</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;    <span class="keywordflow">switch</span> (bgQueueTypeId)</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a02779ae5e6ae1a94636450f7e012bc6c">BATTLEGROUND_QUEUE_2v2</a>:</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aba8dd9984d50b5a179ebf2dec66d8c01">ARENA_TYPE_2v2</a>;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771ae1e81cfb41b8136ade30b98400ac84fd">BATTLEGROUND_QUEUE_3v3</a>:</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aa98d0a1c6432cd3013d20e83937726be">ARENA_TYPE_3v3</a>;</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a6b9cb096b2108333789c9435dcff1191">BATTLEGROUND_QUEUE_5v5</a>:</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a49cde50538e418258d292c3c2f7df512">ARENA_TYPE_5v5</a>;</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a>;</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;    }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;}</div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a439b940dabbb39c17b6acec7075a937b"> 2581</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a439b940dabbb39c17b6acec7075a937b">BattleGroundMgr::ToggleTesting</a>()</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;{</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <a class="code" href="classBattleGroundMgr.html#aa324ba8f05f6b2f8cd57f76045ee26d8">m_testing</a> = !<a class="code" href="classBattleGroundMgr.html#aa324ba8f05f6b2f8cd57f76045ee26d8">m_testing</a>;</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundMgr.html#aa324ba8f05f6b2f8cd57f76045ee26d8">m_testing</a>)</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;        <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a76985e26ac6e683c797cd781b1bee050">LANG_DEBUG_BG_ON</a>);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a0ea06d91b3bd3c6226bd7e5257484171">LANG_DEBUG_BG_OFF</a>);</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;}</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02593"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a8f4f56f5aea2a2c8f50d8a3e9c3b7931"> 2593</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a8f4f56f5aea2a2c8f50d8a3e9c3b7931">BattleGroundMgr::ToggleArenaTesting</a>()</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;{</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;    <a class="code" href="classBattleGroundMgr.html#a78e36aa76d96e165a7b947d0df87e797">m_arenaTesting</a> = !<a class="code" href="classBattleGroundMgr.html#a78e36aa76d96e165a7b947d0df87e797">m_arenaTesting</a>;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classBattleGroundMgr.html#a78e36aa76d96e165a7b947d0df87e797">m_arenaTesting</a>)</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a9fff989466f334e77cb9e2db5b0f3e91">LANG_DEBUG_ARENA_ON</a>);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;        <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.SendWorldText(<a class="code" href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a4b6903a8163567860effa0f72dafa769">LANG_DEBUG_ARENA_OFF</a>);</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;}</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02611"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a2258b732f69f6a6a54512b0a28d8b974"> 2611</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a2258b732f69f6a6a54512b0a28d8b974">BattleGroundMgr::ScheduleQueueUpdate</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> arenaRating, <a class="code" href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a> arenaType, <a class="code" href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a> bgQueueTypeId, <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId, <a class="code" href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a> bracketId)</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;{</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    <span class="comment">// std::lock_guard&lt;std::mutex&gt; guard(SchedulerLock);</span></div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    <span class="comment">// we will use only 1 number created of bgTypeId and bracket_id</span></div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> schedule_id = ((<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>)arenaRating &lt;&lt; 32) | (arenaType &lt;&lt; 24) | (bgQueueTypeId &lt;&lt; 16) | (bgTypeId &lt;&lt; 8) | bracketId;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> i : <a class="code" href="classBattleGroundMgr.html#a3d9d5237b37f14e063fd7a1e1fc078f4">m_queueUpdateScheduler</a>)</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    {</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;        <span class="keywordflow">if</span> (i == schedule_id)</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;        {</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;            found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;        }</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    }</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;        <a class="code" href="classBattleGroundMgr.html#a3d9d5237b37f14e063fd7a1e1fc078f4">m_queueUpdateScheduler</a>.push_back(schedule_id);</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;}</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#ae473aebdab220c3b788127c8108ad62b"> 2632</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classBattleGroundMgr.html#ae473aebdab220c3b788127c8108ad62b">BattleGroundMgr::GetMaxRatingDifference</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;    <span class="comment">// this is for stupid people who can&#39;t use brain and set max rating difference to 0</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> diff = <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232ad3546d2bc7feb4e62b51c51767df1e03">CONFIG_UINT32_ARENA_MAX_RATING_DIFFERENCE</a>);</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    <span class="keywordflow">if</span> (diff == 0)</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        diff = 5000;</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    <span class="keywordflow">return</span> diff;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;}</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#ac110e0874220491573831772ee6489eb"> 2644</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classBattleGroundMgr.html#ac110e0874220491573831772ee6489eb">BattleGroundMgr::GetRatingDiscardTimer</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a9af243abbc26eb5bbc0bcb04f9f4c641">CONFIG_UINT32_ARENA_RATING_DISCARD_TIMER</a>);</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;}</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; </div>
<div class="line"><a name="l02652"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#abc567ce2925d53bd76c69bde8558562c"> 2652</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classBattleGroundMgr.html#abc567ce2925d53bd76c69bde8558562c">BattleGroundMgr::GetPrematureFinishTime</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga89a532a320ff8bd5866836fee5541232a2885b81958ad5c8eaf70303ac1320708">CONFIG_UINT32_BATTLEGROUND_PREMATURE_FINISH_TIMER</a>);</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;}</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160; </div>
<div class="line"><a name="l02660"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#abc91ce77c40c3cf340054f6c277db051"> 2660</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#abc91ce77c40c3cf340054f6c277db051">BattleGroundMgr::LoadBattleMastersEntry</a>()</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;{</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <a class="code" href="classBattleGroundMgr.html#a70e546164aa1eaa7ad0dcf7215bc5520">m_battleMastersMap</a>.clear();                              <span class="comment">// need for reload case</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160; </div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <a class="code" href="classQueryResult.html">QueryResult</a>* result = <a class="code" href="group__mangosd.html#gae551ea020f187b038a84473d48d9e14b">WorldDatabase</a>.<a class="code" href="classDatabase.html#a23b35412451da3ca1bb5c714b727a1f5">Query</a>(<span class="stringliteral">&quot;SELECT entry,bg_template FROM battlemaster_entry&quot;</span>);</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160; </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 0;</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160; </div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;    {</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <a class="code" href="classBarGoLink.html">BarGoLink</a> bar(1);</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        bar.<a class="code" href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">step</a>();</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString(<span class="stringliteral">&quot;&gt;&gt; Loaded 0 battlemaster entries - table is empty!&quot;</span>);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString();</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    }</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160; </div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <a class="code" href="classBarGoLink.html">BarGoLink</a> bar(result-&gt;<a class="code" href="classQueryResult.html#af92312138c98bbceeeddca74ae6029fe">GetRowCount</a>());</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160; </div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;    {</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;        ++count;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        bar.<a class="code" href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">step</a>();</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160; </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160; </div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> entry = fields[0].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> bgTypeId  = fields[1].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="DBCStores_8cpp.html#a57f0243638964eea9aea45639d53b3df">sBattlemasterListStore</a>.LookupEntry(bgTypeId))</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        {</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Table `battlemaster_entry` contain entry %u for nonexistent battleground type %u, ignored.&quot;</span>, entry, bgTypeId);</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        }</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160; </div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        <a class="code" href="classBattleGroundMgr.html#a70e546164aa1eaa7ad0dcf7215bc5520">m_battleMastersMap</a>[entry] = <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a>(bgTypeId);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    }</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;    <span class="keywordflow">while</span> (result-&gt;<a class="code" href="classQueryResult.html#a8f1f135d431fe357bf2b9373dc8d59be">NextRow</a>());</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString(<span class="stringliteral">&quot;&gt;&gt; Loaded %u battlemaster entries&quot;</span>, count);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString();</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;}</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160; </div>
<div class="line"><a name="l02709"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#af8014b786d2f0fbb24161bc9eeac784e"> 2709</a></span>&#160;<a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fab">HolidayIds</a> <a class="code" href="classBattleGroundMgr.html#af8014b786d2f0fbb24161bc9eeac784e">BattleGroundMgr::BgTypeToWeekendHolidayId</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;{</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    <span class="keywordflow">switch</span> (bgTypeId)</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    {</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fabacba982d4cc559b10ff37422de708e7c4">HOLIDAY_CALL_TO_ARMS_AV</a>;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba4f0c74a7c14f25e8cac6b0d50af23cb1">HOLIDAY_CALL_TO_ARMS_EY</a>;</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fabaf7277498797f3b74313598432e271afd">HOLIDAY_CALL_TO_ARMS_WS</a>;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba5894a0869491c731cd87205e0133e66d">HOLIDAY_CALL_TO_ARMS_SA</a>;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba2dcada3c496d660c03092485dcc5fc5f">HOLIDAY_CALL_TO_ARMS_AB</a>;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba28168544ac4271e71835f87f564500f7">HOLIDAY_NONE</a>;</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    }</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;}</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#ab0231742951817cb1e50bf084a2c6b5a"> 2727</a></span>&#160;<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> <a class="code" href="classBattleGroundMgr.html#ab0231742951817cb1e50bf084a2c6b5a">BattleGroundMgr::WeekendHolidayIdToBgType</a>(<a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fab">HolidayIds</a> holiday)</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;{</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="keywordflow">switch</span> (holiday)</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;    {</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fabacba982d4cc559b10ff37422de708e7c4">HOLIDAY_CALL_TO_ARMS_AV</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a>;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba4f0c74a7c14f25e8cac6b0d50af23cb1">HOLIDAY_CALL_TO_ARMS_EY</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a>;</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fabaf7277498797f3b74313598432e271afd">HOLIDAY_CALL_TO_ARMS_WS</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a>;</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba5894a0869491c731cd87205e0133e66d">HOLIDAY_CALL_TO_ARMS_SA</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a>;</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba2dcada3c496d660c03092485dcc5fc5f">HOLIDAY_CALL_TO_ARMS_AB</a>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a>;</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;        <span class="keywordflow">default</span>: <span class="keywordflow">return</span> <a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8748942e38a5e4140daf8e10cb08f0c7">BATTLEGROUND_TYPE_NONE</a>;</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;    }</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;}</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160; </div>
<div class="line"><a name="l02745"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a20f4f79328eb07cad2704f7b34fee010"> 2745</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classBattleGroundMgr.html#a20f4f79328eb07cad2704f7b34fee010">BattleGroundMgr::IsBgWeekend</a>(<a class="code" href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a> bgTypeId)</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;{</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="GameEventMgr_8h.html#a3c1c916d94272dfe845b9cc5e8fc292a">sGameEventMgr</a>.IsActiveHoliday(<a class="code" href="classBattleGroundMgr.html#af8014b786d2f0fbb24161bc9eeac784e">BgTypeToWeekendHolidayId</a>(bgTypeId));</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;}</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160; </div>
<div class="line"><a name="l02753"></a><span class="lineno"><a class="line" href="classBattleGroundMgr.html#a7e70ac825ebbbd6e0cc4dbfa0bf126ce"> 2753</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classBattleGroundMgr.html#a7e70ac825ebbbd6e0cc4dbfa0bf126ce">BattleGroundMgr::LoadBattleEventIndexes</a>()</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;{</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <a class="code" href="structBattleGroundEventIdx.html">BattleGroundEventIdx</a> events;</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    events.<a class="code" href="structBattleGroundEventIdx.html#ae92a0e36d287c2c346e72734e2e54df0">event1</a> = <a class="code" href="BattleGround_8h.html#a9f8352f32376018a7687baece90c5105">BG_EVENT_NONE</a>;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    events.<a class="code" href="structBattleGroundEventIdx.html#a3aa4cf6679936fc83d446236b38d87a5">event2</a> = <a class="code" href="BattleGround_8h.html#a9f8352f32376018a7687baece90c5105">BG_EVENT_NONE</a>;</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    <a class="code" href="classBattleGroundMgr.html#abdb3b6204cf0919b80ec7ab29fd3f59e">m_gameObjectBattleEventIndexMap</a>.clear();             <span class="comment">// need for reload case</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;    <a class="code" href="classBattleGroundMgr.html#abdb3b6204cf0919b80ec7ab29fd3f59e">m_gameObjectBattleEventIndexMap</a>[<span class="keyword">static_cast&lt;</span><a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a><span class="keyword">&gt;</span>(-1)] = events;</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;    <a class="code" href="classBattleGroundMgr.html#ad6aeae5632d2ae0ba6b3cb45dbabcb41">m_creatureBattleEventIndexMap</a>.clear();               <span class="comment">// need for reload case</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;    <a class="code" href="classBattleGroundMgr.html#ad6aeae5632d2ae0ba6b3cb45dbabcb41">m_creatureBattleEventIndexMap</a>[<span class="keyword">static_cast&lt;</span><a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a><span class="keyword">&gt;</span>(-1)] = events;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160; </div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 0;</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160; </div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;    <a class="code" href="classQueryResult.html">QueryResult</a>* result =</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <span class="comment">//                           0         1           2                3                4              5           6</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <a class="code" href="group__mangosd.html#gae551ea020f187b038a84473d48d9e14b">WorldDatabase</a>.<a class="code" href="classDatabase.html#a23b35412451da3ca1bb5c714b727a1f5">Query</a>(<span class="stringliteral">&quot;SELECT data.typ, data.guid1, data.ev1 AS ev1, data.ev2 AS ev2, data.map AS m, data.guid2, description.map, &quot;</span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;                            <span class="comment">//                              7                  8                   9</span></div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;                            <span class="stringliteral">&quot;description.event1, description.event2, description.description &quot;</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;                            <span class="stringliteral">&quot;FROM &quot;</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;                            <span class="stringliteral">&quot;(SELECT &#39;1&#39; AS typ, a.guid AS guid1, a.event1 AS ev1, a.event2 AS ev2, b.map AS map, b.guid AS guid2 &quot;</span></div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                            <span class="stringliteral">&quot;FROM gameobject_battleground AS a &quot;</span></div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                            <span class="stringliteral">&quot;LEFT OUTER JOIN gameobject AS b ON a.guid = b.guid &quot;</span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                            <span class="stringliteral">&quot;UNION &quot;</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                            <span class="stringliteral">&quot;SELECT &#39;2&#39; AS typ, a.guid AS guid1, a.event1 AS ev1, a.event2 AS ev2, b.map AS map, b.guid AS guid2 &quot;</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;                            <span class="stringliteral">&quot;FROM creature_battleground AS a &quot;</span></div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;                            <span class="stringliteral">&quot;LEFT OUTER JOIN creature AS b ON a.guid = b.guid &quot;</span></div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;                            <span class="stringliteral">&quot;) data &quot;</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                            <span class="stringliteral">&quot;RIGHT OUTER JOIN battleground_events AS description ON data.map = description.map &quot;</span></div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                            <span class="stringliteral">&quot;AND data.ev1 = description.event1 AND data.ev2 = description.event2 &quot;</span></div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                            <span class="comment">// full outer join doesn&#39;t work in mysql :-/ so just UNION-select the same again and add a left outer join</span></div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                            <span class="stringliteral">&quot;UNION &quot;</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                            <span class="stringliteral">&quot;SELECT data.typ, data.guid1, data.ev1, data.ev2, data.map, data.guid2, description.map, &quot;</span></div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                            <span class="stringliteral">&quot;description.event1, description.event2, description.description &quot;</span></div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                            <span class="stringliteral">&quot;FROM &quot;</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                            <span class="stringliteral">&quot;(SELECT &#39;1&#39; AS typ, a.guid AS guid1, a.event1 AS ev1, a.event2 AS ev2, b.map AS map, b.guid AS guid2 &quot;</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                            <span class="stringliteral">&quot;FROM gameobject_battleground AS a &quot;</span></div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                            <span class="stringliteral">&quot;LEFT OUTER JOIN gameobject AS b ON a.guid = b.guid &quot;</span></div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                            <span class="stringliteral">&quot;UNION &quot;</span></div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                            <span class="stringliteral">&quot;SELECT &#39;2&#39; AS typ, a.guid AS guid1, a.event1 AS ev1, a.event2 AS ev2, b.map AS map, b.guid AS guid2 &quot;</span></div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                            <span class="stringliteral">&quot;FROM creature_battleground AS a &quot;</span></div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                            <span class="stringliteral">&quot;LEFT OUTER JOIN creature AS b ON a.guid = b.guid &quot;</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                            <span class="stringliteral">&quot;) data &quot;</span></div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;                            <span class="stringliteral">&quot;LEFT OUTER JOIN battleground_events AS description ON data.map = description.map &quot;</span></div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;                            <span class="stringliteral">&quot;AND data.ev1 = description.event1 AND data.ev2 = description.event2 &quot;</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;                            <span class="stringliteral">&quot;ORDER BY m, ev1, ev2&quot;</span>);</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;    {</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;        <a class="code" href="classBarGoLink.html">BarGoLink</a> bar(1);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;        bar.<a class="code" href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">step</a>();</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;&gt;&gt; Loaded 0 battleground eventindexes.&quot;</span>);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString();</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;    }</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160; </div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;    <a class="code" href="classBarGoLink.html">BarGoLink</a> bar(result-&gt;<a class="code" href="classQueryResult.html#af92312138c98bbceeeddca74ae6029fe">GetRowCount</a>());</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160; </div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    {</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;        bar.<a class="code" href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">step</a>();</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <a class="code" href="classField.html">Field</a>* fields = result-&gt;<a class="code" href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">Fetch</a>();</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        <span class="keywordflow">if</span> (fields[2].GetUInt8() == <a class="code" href="BattleGround_8h.html#a9f8352f32376018a7687baece90c5105">BG_EVENT_NONE</a> || fields[3].GetUInt8() == <a class="code" href="BattleGround_8h.html#a9f8352f32376018a7687baece90c5105">BG_EVENT_NONE</a>)</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;            <span class="keywordflow">continue</span>;                                       <span class="comment">// we don&#39;t need to add those to the eventmap</span></div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160; </div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;        <span class="keywordtype">bool</span> gameobject         = (fields[0].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>() == 1);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> dbTableGuidLow   = fields[1].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        events.<a class="code" href="structBattleGroundEventIdx.html#ae92a0e36d287c2c346e72734e2e54df0">event1</a>           = fields[2].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        events.<a class="code" href="structBattleGroundEventIdx.html#a3aa4cf6679936fc83d446236b38d87a5">event2</a>           = fields[3].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> map              = fields[4].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160; </div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> desc_map = fields[6].<a class="code" href="classField.html#af71c97fd38da328f4d9590b112f859c4">GetUInt32</a>();</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> desc_event1 = fields[7].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> desc_event2 = fields[8].<a class="code" href="classField.html#a090beafdf8b41555058a87d00443498a">GetUInt8</a>();</div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">char</span>* description = fields[9].<a class="code" href="classField.html#ab8c1a7e73265f7b14457ab37cf20681c">GetString</a>();</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;        <span class="comment">// checking for nullptr - through right outer join this will mean following:</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;        <span class="keywordflow">if</span> (fields[5].GetUInt32() != dbTableGuidLow)</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;        {</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;BattleGroundEvent: %s with nonexistent guid %u for event: map:%u, event1:%u, event2:%u (\&quot;%s\&quot;)&quot;</span>,</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                            (gameobject) ? <span class="stringliteral">&quot;gameobject&quot;</span> : <span class="stringliteral">&quot;creature&quot;</span>, dbTableGuidLow, map, events.<a class="code" href="structBattleGroundEventIdx.html#ae92a0e36d287c2c346e72734e2e54df0">event1</a>, events.<a class="code" href="structBattleGroundEventIdx.html#a3aa4cf6679936fc83d446236b38d87a5">event2</a>, description);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;        }</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160; </div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;        <span class="comment">// checking for nullptr - through full outer join this can mean 2 things:</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;        <span class="keywordflow">if</span> (desc_map != map)</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;        {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;            <span class="comment">// there is an event missing</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;            <span class="keywordflow">if</span> (dbTableGuidLow == 0)</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;            {</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;BattleGroundEvent: missing db-data for map:%u, event1:%u, event2:%u (\&quot;%s\&quot;)&quot;</span>, desc_map, desc_event1, desc_event2, description);</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;            }</div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;            <span class="comment">// we have an event which shouldn&#39;t exist</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;BattleGroundEvent: %s with guid %u is registered, for a nonexistent event: map:%u, event1:%u, event2:%u&quot;</span>,</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                    (gameobject) ? <span class="stringliteral">&quot;gameobject&quot;</span> : <span class="stringliteral">&quot;creature&quot;</span>, dbTableGuidLow, map, events.<a class="code" href="structBattleGroundEventIdx.html#ae92a0e36d287c2c346e72734e2e54df0">event1</a>, events.<a class="code" href="structBattleGroundEventIdx.html#a3aa4cf6679936fc83d446236b38d87a5">event2</a>);</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;        }</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160; </div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;        <span class="keywordflow">if</span> (gameobject)</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;            <a class="code" href="classBattleGroundMgr.html#abdb3b6204cf0919b80ec7ab29fd3f59e">m_gameObjectBattleEventIndexMap</a>[dbTableGuidLow] = events;</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;            <a class="code" href="classBattleGroundMgr.html#ad6aeae5632d2ae0ba6b3cb45dbabcb41">m_creatureBattleEventIndexMap</a>[dbTableGuidLow] = events;</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        ++count;</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;    <span class="keywordflow">while</span> (result-&gt;<a class="code" href="classQueryResult.html#a8f1f135d431fe357bf2b9373dc8d59be">NextRow</a>());</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160; </div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString(<span class="stringliteral">&quot;&gt;&gt; Loaded %u battleground eventindexes&quot;</span>, count);</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outString();</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    <span class="keyword">delete</span> result;</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;}</div>
<div class="ttc" id="aArenaTeam_8h_html"><div class="ttname"><a href="ArenaTeam_8h.html">ArenaTeam.h</a></div></div>
<div class="ttc" id="aBattleGroundAB_8h_html"><div class="ttname"><a href="BattleGroundAB_8h.html">BattleGroundAB.h</a></div></div>
<div class="ttc" id="aBattleGroundAV_8h_html"><div class="ttname"><a href="BattleGroundAV_8h.html">BattleGroundAV.h</a></div></div>
<div class="ttc" id="aBattleGroundBE_8h_html"><div class="ttname"><a href="BattleGroundBE_8h.html">BattleGroundBE.h</a></div></div>
<div class="ttc" id="aBattleGroundDS_8h_html"><div class="ttname"><a href="BattleGroundDS_8h.html">BattleGroundDS.h</a></div></div>
<div class="ttc" id="aBattleGroundEY_8h_html"><div class="ttname"><a href="BattleGroundEY_8h.html">BattleGroundEY.h</a></div></div>
<div class="ttc" id="aBattleGroundIC_8h_html"><div class="ttname"><a href="BattleGroundIC_8h.html">BattleGroundIC.h</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8cpp_html_a7ecb6f3468146290c3e0f844bf0c8a9d"><div class="ttname"><a href="BattleGroundMgr_8cpp.html#a7ecb6f3468146290c3e0f844bf0c8a9d">SetTitleValues</a></div><div class="ttdeci">void SetTitleValues(uint32 &amp;first, uint32 &amp;second, uint32 titleId)</div><div class="ttdoc">Method that sets that title values.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02162">BattleGroundMgr.cpp:2162</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8cpp_html_aa78d3cad5f23d5463727cc038451480b"><div class="ttname"><a href="BattleGroundMgr_8cpp.html#aa78d3cad5f23d5463727cc038451480b">CheckPlayersAndAddToWinners</a></div><div class="ttdeci">void CheckPlayersAndAddToWinners(ArenaTeam *team, std::map&lt; ObjectGuid, uint32 &gt; &amp;playerRanks, uint32 rank)</div><div class="ttdoc">Method checks players and arena winners.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02136">BattleGroundMgr.cpp:2136</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8cpp_html_aba15c4b26c1f1d8ab7ceefb35f7949b3"><div class="ttname"><a href="BattleGroundMgr_8cpp.html#aba15c4b26c1f1d8ab7ceefb35f7949b3">INSTANTIATE_SINGLETON_1</a></div><div class="ttdeci">INSTANTIATE_SINGLETON_1(BattleGroundMgr)</div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html"><div class="ttname"><a href="BattleGroundMgr_8h.html">BattleGroundMgr.h</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_a0ce5868c633756e71b53b763c925b124"><div class="ttname"><a href="BattleGroundMgr_8h.html#a0ce5868c633756e71b53b763c925b124">BATTLEGROUND_ARENA_POINT_DISTRIBUTION_DAY</a></div><div class="ttdeci">#define BATTLEGROUND_ARENA_POINT_DISTRIBUTION_DAY</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00039">BattleGroundMgr.h:39</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c"><div class="ttname"><a href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a39d0b398e1bcd59620eb0f8701139d1c">BG_QUEUE_PREMADE_HORDE</a></div><div class="ttdeci">@ BG_QUEUE_PREMADE_HORDE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00070">BattleGroundMgr.h:70</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697"><div class="ttname"><a href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a4b31b889f93f89bfaacde424717c2697">BG_QUEUE_NORMAL_ALLIANCE</a></div><div class="ttdeci">@ BG_QUEUE_NORMAL_ALLIANCE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00071">BattleGroundMgr.h:71</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4"><div class="ttname"><a href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7a8f1f06d0124e05efcb390e0e9a29ddf4">BG_QUEUE_PREMADE_ALLIANCE</a></div><div class="ttdeci">@ BG_QUEUE_PREMADE_ALLIANCE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00069">BattleGroundMgr.h:69</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d"><div class="ttname"><a href="BattleGroundMgr_8h.html#a3492a81fb67603f133535ba7d7c29ac7aea585c62a155542b2d643e25d554f15d">BG_QUEUE_NORMAL_HORDE</a></div><div class="ttdeci">@ BG_QUEUE_NORMAL_HORDE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00073">BattleGroundMgr.h:72</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_a5ea6ed78f78489fadc9d98c363702e0d"><div class="ttname"><a href="BattleGroundMgr_8h.html#a5ea6ed78f78489fadc9d98c363702e0d">BG_QUEUE_GROUP_TYPES_COUNT</a></div><div class="ttdeci">#define BG_QUEUE_GROUP_TYPES_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00075">BattleGroundMgr.h:75</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_ac3ad1a9b3606fb278830bb4b2094904e"><div class="ttname"><a href="BattleGroundMgr_8h.html#ac3ad1a9b3606fb278830bb4b2094904e">sBattleGroundMgr</a></div><div class="ttdeci">#define sBattleGroundMgr</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00312">BattleGroundMgr.h:312</a></div></div>
<div class="ttc" id="aBattleGroundMgr_8h_html_acdd9d5422fecea59405438851a2d1f7c"><div class="ttname"><a href="BattleGroundMgr_8h.html#acdd9d5422fecea59405438851a2d1f7c">COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME</a></div><div class="ttdeci">#define COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00040">BattleGroundMgr.h:40</a></div></div>
<div class="ttc" id="aBattleGroundNA_8h_html"><div class="ttname"><a href="BattleGroundNA_8h.html">BattleGroundNA.h</a></div></div>
<div class="ttc" id="aBattleGroundRL_8h_html"><div class="ttname"><a href="BattleGroundRL_8h.html">BattleGroundRL.h</a></div></div>
<div class="ttc" id="aBattleGroundRV_8h_html"><div class="ttname"><a href="BattleGroundRV_8h.html">BattleGroundRV.h</a></div></div>
<div class="ttc" id="aBattleGroundSA_8h_html"><div class="ttname"><a href="BattleGroundSA_8h.html">BattleGroundSA.h</a></div></div>
<div class="ttc" id="aBattleGroundWS_8h_html"><div class="ttname"><a href="BattleGroundWS_8h.html">BattleGroundWS.h</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a270b85294546331d63097ac665c16408"><div class="ttname"><a href="BattleGround_8h.html#a270b85294546331d63097ac665c16408">GroupJoinBattlegroundResult</a></div><div class="ttdeci">GroupJoinBattlegroundResult</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00272">BattleGround.h:273</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a270b85294546331d63097ac665c16408a0371438cee9cd3dd26e4b3921e4ea180"><div class="ttname"><a href="BattleGround_8h.html#a270b85294546331d63097ac665c16408a0371438cee9cd3dd26e4b3921e4ea180">ERR_BATTLEGROUND_JOIN_TIMED_OUT</a></div><div class="ttdeci">@ ERR_BATTLEGROUND_JOIN_TIMED_OUT</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00286">BattleGround.h:286</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a270b85294546331d63097ac665c16408a11f3937262a81d72f1c3ce29cc078961"><div class="ttname"><a href="BattleGround_8h.html#a270b85294546331d63097ac665c16408a11f3937262a81d72f1c3ce29cc078961">ERR_BATTLEGROUND_JOIN_FAILED</a></div><div class="ttdeci">@ ERR_BATTLEGROUND_JOIN_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00287">BattleGround.h:287</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a4808dbe4635b85fbc8363326c669bf9aa26739fc24e4bffd58441ea789ca6464a"><div class="ttname"><a href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa26739fc24e4bffd58441ea789ca6464a">BG_REWARD_WINNER_ARENA_LAST</a></div><div class="ttdeci">@ BG_REWARD_WINNER_ARENA_LAST</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00173">BattleGround.h:173</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a4808dbe4635b85fbc8363326c669bf9aa280954f0640a635b9a1097f0e2a16604"><div class="ttname"><a href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa280954f0640a635b9a1097f0e2a16604">BG_REWARD_WINNER_HONOR_LAST</a></div><div class="ttdeci">@ BG_REWARD_WINNER_HONOR_LAST</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00172">BattleGround.h:172</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a4808dbe4635b85fbc8363326c669bf9aa8de0c0ffbb6f998efb1b96257bb09bdd"><div class="ttname"><a href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa8de0c0ffbb6f998efb1b96257bb09bdd">BG_REWARD_LOOSER_HONOR_LAST</a></div><div class="ttdeci">@ BG_REWARD_LOOSER_HONOR_LAST</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00176">BattleGround.h:175</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a4808dbe4635b85fbc8363326c669bf9aa9ecf35de7ccb54ca226b6ad72af7a068"><div class="ttname"><a href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aa9ecf35de7ccb54ca226b6ad72af7a068">BG_REWARD_LOOSER_HONOR_FIRST</a></div><div class="ttdeci">@ BG_REWARD_LOOSER_HONOR_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00174">BattleGround.h:174</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a4808dbe4635b85fbc8363326c669bf9aac8159825b474ee01a0e2bf02d30ff494"><div class="ttname"><a href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aac8159825b474ee01a0e2bf02d30ff494">BG_REWARD_WINNER_HONOR_FIRST</a></div><div class="ttdeci">@ BG_REWARD_WINNER_HONOR_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00170">BattleGround.h:170</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a4808dbe4635b85fbc8363326c669bf9aaeaa309be5f5931a2cc3491b4894b5670"><div class="ttname"><a href="BattleGround_8h.html#a4808dbe4635b85fbc8363326c669bf9aaeaa309be5f5931a2cc3491b4894b5670">BG_REWARD_WINNER_ARENA_FIRST</a></div><div class="ttdeci">@ BG_REWARD_WINNER_ARENA_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00171">BattleGround.h:171</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a5864554643c56196b9c76164ab35ad05a1b0d93b746ae2d960bd33172a070c365"><div class="ttname"><a href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05a1b0d93b746ae2d960bd33172a070c365">INVITE_ACCEPT_WAIT_TIME</a></div><div class="ttdeci">@ INVITE_ACCEPT_WAIT_TIME</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00128">BattleGround.h:128</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a5864554643c56196b9c76164ab35ad05afa97b69bd50d943b0d6fcb4fb6b0b0f1"><div class="ttname"><a href="BattleGround_8h.html#a5864554643c56196b9c76164ab35ad05afa97b69bd50d943b0d6fcb4fb6b0b0f1">INVITATION_REMIND_TIME</a></div><div class="ttdeci">@ INVITATION_REMIND_TIME</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00127">BattleGround.h:127</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a7e06c7377f6a6ba19e39c6534b207a7fae01a6bdc4b7d444e84bd1e77e3006e6e"><div class="ttname"><a href="BattleGround_8h.html#a7e06c7377f6a6ba19e39c6534b207a7fae01a6bdc4b7d444e84bd1e77e3006e6e">TYPE_ARENA</a></div><div class="ttdeci">@ TYPE_ARENA</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00252">BattleGround.h:251</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_a9f8352f32376018a7687baece90c5105"><div class="ttname"><a href="BattleGround_8h.html#a9f8352f32376018a7687baece90c5105">BG_EVENT_NONE</a></div><div class="ttdeci">#define BG_EVENT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00029">BattleGround.h:29</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0ea91aabae633323f9e31059e42e9ea5240"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0ea91aabae633323f9e31059e42e9ea5240">STATUS_WAIT_QUEUE</a></div><div class="ttdeci">@ STATUS_WAIT_QUEUE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00183">BattleGround.h:183</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0eaa7ff6fbf30c889d48bea1d98b74dc408"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaa7ff6fbf30c889d48bea1d98b74dc408">STATUS_NONE</a></div><div class="ttdeci">@ STATUS_NONE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00182">BattleGround.h:182</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8">STATUS_WAIT_LEAVE</a></div><div class="ttdeci">@ STATUS_WAIT_LEAVE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00187">BattleGround.h:186</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0eaf0b95a17deaea4fc8f467eaacaa515b2"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eaf0b95a17deaea4fc8f467eaacaa515b2">STATUS_WAIT_JOIN</a></div><div class="ttdeci">@ STATUS_WAIT_JOIN</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00184">BattleGround.h:184</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0eafaf0b6349b8a93b543f64c744e321d5a"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eafaf0b6349b8a93b543f64c744e321d5a">STATUS_IN_PROGRESS</a></div><div class="ttdeci">@ STATUS_IN_PROGRESS</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00185">BattleGround.h:185</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771">BattleGroundQueueTypeId</a></div><div class="ttdeci">BattleGroundQueueTypeId</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00205">BattleGround.h:206</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a02779ae5e6ae1a94636450f7e012bc6c"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a02779ae5e6ae1a94636450f7e012bc6c">BATTLEGROUND_QUEUE_2v2</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_2v2</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00215">BattleGround.h:215</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a28ee92c83e56a441fcae56fb5546f431"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a28ee92c83e56a441fcae56fb5546f431">BATTLEGROUND_QUEUE_RB</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_RB</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00214">BattleGround.h:214</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a3ed02e4cd7d03d251b41054d17f3fcf6"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a3ed02e4cd7d03d251b41054d17f3fcf6">BATTLEGROUND_QUEUE_SA</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_SA</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00212">BattleGround.h:212</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a4780d3038e9e37db485a99c4175deee5"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a4780d3038e9e37db485a99c4175deee5">BATTLEGROUND_QUEUE_AB</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_AB</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00210">BattleGround.h:210</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a6b9cb096b2108333789c9435dcff1191"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a6b9cb096b2108333789c9435dcff1191">BATTLEGROUND_QUEUE_5v5</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_5v5</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00217">BattleGround.h:217</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a83643b6b6cf0df0babd743dfda8858de"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a83643b6b6cf0df0babd743dfda8858de">BATTLEGROUND_QUEUE_WS</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_WS</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00209">BattleGround.h:209</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771a89d452c10b2a7a98006539d02229a76d"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771a89d452c10b2a7a98006539d02229a76d">BATTLEGROUND_QUEUE_AV</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_AV</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00208">BattleGround.h:208</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771aaefe474c1c4434f3cbfc4c4e23f6ae0c"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771aaefe474c1c4434f3cbfc4c4e23f6ae0c">BATTLEGROUND_QUEUE_EY</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_EY</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00211">BattleGround.h:211</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771ae1e81cfb41b8136ade30b98400ac84fd"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771ae1e81cfb41b8136ade30b98400ac84fd">BATTLEGROUND_QUEUE_3v3</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_3v3</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00216">BattleGround.h:216</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771af067a2df3fe97694d3ee3669ef9afbe3"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771af067a2df3fe97694d3ee3669ef9afbe3">BATTLEGROUND_QUEUE_NONE</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00207">BattleGround.h:207</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ad170ae161b459345360fac8b1fcba771afeec1d52b1fc2808eabff28facde8b59"><div class="ttname"><a href="BattleGround_8h.html#ad170ae161b459345360fac8b1fcba771afeec1d52b1fc2808eabff28facde8b59">BATTLEGROUND_QUEUE_IC</a></div><div class="ttdeci">@ BATTLEGROUND_QUEUE_IC</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00213">BattleGround.h:213</a></div></div>
<div class="ttc" id="aChat_8h_html"><div class="ttname"><a href="Chat_8h.html">Chat.h</a></div></div>
<div class="ttc" id="aCommon_8h_html"><div class="ttname"><a href="Common_8h.html">Common.h</a></div></div>
<div class="ttc" id="aCommon_8h_html_a12f54e09a2fe86ecb7dc821868e5aaf9"><div class="ttname"><a href="Common_8h.html#a12f54e09a2fe86ecb7dc821868e5aaf9">UI64FMTD</a></div><div class="ttdeci">#define UI64FMTD</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00085">Common.h:85</a></div></div>
<div class="ttc" id="aCommon_8h_html_ab317c73e51fb8a68f86165ac831f7b8c"><div class="ttname"><a href="Common_8h.html#ab317c73e51fb8a68f86165ac831f7b8c">countof</a></div><div class="ttdeci">#define countof(array)</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00170">Common.h:170</a></div></div>
<div class="ttc" id="aCommon_8h_html_ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1"><div class="ttname"><a href="Common_8h.html#ad02db78fbe7773265246ca3010f23f6fa7f04060ed09e837220bc6c3f34d6fef1">SEC_GAMEMASTER</a></div><div class="ttdeci">@ SEC_GAMEMASTER</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00125">Common.h:125</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a301ab62512acfb007c0960856052525f"><div class="ttname"><a href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525f">BattleGroundBracketId</a></div><div class="ttdeci">BattleGroundBracketId</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00035">DBCEnums.h:36</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a301ab62512acfb007c0960856052525fa6491ce72b44414af538f648d5388fc34"><div class="ttname"><a href="DBCEnums_8h.html#a301ab62512acfb007c0960856052525fa6491ce72b44414af538f648d5388fc34">BG_BRACKET_ID_FIRST</a></div><div class="ttdeci">@ BG_BRACKET_ID_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00038">DBCEnums.h:38</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a5201a522ecfb21f8b94bcab8b2ba2f8c"><div class="ttname"><a href="DBCEnums_8h.html#a5201a522ecfb21f8b94bcab8b2ba2f8c">MAX_BATTLEGROUND_BRACKETS</a></div><div class="ttdeci">#define MAX_BATTLEGROUND_BRACKETS</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00043">DBCEnums.h:43</a></div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a09e088516eb11f5c7014a7432f2f8597"><div class="ttname"><a href="DBCStores_8cpp.html#a09e088516eb11f5c7014a7432f2f8597">GetBattlegroundBracketByLevel</a></div><div class="ttdeci">PvPDifficultyEntry const  * GetBattlegroundBracketByLevel(uint32 mapid, uint32 level)</div><div class="ttdef"><b>Definition:</b> <a href="DBCStores_8cpp_source.html#l01047">DBCStores.cpp:1047</a></div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a2997cbe20d462fdb8cee8e14230725e2"><div class="ttname"><a href="DBCStores_8cpp.html#a2997cbe20d462fdb8cee8e14230725e2">sCharTitlesStore</a></div><div class="ttdeci">DBCStorage&lt; CharTitlesEntry &gt; sCharTitlesStore(CharTitlesEntryfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a57f0243638964eea9aea45639d53b3df"><div class="ttname"><a href="DBCStores_8cpp.html#a57f0243638964eea9aea45639d53b3df">sBattlemasterListStore</a></div><div class="ttdeci">DBCStorage&lt; BattlemasterListEntry &gt; sBattlemasterListStore(BattlemasterListEntryfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_abce58e30e684067135e87797c3dc3d08"><div class="ttname"><a href="DBCStores_8cpp.html#abce58e30e684067135e87797c3dc3d08">GetBattlegroundBracketById</a></div><div class="ttdeci">PvPDifficultyEntry const  * GetBattlegroundBracketById(uint32 mapid, BattleGroundBracketId id)</div><div class="ttdef"><b>Definition:</b> <a href="DBCStores_8cpp_source.html#l01071">DBCStores.cpp:1071</a></div></div>
<div class="ttc" id="aDefine_8h_html_a0bf9964a3ce962c07ad3d8b5432bbbcd"><div class="ttname"><a href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a></div><div class="ttdeci">std::int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00112">Define.h:112</a></div></div>
<div class="ttc" id="aDefine_8h_html_a15a8d014fadf85c99a2268d8cbd00767"><div class="ttname"><a href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a></div><div class="ttdeci">std::uint8_t uint8</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00118">Define.h:118</a></div></div>
<div class="ttc" id="aDefine_8h_html_a22f78cc9780bf32aff91ae17c3101c8d"><div class="ttname"><a href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a></div><div class="ttdeci">std::uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00116">Define.h:116</a></div></div>
<div class="ttc" id="aDefine_8h_html_a3bb8a71f4ae9af551f71e9eb2c9c3325"><div class="ttname"><a href="Define_8h.html#a3bb8a71f4ae9af551f71e9eb2c9c3325">int8</a></div><div class="ttdeci">std::int8_t int8</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00114">Define.h:114</a></div></div>
<div class="ttc" id="aDefine_8h_html_ac4dd6ce78ce3b840c53bd4b3c63ed09b"><div class="ttname"><a href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a></div><div class="ttdeci">std::uint64_t uint64</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00115">Define.h:115</a></div></div>
<div class="ttc" id="aFormulas_8h_html"><div class="ttname"><a href="Formulas_8h.html">Formulas.h</a></div></div>
<div class="ttc" id="aGameEventMgr_8h_html"><div class="ttname"><a href="GameEventMgr_8h.html">GameEventMgr.h</a></div></div>
<div class="ttc" id="aGameEventMgr_8h_html_a3c1c916d94272dfe845b9cc5e8fc292a"><div class="ttname"><a href="GameEventMgr_8h.html#a3c1c916d94272dfe845b9cc5e8fc292a">sGameEventMgr</a></div><div class="ttdeci">#define sGameEventMgr</div><div class="ttdef"><b>Definition:</b> <a href="GameEventMgr_8h_source.html#l00164">GameEventMgr.h:164</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a0ea06d91b3bd3c6226bd7e5257484171"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a0ea06d91b3bd3c6226bd7e5257484171">LANG_DEBUG_BG_OFF</a></div><div class="ttdeci">@ LANG_DEBUG_BG_OFF</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00802">Language.h:802</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a3b9590c12e77aa4bcdb7b9014a9c8ed7"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a3b9590c12e77aa4bcdb7b9014a9c8ed7">LANG_DIST_ARENA_POINTS_TEAM_START</a></div><div class="ttdeci">@ LANG_DIST_ARENA_POINTS_TEAM_START</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00806">Language.h:806</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a4b6903a8163567860effa0f72dafa769"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a4b6903a8163567860effa0f72dafa769">LANG_DEBUG_ARENA_OFF</a></div><div class="ttdeci">@ LANG_DEBUG_ARENA_OFF</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00800">Language.h:800</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a4ed413b1da3c24f3f3f17bb1c3732213"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a4ed413b1da3c24f3f3f17bb1c3732213">LANG_ARENA_QUEUE_ANNOUNCE_WORLD_EXIT</a></div><div class="ttdeci">@ LANG_ARENA_QUEUE_ANNOUNCE_WORLD_EXIT</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00779">Language.h:779</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a73a4d4753015938060662b51318f7b77"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a73a4d4753015938060662b51318f7b77">LANG_DIST_ARENA_POINTS_ONLINE_START</a></div><div class="ttdeci">@ LANG_DIST_ARENA_POINTS_ONLINE_START</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00804">Language.h:804</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a7501732cb7eb651a15c52cfbd53ed8d4"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a7501732cb7eb651a15c52cfbd53ed8d4">LANG_DIST_ARENA_REWARDS_START</a></div><div class="ttdeci">@ LANG_DIST_ARENA_REWARDS_START</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00809">Language.h:809</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a756c0228ae5b2b3da41eba015bf03d34"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a756c0228ae5b2b3da41eba015bf03d34">LANG_DIST_ARENA_POINTS_START</a></div><div class="ttdeci">@ LANG_DIST_ARENA_POINTS_START</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00803">Language.h:803</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a76985e26ac6e683c797cd781b1bee050"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a76985e26ac6e683c797cd781b1bee050">LANG_DEBUG_BG_ON</a></div><div class="ttdeci">@ LANG_DEBUG_BG_ON</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00801">Language.h:801</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a93d9b2bd40c78033f6071b05bf3bd000"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a93d9b2bd40c78033f6071b05bf3bd000">LANG_DIST_ARENA_POINTS_TEAM_END</a></div><div class="ttdeci">@ LANG_DIST_ARENA_POINTS_TEAM_END</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00807">Language.h:807</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51a9fff989466f334e77cb9e2db5b0f3e91"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51a9fff989466f334e77cb9e2db5b0f3e91">LANG_DEBUG_ARENA_ON</a></div><div class="ttdeci">@ LANG_DEBUG_ARENA_ON</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00799">Language.h:799</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51aa669aaba8a7f5c52330b934194ff2948"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51aa669aaba8a7f5c52330b934194ff2948">LANG_DIST_ARENA_POINTS_END</a></div><div class="ttdeci">@ LANG_DIST_ARENA_POINTS_END</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00808">Language.h:808</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51ac4b197f5667a5282a6e3809c46b27cb6"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51ac4b197f5667a5282a6e3809c46b27cb6">LANG_BG_QUEUE_ANNOUNCE_SELF</a></div><div class="ttdeci">@ LANG_BG_QUEUE_ANNOUNCE_SELF</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00771">Language.h:771</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51ad41adc4f06593e856a2b271a894404cc"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51ad41adc4f06593e856a2b271a894404cc">LANG_BG_QUEUE_ANNOUNCE_WORLD</a></div><div class="ttdeci">@ LANG_BG_QUEUE_ANNOUNCE_WORLD</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00772">Language.h:772</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51adb1aea6b886487042b9780fd7faaaf82"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51adb1aea6b886487042b9780fd7faaaf82">LANG_DIST_ARENA_REWARDS_END</a></div><div class="ttdeci">@ LANG_DIST_ARENA_REWARDS_END</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00810">Language.h:810</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51ae1cbbd544f2432cf396d039743c0142c"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51ae1cbbd544f2432cf396d039743c0142c">LANG_DIST_ARENA_POINTS_ONLINE_END</a></div><div class="ttdeci">@ LANG_DIST_ARENA_POINTS_ONLINE_END</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00805">Language.h:805</a></div></div>
<div class="ttc" id="aLanguage_8h_html_a1543d0f7021d0539b145b8297818fa51af853c9db3f02033af95ff598f69308f6"><div class="ttname"><a href="Language_8h.html#a1543d0f7021d0539b145b8297818fa51af853c9db3f02033af95ff598f69308f6">LANG_ARENA_QUEUE_ANNOUNCE_WORLD_JOIN</a></div><div class="ttdeci">@ LANG_ARENA_QUEUE_ANNOUNCE_WORLD_JOIN</div><div class="ttdef"><b>Definition:</b> <a href="Language_8h_source.html#l00778">Language.h:778</a></div></div>
<div class="ttc" id="aLog_8h_html_a21a2c7330a04ac78200a986f66609369"><div class="ttname"><a href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a></div><div class="ttdeci">#define DEBUG_LOG(...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00262">Log.h:262</a></div></div>
<div class="ttc" id="aLog_8h_html_ab5487500f5b4b12072043104b916d582"><div class="ttname"><a href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a></div><div class="ttdeci">#define sLog</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00236">Log.h:236</a></div></div>
<div class="ttc" id="aLog_8h_html_adbee991aac31d91a88ae6276d32ba9f6"><div class="ttname"><a href="Log_8h.html#adbee991aac31d91a88ae6276d32ba9f6">DETAIL_LOG</a></div><div class="ttdeci">#define DETAIL_LOG(...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00250">Log.h:250</a></div></div>
<div class="ttc" id="aLootMgr_8h_html"><div class="ttname"><a href="LootMgr_8h.html">LootMgr.h</a></div></div>
<div class="ttc" id="aLootMgr_8h_html_ab8f8fff84ad092dddff5018ed76690d2"><div class="ttname"><a href="LootMgr_8h.html#ab8f8fff84ad092dddff5018ed76690d2">sLootMgr</a></div><div class="ttdeci">#define sLootMgr</div><div class="ttdef"><b>Definition:</b> <a href="LootMgr_8h_source.html#l00439">LootMgr.h:439</a></div></div>
<div class="ttc" id="aMail_8h_html"><div class="ttname"><a href="Mail_8h.html">Mail.h</a></div><div class="ttdoc">This file contains the the headers needed for MaNGOS to handle mails.</div></div>
<div class="ttc" id="aMapManager_8h_html"><div class="ttname"><a href="MapManager_8h.html">MapManager.h</a></div></div>
<div class="ttc" id="aMapManager_8h_html_a9132749f8376c48b0ca7212eb3293905"><div class="ttname"><a href="MapManager_8h.html#a9132749f8376c48b0ca7212eb3293905">sMapMgr</a></div><div class="ttdeci">#define sMapMgr</div><div class="ttdef"><b>Definition:</b> <a href="MapManager_8h_source.html#l00214">MapManager.h:214</a></div></div>
<div class="ttc" id="aMap_8h_html"><div class="ttname"><a href="Map_8h.html">Map.h</a></div></div>
<div class="ttc" id="aObjectAccessor_8h_html_a1ac403f083ed153106723d43e093bfff"><div class="ttname"><a href="ObjectAccessor_8h.html#a1ac403f083ed153106723d43e093bfff">sObjectAccessor</a></div><div class="ttdeci">#define sObjectAccessor</div><div class="ttdef"><b>Definition:</b> <a href="ObjectAccessor_8h_source.html#l00142">ObjectAccessor.h:142</a></div></div>
<div class="ttc" id="aObjectGuid_8h_html_abe8666ac87665ba963053cdd2b014750ac30cd6a15de9e7763b2bcea91be46eb3"><div class="ttname"><a href="ObjectGuid_8h.html#abe8666ac87665ba963053cdd2b014750ac30cd6a15de9e7763b2bcea91be46eb3">HIGHGUID_PLAYER</a></div><div class="ttdeci">@ HIGHGUID_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00063">ObjectGuid.h:63</a></div></div>
<div class="ttc" id="aObjectMgr_8h_html"><div class="ttname"><a href="ObjectMgr_8h.html">ObjectMgr.h</a></div></div>
<div class="ttc" id="aObjectMgr_8h_html_a736e30da2b5261060ac6cdbb5de3b787"><div class="ttname"><a href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a></div><div class="ttdeci">#define sObjectMgr</div><div class="ttdef"><b>Definition:</b> <a href="ObjectMgr_8h_source.html#l01464">ObjectMgr.h:1464</a></div></div>
<div class="ttc" id="aPlayer_8h_html"><div class="ttname"><a href="Player_8h.html">Player.h</a></div></div>
<div class="ttc" id="aProgressBar_8h_html"><div class="ttname"><a href="ProgressBar_8h.html">ProgressBar.h</a></div></div>
<div class="ttc" id="aSQLStorages_8cpp_html_a0ec65b3e31a5da3aa9d4def398f4ad10"><div class="ttname"><a href="SQLStorages_8cpp.html#a0ec65b3e31a5da3aa9d4def398f4ad10">sWorldSafeLocsStore</a></div><div class="ttdeci">SQLStorage sWorldSafeLocsStore(WorldSafeLocsFmt, &quot;id&quot;, &quot;world_safe_locs&quot;)</div></div>
<div class="ttc" id="aSharedDefines_8h_html"><div class="ttname"><a href="SharedDefines_8h.html">SharedDefines.h</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0c78c396b19cfdde4d264131d7ecb787"><div class="ttname"><a href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787">ArenaType</a></div><div class="ttdeci">ArenaType</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02090">SharedDefines.h:2091</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b"><div class="ttname"><a href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a3abb94c265144c09e0e8d4cd4f56557b">ARENA_TYPE_NONE</a></div><div class="ttdeci">@ ARENA_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02092">SharedDefines.h:2092</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0c78c396b19cfdde4d264131d7ecb787a49cde50538e418258d292c3c2f7df512"><div class="ttname"><a href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787a49cde50538e418258d292c3c2f7df512">ARENA_TYPE_5v5</a></div><div class="ttdeci">@ ARENA_TYPE_5v5</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02096">SharedDefines.h:2095</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0c78c396b19cfdde4d264131d7ecb787aa98d0a1c6432cd3013d20e83937726be"><div class="ttname"><a href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aa98d0a1c6432cd3013d20e83937726be">ARENA_TYPE_3v3</a></div><div class="ttdeci">@ ARENA_TYPE_3v3</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02094">SharedDefines.h:2094</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0c78c396b19cfdde4d264131d7ecb787aba8dd9984d50b5a179ebf2dec66d8c01"><div class="ttname"><a href="SharedDefines_8h.html#a0c78c396b19cfdde4d264131d7ecb787aba8dd9984d50b5a179ebf2dec66d8c01">ARENA_TYPE_2v2</a></div><div class="ttdeci">@ ARENA_TYPE_2v2</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02093">SharedDefines.h:2093</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9be"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9be">BattleGroundTypeId</a></div><div class="ttdeci">BattleGroundTypeId</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02071">SharedDefines.h:2072</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea0bbe26d588c3dbd56c898f29589caabf">BATTLEGROUND_IC</a></div><div class="ttdeci">@ BATTLEGROUND_IC</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02085">SharedDefines.h:2085</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea114f4c5470b31d1dfd7a63cb175ee6d1">BATTLEGROUND_AA</a></div><div class="ttdeci">@ BATTLEGROUND_AA</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02079">SharedDefines.h:2079</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea117184e14f6dd8735bfb869a017801ac">BATTLEGROUND_WS</a></div><div class="ttdeci">@ BATTLEGROUND_WS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02075">SharedDefines.h:2075</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea2a39aa0c545f62059a6d02bed55cd185">BATTLEGROUND_EY</a></div><div class="ttdeci">@ BATTLEGROUND_EY</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02080">SharedDefines.h:2080</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea31595c32354087d7dff5c08e291c2a9c">BATTLEGROUND_AV</a></div><div class="ttdeci">@ BATTLEGROUND_AV</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02074">SharedDefines.h:2074</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea35deca0cfa55a395a03288d6124dcd6e">BATTLEGROUND_BE</a></div><div class="ttdeci">@ BATTLEGROUND_BE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02078">SharedDefines.h:2078</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea82612bfec8fc545e3dad4c220abcded5">BATTLEGROUND_RV</a></div><div class="ttdeci">@ BATTLEGROUND_RV</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02084">SharedDefines.h:2084</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea8748942e38a5e4140daf8e10cb08f0c7"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8748942e38a5e4140daf8e10cb08f0c7">BATTLEGROUND_TYPE_NONE</a></div><div class="ttdeci">@ BATTLEGROUND_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02073">SharedDefines.h:2073</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bea8ccad7cdcbecb335e9e70e42a7b2ca09">BATTLEGROUND_NA</a></div><div class="ttdeci">@ BATTLEGROUND_NA</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02077">SharedDefines.h:2077</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beaa95254a62f3cfc9b9f50b077a0e4eecc">BATTLEGROUND_DS</a></div><div class="ttdeci">@ BATTLEGROUND_DS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02083">SharedDefines.h:2083</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beac86b2f76ec73f994a93e5b74eabb75ab">BATTLEGROUND_SA</a></div><div class="ttdeci">@ BATTLEGROUND_SA</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02082">SharedDefines.h:2082</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beacfb3cfbf4efce33f7dfe06964c79188d">BATTLEGROUND_AB</a></div><div class="ttdeci">@ BATTLEGROUND_AB</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02076">SharedDefines.h:2076</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9bead0217c97de424bee8bc929cfde0342cd">BATTLEGROUND_RL</a></div><div class="ttdeci">@ BATTLEGROUND_RL</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02081">SharedDefines.h:2081</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300"><div class="ttname"><a href="SharedDefines_8h.html#a32c9b230f35e9aeec12529ea1c1ab9beade253b1a8546a255cdccefa700b60300">BATTLEGROUND_RB</a></div><div class="ttdeci">@ BATTLEGROUND_RB</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02087">SharedDefines.h:2086</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a4c4967436a7df01cd2084d30a527a030"><div class="ttname"><a href="SharedDefines_8h.html#a4c4967436a7df01cd2084d30a527a030">PVP_TEAM_COUNT</a></div><div class="ttdeci">#define PVP_TEAM_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00361">SharedDefines.h:361</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a9c13bb5b1d69698f9b47900990eaa598"><div class="ttname"><a href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598">Team</a></div><div class="ttdeci">Team</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00338">SharedDefines.h:339</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2"><div class="ttname"><a href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a360acb47017e8e0d3522e08575f3d1b2">ALLIANCE</a></div><div class="ttdeci">@ ALLIANCE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00344">SharedDefines.h:344</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a9c13bb5b1d69698f9b47900990eaa598a66bbf321f9fe6b3387090eb97e230c68"><div class="ttname"><a href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598a66bbf321f9fe6b3387090eb97e230c68">TEAM_NONE</a></div><div class="ttdeci">@ TEAM_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00340">SharedDefines.h:340</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42"><div class="ttname"><a href="SharedDefines_8h.html#a9c13bb5b1d69698f9b47900990eaa598ae00f67931133b08b7de375111e800b42">HORDE</a></div><div class="ttdeci">@ HORDE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00343">SharedDefines.h:343</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_aaef27027c4c75a728cc6832f67fdde73"><div class="ttname"><a href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73">PvpTeamIndex</a></div><div class="ttdeci">PvpTeamIndex</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00354">SharedDefines.h:355</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a"><div class="ttname"><a href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73a1b041a7182855cdebe29c9d46caf7e3a">TEAM_INDEX_ALLIANCE</a></div><div class="ttdeci">@ TEAM_INDEX_ALLIANCE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00356">SharedDefines.h:356</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e"><div class="ttname"><a href="SharedDefines_8h.html#aaef27027c4c75a728cc6832f67fdde73aa37f1b5a8aa98e2f4a4cebd68094ac3e">TEAM_INDEX_HORDE</a></div><div class="ttdeci">@ TEAM_INDEX_HORDE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00357">SharedDefines.h:357</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1fab"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fab">HolidayIds</a></div><div class="ttdeci">HolidayIds</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01366">SharedDefines.h:1367</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1faba28168544ac4271e71835f87f564500f7"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba28168544ac4271e71835f87f564500f7">HOLIDAY_NONE</a></div><div class="ttdeci">@ HOLIDAY_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01368">SharedDefines.h:1368</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1faba2dcada3c496d660c03092485dcc5fc5f"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba2dcada3c496d660c03092485dcc5fc5f">HOLIDAY_CALL_TO_ARMS_AB</a></div><div class="ttdeci">@ HOLIDAY_CALL_TO_ARMS_AB</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01376">SharedDefines.h:1376</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1faba4f0c74a7c14f25e8cac6b0d50af23cb1"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba4f0c74a7c14f25e8cac6b0d50af23cb1">HOLIDAY_CALL_TO_ARMS_EY</a></div><div class="ttdeci">@ HOLIDAY_CALL_TO_ARMS_EY</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01382">SharedDefines.h:1382</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1faba5894a0869491c731cd87205e0133e66d"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1faba5894a0869491c731cd87205e0133e66d">HOLIDAY_CALL_TO_ARMS_SA</a></div><div class="ttdeci">@ HOLIDAY_CALL_TO_ARMS_SA</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01388">SharedDefines.h:1388</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1fabacba982d4cc559b10ff37422de708e7c4"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fabacba982d4cc559b10ff37422de708e7c4">HOLIDAY_CALL_TO_ARMS_AV</a></div><div class="ttdeci">@ HOLIDAY_CALL_TO_ARMS_AV</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01374">SharedDefines.h:1374</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad279224fea61f9754572051fc5ff1fabaf7277498797f3b74313598432e271afd"><div class="ttname"><a href="SharedDefines_8h.html#ad279224fea61f9754572051fc5ff1fabaf7277498797f3b74313598432e271afd">HOLIDAY_CALL_TO_ARMS_WS</a></div><div class="ttdeci">@ HOLIDAY_CALL_TO_ARMS_WS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01375">SharedDefines.h:1375</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad7f5fd5081848acc23f05d510d50dd96"><div class="ttname"><a href="SharedDefines_8h.html#ad7f5fd5081848acc23f05d510d50dd96">GetTeamIndexByTeamId</a></div><div class="ttdeci">static PvpTeamIndex GetTeamIndexByTeamId(Team team)</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00364">SharedDefines.h:364</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_add6e677d0cfd3f1eff02a4dd3b90b95c"><div class="ttname"><a href="SharedDefines_8h.html#add6e677d0cfd3f1eff02a4dd3b90b95c">MAX_BATTLEGROUND_TYPE_ID</a></div><div class="ttdeci">#define MAX_BATTLEGROUND_TYPE_ID</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02088">SharedDefines.h:2088</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ae00102953affc07f8aa49666d1b97c3c"><div class="ttname"><a href="SharedDefines_8h.html#ae00102953affc07f8aa49666d1b97c3c">PLAYER_MAX_BATTLEGROUND_QUEUES</a></div><div class="ttdeci">#define PLAYER_MAX_BATTLEGROUND_QUEUES</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00114">SharedDefines.h:114</a></div></div>
<div class="ttc" id="aSingleton_8h_html"><div class="ttname"><a href="Singleton_8h.html">Singleton.h</a></div></div>
<div class="ttc" id="aUtil_8cpp_html_a524fe58d98e273af8b0fc7729bcb51f7"><div class="ttname"><a href="Util_8cpp.html#a524fe58d98e273af8b0fc7729bcb51f7">StrSplit</a></div><div class="ttdeci">Tokens StrSplit(const std::string &amp;src, const std::string &amp;sep)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8cpp_source.html#l00122">Util.cpp:122</a></div></div>
<div class="ttc" id="aUtil_8cpp_html_ab17def34ccbbd868dc87a16bf35acdbd"><div class="ttname"><a href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a></div><div class="ttdeci">uint32 urand(uint32 min, uint32 max)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8cpp_source.html#l00074">Util.cpp:74</a></div></div>
<div class="ttc" id="aUtil_8h_html_aa816f7b7c0f08ceeecaf357e31b3a544"><div class="ttname"><a href="Util_8h.html#aa816f7b7c0f08ceeecaf357e31b3a544">Tokens</a></div><div class="ttdeci">std::vector&lt; std::string &gt; Tokens</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00028">Util.h:28</a></div></div>
<div class="ttc" id="aWorldPacket_8h_html"><div class="ttname"><a href="WorldPacket_8h.html">WorldPacket.h</a></div></div>
<div class="ttc" id="aWorld_8h_html"><div class="ttname"><a href="World_8h.html">World.h</a></div></div>
<div class="ttc" id="aclassArenaTeam_html"><div class="ttname"><a href="classArenaTeam.html">ArenaTeam</a></div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00116">ArenaTeam.h:117</a></div></div>
<div class="ttc" id="aclassArenaTeam_html_a2132399761d198722d1c1711a8266762"><div class="ttname"><a href="classArenaTeam.html#a2132399761d198722d1c1711a8266762">ArenaTeam::GetStats</a></div><div class="ttdeci">const ArenaTeamStats &amp; GetStats() const</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00133">ArenaTeam.h:133</a></div></div>
<div class="ttc" id="aclassArenaTeam_html_a2b26ff5371a9bb4f76cce0f6ab8f1fba"><div class="ttname"><a href="classArenaTeam.html#a2b26ff5371a9bb4f76cce0f6ab8f1fba">ArenaTeam::MemberLost</a></div><div class="ttdeci">void MemberLost(Player *plr, uint32 againstRating)</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8cpp_source.html#l00641">ArenaTeam.cpp:641</a></div></div>
<div class="ttc" id="aclassArenaTeam_html_a549becb60e18b88deaefbf498a7b23b5"><div class="ttname"><a href="classArenaTeam.html#a549becb60e18b88deaefbf498a7b23b5">ArenaTeam::SaveToDB</a></div><div class="ttdeci">void SaveToDB()</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8cpp_source.html#l00744">ArenaTeam.cpp:744</a></div></div>
<div class="ttc" id="aclassArenaTeam_html_a6258cada2d9eccaa0c1ee5785dc4c974"><div class="ttname"><a href="classArenaTeam.html#a6258cada2d9eccaa0c1ee5785dc4c974">ArenaTeam::GetMembers</a></div><div class="ttdeci">MemberList &amp; GetMembers()</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00152">ArenaTeam.h:152</a></div></div>
<div class="ttc" id="aclassArenaTeam_html_a6bf6796c43b39725f62ee1f7c6f77677"><div class="ttname"><a href="classArenaTeam.html#a6bf6796c43b39725f62ee1f7c6f77677">ArenaTeam::GetName</a></div><div class="ttdeci">std::string GetName() const</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00132">ArenaTeam.h:132</a></div></div>
<div class="ttc" id="aclassArenaTeam_html_a8d2ad09abaedf2ef7523b62680149f04"><div class="ttname"><a href="classArenaTeam.html#a8d2ad09abaedf2ef7523b62680149f04">ArenaTeam::OfflineMemberLost</a></div><div class="ttdeci">void OfflineMemberLost(ObjectGuid guid, uint32 againstRating)</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8cpp_source.html#l00665">ArenaTeam.cpp:665</a></div></div>
<div class="ttc" id="aclassBarGoLink_html"><div class="ttname"><a href="classBarGoLink.html">BarGoLink</a></div><div class="ttdef"><b>Definition:</b> <a href="ProgressBar_8h_source.html#l00024">ProgressBar.h:25</a></div></div>
<div class="ttc" id="aclassBarGoLink_html_af715390ed501b2c5da8e3db63bcdb479"><div class="ttname"><a href="classBarGoLink.html#af715390ed501b2c5da8e3db63bcdb479">BarGoLink::step</a></div><div class="ttdeci">void step()</div><div class="ttdef"><b>Definition:</b> <a href="ProgressBar_8cpp_source.html#l00071">ProgressBar.cpp:71</a></div></div>
<div class="ttc" id="aclassBattleGroundABScore_html"><div class="ttname"><a href="classBattleGroundABScore.html">BattleGroundABScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundAB_8h_source.html#l00238">BattleGroundAB.h:239</a></div></div>
<div class="ttc" id="aclassBattleGroundAB_html"><div class="ttname"><a href="classBattleGroundAB.html">BattleGroundAB</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundAB_8h_source.html#l00251">BattleGroundAB.h:252</a></div></div>
<div class="ttc" id="aclassBattleGroundAVScore_html"><div class="ttname"><a href="classBattleGroundAVScore.html">BattleGroundAVScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundAV_8h_source.html#l00601">BattleGroundAV.h:602</a></div></div>
<div class="ttc" id="aclassBattleGroundAV_html"><div class="ttname"><a href="classBattleGroundAV.html">BattleGroundAV</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundAV_8h_source.html#l00620">BattleGroundAV.h:621</a></div></div>
<div class="ttc" id="aclassBattleGroundBE_html"><div class="ttname"><a href="classBattleGroundBE.html">BattleGroundBE</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundBE_8h_source.html#l00023">BattleGroundBE.h:24</a></div></div>
<div class="ttc" id="aclassBattleGroundDS_html"><div class="ttname"><a href="classBattleGroundDS.html">BattleGroundDS</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundDS_8h_source.html#l00043">BattleGroundDS.h:44</a></div></div>
<div class="ttc" id="aclassBattleGroundEYScore_html"><div class="ttname"><a href="classBattleGroundEYScore.html">BattleGroundEYScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundEY_8h_source.html#l00285">BattleGroundEY.h:286</a></div></div>
<div class="ttc" id="aclassBattleGroundEY_html"><div class="ttname"><a href="classBattleGroundEY.html">BattleGroundEY</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundEY_8h_source.html#l00294">BattleGroundEY.h:295</a></div></div>
<div class="ttc" id="aclassBattleGroundICScore_html"><div class="ttname"><a href="classBattleGroundICScore.html">BattleGroundICScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundIC_8h_source.html#l00691">BattleGroundIC.h:692</a></div></div>
<div class="ttc" id="aclassBattleGroundIC_html"><div class="ttname"><a href="classBattleGroundIC.html">BattleGroundIC</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundIC_8h_source.html#l00704">BattleGroundIC.h:705</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html"><div class="ttname"><a href="classBattleGroundMgr.html">BattleGroundMgr</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00191">BattleGroundMgr.h:192</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a0c4dc70bd058c67d35cd51e596f06441"><div class="ttname"><a href="classBattleGroundMgr.html#a0c4dc70bd058c67d35cd51e596f06441">BattleGroundMgr::BuildPlaySoundPacket</a></div><div class="ttdeci">void BuildPlaySoundPacket(WorldPacket &amp;, uint32) const</div><div class="ttdoc">Send battleground sound packet.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01585">BattleGroundMgr.cpp:1585</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a116949aa8882c704a38602d8e2f2bebf"><div class="ttname"><a href="classBattleGroundMgr.html#a116949aa8882c704a38602d8e2f2bebf">BattleGroundMgr::SendToBattleGround</a></div><div class="ttdeci">void SendToBattleGround(Player *, uint32, BattleGroundTypeId)</div><div class="ttdoc">Method that sends player to battleground.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02438">BattleGroundMgr.cpp:2438</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a19ee65a0f3d7fe9aa2dccbd6870a950e"><div class="ttname"><a href="classBattleGroundMgr.html#a19ee65a0f3d7fe9aa2dccbd6870a950e">BattleGroundMgr::InitAutomaticArenaPointDistribution</a></div><div class="ttdeci">void InitAutomaticArenaPointDistribution()</div><div class="ttdoc">Method that initiates the automatic arena points distribution.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02024">BattleGroundMgr.cpp:2024</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a20f4f79328eb07cad2704f7b34fee010"><div class="ttname"><a href="classBattleGroundMgr.html#a20f4f79328eb07cad2704f7b34fee010">BattleGroundMgr::IsBgWeekend</a></div><div class="ttdeci">static bool IsBgWeekend(BattleGroundTypeId)</div><div class="ttdoc">Function that checks if it's an active battleground holiday weekend.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02745">BattleGroundMgr.cpp:2745</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a2258b732f69f6a6a54512b0a28d8b974"><div class="ttname"><a href="classBattleGroundMgr.html#a2258b732f69f6a6a54512b0a28d8b974">BattleGroundMgr::ScheduleQueueUpdate</a></div><div class="ttdeci">void ScheduleQueueUpdate(uint32, ArenaType, BattleGroundQueueTypeId, BattleGroundTypeId, BattleGroundBracketId)</div><div class="ttdoc">Method that schedules queue update.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02611">BattleGroundMgr.cpp:2611</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a232b7f62bf57513a77f1f9ae17ca862f"><div class="ttname"><a href="classBattleGroundMgr.html#a232b7f62bf57513a77f1f9ae17ca862f">BattleGroundMgr::m_nextAutoDistributionTime</a></div><div class="ttdeci">time_t m_nextAutoDistributionTime</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00305">BattleGroundMgr.h:305</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a25f1e316566e8e78d867ed6586b69da3"><div class="ttname"><a href="classBattleGroundMgr.html#a25f1e316566e8e78d867ed6586b69da3">BattleGroundMgr::AddBattleGround</a></div><div class="ttdeci">void AddBattleGround(uint32 instanceId, BattleGroundTypeId bgTypeId, BattleGround *bg)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00218">BattleGroundMgr.h:218</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a261d503c2fe3cf2a7edcd1d4c37e66f9"><div class="ttname"><a href="classBattleGroundMgr.html#a261d503c2fe3cf2a7edcd1d4c37e66f9">BattleGroundMgr::BuildPlayerJoinedBattleGroundPacket</a></div><div class="ttdeci">void BuildPlayerJoinedBattleGroundPacket(WorldPacket &amp;, Player *) const</div><div class="ttdoc">Send player join from battleground packet.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01609">BattleGroundMgr.cpp:1609</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a2626e64e4c8c5ebb515da8a94c5e6188"><div class="ttname"><a href="classBattleGroundMgr.html#a2626e64e4c8c5ebb515da8a94c5e6188">BattleGroundMgr::BgQueueTypeId</a></div><div class="ttdeci">static BattleGroundQueueTypeId BgQueueTypeId(BattleGroundTypeId, ArenaType)</div><div class="ttdoc">Function that returns the queue type for battleground type id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02486">BattleGroundMgr.cpp:2486</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a36d5b734fedd9a5959321c48004a3e70"><div class="ttname"><a href="classBattleGroundMgr.html#a36d5b734fedd9a5959321c48004a3e70">BattleGroundMgr::Update</a></div><div class="ttdeci">void Update(uint32)</div><div class="ttdoc">Update method.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01303">BattleGroundMgr.cpp:1303</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a37eec221fa4b0d79ca034f9790750363"><div class="ttname"><a href="classBattleGroundMgr.html#a37eec221fa4b0d79ca034f9790750363">BattleGroundMgr::CreateBattleGround</a></div><div class="ttdeci">uint32 CreateBattleGround(BattleGroundTypeId, bool, uint32, uint32, uint32, uint32, char const *, uint32, float, float, float, float, float, float, float, float, float, uint32)</div><div class="ttdoc">Function that creates battleground templates.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01848">BattleGroundMgr.cpp:1848</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a3a3bb90886fd82d7910a67a655b3e28a"><div class="ttname"><a href="classBattleGroundMgr.html#a3a3bb90886fd82d7910a67a655b3e28a">BattleGroundMgr::GetBattleGroundThroughClientInstance</a></div><div class="ttdeci">BattleGround * GetBattleGroundThroughClientInstance(uint32, BattleGroundTypeId)</div><div class="ttdoc">Function that returns battleground from client instance id and battleground type.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01621">BattleGroundMgr.cpp:1621</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a3d03a58137de7e085237a4327a9c7b31"><div class="ttname"><a href="classBattleGroundMgr.html#a3d03a58137de7e085237a4327a9c7b31">BattleGroundMgr::GetBattleGround</a></div><div class="ttdeci">BattleGround * GetBattleGround(uint32, BattleGroundTypeId)</div><div class="ttdoc">Function that returns battleground from instance id and battleground type.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01647">BattleGroundMgr.cpp:1647</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a3d9d5237b37f14e063fd7a1e1fc078f4"><div class="ttname"><a href="classBattleGroundMgr.html#a3d9d5237b37f14e063fd7a1e1fc078f4">BattleGroundMgr::m_queueUpdateScheduler</a></div><div class="ttdeci">std::vector&lt; uint64 &gt; m_queueUpdateScheduler</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00301">BattleGroundMgr.h:301</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a439b940dabbb39c17b6acec7075a937b"><div class="ttname"><a href="classBattleGroundMgr.html#a439b940dabbb39c17b6acec7075a937b">BattleGroundMgr::ToggleTesting</a></div><div class="ttdeci">void ToggleTesting()</div><div class="ttdoc">Method that toggles battleground test mode on / off.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02581">BattleGroundMgr.cpp:2581</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a4b2148f7acf0f7424cc8ff791a921951"><div class="ttname"><a href="classBattleGroundMgr.html#a4b2148f7acf0f7424cc8ff791a921951">BattleGroundMgr::ClientBattleGroundIdSet</a></div><div class="ttdeci">std::set&lt; uint32 &gt; ClientBattleGroundIdSet</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00302">BattleGroundMgr.h:302</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a586b5add4c230eb4dfea20c9234239e4"><div class="ttname"><a href="classBattleGroundMgr.html#a586b5add4c230eb4dfea20c9234239e4">BattleGroundMgr::CreateInitialBattleGrounds</a></div><div class="ttdeci">void CreateInitialBattleGrounds()</div><div class="ttdoc">Method that loads battleground data from DB.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01894">BattleGroundMgr.cpp:1894</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a669ae70091f8092ba8aa6c909e30d8f8"><div class="ttname"><a href="classBattleGroundMgr.html#a669ae70091f8092ba8aa6c909e30d8f8">BattleGroundMgr::IsArenaType</a></div><div class="ttdeci">static bool IsArenaType(BattleGroundTypeId)</div><div class="ttdoc">Function that returns the arena type.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02464">BattleGroundMgr.cpp:2464</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a70e546164aa1eaa7ad0dcf7215bc5520"><div class="ttname"><a href="classBattleGroundMgr.html#a70e546164aa1eaa7ad0dcf7215bc5520">BattleGroundMgr::m_battleMastersMap</a></div><div class="ttdeci">BattleMastersMap m_battleMastersMap</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00295">BattleGroundMgr.h:295</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a751661a870f7e55b2984128e27edefcc"><div class="ttname"><a href="classBattleGroundMgr.html#a751661a870f7e55b2984128e27edefcc">BattleGroundMgr::BuildBattleGroundListPacket</a></div><div class="ttdeci">void BuildBattleGroundListPacket(WorldPacket &amp;, ObjectGuid, Player *, BattleGroundTypeId, uint8) const</div><div class="ttdoc">Method that builds battleground list data.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02367">BattleGroundMgr.cpp:2367</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a78e36aa76d96e165a7b947d0df87e797"><div class="ttname"><a href="classBattleGroundMgr.html#a78e36aa76d96e165a7b947d0df87e797">BattleGroundMgr::m_arenaTesting</a></div><div class="ttdeci">bool m_arenaTesting</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00307">BattleGroundMgr.h:307</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a7da687f187053c09819549e9b58b2d2a"><div class="ttname"><a href="classBattleGroundMgr.html#a7da687f187053c09819549e9b58b2d2a">BattleGroundMgr::ResetAllArenaData</a></div><div class="ttdeci">void ResetAllArenaData()</div><div class="ttdoc">Method that resets all arena data.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02345">BattleGroundMgr.cpp:2345</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a7e70ac825ebbbd6e0cc4dbfa0bf126ce"><div class="ttname"><a href="classBattleGroundMgr.html#a7e70ac825ebbbd6e0cc4dbfa0bf126ce">BattleGroundMgr::LoadBattleEventIndexes</a></div><div class="ttdeci">void LoadBattleEventIndexes()</div><div class="ttdoc">Method that loads battleground events used in battleground scripts.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02753">BattleGroundMgr.cpp:2753</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a809ed86411a3d3e5ef983747590982bf"><div class="ttname"><a href="classBattleGroundMgr.html#a809ed86411a3d3e5ef983747590982bf">BattleGroundMgr::DistributeArenaPoints</a></div><div class="ttdeci">void DistributeArenaPoints() const</div><div class="ttdoc">Method that distributes the arena points distribution.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02080">BattleGroundMgr.cpp:2080</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a84956ee24f5a6642fe99fb1745f9c8b9"><div class="ttname"><a href="classBattleGroundMgr.html#a84956ee24f5a6642fe99fb1745f9c8b9">BattleGroundMgr::GetBattleGroundTemplate</a></div><div class="ttdeci">BattleGround * GetBattleGroundTemplate(BattleGroundTypeId)</div><div class="ttdoc">Function that returns battleground from template id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01671">BattleGroundMgr.cpp:1671</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a8c2aee4bdf49393a4d8fb24c88541aa1"><div class="ttname"><a href="classBattleGroundMgr.html#a8c2aee4bdf49393a4d8fb24c88541aa1">BattleGroundMgr::CreateNewBattleGround</a></div><div class="ttdeci">BattleGround * CreateNewBattleGround(BattleGroundTypeId, PvPDifficultyEntry const *, ArenaType, bool)</div><div class="ttdoc">Function that creates a new battleground that is actually used.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01716">BattleGroundMgr.cpp:1716</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a8dadadd0b5e6016a558f394a293fb205"><div class="ttname"><a href="classBattleGroundMgr.html#a8dadadd0b5e6016a558f394a293fb205">BattleGroundMgr::~BattleGroundMgr</a></div><div class="ttdeci">~BattleGroundMgr()</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01276">BattleGroundMgr.cpp:1276</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a8f4f56f5aea2a2c8f50d8a3e9c3b7931"><div class="ttname"><a href="classBattleGroundMgr.html#a8f4f56f5aea2a2c8f50d8a3e9c3b7931">BattleGroundMgr::ToggleArenaTesting</a></div><div class="ttdeci">void ToggleArenaTesting()</div><div class="ttdoc">Method that toggles arena test mode on / off.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02593">BattleGroundMgr.cpp:2593</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a9496486e3066cd0eb8a4cd399d3724a4"><div class="ttname"><a href="classBattleGroundMgr.html#a9496486e3066cd0eb8a4cd399d3724a4">BattleGroundMgr::BuildUpdateWorldStatePacket</a></div><div class="ttdeci">void BuildUpdateWorldStatePacket(WorldPacket &amp;, uint32, uint32) const</div><div class="ttdoc">Send battleground world state packet.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01572">BattleGroundMgr.cpp:1572</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_a99302a2a0e78a27b22ba192b70e3be21"><div class="ttname"><a href="classBattleGroundMgr.html#a99302a2a0e78a27b22ba192b70e3be21">BattleGroundMgr::BuildGroupJoinedBattlegroundPacket</a></div><div class="ttdeci">void BuildGroupJoinedBattlegroundPacket(WorldPacket &amp;, GroupJoinBattlegroundResult) const</div><div class="ttdoc">Send battleground joined packet.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01557">BattleGroundMgr.cpp:1557</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_aa0389afbe68b5c94779c02f8192c1f9e"><div class="ttname"><a href="classBattleGroundMgr.html#aa0389afbe68b5c94779c02f8192c1f9e">BattleGroundMgr::m_usedRefloot</a></div><div class="ttdeci">std::set&lt; uint32 &gt; m_usedRefloot</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00309">BattleGroundMgr.h:309</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_aa05d72771e50f0a581cf04fb031db0d2"><div class="ttname"><a href="classBattleGroundMgr.html#aa05d72771e50f0a581cf04fb031db0d2">BattleGroundMgr::DeleteAllBattleGrounds</a></div><div class="ttdeci">void DeleteAllBattleGrounds()</div><div class="ttdoc">Method that deletes all battlegrounds.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01284">BattleGroundMgr.cpp:1284</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_aa093ad05f391e79d11dd64b98b8b43da"><div class="ttname"><a href="classBattleGroundMgr.html#aa093ad05f391e79d11dd64b98b8b43da">BattleGroundMgr::BuildBattleGroundStatusPacket</a></div><div class="ttdeci">void BuildBattleGroundStatusPacket(WorldPacket &amp;, BattleGround *, uint8, uint8, uint32, uint32, ArenaType, Team) const</div><div class="ttdoc">Send battleground status update.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01379">BattleGroundMgr.cpp:1379</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_aa324ba8f05f6b2f8cd57f76045ee26d8"><div class="ttname"><a href="classBattleGroundMgr.html#aa324ba8f05f6b2f8cd57f76045ee26d8">BattleGroundMgr::m_testing</a></div><div class="ttdeci">bool m_testing</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00308">BattleGroundMgr.h:308</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_aa4dd9379ea4fbb04a68f9961a421be01"><div class="ttname"><a href="classBattleGroundMgr.html#aa4dd9379ea4fbb04a68f9961a421be01">BattleGroundMgr::CreateClientVisibleInstanceId</a></div><div class="ttdeci">uint32 CreateClientVisibleInstanceId(BattleGroundTypeId, BattleGroundBracketId)</div><div class="ttdoc">Function that returns client instance id from battleground type id and bracket id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01683">BattleGroundMgr.cpp:1683</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ab0231742951817cb1e50bf084a2c6b5a"><div class="ttname"><a href="classBattleGroundMgr.html#ab0231742951817cb1e50bf084a2c6b5a">BattleGroundMgr::WeekendHolidayIdToBgType</a></div><div class="ttdeci">static BattleGroundTypeId WeekendHolidayIdToBgType(HolidayIds)</div><div class="ttdoc">Function that returns the battleground type id from holiday id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02727">BattleGroundMgr.cpp:2727</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ab0519f7609403fe2264128a949a545e5"><div class="ttname"><a href="classBattleGroundMgr.html#ab0519f7609403fe2264128a949a545e5">BattleGroundMgr::m_battleGrounds</a></div><div class="ttdeci">BattleGroundSet m_battleGrounds[MAX_BATTLEGROUND_TYPE_ID]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00300">BattleGroundMgr.h:300</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ab36bb5c81b3f2ac36804cc97b3849555"><div class="ttname"><a href="classBattleGroundMgr.html#ab36bb5c81b3f2ac36804cc97b3849555">BattleGroundMgr::m_nextRatingDiscardUpdate</a></div><div class="ttdeci">uint32 m_nextRatingDiscardUpdate</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00304">BattleGroundMgr.h:304</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_abaa0819870ac4863dfa3955d3c50e6da"><div class="ttname"><a href="classBattleGroundMgr.html#abaa0819870ac4863dfa3955d3c50e6da">BattleGroundMgr::m_battleGroundQueues</a></div><div class="ttdeci">BattleGroundQueue m_battleGroundQueues[MAX_BATTLEGROUND_QUEUE_TYPES]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00234">BattleGroundMgr.h:234</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_abc567ce2925d53bd76c69bde8558562c"><div class="ttname"><a href="classBattleGroundMgr.html#abc567ce2925d53bd76c69bde8558562c">BattleGroundMgr::GetPrematureFinishTime</a></div><div class="ttdeci">uint32 GetPrematureFinishTime() const</div><div class="ttdoc">Function that returns the premature finish time.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02652">BattleGroundMgr.cpp:2652</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_abc91ce77c40c3cf340054f6c277db051"><div class="ttname"><a href="classBattleGroundMgr.html#abc91ce77c40c3cf340054f6c277db051">BattleGroundMgr::LoadBattleMastersEntry</a></div><div class="ttdeci">void LoadBattleMastersEntry()</div><div class="ttdoc">Method that loads battlemaster entries from DB.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02660">BattleGroundMgr.cpp:2660</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_abd238d9c4b982cf368d9875401e014c6"><div class="ttname"><a href="classBattleGroundMgr.html#abd238d9c4b982cf368d9875401e014c6">BattleGroundMgr::m_clientBattleGroundIds</a></div><div class="ttdeci">ClientBattleGroundIdSet m_clientBattleGroundIds[MAX_BATTLEGROUND_TYPE_ID][MAX_BATTLEGROUND_BRACKETS]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00303">BattleGroundMgr.h:303</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_abdb3b6204cf0919b80ec7ab29fd3f59e"><div class="ttname"><a href="classBattleGroundMgr.html#abdb3b6204cf0919b80ec7ab29fd3f59e">BattleGroundMgr::m_gameObjectBattleEventIndexMap</a></div><div class="ttdeci">GameObjectBattleEventIndexesMap m_gameObjectBattleEventIndexMap</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00297">BattleGroundMgr.h:297</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ac110e0874220491573831772ee6489eb"><div class="ttname"><a href="classBattleGroundMgr.html#ac110e0874220491573831772ee6489eb">BattleGroundMgr::GetRatingDiscardTimer</a></div><div class="ttdeci">uint32 GetRatingDiscardTimer() const</div><div class="ttdoc">Function that returns the arena rating discard timer.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02644">BattleGroundMgr.cpp:2644</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_accca20f2f5911050839113eb74dd7c81"><div class="ttname"><a href="classBattleGroundMgr.html#accca20f2f5911050839113eb74dd7c81">BattleGroundMgr::BuildPvpLogDataPacket</a></div><div class="ttdeci">void BuildPvpLogDataPacket(WorldPacket &amp;, BattleGround *) const</div><div class="ttdoc">Send battleground log update.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01433">BattleGroundMgr.cpp:1433</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ad26b90f8ea503b81a8e1af2434160ec1"><div class="ttname"><a href="classBattleGroundMgr.html#ad26b90f8ea503b81a8e1af2434160ec1">BattleGroundMgr::m_autoDistributionTimeChecker</a></div><div class="ttdeci">uint32 m_autoDistributionTimeChecker</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00306">BattleGroundMgr.h:306</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ad40d2889a679f4ed9faed31e1be3fc01"><div class="ttname"><a href="classBattleGroundMgr.html#ad40d2889a679f4ed9faed31e1be3fc01">BattleGroundMgr::BgArenaType</a></div><div class="ttdeci">static ArenaType BgArenaType(BattleGroundQueueTypeId)</div><div class="ttdoc">Function that returns the arena type from battleground queue id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02563">BattleGroundMgr.cpp:2563</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ad6aeae5632d2ae0ba6b3cb45dbabcb41"><div class="ttname"><a href="classBattleGroundMgr.html#ad6aeae5632d2ae0ba6b3cb45dbabcb41">BattleGroundMgr::m_creatureBattleEventIndexMap</a></div><div class="ttdeci">CreatureBattleEventIndexesMap m_creatureBattleEventIndexMap</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00296">BattleGroundMgr.h:296</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ae4041f739e64d134313b327e6f73d899"><div class="ttname"><a href="classBattleGroundMgr.html#ae4041f739e64d134313b327e6f73d899">BattleGroundMgr::BgTemplateId</a></div><div class="ttdeci">static BattleGroundTypeId BgTemplateId(BattleGroundQueueTypeId)</div><div class="ttdoc">Function that returns the battleground type id from battleground queue id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02531">BattleGroundMgr.cpp:2531</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ae473aebdab220c3b788127c8108ad62b"><div class="ttname"><a href="classBattleGroundMgr.html#ae473aebdab220c3b788127c8108ad62b">BattleGroundMgr::GetMaxRatingDifference</a></div><div class="ttdeci">uint32 GetMaxRatingDifference() const</div><div class="ttdoc">Function that returns max arena rating difference.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02632">BattleGroundMgr.cpp:2632</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_ae7d08202c53b50d58221160e99a27c9f"><div class="ttname"><a href="classBattleGroundMgr.html#ae7d08202c53b50d58221160e99a27c9f">BattleGroundMgr::BattleGroundMgr</a></div><div class="ttdeci">BattleGroundMgr()</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01268">BattleGroundMgr.cpp:1268</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_af70713ed455320190b384670ff27f6d2"><div class="ttname"><a href="classBattleGroundMgr.html#af70713ed455320190b384670ff27f6d2">BattleGroundMgr::RewardArenaSeason</a></div><div class="ttdeci">void RewardArenaSeason(uint32)</div><div class="ttdoc">Method that computes arena season rewards.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02181">BattleGroundMgr.cpp:2181</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_af8014b786d2f0fbb24161bc9eeac784e"><div class="ttname"><a href="classBattleGroundMgr.html#af8014b786d2f0fbb24161bc9eeac784e">BattleGroundMgr::BgTypeToWeekendHolidayId</a></div><div class="ttdeci">static HolidayIds BgTypeToWeekendHolidayId(BattleGroundTypeId)</div><div class="ttdoc">Function that returns the holiday id from battleground type id.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l02709">BattleGroundMgr.cpp:2709</a></div></div>
<div class="ttc" id="aclassBattleGroundMgr_html_afa1e255be00efde32b18b8808c032d35"><div class="ttname"><a href="classBattleGroundMgr.html#afa1e255be00efde32b18b8808c032d35">BattleGroundMgr::BuildPlayerLeftBattleGroundPacket</a></div><div class="ttdeci">void BuildPlayerLeftBattleGroundPacket(WorldPacket &amp;, ObjectGuid) const</div><div class="ttdoc">Send player leave from battleground packet.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01597">BattleGroundMgr.cpp:1597</a></div></div>
<div class="ttc" id="aclassBattleGroundNA_html"><div class="ttname"><a href="classBattleGroundNA.html">BattleGroundNA</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundNA_8h_source.html#l00023">BattleGroundNA.h:24</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_1_1SelectionPool_html_a2707c4cbec26004d6f2af942e54c2bb3"><div class="ttname"><a href="classBattleGroundQueue_1_1SelectionPool.html#a2707c4cbec26004d6f2af942e54c2bb3">BattleGroundQueue::SelectionPool::GetPlayerCount</a></div><div class="ttdeci">uint32 GetPlayerCount() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00126">BattleGroundMgr.h:126</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_1_1SelectionPool_html_a567436725c2f1316b54b03595a5c87b4"><div class="ttname"><a href="classBattleGroundQueue_1_1SelectionPool.html#a567436725c2f1316b54b03595a5c87b4">BattleGroundQueue::SelectionPool::KickGroup</a></div><div class="ttdeci">bool KickGroup(uint32 size)</div><div class="ttdoc">Function that removes group infr from pool selection.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00104">BattleGroundMgr.cpp:104</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_1_1SelectionPool_html_a6f3de8af6445a0f41eae7093b6523ce8"><div class="ttname"><a href="classBattleGroundQueue_1_1SelectionPool.html#a6f3de8af6445a0f41eae7093b6523ce8">BattleGroundQueue::SelectionPool::selectedGroups</a></div><div class="ttdeci">GroupsQueueType selectedGroups</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00127">BattleGroundMgr.h:127</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_1_1SelectionPool_html_a75ce642803080be318617b2346afffbb"><div class="ttname"><a href="classBattleGroundQueue_1_1SelectionPool.html#a75ce642803080be318617b2346afffbb">BattleGroundQueue::SelectionPool::Init</a></div><div class="ttdeci">void Init()</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00090">BattleGroundMgr.cpp:90</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_1_1SelectionPool_html_ac0da40d743fb0f392e779f7d74efa796"><div class="ttname"><a href="classBattleGroundQueue_1_1SelectionPool.html#ac0da40d743fb0f392e779f7d74efa796">BattleGroundQueue::SelectionPool::playerCount</a></div><div class="ttdeci">uint32 playerCount</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00129">BattleGroundMgr.h:129</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_1_1SelectionPool_html_ae64b50b90e25b38fd603b3cb5b5d5d90"><div class="ttname"><a href="classBattleGroundQueue_1_1SelectionPool.html#ae64b50b90e25b38fd603b3cb5b5d5d90">BattleGroundQueue::SelectionPool::AddGroup</a></div><div class="ttdeci">bool AddGroup(GroupQueueInfo *ginfo, uint32 desiredCount, uint32 bgInstanceId)</div><div class="ttdoc">Function that adds group to selection pool.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00144">BattleGroundMgr.cpp:144</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html"><div class="ttname"><a href="classBattleGroundQueue.html">BattleGroundQueue</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00078">BattleGroundMgr.h:79</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a0be1825f0fe29ecdc439525ad9ee6ef9"><div class="ttname"><a href="classBattleGroundQueue.html#a0be1825f0fe29ecdc439525ad9ee6ef9">BattleGroundQueue::CheckNormalMatch</a></div><div class="ttdeci">bool CheckNormalMatch(BattleGround *, BattleGroundBracketId, uint32, uint32)</div><div class="ttdoc">Method that tries to create battleground or arena with minPlayersPerTeam against maxPlayersPerTeam.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00743">BattleGroundMgr.cpp:743</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a101e4b94f69ef76275db4eec15bdb58e"><div class="ttname"><a href="classBattleGroundQueue.html#a101e4b94f69ef76275db4eec15bdb58e">BattleGroundQueue::AddGroup</a></div><div class="ttdeci">GroupQueueInfo * AddGroup(Player *, Group *, BattleGroundTypeId, PvPDifficultyEntry const *, ArenaType, bool, bool, uint32, uint32, uint32 arenaTeamId=0)</div><div class="ttdoc">Function that adds group or player (grp == nullptr) to battleground queue with the given leader and s...</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00178">BattleGroundMgr.cpp:178</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a1255a24104fcc3636463b07dee12ee27"><div class="ttname"><a href="classBattleGroundQueue.html#a1255a24104fcc3636463b07dee12ee27">BattleGroundQueue::m_waitTimeLastPlayer</a></div><div class="ttdeci">uint32 m_waitTimeLastPlayer[PVP_TEAM_COUNT][MAX_BATTLEGROUND_BRACKETS]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00138">BattleGroundMgr.h:138</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a220dc1527cfe4c1f362b373b2cd3de3a"><div class="ttname"><a href="classBattleGroundQueue.html#a220dc1527cfe4c1f362b373b2cd3de3a">BattleGroundQueue::m_waitTimes</a></div><div class="ttdeci">uint32 m_waitTimes[PVP_TEAM_COUNT][MAX_BATTLEGROUND_BRACKETS][COUNT_OF_PLAYERS_TO_AVERAGE_WAIT_TIME]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00137">BattleGroundMgr.h:137</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a5fe6153dbc84016dc15f149fb9826314"><div class="ttname"><a href="classBattleGroundQueue.html#a5fe6153dbc84016dc15f149fb9826314">BattleGroundQueue::m_sumOfWaitTimes</a></div><div class="ttdeci">uint32 m_sumOfWaitTimes[PVP_TEAM_COUNT][MAX_BATTLEGROUND_BRACKETS]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00139">BattleGroundMgr.h:139</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a66bc6553872e49dd56133fda5a94c575"><div class="ttname"><a href="classBattleGroundQueue.html#a66bc6553872e49dd56133fda5a94c575">BattleGroundQueue::RemovePlayer</a></div><div class="ttdeci">void RemovePlayer(ObjectGuid, bool)</div><div class="ttdoc">Method that removes player from queue and from group info, if group info is empty then remove it too.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00352">BattleGroundMgr.cpp:352</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a73a0ef682508d3cfd13e2dc3e685b169"><div class="ttname"><a href="classBattleGroundQueue.html#a73a0ef682508d3cfd13e2dc3e685b169">BattleGroundQueue::CheckPremadeMatch</a></div><div class="ttdeci">bool CheckPremadeMatch(BattleGroundBracketId, uint32, uint32)</div><div class="ttdoc">Method that checks if (premade vs premade) battlegrouns is possible.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00675">BattleGroundMgr.cpp:675</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a74cb1a78fa60d7a870e4a1a2e2380866"><div class="ttname"><a href="classBattleGroundQueue.html#a74cb1a78fa60d7a870e4a1a2e2380866">BattleGroundQueue::IsPlayerInvited</a></div><div class="ttdeci">bool IsPlayerInvited(ObjectGuid, const uint32, const uint32)</div><div class="ttdoc">Function that returns true when player is in queue and is invited to bgInstanceGuid.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00483">BattleGroundMgr.cpp:483</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a85f386312cd712dd9e05f6d6f4360e46"><div class="ttname"><a href="classBattleGroundQueue.html#a85f386312cd712dd9e05f6d6f4360e46">BattleGroundQueue::PlayerInvitedToBgUpdateAverageWaitTime</a></div><div class="ttdeci">void PlayerInvitedToBgUpdateAverageWaitTime(GroupQueueInfo *, BattleGroundBracketId)</div><div class="ttdoc">Method that updates average update wait time.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00285">BattleGroundMgr.cpp:285</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a8eb51f824e6d65b6567388317038db67"><div class="ttname"><a href="classBattleGroundQueue.html#a8eb51f824e6d65b6567388317038db67">BattleGroundQueue::BattleGroundQueue</a></div><div class="ttdeci">BattleGroundQueue()</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00055">BattleGroundMgr.cpp:55</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_a9d1e8f8d38dd46f0a8051fc476831101"><div class="ttname"><a href="classBattleGroundQueue.html#a9d1e8f8d38dd46f0a8051fc476831101">BattleGroundQueue::m_selectionPools</a></div><div class="ttdeci">SelectionPool m_selectionPools[PVP_TEAM_COUNT]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00133">BattleGroundMgr.h:133</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_aaad0b13ecd75f91d2f80302d2d5d6644"><div class="ttname"><a href="classBattleGroundQueue.html#aaad0b13ecd75f91d2f80302d2d5d6644">BattleGroundQueue::GetAverageQueueWaitTime</a></div><div class="ttdeci">uint32 GetAverageQueueWaitTime(GroupQueueInfo *, BattleGroundBracketId)</div><div class="ttdoc">Function that returns averate queue wait time.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00324">BattleGroundMgr.cpp:324</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_aaf5160586cb7cd490a6e67b2705a5a07"><div class="ttname"><a href="classBattleGroundQueue.html#aaf5160586cb7cd490a6e67b2705a5a07">BattleGroundQueue::m_queuedGroups</a></div><div class="ttdeci">GroupsQueueType m_queuedGroups[MAX_BATTLEGROUND_BRACKETS][BG_QUEUE_GROUP_TYPES_COUNT]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00116">BattleGroundMgr.h:116</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_ace4e82d788dc6ba44b32804a006b6e2c"><div class="ttname"><a href="classBattleGroundQueue.html#ace4e82d788dc6ba44b32804a006b6e2c">BattleGroundQueue::~BattleGroundQueue</a></div><div class="ttdeci">~BattleGroundQueue()</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00070">BattleGroundMgr.cpp:70</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_ace7dd1fbaee6e506eebbcec071225e61"><div class="ttname"><a href="classBattleGroundQueue.html#ace7dd1fbaee6e506eebbcec071225e61">BattleGroundQueue::FillPlayersToBg</a></div><div class="ttdeci">void FillPlayersToBg(BattleGround *, BattleGroundBracketId)</div><div class="ttdoc">Method that invites players to an already running battleground.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00589">BattleGroundMgr.cpp:589</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_ad75c02c80265e8d4ee67cadf62d60959"><div class="ttname"><a href="classBattleGroundQueue.html#ad75c02c80265e8d4ee67cadf62d60959">BattleGroundQueue::CheckSkirmishForSameFaction</a></div><div class="ttdeci">bool CheckSkirmishForSameFaction(BattleGroundBracketId, uint32)</div><div class="ttdoc">Method that will check if we can invite players to same faction skirmish match.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00795">BattleGroundMgr.cpp:795</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_adb6bb5a46dfb75d1723b4ccbc1d2bd8e"><div class="ttname"><a href="classBattleGroundQueue.html#adb6bb5a46dfb75d1723b4ccbc1d2bd8e">BattleGroundQueue::InviteGroupToBg</a></div><div class="ttdeci">bool InviteGroupToBg(GroupQueueInfo *, BattleGround *, Team)</div><div class="ttdoc">Function that invites group to battleground.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00517">BattleGroundMgr.cpp:517</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_aea14887d570348f613f562492e60a755"><div class="ttname"><a href="classBattleGroundQueue.html#aea14887d570348f613f562492e60a755">BattleGroundQueue::GetPlayerGroupInfoData</a></div><div class="ttdeci">bool GetPlayerGroupInfoData(ObjectGuid, GroupQueueInfo *)</div><div class="ttdoc">Function that returns player group info data.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00499">BattleGroundMgr.cpp:499</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_af008c33f7d1faa079482f92bba977834"><div class="ttname"><a href="classBattleGroundQueue.html#af008c33f7d1faa079482f92bba977834">BattleGroundQueue::m_queuedPlayers</a></div><div class="ttdeci">QueuedPlayersMap m_queuedPlayers</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00102">BattleGroundMgr.h:102</a></div></div>
<div class="ttc" id="aclassBattleGroundQueue_html_af7b20fca70ffededaf59d29df058a6c7"><div class="ttname"><a href="classBattleGroundQueue.html#af7b20fca70ffededaf59d29df058a6c7">BattleGroundQueue::Update</a></div><div class="ttdeci">void Update(BattleGroundTypeId, BattleGroundBracketId, ArenaType arenaType=ARENA_TYPE_NONE, bool isRated=false, uint32 arenaRating=0)</div><div class="ttdoc">Method that is called when group is inserted, or player / group is removed from BG Queue - there is o...</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l00872">BattleGroundMgr.cpp:872</a></div></div>
<div class="ttc" id="aclassBattleGroundRL_html"><div class="ttname"><a href="classBattleGroundRL.html">BattleGroundRL</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundRL_8h_source.html#l00023">BattleGroundRL.h:24</a></div></div>
<div class="ttc" id="aclassBattleGroundRV_html"><div class="ttname"><a href="classBattleGroundRV.html">BattleGroundRV</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundRV_8h_source.html#l00054">BattleGroundRV.h:55</a></div></div>
<div class="ttc" id="aclassBattleGroundSAScore_html"><div class="ttname"><a href="classBattleGroundSAScore.html">BattleGroundSAScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundSA_8h_source.html#l00344">BattleGroundSA.h:345</a></div></div>
<div class="ttc" id="aclassBattleGroundSA_html"><div class="ttname"><a href="classBattleGroundSA.html">BattleGroundSA</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundSA_8h_source.html#l00357">BattleGroundSA.h:358</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html"><div class="ttname"><a href="classBattleGroundScore.html">BattleGroundScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00296">BattleGround.h:297</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html_a5913069e620539c59880fe1ffc65c372"><div class="ttname"><a href="classBattleGroundScore.html#a5913069e620539c59880fe1ffc65c372">BattleGroundScore::damageDone</a></div><div class="ttdeci">uint32 damageDone</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00321">BattleGround.h:321</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html_a76cd7869c5ecd95e263adaf3b08cce0d"><div class="ttname"><a href="classBattleGroundScore.html#a76cd7869c5ecd95e263adaf3b08cce0d">BattleGroundScore::deaths</a></div><div class="ttdeci">uint32 deaths</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00318">BattleGround.h:318</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html_a88de911478192716adeb7bbba9640636"><div class="ttname"><a href="classBattleGroundScore.html#a88de911478192716adeb7bbba9640636">BattleGroundScore::healingDone</a></div><div class="ttdeci">uint32 healingDone</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00322">BattleGround.h:322</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html_a8d2f7d7a6b515596ce4a92635cfe5d68"><div class="ttname"><a href="classBattleGroundScore.html#a8d2f7d7a6b515596ce4a92635cfe5d68">BattleGroundScore::bonusHonor</a></div><div class="ttdeci">uint32 bonusHonor</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00320">BattleGround.h:320</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html_a9399d364334990250f22938e545065d8"><div class="ttname"><a href="classBattleGroundScore.html#a9399d364334990250f22938e545065d8">BattleGroundScore::killingBlows</a></div><div class="ttdeci">uint32 killingBlows</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00317">BattleGround.h:317</a></div></div>
<div class="ttc" id="aclassBattleGroundScore_html_ae9040175a753866df505d1fa11c6f353"><div class="ttname"><a href="classBattleGroundScore.html#ae9040175a753866df505d1fa11c6f353">BattleGroundScore::honorableKills</a></div><div class="ttdeci">uint32 honorableKills</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00319">BattleGround.h:319</a></div></div>
<div class="ttc" id="aclassBattleGroundWGScore_html"><div class="ttname"><a href="classBattleGroundWGScore.html">BattleGroundWGScore</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundWS_8h_source.html#l00199">BattleGroundWS.h:200</a></div></div>
<div class="ttc" id="aclassBattleGroundWS_html"><div class="ttname"><a href="classBattleGroundWS.html">BattleGroundWS</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundWS_8h_source.html#l00212">BattleGroundWS.h:213</a></div></div>
<div class="ttc" id="aclassBattleGround_html"><div class="ttname"><a href="classBattleGround.html">BattleGround</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00334">BattleGround.h:335</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a045e4dd53abe44038888108e8a4b5aec"><div class="ttname"><a href="classBattleGround.html#a045e4dd53abe44038888108e8a4b5aec">BattleGround::IncreaseInvitedCount</a></div><div class="ttdeci">void IncreaseInvitedCount(Team team)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00409">BattleGround.h:409</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a079219992af20076d06d9453cc049a25"><div class="ttname"><a href="classBattleGround.html#a079219992af20076d06d9453cc049a25">BattleGround::SetBracket</a></div><div class="ttdeci">void SetBracket(PvPDifficultyEntry const *bracketEntry)</div><div class="ttdoc">Method that sets the battleground bracket.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l02356">BattleGround.cpp:2356</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a0d03e64051f46948fba2dd8f90b2742b"><div class="ttname"><a href="classBattleGround.html#a0d03e64051f46948fba2dd8f90b2742b">BattleGround::SetStartMaxDist</a></div><div class="ttdeci">void SetStartMaxDist(float startMaxDist)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00466">BattleGround.h:466</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a16d50f6f034ab259d61ca71305020a93"><div class="ttname"><a href="classBattleGround.html#a16d50f6f034ab259d61ca71305020a93">BattleGround::GetTeamStartLoc</a></div><div class="ttdeci">void GetTeamStartLoc(Team team, float &amp;x, float &amp;y, float &amp;z, float &amp;o) const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00457">BattleGround.h:457</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a18317f163274ee46b43d3ebbaec5bfde"><div class="ttname"><a href="classBattleGround.html#a18317f163274ee46b43d3ebbaec5bfde">BattleGround::SetPlayerSkinRefLootId</a></div><div class="ttdeci">void SetPlayerSkinRefLootId(uint32 reflootId)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00673">BattleGround.h:673</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a252b10c72b1a28b0534db1c4cbd55829"><div class="ttname"><a href="classBattleGround.html#a252b10c72b1a28b0534db1c4cbd55829">BattleGround::GetStatus</a></div><div class="ttdeci">BattleGroundStatus GetStatus() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00359">BattleGround.h:359</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a2724ec2c0ee6fed5f53fab5346274804"><div class="ttname"><a href="classBattleGround.html#a2724ec2c0ee6fed5f53fab5346274804">BattleGround::SetArenaTeamIdForTeam</a></div><div class="ttdeci">void SetArenaTeamIdForTeam(Team team, uint32 arenaTeamId)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00549">BattleGround.h:549</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a280ed4b0edce428eed83af0497f76930"><div class="ttname"><a href="classBattleGround.html#a280ed4b0edce428eed83af0497f76930">BattleGround::RemoveFromBgFreeSlotQueue</a></div><div class="ttdeci">void RemoveFromBgFreeSlotQueue()</div><div class="ttdoc">Method that removes this battleground from free queue - it must be called when deleting battleground.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l01726">BattleGround.cpp:1726</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a31cbe1ab6942f9b3d4199ea5918d49f7"><div class="ttname"><a href="classBattleGround.html#a31cbe1ab6942f9b3d4199ea5918d49f7">BattleGround::GetMaxPlayersPerTeam</a></div><div class="ttdeci">uint32 GetMaxPlayersPerTeam() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00369">BattleGround.h:369</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a3aba04c3d95385da614a95dce62ec48e"><div class="ttname"><a href="classBattleGround.html#a3aba04c3d95385da614a95dce62ec48e">BattleGround::GetMapId</a></div><div class="ttdeci">uint32 GetMapId() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00445">BattleGround.h:445</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a3c2b4629969b3c55a02918ee9cb3aa1d"><div class="ttname"><a href="classBattleGround.html#a3c2b4629969b3c55a02918ee9cb3aa1d">BattleGround::SetArenaorBGType</a></div><div class="ttdeci">void SetArenaorBGType(bool isArena)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00394">BattleGround.h:394</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a3f8170a5d81f660f9fae6c28337d356b"><div class="ttname"><a href="classBattleGround.html#a3f8170a5d81f660f9fae6c28337d356b">BattleGround::IsRated</a></div><div class="ttdeci">bool IsRated() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00422">BattleGround.h:422</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a4a599d0991c5f98660322d75895f6330"><div class="ttname"><a href="classBattleGround.html#a4a599d0991c5f98660322d75895f6330">BattleGround::GetPlayerScoresBegin</a></div><div class="ttdeci">BattleGroundScoreMap::const_iterator GetPlayerScoresBegin() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00431">BattleGround.h:431</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a4bd4b3610f0cd717c01f827db79cd120"><div class="ttname"><a href="classBattleGround.html#a4bd4b3610f0cd717c01f827db79cd120">BattleGround::SetRandomTypeId</a></div><div class="ttdeci">void SetRandomTypeId(BattleGroundTypeId typeId)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00382">BattleGround.h:382</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a4d43283dc3c9cbf5430c01d8c4a3e38a"><div class="ttname"><a href="classBattleGround.html#a4d43283dc3c9cbf5430c01d8c4a3e38a">BattleGround::GetWinner</a></div><div class="ttdeci">BattleGroundWinner GetWinner() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00374">BattleGround.h:374</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a566dbd1bc93724071ceda9aef0fd40c4"><div class="ttname"><a href="classBattleGround.html#a566dbd1bc93724071ceda9aef0fd40c4">BattleGround::SetArenaType</a></div><div class="ttdeci">void SetArenaType(ArenaType type)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00393">BattleGround.h:393</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a5dccc4e6c706f6e71c77f23f21b08afb"><div class="ttname"><a href="classBattleGround.html#a5dccc4e6c706f6e71c77f23f21b08afb">BattleGround::SetMinPlayers</a></div><div class="ttdeci">void SetMinPlayers(uint32 minPlayers)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00390">BattleGround.h:390</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a60a41018415b6c7a123a62629c0107ee"><div class="ttname"><a href="classBattleGround.html#a60a41018415b6c7a123a62629c0107ee">BattleGround::GetTypeId</a></div><div class="ttdeci">BattleGroundTypeId GetTypeId(bool getRandom=false) const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00354">BattleGround.h:354</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a6b4f03ff10353177437b435964384edd"><div class="ttname"><a href="classBattleGround.html#a6b4f03ff10353177437b435964384edd">BattleGround::SetMinPlayersPerTeam</a></div><div class="ttdeci">void SetMinPlayersPerTeam(uint32 minPlayers)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00402">BattleGround.h:402</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a72477d06bf9c16a116ed66d2f7eb77b7"><div class="ttname"><a href="classBattleGround.html#a72477d06bf9c16a116ed66d2f7eb77b7">BattleGround::GetInstanceId</a></div><div class="ttdeci">uint32 GetInstanceId() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00358">BattleGround.h:358</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a899ece38db310b6a4418c86b5c9bdb92"><div class="ttname"><a href="classBattleGround.html#a899ece38db310b6a4418c86b5c9bdb92">BattleGround::DecreaseInvitedCount</a></div><div class="ttdeci">void DecreaseInvitedCount(Team team)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00408">BattleGround.h:408</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a8c48da7691e3702b2c5a94044aaa7454"><div class="ttname"><a href="classBattleGround.html#a8c48da7691e3702b2c5a94044aaa7454">BattleGround::m_arenaTeamRatingChanges</a></div><div class="ttdeci">int32 m_arenaTeamRatingChanges[PVP_TEAM_COUNT]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00748">BattleGround.h:748</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a8da15b689f8837f8ab9400787733113d"><div class="ttname"><a href="classBattleGround.html#a8da15b689f8837f8ab9400787733113d">BattleGround::StartBattleGround</a></div><div class="ttdeci">void StartBattleGround()</div><div class="ttdoc">Method that starts the battleground.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l01483">BattleGround.cpp:1483</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a8dd6dd20f583b3e0a7ec6a67cab93e3e"><div class="ttname"><a href="classBattleGround.html#a8dd6dd20f583b3e0a7ec6a67cab93e3e">BattleGround::GetMaxLevel</a></div><div class="ttdeci">uint32 GetMaxLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00367">BattleGround.h:367</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a9098ac7a9630a28f039be2c8b7f5569d"><div class="ttname"><a href="classBattleGround.html#a9098ac7a9630a28f039be2c8b7f5569d">BattleGround::HasFreeSlots</a></div><div class="ttdeci">bool HasFreeSlots() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00416">BattleGround.h:416</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a928a22c556c89666337bf636671c90e1"><div class="ttname"><a href="classBattleGround.html#a928a22c556c89666337bf636671c90e1">BattleGround::GetPlayerTeam</a></div><div class="ttdeci">Team GetPlayerTeam(ObjectGuid)</div><div class="ttdoc">Function that returns the team of the given player - used mainly in arenas.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l02260">BattleGround.cpp:2260</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a94cd4dbb8682edac867f75aa43ae072a"><div class="ttname"><a href="classBattleGround.html#a94cd4dbb8682edac867f75aa43ae072a">BattleGround::IsArena</a></div><div class="ttdeci">bool IsArena() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00420">BattleGround.h:420</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a97adf01f21b2b87025f03f493cdd623b"><div class="ttname"><a href="classBattleGround.html#a97adf01f21b2b87025f03f493cdd623b">BattleGround::SetMaxPlayersPerTeam</a></div><div class="ttdeci">void SetMaxPlayersPerTeam(uint32 maxPlayers)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00401">BattleGround.h:401</a></div></div>
<div class="ttc" id="aclassBattleGround_html_a99286a44ebf4d93ecfccf2724f70420c"><div class="ttname"><a href="classBattleGround.html#a99286a44ebf4d93ecfccf2724f70420c">BattleGround::SetRandom</a></div><div class="ttdeci">void SetRandom(bool isRandom)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00396">BattleGround.h:396</a></div></div>
<div class="ttc" id="aclassBattleGround_html_aa5192bced3c38cbdfe0c9ec24804b6e5"><div class="ttname"><a href="classBattleGround.html#aa5192bced3c38cbdfe0c9ec24804b6e5">BattleGround::GetMinLevel</a></div><div class="ttdeci">uint32 GetMinLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00366">BattleGround.h:366</a></div></div>
<div class="ttc" id="aclassBattleGround_html_aae6d6881ab4cb39901420f43834eef98"><div class="ttname"><a href="classBattleGround.html#aae6d6881ab4cb39901420f43834eef98">BattleGround::IsBattleGround</a></div><div class="ttdeci">bool IsBattleGround() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00421">BattleGround.h:421</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ab67e4e9d4b19576522b99d1dedf3b850"><div class="ttname"><a href="classBattleGround.html#ab67e4e9d4b19576522b99d1dedf3b850">BattleGround::SetMapId</a></div><div class="ttdeci">void SetMapId(uint32 mapId)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00444">BattleGround.h:444</a></div></div>
<div class="ttc" id="aclassBattleGround_html_aba75ff9ec15240bc746ce95b1ddeb932"><div class="ttname"><a href="classBattleGround.html#aba75ff9ec15240bc746ce95b1ddeb932">BattleGround::GetFreeSlotsForTeam</a></div><div class="ttdeci">uint32 GetFreeSlotsForTeam(Team team) const</div><div class="ttdoc">Function that returns the number of players that can join a battleground based on the provided team.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l01747">BattleGround.cpp:1747</a></div></div>
<div class="ttc" id="aclassBattleGround_html_abcbde26976ecd6b28f3a5d0d7c4b4eb2"><div class="ttname"><a href="classBattleGround.html#abcbde26976ecd6b28f3a5d0d7c4b4eb2">BattleGround::GetArenaType</a></div><div class="ttdeci">ArenaType GetArenaType() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00373">BattleGround.h:373</a></div></div>
<div class="ttc" id="aclassBattleGround_html_abf7822226a49df5d9893262a539b5f16"><div class="ttname"><a href="classBattleGround.html#abf7822226a49df5d9893262a539b5f16">BattleGround::Reset</a></div><div class="ttdeci">virtual void Reset()</div><div class="ttdoc">Method that is called when no players remains in battleground.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l01419">BattleGround.cpp:1419</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ac0d4150ea2cea10de52503499c8bfad1"><div class="ttname"><a href="classBattleGround.html#ac0d4150ea2cea10de52503499c8bfad1">BattleGround::m_arenaTeamIds</a></div><div class="ttdeci">uint32 m_arenaTeamIds[PVP_TEAM_COUNT]</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00746">BattleGround.h:746</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ac6a7eff67f6b86fdf8deab465ef6f383"><div class="ttname"><a href="classBattleGround.html#ac6a7eff67f6b86fdf8deab465ef6f383">BattleGround::SetStatus</a></div><div class="ttdeci">void SetStatus(BattleGroundStatus status)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00385">BattleGround.h:385</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ac76706d80992d887d1dbee0c94f3fb2b"><div class="ttname"><a href="classBattleGround.html#ac76706d80992d887d1dbee0c94f3fb2b">BattleGround::GetPlayerScoresSize</a></div><div class="ttdeci">uint32 GetPlayerScoresSize() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00433">BattleGround.h:433</a></div></div>
<div class="ttc" id="aclassBattleGround_html_acf53bf94ac3786067e55dee819a24f52"><div class="ttname"><a href="classBattleGround.html#acf53bf94ac3786067e55dee819a24f52">BattleGround::SetRated</a></div><div class="ttdeci">void SetRated(bool state)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00392">BattleGround.h:392</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ad0703f439c2f254a7a5e823d4d7df62e"><div class="ttname"><a href="classBattleGround.html#ad0703f439c2f254a7a5e823d4d7df62e">BattleGround::GetPlayerScoresEnd</a></div><div class="ttdeci">BattleGroundScoreMap::const_iterator GetPlayerScoresEnd() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00432">BattleGround.h:432</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ad187c9e07479c1f63bdce36438bc01f4"><div class="ttname"><a href="classBattleGround.html#ad187c9e07479c1f63bdce36438bc01f4">BattleGround::GetMinPlayersPerTeam</a></div><div class="ttdeci">uint32 GetMinPlayersPerTeam() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00370">BattleGround.h:370</a></div></div>
<div class="ttc" id="aclassBattleGround_html_add0834abfb4a5647628ad9ca49d06f39"><div class="ttname"><a href="classBattleGround.html#add0834abfb4a5647628ad9ca49d06f39">BattleGround::GetBracketId</a></div><div class="ttdeci">BattleGroundBracketId GetBracketId() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00355">BattleGround.h:355</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ae53fc3217e685e5eb26938833f9b4699"><div class="ttname"><a href="classBattleGround.html#ae53fc3217e685e5eb26938833f9b4699">BattleGround::SetTypeId</a></div><div class="ttdeci">void SetTypeId(BattleGroundTypeId typeId)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00381">BattleGround.h:381</a></div></div>
<div class="ttc" id="aclassBattleGround_html_ae5654a88574ef06bc497e1de99ee03ff"><div class="ttname"><a href="classBattleGround.html#ae5654a88574ef06bc497e1de99ee03ff">BattleGround::SetName</a></div><div class="ttdeci">void SetName(char const *name)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00380">BattleGround.h:380</a></div></div>
<div class="ttc" id="aclassBattleGround_html_af0bb2b507ef9c0507693ccb9ce4d9413"><div class="ttname"><a href="classBattleGround.html#af0bb2b507ef9c0507693ccb9ce4d9413">BattleGround::SetLevelRange</a></div><div class="ttdeci">void SetLevelRange(uint32 min, uint32 max)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00391">BattleGround.h:391</a></div></div>
<div class="ttc" id="aclassBattleGround_html_af22363ba2055213ac1591b39ad0e32fc"><div class="ttname"><a href="classBattleGround.html#af22363ba2055213ac1591b39ad0e32fc">BattleGround::GetClientInstanceId</a></div><div class="ttdeci">uint32 GetClientInstanceId() const</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00360">BattleGround.h:360</a></div></div>
<div class="ttc" id="aclassBattleGround_html_af337c8140386e213f6bbef03b14b01b4"><div class="ttname"><a href="classBattleGround.html#af337c8140386e213f6bbef03b14b01b4">BattleGround::SetMaxPlayers</a></div><div class="ttdeci">void SetMaxPlayers(uint32 maxPlayers)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00389">BattleGround.h:389</a></div></div>
<div class="ttc" id="aclassBattleGround_html_afed1dac8f1d63700f0bdf1c6c84b6c9b"><div class="ttname"><a href="classBattleGround.html#afed1dac8f1d63700f0bdf1c6c84b6c9b">BattleGround::SetTeamStartLoc</a></div><div class="ttdeci">void SetTeamStartLoc(Team team, float x, float y, float z, float o)</div><div class="ttdoc">Method that sets the team start location.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8cpp_source.html#l00553">BattleGround.cpp:553</a></div></div>
<div class="ttc" id="aclassBattleGround_html_aff315457ce3c289f1a51e32a578fddd1"><div class="ttname"><a href="classBattleGround.html#aff315457ce3c289f1a51e32a578fddd1">BattleGround::SetClientInstanceId</a></div><div class="ttdeci">void SetClientInstanceId(uint32 instanceId)</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00386">BattleGround.h:386</a></div></div>
<div class="ttc" id="aclassBgQueueInviteEvent_html"><div class="ttname"><a href="classBgQueueInviteEvent.html">BgQueueInviteEvent</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00146">BattleGroundMgr.h:147</a></div></div>
<div class="ttc" id="aclassBgQueueInviteEvent_html_aa83a13d03d7e57f49263f7f8fa47899f"><div class="ttname"><a href="classBgQueueInviteEvent.html#aa83a13d03d7e57f49263f7f8fa47899f">BgQueueInviteEvent::Abort</a></div><div class="ttdeci">virtual void Abort(uint64 e_time) override</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01204">BattleGroundMgr.cpp:1204</a></div></div>
<div class="ttc" id="aclassBgQueueInviteEvent_html_ad89a92e47d237513c06673c7870fe1cb"><div class="ttname"><a href="classBgQueueInviteEvent.html#ad89a92e47d237513c06673c7870fe1cb">BgQueueInviteEvent::Execute</a></div><div class="ttdeci">virtual bool Execute(uint64 e_time, uint32 p_time) override</div><div class="ttdoc">Function that executes battleground queue invite event.</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01172">BattleGroundMgr.cpp:1172</a></div></div>
<div class="ttc" id="aclassBgQueueRemoveEvent_html"><div class="ttname"><a href="classBgQueueRemoveEvent.html">BgQueueRemoveEvent</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00171">BattleGroundMgr.h:172</a></div></div>
<div class="ttc" id="aclassBgQueueRemoveEvent_html_abdf64fcf29c2d818e92cad38b64d3131"><div class="ttname"><a href="classBgQueueRemoveEvent.html#abdf64fcf29c2d818e92cad38b64d3131">BgQueueRemoveEvent::Execute</a></div><div class="ttdeci">virtual bool Execute(uint64 e_time, uint32 p_time) override</div><div class="ttdoc">Function that executes battleground queue remove event this event has many possibilities when it is e...</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01219">BattleGroundMgr.cpp:1219</a></div></div>
<div class="ttc" id="aclassBgQueueRemoveEvent_html_ace7f37c0190c9f6736fdae532ffcd671"><div class="ttname"><a href="classBgQueueRemoveEvent.html#ace7f37c0190c9f6736fdae532ffcd671">BgQueueRemoveEvent::Abort</a></div><div class="ttdeci">virtual void Abort(uint64 e_time) override</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8cpp_source.html#l01259">BattleGroundMgr.cpp:1259</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a1c6679ea7a9b1eb27762460f87b25836"><div class="ttname"><a href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">ByteBuffer::put</a></div><div class="ttdeci">void put(size_t pos, T value)</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00105">ByteBuffer.h:105</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a822527905d8efa5938e6a9f1adde97fd"><div class="ttname"><a href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">ByteBuffer::wpos</a></div><div class="ttdeci">size_t wpos() const</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00280">ByteBuffer.h:280</a></div></div>
<div class="ttc" id="aclassChatHandler_html"><div class="ttname"><a href="classChatHandler.html">ChatHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="Chat_8h_source.html#l00080">Chat.h:81</a></div></div>
<div class="ttc" id="aclassChatHandler_html_aa2c513be476b7a698afb71c7d271650b"><div class="ttname"><a href="classChatHandler.html#aa2c513be476b7a698afb71c7d271650b">ChatHandler::PSendSysMessage</a></div><div class="ttdeci">void PSendSysMessage(const char *format,...) ATTR_PRINTF(2</div><div class="ttdef"><b>Definition:</b> <a href="Chat_8cpp_source.html#l01268">Chat.cpp:1268</a></div></div>
<div class="ttc" id="aclassDatabase_html_a1379d88f95a689d8b6f7ff0fd9215b4d"><div class="ttname"><a href="classDatabase.html#a1379d88f95a689d8b6f7ff0fd9215b4d">Database::PExecute</a></div><div class="ttdeci">bool PExecute(const char *format,...) ATTR_PRINTF(2</div><div class="ttdef"><b>Definition:</b> <a href="Database_8cpp_source.html#l00348">Database.cpp:348</a></div></div>
<div class="ttc" id="aclassDatabase_html_a23b35412451da3ca1bb5c714b727a1f5"><div class="ttname"><a href="classDatabase.html#a23b35412451da3ca1bb5c714b727a1f5">Database::Query</a></div><div class="ttdeci">QueryResult * Query(const char *sql)</div><div class="ttdoc">Synchronous DB queries.</div><div class="ttdef"><b>Definition:</b> <a href="Database_8h_source.html#l00114">Database.h:114</a></div></div>
<div class="ttc" id="aclassDatabase_html_ae9332e6ba803852091f432bc329a62bc"><div class="ttname"><a href="classDatabase.html#ae9332e6ba803852091f432bc329a62bc">Database::PQuery</a></div><div class="ttdeci">QueryResult * PQuery(const char *format,...) ATTR_PRINTF(2</div><div class="ttdef"><b>Definition:</b> <a href="Database_8cpp_source.html#l00286">Database.cpp:286</a></div></div>
<div class="ttc" id="aclassEventProcessor_html_a0ecdf822624a632b7b3fad1e66228cfb"><div class="ttname"><a href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">EventProcessor::AddEvent</a></div><div class="ttdeci">void AddEvent(BasicEvent *Event, uint64 e_time, bool set_addtime=true)</div><div class="ttdef"><b>Definition:</b> <a href="EventProcessor_8cpp_source.html#l00101">EventProcessor.cpp:101</a></div></div>
<div class="ttc" id="aclassEventProcessor_html_a1a92f983f1dd415146c2875f80cba433"><div class="ttname"><a href="classEventProcessor.html#a1a92f983f1dd415146c2875f80cba433">EventProcessor::CalculateTime</a></div><div class="ttdeci">uint64 CalculateTime(uint64 t_offset) const</div><div class="ttdef"><b>Definition:</b> <a href="EventProcessor_8cpp_source.html#l00124">EventProcessor.cpp:124</a></div></div>
<div class="ttc" id="aclassField_html"><div class="ttname"><a href="classField.html">Field</a></div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00024">Field.h:25</a></div></div>
<div class="ttc" id="aclassField_html_a090beafdf8b41555058a87d00443498a"><div class="ttname"><a href="classField.html#a090beafdf8b41555058a87d00443498a">Field::GetUInt8</a></div><div class="ttdeci">uint8 GetUInt8() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00056">Field.h:56</a></div></div>
<div class="ttc" id="aclassField_html_a8b05a34c3d0cb92a9d2c0f298aa11dea"><div class="ttname"><a href="classField.html#a8b05a34c3d0cb92a9d2c0f298aa11dea">Field::GetFloat</a></div><div class="ttdeci">float GetFloat() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00053">Field.h:53</a></div></div>
<div class="ttc" id="aclassField_html_ab8c1a7e73265f7b14457ab37cf20681c"><div class="ttname"><a href="classField.html#ab8c1a7e73265f7b14457ab37cf20681c">Field::GetString</a></div><div class="ttdeci">const char * GetString() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00045">Field.h:45</a></div></div>
<div class="ttc" id="aclassField_html_ac3fe5bf9cdc61b5be66a4c79598cba5e"><div class="ttname"><a href="classField.html#ac3fe5bf9cdc61b5be66a4c79598cba5e">Field::GetCppString</a></div><div class="ttdeci">std::string GetCppString() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00049">Field.h:49</a></div></div>
<div class="ttc" id="aclassField_html_af71c97fd38da328f4d9590b112f859c4"><div class="ttname"><a href="classField.html#af71c97fd38da328f4d9590b112f859c4">Field::GetUInt32</a></div><div class="ttdeci">uint32 GetUInt32() const</div><div class="ttdef"><b>Definition:</b> <a href="Field_8h_source.html#l00059">Field.h:59</a></div></div>
<div class="ttc" id="aclassGroupReference_html"><div class="ttname"><a href="classGroupReference.html">GroupReference</a></div><div class="ttdef"><b>Definition:</b> <a href="GroupReference_8h_source.html#l00027">GroupReference.h:28</a></div></div>
<div class="ttc" id="aclassGroupReference_html_a05b946c0952db094a696093283308cb1"><div class="ttname"><a href="classGroupReference.html#a05b946c0952db094a696093283308cb1">GroupReference::next</a></div><div class="ttdeci">GroupReference * next()</div><div class="ttdef"><b>Definition:</b> <a href="GroupReference_8h_source.html#l00037">GroupReference.h:37</a></div></div>
<div class="ttc" id="aclassGroup_html"><div class="ttname"><a href="classGroup.html">Group</a></div><div class="ttdoc">request member stats checken</div><div class="ttdef"><b>Definition:</b> <a href="Group_8h_source.html#l00122">Group.h:123</a></div></div>
<div class="ttc" id="aclassGroup_html_a39cc0707e5c157b6ff4851e133b0a9dc"><div class="ttname"><a href="classGroup.html#a39cc0707e5c157b6ff4851e133b0a9dc">Group::GetFirstMember</a></div><div class="ttdeci">GroupReference * GetFirstMember()</div><div class="ttdef"><b>Definition:</b> <a href="Group_8h_source.html#l00200">Group.h:200</a></div></div>
<div class="ttc" id="aclassItem_html"><div class="ttname"><a href="classItem.html">Item</a></div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00271">Item.h:272</a></div></div>
<div class="ttc" id="aclassItem_html_aec8277f266581dd7bdd88eb9ccbb1ae1"><div class="ttname"><a href="classItem.html#aec8277f266581dd7bdd88eb9ccbb1ae1">Item::SaveToDB</a></div><div class="ttdeci">virtual void SaveToDB()</div><div class="ttdef"><b>Definition:</b> <a href="Item_8cpp_source.html#l00265">Item.cpp:265</a></div></div>
<div class="ttc" id="aclassItem_html_afa31c834b8cab84e5d7e27d971293da1"><div class="ttname"><a href="classItem.html#afa31c834b8cab84e5d7e27d971293da1">Item::CreateItem</a></div><div class="ttdeci">static Item * CreateItem(uint32 item, uint32 count, Player const *player=nullptr, uint32 randomPropertyId=0)</div><div class="ttdef"><b>Definition:</b> <a href="Item_8cpp_source.html#l01134">Item.cpp:1134</a></div></div>
<div class="ttc" id="aclassMailDraft_html"><div class="ttname"><a href="classMailDraft.html">MailDraft</a></div><div class="ttdoc">The class to represent the draft of a mail.</div><div class="ttdef"><b>Definition:</b> <a href="Mail_8h_source.html#l00183">Mail.h:184</a></div></div>
<div class="ttc" id="aclassMailDraft_html_a7a5153edf5907d5cd012358a3450d9d5"><div class="ttname"><a href="classMailDraft.html#a7a5153edf5907d5cd012358a3450d9d5">MailDraft::SetSubjectAndBody</a></div><div class="ttdeci">MailDraft &amp; SetSubjectAndBody(const std::string &amp;subject, const std::string &amp;body)</div><div class="ttdef"><b>Definition:</b> <a href="Mail_8h_source.html#l00229">Mail.h:229</a></div></div>
<div class="ttc" id="aclassMailReceiver_html"><div class="ttname"><a href="classMailReceiver.html">MailReceiver</a></div><div class="ttdoc">A class to represent the receiver of a mail.</div><div class="ttdef"><b>Definition:</b> <a href="Mail_8h_source.html#l00154">Mail.h:155</a></div></div>
<div class="ttc" id="aclassMailSender_html"><div class="ttname"><a href="classMailSender.html">MailSender</a></div><div class="ttdoc">A class to represent the sender of a mail.</div><div class="ttdef"><b>Definition:</b> <a href="Mail_8h_source.html#l00115">Mail.h:116</a></div></div>
<div class="ttc" id="aclassObjectGuid_html"><div class="ttname"><a href="classObjectGuid.html">ObjectGuid</a></div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00087">ObjectGuid.h:88</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a0eb47d3c61516f4242e8599b55ae755e"><div class="ttname"><a href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">ObjectGuid::GetString</a></div><div class="ttdeci">std::string GetString() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8cpp_source.html#l00047">ObjectGuid.cpp:47</a></div></div>
<div class="ttc" id="aclassObject_html_a4777844356842a389621c1bad1433109"><div class="ttname"><a href="classObject.html#a4777844356842a389621c1bad1433109">Object::GetGUIDLow</a></div><div class="ttdeci">uint32 GetGUIDLow() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00410">Object.h:410</a></div></div>
<div class="ttc" id="aclassObject_html_a5c2f31b9fb0a083ff4caca3de93fac90"><div class="ttname"><a href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">Object::GetGuidStr</a></div><div class="ttdeci">std::string GetGuidStr() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00414">Object.h:414</a></div></div>
<div class="ttc" id="aclassObject_html_ae7e0c11556aeda48ab347a56b6b7bd6a"><div class="ttname"><a href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">Object::GetObjectGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetObjectGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00409">Object.h:409</a></div></div>
<div class="ttc" id="aclassPlayer_html"><div class="ttname"><a href="classPlayer.html">Player</a></div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01063">Player.h:1064</a></div></div>
<div class="ttc" id="aclassPlayer_html_a092c3de4a1ae7720ecd24ec4fcc6f72e"><div class="ttname"><a href="classPlayer.html#a092c3de4a1ae7720ecd24ec4fcc6f72e">Player::ModifyHonorPoints</a></div><div class="ttdeci">void ModifyHonorPoints(int32 value)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l07328">Player.cpp:7328</a></div></div>
<div class="ttc" id="aclassPlayer_html_a0ee06e278ecf1ca41c3052e9eb72f13c"><div class="ttname"><a href="classPlayer.html#a0ee06e278ecf1ca41c3052e9eb72f13c">Player::TeleportTo</a></div><div class="ttdeci">bool TeleportTo(uint32 mapid, float x, float y, float z, float orientation, uint32 options=0, AreaTrigger const *at=nullptr, GenericTransport *transport=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l02016">Player.cpp:2016</a></div></div>
<div class="ttc" id="aclassPlayer_html_a1c212b8f9ae8b1a38a41f9c7db005dca"><div class="ttname"><a href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">Player::GetSession</a></div><div class="ttdeci">WorldSession * GetSession() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01932">Player.h:1932</a></div></div>
<div class="ttc" id="aclassPlayer_html_a1e807120767272c266a2bef0ac5b06e0"><div class="ttname"><a href="classPlayer.html#a1e807120767272c266a2bef0ac5b06e0">Player::SetTitle</a></div><div class="ttdeci">void SetTitle(uint32 titleId, bool lost=false)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l22799">Player.cpp:22799</a></div></div>
<div class="ttc" id="aclassPlayer_html_a25cf1fdb2e61f6229ca63c2ad5b78e1d"><div class="ttname"><a href="classPlayer.html#a25cf1fdb2e61f6229ca63c2ad5b78e1d">Player::GetArenaPoints</a></div><div class="ttdeci">uint32 GetArenaPoints() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02082">Player.h:2082</a></div></div>
<div class="ttc" id="aclassPlayer_html_a272d7b889a3e211289389ff9616fdebc"><div class="ttname"><a href="classPlayer.html#a272d7b889a3e211289389ff9616fdebc">Player::HasWonRandomBattleground</a></div><div class="ttdeci">bool HasWonRandomBattleground()</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02272">Player.h:2272</a></div></div>
<div class="ttc" id="aclassPlayer_html_a3ab026e1c8ff1c957f84dcbc7ad0cfd2"><div class="ttname"><a href="classPlayer.html#a3ab026e1c8ff1c957f84dcbc7ad0cfd2">Player::SetArenaPoints</a></div><div class="ttdeci">void SetArenaPoints(uint32 value)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l07320">Player.cpp:7320</a></div></div>
<div class="ttc" id="aclassPlayer_html_a4599b778fbc3e2e4ee1b0c9e7490887b"><div class="ttname"><a href="classPlayer.html#a4599b778fbc3e2e4ee1b0c9e7490887b">Player::SaveTitles</a></div><div class="ttdeci">void SaveTitles()</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l22834">Player.cpp:22834</a></div></div>
<div class="ttc" id="aclassPlayer_html_a84d23ac8815a25b0d532e93e6e1d7a9c"><div class="ttname"><a href="classPlayer.html#a84d23ac8815a25b0d532e93e6e1d7a9c">Player::SetInviteForBattleGroundQueueType</a></div><div class="ttdeci">void SetInviteForBattleGroundQueueType(BattleGroundQueueTypeId bgQueueTypeId, uint32 instanceId)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02240">Player.h:2240</a></div></div>
<div class="ttc" id="aclassPlayer_html_ac0b1b01da51987e47b563832a6d92b87"><div class="ttname"><a href="classPlayer.html#ac0b1b01da51987e47b563832a6d92b87">Player::GetBattleGroundQueueIndex</a></div><div class="ttdeci">uint32 GetBattleGroundQueueIndex(BattleGroundQueueTypeId bgQueueTypeId) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02181">Player.h:2181</a></div></div>
<div class="ttc" id="aclassPlayer_html_af002dd6bf131244d4357338c4a2f1204"><div class="ttname"><a href="classPlayer.html#af002dd6bf131244d4357338c4a2f1204">Player::GetBGTeam</a></div><div class="ttdeci">Team GetBGTeam() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02259">Player.h:2259</a></div></div>
<div class="ttc" id="aclassPlayer_html_af984d68ab11bb3f4081e0965593fbc9b"><div class="ttname"><a href="classPlayer.html#af984d68ab11bb3f4081e0965593fbc9b">Player::GetTeam</a></div><div class="ttdeci">Team GetTeam() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02035">Player.h:2035</a></div></div>
<div class="ttc" id="aclassQueryResult_html"><div class="ttname"><a href="classQueryResult.html">QueryResult</a></div><div class="ttdef"><b>Definition:</b> <a href="QueryResult_8h_source.html#l00026">QueryResult.h:27</a></div></div>
<div class="ttc" id="aclassQueryResult_html_a8f1f135d431fe357bf2b9373dc8d59be"><div class="ttname"><a href="classQueryResult.html#a8f1f135d431fe357bf2b9373dc8d59be">QueryResult::NextRow</a></div><div class="ttdeci">virtual bool NextRow()=0</div></div>
<div class="ttc" id="aclassQueryResult_html_ae59bcb12d59b9a369953be91ddb5c446"><div class="ttname"><a href="classQueryResult.html#ae59bcb12d59b9a369953be91ddb5c446">QueryResult::Fetch</a></div><div class="ttdeci">Field * Fetch() const</div><div class="ttdef"><b>Definition:</b> <a href="QueryResult_8h_source.html#l00036">QueryResult.h:36</a></div></div>
<div class="ttc" id="aclassQueryResult_html_af92312138c98bbceeeddca74ae6029fe"><div class="ttname"><a href="classQueryResult.html#af92312138c98bbceeeddca74ae6029fe">QueryResult::GetRowCount</a></div><div class="ttdeci">uint64 GetRowCount() const</div><div class="ttdef"><b>Definition:</b> <a href="QueryResult_8h_source.html#l00041">QueryResult.h:41</a></div></div>
<div class="ttc" id="aclassSQLStorage_html_ace42ec0424ef41d187eb7c1bdcfa8c62"><div class="ttname"><a href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">SQLStorage::LookupEntry</a></div><div class="ttdeci">T const  * LookupEntry(uint32 id) const</div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00113">SQLStorage.h:113</a></div></div>
<div class="ttc" id="aclassUnit_html_a7e54441e936d60c8d5debbf0f64b8d9c"><div class="ttname"><a href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">Unit::GetLevel</a></div><div class="ttdeci">uint32 GetLevel() const override</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01391">Unit.h:1391</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a5e9a954bf661e8fb9a438be1d9894dac"><div class="ttname"><a href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">WorldObject::m_events</a></div><div class="ttdeci">EventProcessor m_events</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01265">Object.h:1265</a></div></div>
<div class="ttc" id="aclassWorldObject_html_af60e24425abfff16a925c7b5808d8b38"><div class="ttname"><a href="classWorldObject.html#af60e24425abfff16a925c7b5808d8b38">WorldObject::GetName</a></div><div class="ttdeci">char const  * GetName() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01058">Object.h:1058</a></div></div>
<div class="ttc" id="aclassWorldPacket_html"><div class="ttname"><a href="classWorldPacket.html">WorldPacket</a></div><div class="ttdef"><b>Definition:</b> <a href="WorldPacket_8h_source.html#l00029">WorldPacket.h:30</a></div></div>
<div class="ttc" id="aclassWorldPacket_html_a59f4f321e9acdb083f31cc54f1203b21"><div class="ttname"><a href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">WorldPacket::Initialize</a></div><div class="ttdeci">void Initialize(Opcodes opcode, size_t newres=200)</div><div class="ttdef"><b>Definition:</b> <a href="WorldPacket_8h_source.html#l00046">WorldPacket.h:46</a></div></div>
<div class="ttc" id="aclassWorldSession_html_a15a10b125d9f54c3945a3daf319b228f"><div class="ttname"><a href="classWorldSession.html#a15a10b125d9f54c3945a3daf319b228f">WorldSession::SendPacket</a></div><div class="ttdeci">void SendPacket(WorldPacket const &amp;packet) const</div><div class="ttdoc">Send a packet to the client.</div><div class="ttdef"><b>Definition:</b> <a href="WorldSession_8cpp_source.html#l00202">WorldSession.cpp:202</a></div></div>
<div class="ttc" id="aclassWorldTimer_html_ac3e0aef4f8477912d3dc1b44332848cc"><div class="ttname"><a href="classWorldTimer.html#ac3e0aef4f8477912d3dc1b44332848cc">WorldTimer::getMSTimeDiff</a></div><div class="ttdeci">static uint32 getMSTimeDiff(const uint32 &amp;oldMSTime, std::chrono::steady_clock::time_point newTime)</div><div class="ttdef"><b>Definition:</b> <a href="Timer_8h_source.html#l00041">Timer.h:41</a></div></div>
<div class="ttc" id="aclassWorldTimer_html_ae257706b7a1456a593811cc77fa84375"><div class="ttname"><a href="classWorldTimer.html#ae257706b7a1456a593811cc77fa84375">WorldTimer::getMSTime</a></div><div class="ttdeci">static uint32 getMSTime()</div><div class="ttdef"><b>Definition:</b> <a href="Util_8cpp_source.html#l00060">Util.cpp:60</a></div></div>
<div class="ttc" id="aclassWorld_html"><div class="ttname"><a href="classWorld.html">World</a></div><div class="ttdoc">The World.</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00496">World.h:497</a></div></div>
<div class="ttc" id="agroup__mailing_html_gae0c2b4bac4dd8f2a8c53608c45cbb11a"><div class="ttname"><a href="group__mailing.html#gae0c2b4bac4dd8f2a8c53608c45cbb11a">MailDraft::AddItem</a></div><div class="ttdeci">MailDraft &amp; AddItem(Item *item)</div><div class="ttdoc">Adds an item to the MailDraft.</div><div class="ttdef"><b>Definition:</b> <a href="Mail_8cpp_source.html#l00114">Mail.cpp:114</a></div></div>
<div class="ttc" id="agroup__mailing_html_gaf1f4156c2ab653e42f25cbfa38464afd"><div class="ttname"><a href="group__mailing.html#gaf1f4156c2ab653e42f25cbfa38464afd">MailDraft::SendMailTo</a></div><div class="ttdeci">void SendMailTo(MailReceiver const &amp;receiver, MailSender const &amp;sender, MailCheckMask checked=MAIL_CHECK_MASK_NONE, uint32 deliver_delay=0)</div><div class="ttdoc">Sends a mail.</div><div class="ttdef"><b>Definition:</b> <a href="Mail_8cpp_source.html#l00249">Mail.cpp:249</a></div></div>
<div class="ttc" id="agroup__mangosd_html_ga4af16b54c7219346503d4c430d955f41"><div class="ttname"><a href="group__mangosd.html#ga4af16b54c7219346503d4c430d955f41">CharacterDatabase</a></div><div class="ttdeci">DatabaseType CharacterDatabase</div><div class="ttdoc">Accessor to the character database.</div><div class="ttdef"><b>Definition:</b> <a href="mangosd_2Main_8cpp_source.html#l00062">mangosd/Main.cpp:62</a></div></div>
<div class="ttc" id="agroup__mangosd_html_gae551ea020f187b038a84473d48d9e14b"><div class="ttname"><a href="group__mangosd.html#gae551ea020f187b038a84473d48d9e14b">WorldDatabase</a></div><div class="ttdeci">DatabaseType WorldDatabase</div><div class="ttdoc">Accessor to the world database.</div><div class="ttdef"><b>Definition:</b> <a href="mangosd_2Main_8cpp_source.html#l00061">mangosd/Main.cpp:61</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca0b4708d07fe8318f0a87a8e24c7ac7cb"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca0b4708d07fe8318f0a87a8e24c7ac7cb">SMSG_GROUP_JOINED_BATTLEGROUND</a></div><div class="ttdeci">@ SMSG_GROUP_JOINED_BATTLEGROUND</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00781">Opcodes.h:781</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca156c546c3ed9661a9731321423226c77"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca156c546c3ed9661a9731321423226c77">SMSG_BATTLEFIELD_LIST</a></div><div class="ttdeci">@ SMSG_BATTLEFIELD_LIST</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00610">Opcodes.h:610</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca23e69a1dd0f74081bc248b7c5056bad9"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca23e69a1dd0f74081bc248b7c5056bad9">SMSG_BATTLEFIELD_STATUS</a></div><div class="ttdeci">@ SMSG_BATTLEFIELD_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00761">Opcodes.h:761</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca453a1c6742bb2e88150a8abe969be502"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca453a1c6742bb2e88150a8abe969be502">MSG_PVP_LOG_DATA</a></div><div class="ttdeci">@ MSG_PVP_LOG_DATA</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00773">Opcodes.h:773</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca7ffb25a5bf6639c2fef2bf2a79ec3c05"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca7ffb25a5bf6639c2fef2bf2a79ec3c05">SMSG_UPDATE_WORLD_STATE</a></div><div class="ttdeci">@ SMSG_UPDATE_WORLD_STATE</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00744">Opcodes.h:744</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca9ecbc0808c5e2e15978e7127f4e1930f"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca9ecbc0808c5e2e15978e7127f4e1930f">SMSG_PLAY_SOUND</a></div><div class="ttdeci">@ SMSG_PLAY_SOUND</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00759">Opcodes.h:759</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002cacac7cd27ed3678566826415657f484a656"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacac7cd27ed3678566826415657f484a656">SMSG_BATTLEGROUND_PLAYER_LEFT</a></div><div class="ttdeci">@ SMSG_BATTLEGROUND_PLAYER_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00786">Opcodes.h:786</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002cacae6dad235c681e7970a84c5c20cb0d55a"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacae6dad235c681e7970a84c5c20cb0d55a">SMSG_BATTLEGROUND_PLAYER_JOINED</a></div><div class="ttdeci">@ SMSG_BATTLEGROUND_PLAYER_JOINED</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00785">Opcodes.h:785</a></div></div>
<div class="ttc" id="agroup__world_html_ga05dfb35c344e5b947a19e4284e7f5fa7"><div class="ttname"><a href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a></div><div class="ttdeci">#define sWorld</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00832">World.h:832</a></div></div>
<div class="ttc" id="agroup__world_html_gga0400d571bb6627ef2b170a4e0dc846cda6c3441c6bac1b06978eb977de437f7ad"><div class="ttname"><a href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda6c3441c6bac1b06978eb977de437f7ad">CONFIG_BOOL_ARENA_QUEUE_ANNOUNCER_EXIT</a></div><div class="ttdeci">@ CONFIG_BOOL_ARENA_QUEUE_ANNOUNCER_EXIT</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00381">World.h:381</a></div></div>
<div class="ttc" id="agroup__world_html_gga0400d571bb6627ef2b170a4e0dc846cda941de37043fd9e75ad8a719281f22690"><div class="ttname"><a href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda941de37043fd9e75ad8a719281f22690">CONFIG_BOOL_ARENA_AUTO_DISTRIBUTE_POINTS</a></div><div class="ttdeci">@ CONFIG_BOOL_ARENA_AUTO_DISTRIBUTE_POINTS</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00379">World.h:379</a></div></div>
<div class="ttc" id="agroup__world_html_gga0400d571bb6627ef2b170a4e0dc846cdaba3d0b1ae01ff3f2223c4a6f0819bc56"><div class="ttname"><a href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cdaba3d0b1ae01ff3f2223c4a6f0819bc56">CONFIG_BOOL_ARENA_QUEUE_ANNOUNCER_JOIN</a></div><div class="ttdeci">@ CONFIG_BOOL_ARENA_QUEUE_ANNOUNCER_JOIN</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00380">World.h:380</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232a1166408853acad43f8dcbe56da26e585"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232a1166408853acad43f8dcbe56da26e585">CONFIG_UINT32_BATTLEGROUND_INVITATION_TYPE</a></div><div class="ttdeci">@ CONFIG_UINT32_BATTLEGROUND_INVITATION_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00185">World.h:185</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232a2885b81958ad5c8eaf70303ac1320708"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232a2885b81958ad5c8eaf70303ac1320708">CONFIG_UINT32_BATTLEGROUND_PREMATURE_FINISH_TIMER</a></div><div class="ttdeci">@ CONFIG_UINT32_BATTLEGROUND_PREMATURE_FINISH_TIMER</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00186">World.h:186</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232a4abebec67671887171fac3bd0d3c08eb"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232a4abebec67671887171fac3bd0d3c08eb">CONFIG_UINT32_ARENA_FIRST_RESET_DAY</a></div><div class="ttdeci">@ CONFIG_UINT32_ARENA_FIRST_RESET_DAY</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00194">World.h:194</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232a4b5028ad5ecd90ec5acedb83cf5fc160"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232a4b5028ad5ecd90ec5acedb83cf5fc160">CONFIG_UINT32_BATTLEGROUND_QUEUE_ANNOUNCER_JOIN</a></div><div class="ttdeci">@ CONFIG_UINT32_BATTLEGROUND_QUEUE_ANNOUNCER_JOIN</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00188">World.h:188</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232a7a1c7fff342dfcb57f657430f70b95e0"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232a7a1c7fff342dfcb57f657430f70b95e0">CONFIG_UINT32_BATTLEGROUND_PREMADE_GROUP_WAIT_FOR_MATCH</a></div><div class="ttdeci">@ CONFIG_UINT32_BATTLEGROUND_PREMADE_GROUP_WAIT_FOR_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00187">World.h:187</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232a9af243abbc26eb5bbc0bcb04f9f4c641"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232a9af243abbc26eb5bbc0bcb04f9f4c641">CONFIG_UINT32_ARENA_RATING_DISCARD_TIMER</a></div><div class="ttdeci">@ CONFIG_UINT32_ARENA_RATING_DISCARD_TIMER</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00191">World.h:191</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232abf1a4b8420382ebfc9de9cb062f31767"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232abf1a4b8420382ebfc9de9cb062f31767">CONFIG_UINT32_QUEST_DAILY_RESET_HOUR</a></div><div class="ttdeci">@ CONFIG_UINT32_QUEST_DAILY_RESET_HOUR</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00173">World.h:173</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232ad3546d2bc7feb4e62b51c51767df1e03"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232ad3546d2bc7feb4e62b51c51767df1e03">CONFIG_UINT32_ARENA_MAX_RATING_DIFFERENCE</a></div><div class="ttdeci">@ CONFIG_UINT32_ARENA_MAX_RATING_DIFFERENCE</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00190">World.h:190</a></div></div>
<div class="ttc" id="agroup__world_html_gga89a532a320ff8bd5866836fee5541232ade6a14406c661a78fe5d4fca6d7b5116"><div class="ttname"><a href="group__world.html#gga89a532a320ff8bd5866836fee5541232ade6a14406c661a78fe5d4fca6d7b5116">CONFIG_UINT32_ARENA_AUTO_DISTRIBUTE_INTERVAL_DAYS</a></div><div class="ttdeci">@ CONFIG_UINT32_ARENA_AUTO_DISTRIBUTE_INTERVAL_DAYS</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00192">World.h:192</a></div></div>
<div class="ttc" id="anamespaceMaNGOS_1_1Honor_html_a249974b98a142bca70c8c8d8e9e69a3e"><div class="ttname"><a href="namespaceMaNGOS_1_1Honor.html#a249974b98a142bca70c8c8d8e9e69a3e">MaNGOS::Honor::hk_honor_at_level</a></div><div class="ttdeci">float hk_honor_at_level(uint32 level, uint32 count=1)</div><div class="ttdef"><b>Definition:</b> <a href="Formulas_8h_source.html#l00028">Formulas.h:28</a></div></div>
<div class="ttc" id="astructArenaTeamMember_html"><div class="ttname"><a href="structArenaTeamMember.html">ArenaTeamMember</a></div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00090">ArenaTeam.h:91</a></div></div>
<div class="ttc" id="astructArenaTeamStats_html_a703cb423a8eaa9fc0efdd56555522758"><div class="ttname"><a href="structArenaTeamStats.html#a703cb423a8eaa9fc0efdd56555522758">ArenaTeamStats::games_season</a></div><div class="ttdeci">uint32 games_season</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00109">ArenaTeam.h:109</a></div></div>
<div class="ttc" id="astructArenaTeamStats_html_a9401e96424f770f226b8fdb61cf6ded9"><div class="ttname"><a href="structArenaTeamStats.html#a9401e96424f770f226b8fdb61cf6ded9">ArenaTeamStats::rating</a></div><div class="ttdeci">uint32 rating</div><div class="ttdef"><b>Definition:</b> <a href="ArenaTeam_8h_source.html#l00106">ArenaTeam.h:106</a></div></div>
<div class="ttc" id="astructBattleGroundEventIdx_html"><div class="ttname"><a href="structBattleGroundEventIdx.html">BattleGroundEventIdx</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00047">BattleGround.h:48</a></div></div>
<div class="ttc" id="astructBattleGroundEventIdx_html_a3aa4cf6679936fc83d446236b38d87a5"><div class="ttname"><a href="structBattleGroundEventIdx.html#a3aa4cf6679936fc83d446236b38d87a5">BattleGroundEventIdx::event2</a></div><div class="ttdeci">uint8 event2</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00050">BattleGround.h:50</a></div></div>
<div class="ttc" id="astructBattleGroundEventIdx_html_ae92a0e36d287c2c346e72734e2e54df0"><div class="ttname"><a href="structBattleGroundEventIdx.html#ae92a0e36d287c2c346e72734e2e54df0">BattleGroundEventIdx::event1</a></div><div class="ttdeci">uint8 event1</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00049">BattleGround.h:49</a></div></div>
<div class="ttc" id="astructBattlemasterListEntry_html"><div class="ttname"><a href="structBattlemasterListEntry.html">BattlemasterListEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00629">DBCStructure.h:630</a></div></div>
<div class="ttc" id="astructBattlemasterListEntry_html_a11e1326eeb24b436b10db53acc323c13"><div class="ttname"><a href="structBattlemasterListEntry.html#a11e1326eeb24b436b10db53acc323c13">BattlemasterListEntry::mapid</a></div><div class="ttdeci">int32 mapid[8]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00632">DBCStructure.h:632</a></div></div>
<div class="ttc" id="astructBattlemasterListEntry_html_a48cb0452213d79c5d45913bf031e5e18"><div class="ttname"><a href="structBattlemasterListEntry.html#a48cb0452213d79c5d45913bf031e5e18">BattlemasterListEntry::name</a></div><div class="ttdeci">char * name[16]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00635">DBCStructure.h:635</a></div></div>
<div class="ttc" id="astructBattlemasterListEntry_html_a647669b97599d7edf02b5a38dd1d5116"><div class="ttname"><a href="structBattlemasterListEntry.html#a647669b97599d7edf02b5a38dd1d5116">BattlemasterListEntry::type</a></div><div class="ttdeci">uint32 type</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00633">DBCStructure.h:633</a></div></div>
<div class="ttc" id="astructBattlemasterListEntry_html_a6f95f35c741b22a94eb29dba9c50e679"><div class="ttname"><a href="structBattlemasterListEntry.html#a6f95f35c741b22a94eb29dba9c50e679">BattlemasterListEntry::minLevel</a></div><div class="ttdeci">uint32 minLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00639">DBCStructure.h:639</a></div></div>
<div class="ttc" id="astructBattlemasterListEntry_html_a814e1d226c3d3edc66389e74fe059cc7"><div class="ttname"><a href="structBattlemasterListEntry.html#a814e1d226c3d3edc66389e74fe059cc7">BattlemasterListEntry::maxLevel</a></div><div class="ttdeci">uint32 maxLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00640">DBCStructure.h:640</a></div></div>
<div class="ttc" id="astructCharTitlesEntry_html"><div class="ttname"><a href="structCharTitlesEntry.html">CharTitlesEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l00675">DBCStructure.h:676</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html"><div class="ttname"><a href="structGroupQueueInfo.html">GroupQueueInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00051">BattleGroundMgr.h:52</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a02d12dbd5a4e8c367f0644857cd68584"><div class="ttname"><a href="structGroupQueueInfo.html#a02d12dbd5a4e8c367f0644857cd68584">GroupQueueInfo::arenaTeamRating</a></div><div class="ttdeci">uint32 arenaTeamRating</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00063">BattleGroundMgr.h:63</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a4a367c0d799a1ae587ab11d6e002a392"><div class="ttname"><a href="structGroupQueueInfo.html#a4a367c0d799a1ae587ab11d6e002a392">GroupQueueInfo::players</a></div><div class="ttdeci">GroupQueueInfoPlayers players</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00053">BattleGroundMgr.h:53</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a4ff35b16fbe254f2b308ea307e32d0b5"><div class="ttname"><a href="structGroupQueueInfo.html#a4ff35b16fbe254f2b308ea307e32d0b5">GroupQueueInfo::opponentsTeamRating</a></div><div class="ttdeci">uint32 opponentsTeamRating</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00064">BattleGroundMgr.h:64</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a5563ea9b10d58ae3d72282a4be6edf18"><div class="ttname"><a href="structGroupQueueInfo.html#a5563ea9b10d58ae3d72282a4be6edf18">GroupQueueInfo::isRated</a></div><div class="ttdeci">bool isRated</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00056">BattleGroundMgr.h:56</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a5fd92196f972af5b47b8cae4eff66089"><div class="ttname"><a href="structGroupQueueInfo.html#a5fd92196f972af5b47b8cae4eff66089">GroupQueueInfo::bgTypeId</a></div><div class="ttdeci">BattleGroundTypeId bgTypeId</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00055">BattleGroundMgr.h:55</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a7d4926c899369f6d039f9938a3e3afea"><div class="ttname"><a href="structGroupQueueInfo.html#a7d4926c899369f6d039f9938a3e3afea">GroupQueueInfo::desiredInstanceId</a></div><div class="ttdeci">uint32 desiredInstanceId</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00062">BattleGroundMgr.h:62</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a7d68836a2a2d30f5ecf4e67f45685459"><div class="ttname"><a href="structGroupQueueInfo.html#a7d68836a2a2d30f5ecf4e67f45685459">GroupQueueInfo::arenaTeamId</a></div><div class="ttdeci">uint32 arenaTeamId</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00058">BattleGroundMgr.h:58</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_a88e7bb1f79bfd00568ea64decd9bdba4"><div class="ttname"><a href="structGroupQueueInfo.html#a88e7bb1f79bfd00568ea64decd9bdba4">GroupQueueInfo::isInvitedToBgInstanceGuid</a></div><div class="ttdeci">uint32 isInvitedToBgInstanceGuid</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00061">BattleGroundMgr.h:61</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_aad199f573947f2a86eec3dec3561c3c2"><div class="ttname"><a href="structGroupQueueInfo.html#aad199f573947f2a86eec3dec3561c3c2">GroupQueueInfo::arenaType</a></div><div class="ttdeci">ArenaType arenaType</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00057">BattleGroundMgr.h:57</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_ac5e508ed18408ce91fb9b2dab3a69265"><div class="ttname"><a href="structGroupQueueInfo.html#ac5e508ed18408ce91fb9b2dab3a69265">GroupQueueInfo::joinTime</a></div><div class="ttdeci">uint32 joinTime</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00059">BattleGroundMgr.h:59</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_aeb62b4617f24b10d24dd85c0bb48626f"><div class="ttname"><a href="structGroupQueueInfo.html#aeb62b4617f24b10d24dd85c0bb48626f">GroupQueueInfo::removeInviteTime</a></div><div class="ttdeci">uint32 removeInviteTime</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00060">BattleGroundMgr.h:60</a></div></div>
<div class="ttc" id="astructGroupQueueInfo_html_af5362b4209afc753ad48af7ceaf6966a"><div class="ttname"><a href="structGroupQueueInfo.html#af5362b4209afc753ad48af7ceaf6966a">GroupQueueInfo::groupTeam</a></div><div class="ttdeci">Team groupTeam</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00054">BattleGroundMgr.h:54</a></div></div>
<div class="ttc" id="astructPlayerQueueInfo_html"><div class="ttname"><a href="structPlayerQueueInfo.html">PlayerQueueInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00043">BattleGroundMgr.h:44</a></div></div>
<div class="ttc" id="astructPlayerQueueInfo_html_a1963b711ca37c7d28c8e0043f14b72c4"><div class="ttname"><a href="structPlayerQueueInfo.html#a1963b711ca37c7d28c8e0043f14b72c4">PlayerQueueInfo::groupInfo</a></div><div class="ttdeci">GroupQueueInfo * groupInfo</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00046">BattleGroundMgr.h:46</a></div></div>
<div class="ttc" id="astructPlayerQueueInfo_html_a8cb99eb641027a390825a854dd0dbc35"><div class="ttname"><a href="structPlayerQueueInfo.html#a8cb99eb641027a390825a854dd0dbc35">PlayerQueueInfo::lastOnlineTime</a></div><div class="ttdeci">uint32 lastOnlineTime</div><div class="ttdef"><b>Definition:</b> <a href="BattleGroundMgr_8h_source.html#l00045">BattleGroundMgr.h:45</a></div></div>
<div class="ttc" id="astructPvPDifficultyEntry_html"><div class="ttname"><a href="structPvPDifficultyEntry.html">PvPDifficultyEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01541">DBCStructure.h:1542</a></div></div>
<div class="ttc" id="astructPvPDifficultyEntry_html_a1385166568239f2118b65377df8b4b55"><div class="ttname"><a href="structPvPDifficultyEntry.html#a1385166568239f2118b65377df8b4b55">PvPDifficultyEntry::maxLevel</a></div><div class="ttdeci">uint32 maxLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01547">DBCStructure.h:1547</a></div></div>
<div class="ttc" id="astructPvPDifficultyEntry_html_a6e491b5202e2af6675eba8d4372274a1"><div class="ttname"><a href="structPvPDifficultyEntry.html#a6e491b5202e2af6675eba8d4372274a1">PvPDifficultyEntry::GetBracketId</a></div><div class="ttdeci">BattleGroundBracketId GetBracketId() const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01551">DBCStructure.h:1551</a></div></div>
<div class="ttc" id="astructPvPDifficultyEntry_html_acd07e8d759af1b73ec7543f6e70df242"><div class="ttname"><a href="structPvPDifficultyEntry.html#acd07e8d759af1b73ec7543f6e70df242">PvPDifficultyEntry::minLevel</a></div><div class="ttdeci">uint32 minLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01546">DBCStructure.h:1546</a></div></div>
<div class="ttc" id="astructWorldSafeLocsEntry_html"><div class="ttname"><a href="structWorldSafeLocsEntry.html">WorldSafeLocsEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="GraveyardManager_8h_source.html#l00025">GraveyardManager.h:26</a></div></div>
<div class="ttc" id="astructWorldSafeLocsEntry_html_a2309f388c48a169148932c758d0afaf5"><div class="ttname"><a href="structWorldSafeLocsEntry.html#a2309f388c48a169148932c758d0afaf5">WorldSafeLocsEntry::x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="GraveyardManager_8h_source.html#l00029">GraveyardManager.h:29</a></div></div>
<div class="ttc" id="astructWorldSafeLocsEntry_html_a4690a5a8f5c1598e5115d2e6f2f6debf"><div class="ttname"><a href="structWorldSafeLocsEntry.html#a4690a5a8f5c1598e5115d2e6f2f6debf">WorldSafeLocsEntry::z</a></div><div class="ttdeci">float z</div><div class="ttdef"><b>Definition:</b> <a href="GraveyardManager_8h_source.html#l00031">GraveyardManager.h:31</a></div></div>
<div class="ttc" id="astructWorldSafeLocsEntry_html_a4f38fe21bea4dcbacb1cc25e1a209561"><div class="ttname"><a href="structWorldSafeLocsEntry.html#a4f38fe21bea4dcbacb1cc25e1a209561">WorldSafeLocsEntry::y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="GraveyardManager_8h_source.html#l00030">GraveyardManager.h:30</a></div></div>
<div class="ttc" id="astructWorldSafeLocsEntry_html_aa3138280f78f53756f1d49cf37b65201"><div class="ttname"><a href="structWorldSafeLocsEntry.html#aa3138280f78f53756f1d49cf37b65201">WorldSafeLocsEntry::o</a></div><div class="ttdeci">float o</div><div class="ttdef"><b>Definition:</b> <a href="GraveyardManager_8h_source.html#l00032">GraveyardManager.h:32</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1699be727a800b1d059c6f7f2b91d2ee.html">game</a></li><li class="navelem"><a class="el" href="dir_ab4922530c3aff2ba840e6bbb19273c0.html">BattleGround</a></li><li class="navelem"><a class="el" href="BattleGroundMgr_8cpp.html">BattleGroundMgr.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
