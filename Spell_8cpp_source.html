<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CMaNGOS_WoTLK: Spell.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CMaNGOS_WoTLK
   &#160;<span id="projectnumber">0b6ed145724bbfe54f426dc34e27de563eb3bc54</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Spell_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Spell.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Spell_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * This file is part of the CMaNGOS Project. See AUTHORS file for Copyright information</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * This program is free software; you can redistribute it and/or modify</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * it under the terms of the GNU General Public License as published by</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * (at your option) any later version.</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * This program is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * GNU General Public License for more details.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * You should have received a copy of the GNU General Public License</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * along with this program; if not, write to the Free Software</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Spell_8h.html">Spells/Spell.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DatabaseEnv_8h.html">Database/DatabaseEnv.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="WorldPacket_8h.html">Server/WorldPacket.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="WorldSession_8h.html">Server/WorldSession.h</a>&quot;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GridNotifiers_8h.html">Grids/GridNotifiers.h</a>&quot;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="GridNotifiersImpl_8h.html">Grids/GridNotifiersImpl.h</a>&quot;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Opcodes_8h.html">Server/Opcodes.h</a>&quot;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Log_8h.html">Log.h</a>&quot;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="World_8h.html">World/World.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObjectMgr_8h.html">Globals/ObjectMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SpellMgr_8h.html">Spells/SpellMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Player_8h.html">Entities/Player.h</a>&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pet_8h.html">Entities/Pet.h</a>&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Unit_8h.html">Entities/Unit.h</a>&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DynamicObject_8h.html">Entities/DynamicObject.h</a>&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Group_8h.html">Groups/Group.h</a>&quot;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="UpdateData_8h.html">Entities/UpdateData.h</a>&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObjectAccessor_8h.html">Globals/ObjectAccessor.h</a>&quot;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CellImpl_8h.html">Grids/CellImpl.h</a>&quot;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Singleton_8h.html">Policies/Singleton.h</a>&quot;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SharedDefines_8h.html">Globals/SharedDefines.h</a>&quot;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="LootMgr_8h.html">Loot/LootMgr.h</a>&quot;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="VMapFactory_8h.html">Vmap/VMapFactory.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="BattleGround_8h.html">BattleGround/BattleGround.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Util_8h.html">Util/Util.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Chat_8h.html">Chat/Chat.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Vehicle_8h.html">Entities/Vehicle.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TemporarySpawn_8h.html">Entities/TemporarySpawn.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SQLStorages_8h.html">Server/SQLStorages.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PathFinder_8h.html">MotionGenerators/PathFinder.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SpellScript_8h.html">Spells/Scripts/SpellScript.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ObjectGuid_8h.html">Entities/ObjectGuid.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Transports_8h.html">Entities/Transports.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="keyword">extern</span> <a class="code" href="Spell_8h.html#abf8a42faff2e4c924eb6200d1243470e">pEffect</a> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97">SpellEffects</a>[<a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a38f4a390f591eee0f8f7873d4ef4ec49">MAX_SPELL_EFFECTS</a>];</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="classPrioritizeManaUnitWraper.html">   55</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPrioritizeManaUnitWraper.html">PrioritizeManaUnitWraper</a></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;{</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classPrioritizeManaUnitWraper.html#a7f67bddd3e776bfc46ef0b57b790c0d0">   58</a></span>&#160;        <span class="keyword">explicit</span> <a class="code" href="classPrioritizeManaUnitWraper.html#a7f67bddd3e776bfc46ef0b57b790c0d0">PrioritizeManaUnitWraper</a>(<a class="code" href="classUnit.html">Unit</a>* unit) : <a class="code" href="classPrioritizeManaUnitWraper.html#a16aeddc2f6a641306b52cb105487add5">i_unit</a>(unit)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxmana = unit-&gt;<a class="code" href="classUnit.html#a93f83fd909310de2c76382d00d7dbbf1">GetMaxPower</a>(<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;            <a class="code" href="classPrioritizeManaUnitWraper.html#a2eede6fcfaaa8ec2de5e8b21bedccf77">i_percent</a> = maxmana ? unit-&gt;<a class="code" href="classUnit.html#ad7e475d80b9af430cc076d7c01f967e9">GetPower</a>(<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>) * 100 / maxmana : 101;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        }</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="classPrioritizeManaUnitWraper.html#a4421ed0010cf68678c74a981a1233d90">   63</a></span>&#160;        <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classPrioritizeManaUnitWraper.html#a4421ed0010cf68678c74a981a1233d90">getUnit</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classPrioritizeManaUnitWraper.html#a16aeddc2f6a641306b52cb105487add5">i_unit</a>; }</div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classPrioritizeManaUnitWraper.html#ad51e2fcd204e05972936f0ad1283b076">   64</a></span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classPrioritizeManaUnitWraper.html#ad51e2fcd204e05972936f0ad1283b076">getPercent</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classPrioritizeManaUnitWraper.html#a2eede6fcfaaa8ec2de5e8b21bedccf77">i_percent</a>; }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classPrioritizeManaUnitWraper.html#a16aeddc2f6a641306b52cb105487add5">   66</a></span>&#160;        <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classPrioritizeManaUnitWraper.html#a16aeddc2f6a641306b52cb105487add5">i_unit</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classPrioritizeManaUnitWraper.html#a2eede6fcfaaa8ec2de5e8b21bedccf77">   67</a></span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classPrioritizeManaUnitWraper.html#a2eede6fcfaaa8ec2de5e8b21bedccf77">i_percent</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;};</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structPrioritizeMana.html">   70</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structPrioritizeMana.html">PrioritizeMana</a></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structPrioritizeMana.html#aa182d20b982897154a7f72a84adb9051">   72</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structPrioritizeMana.html#aa182d20b982897154a7f72a84adb9051">operator()</a>(<a class="code" href="classPrioritizeManaUnitWraper.html">PrioritizeManaUnitWraper</a> <span class="keyword">const</span>&amp; x, <a class="code" href="classPrioritizeManaUnitWraper.html">PrioritizeManaUnitWraper</a> <span class="keyword">const</span>&amp; y)<span class="keyword"> const</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        <span class="keywordflow">return</span> x.<a class="code" href="classPrioritizeManaUnitWraper.html#ad51e2fcd204e05972936f0ad1283b076">getPercent</a>() &gt; y.<a class="code" href="classPrioritizeManaUnitWraper.html#ad51e2fcd204e05972936f0ad1283b076">getPercent</a>();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;};</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="Spell_8cpp.html#a75fe3a63b7f03e4148a49154481cd53d">   78</a></span>&#160;<span class="keyword">typedef</span> std::priority_queue&lt;PrioritizeManaUnitWraper, std::vector&lt;PrioritizeManaUnitWraper&gt;, <a class="code" href="structPrioritizeMana.html">PrioritizeMana</a>&gt; <a class="code" href="Spell_8cpp.html#a75fe3a63b7f03e4148a49154481cd53d">PrioritizeManaUnitQueue</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classPrioritizeHealthUnitWraper.html">   80</a></span>&#160;<span class="keyword">class </span><a class="code" href="classPrioritizeHealthUnitWraper.html">PrioritizeHealthUnitWraper</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;{</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="classPrioritizeHealthUnitWraper.html#a25c4252f3068e7a7eebac88bca031482">   83</a></span>&#160;        <span class="keyword">explicit</span> <a class="code" href="classPrioritizeHealthUnitWraper.html#a25c4252f3068e7a7eebac88bca031482">PrioritizeHealthUnitWraper</a>(<a class="code" href="classUnit.html">Unit</a>* unit) : <a class="code" href="classPrioritizeHealthUnitWraper.html#a92e33dcab8a31dc09617e1b2540cce99">i_unit</a>(unit)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <a class="code" href="classPrioritizeHealthUnitWraper.html#a4925f46cf9cd6677361f8bb41e12c18f">i_percent</a> = unit-&gt;<a class="code" href="classUnit.html#ae3c4d9c8d0f20933a40fb4498be62c29">GetHealthPercent</a>();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classPrioritizeHealthUnitWraper.html#a5e9eca412b08d7e420d5c2afd51ffce4">   87</a></span>&#160;        <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classPrioritizeHealthUnitWraper.html#a5e9eca412b08d7e420d5c2afd51ffce4">getUnit</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classPrioritizeHealthUnitWraper.html#a92e33dcab8a31dc09617e1b2540cce99">i_unit</a>; }</div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classPrioritizeHealthUnitWraper.html#a04f435d35010336810210a886f40c62b">   88</a></span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classPrioritizeHealthUnitWraper.html#a04f435d35010336810210a886f40c62b">getPercent</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classPrioritizeHealthUnitWraper.html#a4925f46cf9cd6677361f8bb41e12c18f">i_percent</a>; }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classPrioritizeHealthUnitWraper.html#a92e33dcab8a31dc09617e1b2540cce99">   90</a></span>&#160;        <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classPrioritizeHealthUnitWraper.html#a92e33dcab8a31dc09617e1b2540cce99">i_unit</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="classPrioritizeHealthUnitWraper.html#a4925f46cf9cd6677361f8bb41e12c18f">   91</a></span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classPrioritizeHealthUnitWraper.html#a4925f46cf9cd6677361f8bb41e12c18f">i_percent</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;};</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="structPrioritizeHealth.html">   94</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structPrioritizeHealth.html">PrioritizeHealth</a></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;{</div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structPrioritizeHealth.html#a07abfec1d2f68355565460e6d474f2d3">   96</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structPrioritizeHealth.html#a07abfec1d2f68355565460e6d474f2d3">operator()</a>(<a class="code" href="classPrioritizeHealthUnitWraper.html">PrioritizeHealthUnitWraper</a> <span class="keyword">const</span>&amp; x, <a class="code" href="classPrioritizeHealthUnitWraper.html">PrioritizeHealthUnitWraper</a> <span class="keyword">const</span>&amp; y)<span class="keyword"> const</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">return</span> x.<a class="code" href="classPrioritizeHealthUnitWraper.html#a04f435d35010336810210a886f40c62b">getPercent</a>() &gt; y.<a class="code" href="classPrioritizeHealthUnitWraper.html#a04f435d35010336810210a886f40c62b">getPercent</a>();</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;};</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="Spell_8cpp.html#a383f3a05d4be51b435ee3729ecef2945">  102</a></span>&#160;<span class="keyword">typedef</span> std::priority_queue&lt;PrioritizeHealthUnitWraper, std::vector&lt;PrioritizeHealthUnitWraper&gt;, <a class="code" href="structPrioritizeHealth.html">PrioritizeHealth</a>&gt; <a class="code" href="Spell_8cpp.html#a383f3a05d4be51b435ee3729ecef2945">PrioritizeHealthUnitQueue</a>;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="Spell_8cpp.html#a9139404c5db8890c4fa92c1a7a8e68b1">  104</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="Spell_8cpp.html#a9139404c5db8890c4fa92c1a7a8e68b1">IsQuestTameSpell</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellproto = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(spellId);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">if</span> (!spellproto)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">return</span> spellproto-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aef7bb8a1f1b7064a44d136d9f622618a">SPELL_EFFECT_THREAT</a></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;           &amp;&amp; spellproto-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db">EFFECT_INDEX_1</a>] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d">SPELL_EFFECT_APPLY_AURA</a> &amp;&amp; spellproto-&gt;<a class="code" href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">EffectApplyAuraName</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db">EFFECT_INDEX_1</a>] == <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf">SPELL_AURA_DUMMY</a>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;}</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">// SpellCastTargets class</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">// **********************</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#aae040bf9308a0ee63208cdb6cd15580b">  117</a></span>&#160;<a class="code" href="classSpellCastTargets.html#aae040bf9308a0ee63208cdb6cd15580b">SpellCastTargets::SpellCastTargets</a>()</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="classSpellCastTargets.html#a689c7eccebe061bf922feefa6f2b573a">m_unitTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <a class="code" href="classSpellCastTargets.html#ad4fc13d480005a5a843343337609d610">m_GOTarget</a>   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="classSpellCastTargets.html#af50c56408314351ab31dad61da35d2f8">m_CorpseTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="classSpellCastTargets.html#aca34f267418ee0bfae1d6e19b2cebc45">m_itemTargetEntry</a>  = 0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classSpellCastTargets.html#a7980149cc7e517022ee042846ad7176a">m_strTarget</a>.clear();</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> = 0;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classSpellCastTargets.html#a8e006f10fb11d63e09434d7b3209380e">m_elevation</a> = 0.0f;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classSpellCastTargets.html#a7a028a5091990652b82e27148eeba0e7">m_speed</a> = 0.0f;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classSpellCastTargets.html#afd911e74e902f7a8f255b0b92937bc61">m_mapId</a> = UINT32_MAX;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;}</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#ab3bf003f250e2d77bf1905e4c8b81244">  134</a></span>&#160;<a class="code" href="classSpellCastTargets.html#ab3bf003f250e2d77bf1905e4c8b81244">SpellCastTargets::~SpellCastTargets</a>()</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;{</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;}</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">  138</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">SpellCastTargets::setUnitTarget</a>(<a class="code" href="classUnit.html">Unit</a>* target)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a> = target-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <a class="code" href="classSpellCastTargets.html#a689c7eccebe061bf922feefa6f2b573a">m_unitTarget</a> = target;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="classSpellCastTargets.html#ae03a7a2663dc534b43ab15970b7f38f9">m_unitTargetGUID</a> = target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;}</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">  149</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">SpellCastTargets::setDestination</a>(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;{</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> = x;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> = y;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a> = z;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a33c6dafa171a414f19b2ec85aeaa4d93">  157</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">SpellCastTargets::setDestination</a>(<a class="code" href="structPosition.html">Position</a> position)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a> = position;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#afa341e13427e2d645c72fb04c55b7922">  163</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#afa341e13427e2d645c72fb04c55b7922">SpellCastTargets::setSource</a>(<span class="keywordtype">float</span> x, <span class="keywordtype">float</span> y, <span class="keywordtype">float</span> z)</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;{</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> = x;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> = y;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a> = z;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a85fac9724b195534fd0348be2937c331">  171</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a85fac9724b195534fd0348be2937c331">SpellCastTargets::setGOTarget</a>(<a class="code" href="classGameObject.html">GameObject</a>* target)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;{</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="classSpellCastTargets.html#ad4fc13d480005a5a843343337609d610">m_GOTarget</a> = target;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="classSpellCastTargets.html#a668ddc424939e93a1f7f3eff97d02138">m_GOTargetGUID</a> = target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">//    m_targetMask |= TARGET_FLAG_GAMEOBJECT;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a5ddeb0e96775789e553286c9cc879c27">  178</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a5ddeb0e96775789e553286c9cc879c27">SpellCastTargets::setItemTarget</a>(<a class="code" href="classItem.html">Item</a>* item)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;{</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <span class="keywordflow">if</span> (!item)</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a> = item;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">m_itemTargetGUID</a> = item-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classSpellCastTargets.html#aca34f267418ee0bfae1d6e19b2cebc45">m_itemTargetEntry</a> = item-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49">TARGET_FLAG_ITEM</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#af17d6161f1bf74aa8c13c30885dcdbeb">  189</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#af17d6161f1bf74aa8c13c30885dcdbeb">SpellCastTargets::setTradeItemTarget</a>(<a class="code" href="classPlayer.html">Player</a>* caster)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;{</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">m_itemTargetGUID</a> = <a class="code" href="classObjectGuid.html">ObjectGuid</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(<a class="code" href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62abdab7c30065c4b145dd2e6ce0e27c45f">TRADE_SLOT_NONTRADED</a>));</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classSpellCastTargets.html#aca34f267418ee0bfae1d6e19b2cebc45">m_itemTargetEntry</a> = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="classSpellCastTargets.html#acba7dabf3692dcf95a31ad1ed6a5089b">Update</a>(caster);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a5f5f01751fab6066b430d427466121c1">  198</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a5f5f01751fab6066b430d427466121c1">SpellCastTargets::setCorpseTarget</a>(<a class="code" href="classCorpse.html">Corpse</a>* corpse)</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classSpellCastTargets.html#af50c56408314351ab31dad61da35d2f8">m_CorpseTarget</a> = corpse;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <a class="code" href="classSpellCastTargets.html#a357429830fcc4577ac9bafbcb6d4db37">m_CorpseTargetGUID</a> = corpse-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;}</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#acba7dabf3692dcf95a31ad1ed6a5089b">  204</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#acba7dabf3692dcf95a31ad1ed6a5089b">SpellCastTargets::Update</a>(<a class="code" href="classWorldObject.html">WorldObject</a>* caster)</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;{</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classSpellCastTargets.html#ad4fc13d480005a5a843343337609d610">m_GOTarget</a>   = <a class="code" href="classSpellCastTargets.html#a668ddc424939e93a1f7f3eff97d02138">m_GOTargetGUID</a> ? caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(<a class="code" href="classSpellCastTargets.html#a668ddc424939e93a1f7f3eff97d02138">m_GOTargetGUID</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classSpellCastTargets.html#a689c7eccebe061bf922feefa6f2b573a">m_unitTarget</a> = <a class="code" href="classSpellCastTargets.html#ae03a7a2663dc534b43ab15970b7f38f9">m_unitTargetGUID</a> ?</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                   (<a class="code" href="classSpellCastTargets.html#ae03a7a2663dc534b43ab15970b7f38f9">m_unitTargetGUID</a> == caster-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() ? <span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(caster) : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*caster, <a class="code" href="classSpellCastTargets.html#ae03a7a2663dc534b43ab15970b7f38f9">m_unitTargetGUID</a>)) :</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                   <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; </div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="classSpellCastTargets.html#af50c56408314351ab31dad61da35d2f8">m_CorpseTarget</a> = <a class="code" href="classObjectAccessor.html#a0d4a6323d8cf6690976731f16a588fe8">ObjectAccessor::GetCorpseInMap</a>(<a class="code" href="classSpellCastTargets.html#a357429830fcc4577ac9bafbcb6d4db37">m_CorpseTargetGUID</a>, caster-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>());</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* player = ((<a class="code" href="classPlayer.html">Player</a>*)caster);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49">TARGET_FLAG_ITEM</a>)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a> = player-&gt;<a class="code" href="classPlayer.html#adf5d2bf68d3caad2202caeb25daadc8e">GetItemByGuid</a>(<a class="code" href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">m_itemTargetGUID</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classTradeData.html">TradeData</a>* pTrade = player-&gt;<a class="code" href="classPlayer.html#ac23afe6cea3000024eb546a42d52e6ef">GetTradeData</a>())</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">m_itemTargetGUID</a>.<a class="code" href="classObjectGuid.html#a65626f4640cb4f79c66ce9d5dda8ab27">GetRawValue</a>() &lt; <a class="code" href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62a1e8d56a5a22d784c5d388fd8bd206488">TRADE_SLOT_COUNT</a>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                    <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a> = pTrade-&gt;GetTraderData()-&gt;GetItem(<a class="code" href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62">TradeSlots</a>(<a class="code" href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">m_itemTargetGUID</a>.<a class="code" href="classObjectGuid.html#a65626f4640cb4f79c66ce9d5dda8ab27">GetRawValue</a>()));</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a>)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <a class="code" href="classSpellCastTargets.html#aca34f267418ee0bfae1d6e19b2cebc45">m_itemTargetEntry</a> = <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">m_srcTransportGUID</a>)</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGenericTransport.html">GenericTransport</a>* transport = caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a21da1922573a3ebf32e7bac056c7ee65">GetTransport</a>(<a class="code" href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">m_srcTransportGUID</a>))</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <a class="code" href="structPosition.html">Position</a> temp = <a class="code" href="classSpellCastTargets.html#a23b37368504caddfb397425514312cc7">m_srcTransportPos</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            transport-&gt;CalculatePassengerPosition(temp.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, temp.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, temp.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>, &amp;temp.<a class="code" href="structPosition.html#ab03b4a5c58b5d266e2505bffc906d21e">o</a>);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a> = temp;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">m_destTransportGUID</a>)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classGenericTransport.html">GenericTransport</a>* transport = caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a21da1922573a3ebf32e7bac056c7ee65">GetTransport</a>(<a class="code" href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">m_destTransportGUID</a>))</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <a class="code" href="structPosition.html">Position</a> temp = <a class="code" href="classSpellCastTargets.html#a251b411d756aee45e9ecea9fcbd676ad">m_destTransportPos</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            transport-&gt;CalculatePassengerPosition(temp.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, temp.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, temp.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>, &amp;temp.<a class="code" href="structPosition.html#ab03b4a5c58b5d266e2505bffc906d21e">o</a>);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a> = temp;</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;}</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a524a7750c6c3fa3532d38cc94583b13d">  251</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a524a7750c6c3fa3532d38cc94583b13d">SpellCastTargets::read</a>(<a class="code" href="classByteBuffer.html">ByteBuffer</a>&amp; data, <a class="code" href="classUnit.html">Unit</a>* caster)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;{</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> == <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fafe9a52eb16cad63aeb4202ecae8e2c18">TARGET_FLAG_SELF</a>)</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// TARGET_FLAG_UNIT_MINIPET is used for non-combat pets, maybe other?</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa41f9f26a19c99a5517d021765a1173e3">TARGET_FLAG_UNIT_MINIPET</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa3325fba850592588fce959a992007a87">TARGET_FLAG_UNIT_ENEMY</a>))</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#ae03a7a2663dc534b43ab15970b7f38f9">m_unitTargetGUID</a>.<a class="code" href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ReadAsPacked</a>();</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0cc43eed3775f0742de2f496d9dadc49">TARGET_FLAG_GAMEOBJECT</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0b198012d8080657fe78d2b311503d5e">TARGET_FLAG_LOCKED</a>))</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a668ddc424939e93a1f7f3eff97d02138">m_GOTargetGUID</a>.<a class="code" href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ReadAsPacked</a>();</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49">TARGET_FLAG_ITEM</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)) &amp;&amp; caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">m_itemTargetGUID</a>.<a class="code" href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ReadAsPacked</a>();</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11">TARGET_FLAG_CORPSE_ALLY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b">TARGET_FLAG_CORPSE_ENEMY</a>))</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a357429830fcc4577ac9bafbcb6d4db37">m_CorpseTargetGUID</a>.<a class="code" href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ReadAsPacked</a>();</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">m_srcTransportGUID</a>.<a class="code" href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ReadAsPacked</a>();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">m_srcTransportGUID</a>)</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a23b37368504caddfb397425514312cc7">m_srcTransportPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a23b37368504caddfb397425514312cc7">m_srcTransportPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a23b37368504caddfb397425514312cc7">m_srcTransportPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a> = <a class="code" href="classSpellCastTargets.html#a23b37368504caddfb397425514312cc7">m_srcTransportPos</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGenericTransport.html">GenericTransport</a>* transport = caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a21da1922573a3ebf32e7bac056c7ee65">GetTransport</a>(<a class="code" href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">m_srcTransportGUID</a>))</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                transport-&gt;CalculatePassengerPosition(<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>, &amp;<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#ab03b4a5c58b5d266e2505bffc906d21e">o</a>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespaceMaNGOS.html#ae0f51133c9887d1ccc5b1dcc7e39f5e9">MaNGOS::IsValidMapCoord</a>(<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classByteBufferException.html">ByteBufferException</a>(<span class="keyword">false</span>, data.<a class="code" href="classByteBuffer.html#a1e1a47f362861d8cd61cdf27f7eb1812">rpos</a>(), 0, data.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">m_destTransportGUID</a>.<a class="code" href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ReadAsPacked</a>();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">m_destTransportGUID</a>)</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a251b411d756aee45e9ecea9fcbd676ad">m_destTransportPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a251b411d756aee45e9ecea9fcbd676ad">m_destTransportPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a251b411d756aee45e9ecea9fcbd676ad">m_destTransportPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a> = <a class="code" href="classSpellCastTargets.html#a251b411d756aee45e9ecea9fcbd676ad">m_destTransportPos</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGenericTransport.html">GenericTransport</a>* transport = caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a21da1922573a3ebf32e7bac056c7ee65">GetTransport</a>(<a class="code" href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">m_destTransportGUID</a>))</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                transport-&gt;CalculatePassengerPosition(<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>, &amp;<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#ab03b4a5c58b5d266e2505bffc906d21e">o</a>);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &gt;&gt; <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespaceMaNGOS.html#ae0f51133c9887d1ccc5b1dcc7e39f5e9">MaNGOS::IsValidMapCoord</a>(<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>))</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">throw</span> <a class="code" href="classByteBufferException.html">ByteBufferException</a>(<span class="keyword">false</span>, data.<a class="code" href="classByteBuffer.html#a1e1a47f362861d8cd61cdf27f7eb1812">rpos</a>(), 0, data.<a class="code" href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">size</a>());</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa24d43cf0043fec76138893870d0f33e4">TARGET_FLAG_STRING</a>)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        data &gt;&gt; <a class="code" href="classSpellCastTargets.html#a7980149cc7e517022ee042846ad7176a">m_strTarget</a>;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// find real units/GOs</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <a class="code" href="classSpellCastTargets.html#acba7dabf3692dcf95a31ad1ed6a5089b">Update</a>(caster);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;}</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="classSpellCastTargets.html#a865d258a598ff7453e85649e527bc44b">  310</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellCastTargets.html#a865d258a598ff7453e85649e527bc44b">SpellCastTargets::write</a>(<a class="code" href="classByteBuffer.html">ByteBuffer</a>&amp; data)<span class="keyword"> const</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b">TARGET_FLAG_CORPSE_ENEMY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0cc43eed3775f0742de2f496d9dadc49">TARGET_FLAG_GAMEOBJECT</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11">TARGET_FLAG_CORPSE_ALLY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa41f9f26a19c99a5517d021765a1173e3">TARGET_FLAG_UNIT_MINIPET</a>))</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a>)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a689c7eccebe061bf922feefa6f2b573a">m_unitTarget</a>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                data &lt;&lt; <a class="code" href="classSpellCastTargets.html#a689c7eccebe061bf922feefa6f2b573a">m_unitTarget</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        }</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0cc43eed3775f0742de2f496d9dadc49">TARGET_FLAG_GAMEOBJECT</a>)</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        {</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#ad4fc13d480005a5a843343337609d610">m_GOTarget</a>)</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                data &lt;&lt; <a class="code" href="classSpellCastTargets.html#ad4fc13d480005a5a843343337609d610">m_GOTarget</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11">TARGET_FLAG_CORPSE_ALLY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b">TARGET_FLAG_CORPSE_ENEMY</a>))</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            data &lt;&lt; <a class="code" href="classSpellCastTargets.html#a357429830fcc4577ac9bafbcb6d4db37">m_CorpseTargetGUID</a>.<a class="code" href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49">TARGET_FLAG_ITEM</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>))</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a>)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            data &lt;&lt; <a class="code" href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">m_itemTarget</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        data &lt;&lt; <a class="code" href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">m_srcTransportGUID</a>.<a class="code" href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        data &lt;&lt; <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &lt;&lt; <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &lt;&lt; <a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        data &lt;&lt; <a class="code" href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">m_destTransportGUID</a>.<a class="code" href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        data &lt;&lt; <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &lt;&lt; <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &lt;&lt; <a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa24d43cf0043fec76138893870d0f33e4">TARGET_FLAG_STRING</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        data &lt;&lt; <a class="code" href="classSpellCastTargets.html#a7980149cc7e517022ee042846ad7176a">m_strTarget</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">// SpellLog class</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">// **************</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classSpellLog.html#a6bd272f573b8e217c6ea18843236ccdf">  363</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellLog.html#a6bd272f573b8e217c6ea18843236ccdf">SpellLog::Initialize</a>()</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca5ad793f4246ce905e7c0e7461c1f8a6a">SMSG_SPELLLOGEXECUTE</a>);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">//m_spellLogData &lt;&lt; m_spell-&gt;GetCaster()-&gt;GetPackGUID();</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>.<a class="code" href="classByteBuffer.html#a2dd5e1c2c674c3a0a4c368f6fa833dd6">appendPackGUID</a>(<a class="code" href="classSpellLog.html#a7b5701412168f4838480cd9a4d2f187f">m_spell</a>-&gt;<a class="code" href="classSpell.html#abe5d2483c52b087c98e7f7b1c49606ad">GetTrueCaster</a>()-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>().<a class="code" href="classObjectGuid.html#a65626f4640cb4f79c66ce9d5dda8ab27">GetRawValue</a>());</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a> &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpellLog.html#a7b5701412168f4838480cd9a4d2f187f">m_spell</a>-&gt;<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classSpellLog.html#a7800e73549c607ca1b70613daf6c5a54">m_spellLogDataEffectsCounterPos</a> = <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>.<a class="code" href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">wpos</a>();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a> &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                            <span class="comment">//placeholder</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classSpellLog.html#aa9f2bd5847231a14665c02e66a304346">m_spellLogDataEffectsCounter</a> = 0;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="line" href="classSpellLog.html#a2f0110d6d4dec153f336825cfb1c2197">  374</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellLog.html#a2f0110d6d4dec153f336825cfb1c2197">SpellLog::FinalizePrevious</a>()</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellLog.html#a02d04282fcdf49f6480098cdfdc54837">m_currentEffect</a> &lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a38f4a390f591eee0f8f7873d4ef4ec49">MAX_SPELL_EFFECTS</a>))</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="comment">// not first effect processed so we have to finalize the previous one by putting correct amount of targets</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>.<a class="code" href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">put</a>&lt;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&gt;(<a class="code" href="classSpellLog.html#a82417543f128da7458422ff92fd63dbf">m_spellLogDataTargetsCounterPos</a>, <a class="code" href="classSpellLog.html#a4430d5157d7e0c6c13e38919f3863e42">m_spellLogDataTargetsCounter</a>);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="classSpellLog.html#a02d04282fcdf49f6480098cdfdc54837">m_currentEffect</a> = <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a38f4a390f591eee0f8f7873d4ef4ec49">MAX_SPELL_EFFECTS</a>);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    }</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="classSpellLog.html#a201d26c46c6496801d03362aa9e79255">  384</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellLog.html#a201d26c46c6496801d03362aa9e79255">SpellLog::SetCurrentEffect</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effect)</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">// check if its same effect so we don&#39;t have to put header</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (effect == <a class="code" href="classSpellLog.html#a02d04282fcdf49f6480098cdfdc54837">m_currentEffect</a>)</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        ++<a class="code" href="classSpellLog.html#a4430d5157d7e0c6c13e38919f3863e42">m_spellLogDataTargetsCounter</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <a class="code" href="classSpellLog.html#a2f0110d6d4dec153f336825cfb1c2197">FinalizePrevious</a>();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a> &lt;&lt; effect;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="classSpellLog.html#a82417543f128da7458422ff92fd63dbf">m_spellLogDataTargetsCounterPos</a> = <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>.<a class="code" href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">wpos</a>();</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a> &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                            <span class="comment">// placeholder for target counter</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="classSpellLog.html#a02d04282fcdf49f6480098cdfdc54837">m_currentEffect</a> = effect;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="classSpellLog.html#a4430d5157d7e0c6c13e38919f3863e42">m_spellLogDataTargetsCounter</a> = 1;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno"><a class="line" href="classSpellLog.html#a234368e990a795b9af41ba158e4d9db4">  402</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellLog.html#a234368e990a795b9af41ba158e4d9db4">SpellLog::SendToSet</a>()</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;{</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpellLog.html#aa9f2bd5847231a14665c02e66a304346">m_spellLogDataEffectsCounter</a>)</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// check if one of previous target is not finalized</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classSpellLog.html#a2f0110d6d4dec153f336825cfb1c2197">FinalizePrevious</a>();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// put total effect counter in packet</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>.<a class="code" href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">put</a>&lt;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&gt;(<a class="code" href="classSpellLog.html#a7800e73549c607ca1b70613daf6c5a54">m_spellLogDataEffectsCounterPos</a>, <a class="code" href="classSpellLog.html#aa9f2bd5847231a14665c02e66a304346">m_spellLogDataEffectsCounter</a>);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="classSpellLog.html#a7b5701412168f4838480cd9a4d2f187f">m_spell</a>-&gt;<a class="code" href="classSpell.html#abe5d2483c52b087c98e7f7b1c49606ad">GetTrueCaster</a>()-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(<a class="code" href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">m_spellLogData</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// make it ready for another log if need</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <a class="code" href="classSpellLog.html#a6bd272f573b8e217c6ea18843236ccdf">Initialize</a>();</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">// Spell class</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">// ***********</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="classSpell.html#aebdf5cc0847865b97bf8f4b06a5921f6">  421</a></span>&#160;<a class="code" href="classSpell.html#aebdf5cc0847865b97bf8f4b06a5921f6">Spell::Spell</a>(<a class="code" href="classWorldObject.html">WorldObject</a>* caster, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* info, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> triggeredFlags, <a class="code" href="classObjectGuid.html">ObjectGuid</a> originalCasterGUID, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* triggeredBy) :</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    m_partialApplicationMask(0), m_spellScript(<a class="code" href="classSpellScriptMgr.html">SpellScriptMgr</a>::GetSpellScript(info-&gt;Id)), m_auraScript(<a class="code" href="classSpellScriptMgr.html">SpellScriptMgr</a>::GetAuraScript(info-&gt;Id)),</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    m_spellEvent(nullptr), m_spellLog(this), m_param1(0), m_param2(0), m_trueCaster(caster)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="Errors_8h.html#a7b94d20194b84dde056465e12496d3f4">MANGOS_ASSERT</a>(caster != <span class="keyword">nullptr</span> &amp;&amp; info != <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <a class="code" href="Errors_8h.html#a7b94d20194b84dde056465e12496d3f4">MANGOS_ASSERT</a>(info == <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(info-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>) &amp;&amp; <span class="stringliteral">&quot;`info` must be pointer to sSpellTemplate element&quot;</span>);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (info-&gt;<a class="code" href="structSpellEntry.html#afaee718bd1e230dce004419da66f188e">SpellDifficultyId</a> &amp;&amp; caster-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() &amp;&amp; caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0c80d50b012dc8d560e256201970f3b3">IsDungeon</a>())</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellEntry = <a class="code" href="SpellMgr_8cpp.html#ab4186b06cc81cf862ba2c93c23b77786">GetSpellEntryByDifficulty</a>(info-&gt;<a class="code" href="structSpellEntry.html#afaee718bd1e230dce004419da66f188e">SpellDifficultyId</a>, caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ace981bca7a407e53d8f3506b5eecb2da">GetDifficulty</a>(), caster-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a556d2eafa563b4a5de4957de28e369b3">IsRaid</a>()))</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a> = spellEntry;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a> = info;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a> = info;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <a class="code" href="classSpell.html#ab3d3ccf4db3daa4de3bdfd7fe3371eae">m_triggeredBySpellInfo</a> = triggeredBy;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(caster);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <a class="code" href="classSpell.html#a10c83ebca0cec17982c4e6a849ec668f">m_referencedFromCurrentSpell</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <a class="code" href="classSpell.html#a70b015d3289a781f9f7097e6581cadf5">m_executedCurrently</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="classSpell.html#a21ad65d1dbdf61469baa14a0e49887b6">m_delayStart</a> = 0;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <a class="code" href="classSpell.html#a4b89533356cf0fe417a3e646c30e5a04">m_delayAtDamageCount</a> = 0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="classSpell.html#ac63ea9310b09ececfc1eac19133abce1">m_applyMultiplierMask</a> = 0;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// Get data for type of attack</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a> = <a class="code" href="SpellMgr_8cpp.html#a8a6c654559ee1eedaa1c460dd60f1823">GetWeaponAttackType</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a> = <a class="code" href="SpellMgr_8h.html#a22e0f1c7f488563ce1e10a2ae2d4906d">GetSpellSchoolMask</a>(info);           <span class="comment">// Can be override for some spell (wand shoot for example)</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">// wand case</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a> == <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> (!!(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abbbd9cc147469bc7f35075539bdf55a0">getClassMask</a>() &amp; <a class="code" href="SharedDefines_8h.html#a3002b6959a1e2bc149144b9ae9a9728c">CLASSMASK_WAND_USERS</a>) &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a> = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a330a0f343946954a1996ee04cb9c6e3c">GetRangedDamageSchoolMask</a>();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">// Set health leech amount to zero</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <a class="code" href="classSpell.html#aeea292e4bbbeb073f624dabda6420903">m_healthLeech</a> = 0;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a> = originalCasterGUID ? originalCasterGUID : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <a class="code" href="classSpell.html#af4432b3a613d924a4bdc8f68e9c99dac">UpdateOriginalCasterPointer</a>();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="classSpell.html#ac6c221b279935d9dfdf840f569f62954">m_currentBasePoints</a>[i] = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6f908af779d48f0107cc905c5e97d457">CalculateSimpleValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i));</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa2469fe6b82004a0a40c5f2162b362dd0">SPELL_STATE_CREATED</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classSpell.html#a72d630ee8147b4197d46503dd2c9ed34">m_castPositionX</a> = <a class="code" href="classSpell.html#a7a1b42fb496a662f928a3f3f2e738bcc">m_castPositionY</a> = <a class="code" href="classSpell.html#a5e4e64d34f282231e10ec16596700432">m_castPositionZ</a> = 0;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <a class="code" href="classSpell.html#ab74dcb259c27daf0a123cc30049d1b37">m_TriggerSpells</a>.clear();</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="classSpell.html#a9bc6be667fcb649021e8c4b8d6a0cc1f">m_preCastSpells</a>.clear();</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> = triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">// m_AreaAura = false;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <a class="code" href="classSpell.html#a8159f0f9fef838bc5f506d3e6950e71c">m_itemCastSpell</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="classSpell.html#a0e7f35f88f4bad9f5599c67fde08f98a">gameObjTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <a class="code" href="classSpell.html#a04adccf710024da5871ed1f1dfd8fe4a">corpseTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="classSpell.html#af20339d17376838e640f9cc2f9b01308">m_eventTarget</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a> = 0;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <a class="code" href="classSpell.html#a97631df87d99fcf61c1eba094122ff76">m_glyphIndex</a> = 0;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>  = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// Auto Shot &amp; Shoot (wand)</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <a class="code" href="classSpell.html#af8e7a207583b68ff524b4372e995664a">m_autoRepeat</a> = <a class="code" href="SpellMgr_8h.html#a9fd9fd7aff5bf01e30dc3b9a6858058e">IsAutoRepeatRangedSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="classSpell.html#af6bea341ebc74608726857671d92bb6d">m_runesState</a> = 0;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <a class="code" href="classSpell.html#aa1e44566b72ceb6915fc6ea3d2f92f26">m_runesStateAfterCast</a> = 0;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a> = 0;                                        <span class="comment">// setup to correct value in Spell::prepare, don&#39;t must be used before.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a> = 0;                                         <span class="comment">// setup to correct value in Spell::prepare, don&#39;t must be used before.</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> = 0;                                            <span class="comment">// will set to cast time in prepare</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="classSpell.html#a566fd7627f0840d8a2cc69fbdc9d4c25">m_creationTime</a> = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a753346ed8fd6a52a17aa1bccb0652990">GetCurrentMSTime</a>();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classSpell.html#a9bbf21780bd930bcb9855935743bec2f">m_updated</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a> = 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <a class="code" href="classSpell.html#a1eccb88ab5fe5367817bcbbdbb368b81">m_maxRange</a> = 0.f;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="classSpell.html#adcb37c1f1904971b48304f6d18d48ee5">m_needAliveTargetMask</a> = 0;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="classSpell.html#a2802c4efcae1cb5ad2b5a1fbe12d59b7">m_ignoreHitResult</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ae6af255402f3dfe4ba0549396658ab7f">TRIGGERED_IGNORE_HIT_CALCULATION</a>) != 0;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classSpell.html#a86aa78d62024c54252d387e9e230878c">m_ignoreUnselectableTarget</a> = <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a16535f56de056146743172e37087b879">TRIGGERED_IGNORE_UNSELECTABLE_FLAG</a>) != 0);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="classSpell.html#a840b081d5abbcaeda47b522fbdd36e62">m_ignoreCastTime</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a5b958fa73cfa7edb70dad57c96ca69d8">TRIGGERED_INSTANT_CAST</a>) != 0;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <a class="code" href="classSpell.html#abd4373f5c04145f12de7e58a03811d09">m_ignoreUnattackableTarget</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a517c1f96821a2e7aa5c7c6e38aa8e4e0">TRIGGERED_IGNORE_UNATTACKABLE_FLAG</a>) != 0;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="classSpell.html#a11b87f50b82300c30c1d17dd079c1fd5">m_triggerAutorepeat</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29abc810f966ed6f07995c8ed514f7ede64">TRIGGERED_AUTOREPEAT</a>) != 0;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="classSpell.html#a95aee0efa022cac01f221d3435736f38">m_doNotProc</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a0a7f659a1c84875e683b12be98690486">TRIGGERED_DO_NOT_PROC</a>) != 0;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="classSpell.html#a08f2d24b9c2b77d5638a8f7d8aa4d4a1">m_petCast</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ac9685659ce6bfb28f1b00ee4f9f5be8e">TRIGGERED_PET_CAST</a>) != 0;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <a class="code" href="classSpell.html#a8425d18c430e7f6f47cc66f8576b62df">m_notifyAI</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aee3c4111b8df4a50e93ca83f992f5682">TRIGGERED_NORMAL_COMBAT_CAST</a>) != 0;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <a class="code" href="classSpell.html#ad496cad5a2082b8d8b4afa249855417a">m_ignoreGCD</a> = <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a899fa7df360462673111bbfbb0bbd00d">TRIGGERED_IGNORE_GCD</a>) != 0);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <a class="code" href="classSpell.html#aa2b31e212fc2a2b6608c464b428976d1">m_ignoreCosts</a> = <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad52490b339c2e30db5418166416d18c0">TRIGGERED_IGNORE_COSTS</a>) != 0);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="classSpell.html#aeef1431d123d73b176f47567a0e01647">m_ignoreCooldowns</a> = <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aaf2e6f2e4c3f497f195817316711147c">TRIGGERED_IGNORE_COOLDOWNS</a>) != 0);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="classSpell.html#a3ae4f6a6ff1cf1d52d5e2dce4bcd43fa">m_ignoreConcurrentCasts</a> = <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aedf85a11ac6fb96d0b2d08509bb40a7d">TRIGGERED_IGNORE_CURRENT_CASTED_SPELL</a>) != 0) || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035ac28babc82dd18ec816e8dcf5fbce54d1">SPELL_ATTR_EX4_ALLOW_CAST_WHILE_CASTING</a>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="classSpell.html#af8ae043215e1e85e6e67b934ae91d896">m_ignoreCasterAuraState</a> = <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a5d21f7fce865b4cab5bbe0b48698dd61">TRIGGERED_IGNORE_CASTER_AURA_STATE</a>) != 0 || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a56972efc92caab29f6fa30e2cce3286c">SPELL_ATTR_EX5_IGNORE_CASTER_REQUIREMENTS</a>));</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="classSpell.html#a9b11d1180294970c027d069197dd57c7">m_hideInCombatLog</a> = (<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a9fd9fd7aff5bf01e30dc3b9a6858058e">IsAutoRepeatRangedSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) || ((triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a8c3d6f3b162ab6c0398ff725e7e4ef69">TRIGGERED_HIDE_CAST_IN_COMBAT_LOG</a>) != 0);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="classSpell.html#a6aedd6eccb2dc430c199cb5144c5e6f4">m_resetLeash</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aea48543e222d5f119aba63ec668feecb">TRIGGERED_DO_NOT_RESET_LEASH</a>) == 0;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <a class="code" href="classSpell.html#afbeb295ad7652c0abf129066e76a4a10">m_channelOnly</a> = (triggeredFlags &amp; <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a25fb62b8551cfab083926b40f2e306f1">TRIGGERED_CHANNEL_ONLY</a>) != 0;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <a class="code" href="classSpell.html#a2999180c9cb3caf82303f88dd2f3e6e3">m_clientCast</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="classSpell.html#a180d44289121f790927b13253164d1b2">m_reflectable</a> = <a class="code" href="SpellMgr_8h.html#a8725a06093ceafbdf644303cd4af633e">IsReflectableSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="classSpell.html#a8de51903353a2351a520711b9b9a187f">m_spellFlags</a> = <a class="code" href="Spell_8h.html#a68423826ac8d5f2d2aca7e83dfa9d2c2abc18f1a292e6163055b15c50854a6cbe">SPELL_FLAG_NORMAL</a>;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a> = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6d6f3c418ca9cd448e8e861c1324a93a">MaxAffectedTargets</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="classSpell.html#ab0dff4108f46be429308f82a301e310e">m_chainTargetCount</a>[i] = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a44ccfe3e8ec838d73c09d1e6aa261c19">EffectChainTarget</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)];</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a> = <a class="code" href="classSpellTargetMgr.html#a97e1223049b826364a522110f5c7ff3f">SpellTargetMgr::GetJumpRadius</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    memcpy(<a class="code" href="classSpell.html#ade05873e2d5e60d68fed60995ef56bc4">m_filteringScheme</a>, <a class="code" href="classSpellTargetMgr.html#a7cbcb402c05cdbe0f5cb24423e1cce21">SpellTargetMgr::GetSpellTargetingData</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>).<a class="code" href="structSpellTargetingData.html#a05848478306b4108cfe4171a48016a94">filteringScheme</a>, <span class="keyword">sizeof</span>(<a class="code" href="classSpell.html#ade05873e2d5e60d68fed60995ef56bc4">m_filteringScheme</a>));</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <a class="code" href="classSpell.html#aea2657881d1a997c81f1cffefd1b2abd">m_scriptValue</a> = 0;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    memset(<a class="code" href="classSpell.html#a33a3b5316aef596513c831765ece5cae">m_effectTriggerChance</a>, -1, <span class="keyword">sizeof</span>(<a class="code" href="classSpell.html#a33a3b5316aef596513c831765ece5cae">m_effectTriggerChance</a>));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    memset(<a class="code" href="classSpell.html#a3255c4ac70b615c4bbb9f77305038ac0">damagePerEffect</a>, 0, <span class="keyword">sizeof</span>(<a class="code" href="classSpell.html#a3255c4ac70b615c4bbb9f77305038ac0">damagePerEffect</a>));</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <a class="code" href="classSpell.html#a6128294a5ab1a765cc51d55c31edb3f4">CleanupTargetList</a>();</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="classSpell.html#ab226199131a3f1c8ce11239ac01c3617">m_spellLog</a>.<a class="code" href="classSpellLog.html#a6bd272f573b8e217c6ea18843236ccdf">Initialize</a>();</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <a class="code" href="classSpell.html#af880d166ee53ab6614c4bd885fa6e466">m_needSpellLog</a> = (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a7a2226ccf62201d46c40b90ac7d35305">Attributes</a> &amp; (<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50aba1c104378265f988ef597efd9570e59">SPELL_ATTR_DO_NOT_LOG</a> | <a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a562c93884d9b677274333ca583a3d236">SPELL_ATTR_DO_NOT_DISPLAY</a>)) == 0;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="classSpell.html#a4af287958e9bb23bebda37a5c7d72ee6">m_travellingStart</a> = UINT32_MAX;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <a class="code" href="classSpell.html#aad28cf5dd3755b514793c6befa52844b">m_targetlessMask</a> = 0;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <a class="code" href="classSpell.html#ae7ef00105b47529bb50b1c669aabb283">m_overrideSpeed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="classSpell.html#a5df90e7aa2cdd206ade4afdacdf679c0">m_ignoreRoot</a> = <a class="code" href="SpellMgr_8h.html#ae416332245463d653332abb464abfd28">IsIgnoreRootSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="classSpell.html#a719bf842069982303be22a15c9794531">m_ignoreOwnerLevel</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a4812e0755be6918d62a7760f9b33ac68">SPELL_ATTR_EX6_ORIGINATE_FROM_CONTROLLER</a>))</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        {</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* controllingPlayer = <span class="keyword">const_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6535c9c8175652b8497b1615147636ac">GetControllingPlayer</a>()))</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> = controllingPlayer;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> = controllingPlayer;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="classSpell.html#ae031e444535b6a6ad619b430fb4fdc7f">OnInit</a>();</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;}</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="classSpell.html#ab00bfde34dc5dcdc6e1035608e14c067">  565</a></span>&#160;<a class="code" href="classSpell.html#ab00bfde34dc5dcdc6e1035608e14c067">Spell::~Spell</a>()</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;{</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a01443ad39de8bab4cd61c71e4a7f35bd">SetUsedInSpell</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;}</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="classSpell.html#ac5331b13cbc4d1bc6ce1d68878f7a529">  572</a></span>&#160;<a class="code" href="classWorldObject.html">WorldObject</a>* <a class="code" href="classSpell.html#ac5331b13cbc4d1bc6ce1d68878f7a529">Spell::FindCorpseUsing</a>()</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;{</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="comment">// non-standard target selection</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="structSpellRangeEntry.html">SpellRangeEntry</a> <span class="keyword">const</span>* srange = <a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordtype">float</span> max_range = <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(srange);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* result = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    T u_check(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, max_range);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="structMaNGOS_1_1WorldObjectSearcher.html">MaNGOS::WorldObjectSearcher&lt;T&gt;</a> searcher(result, u_check);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, searcher, max_range);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">if</span> (!result)</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="structCell.html#aaa71b83434fc3d01f05dfbde2030124e">Cell::VisitWorldObjects</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, searcher, max_range);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;}</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno"><a class="line" href="classSpell.html#aae8b05fa2c3fad700a3dca8c4d154e94">  591</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#aae8b05fa2c3fad700a3dca8c4d154e94">Spell::FillTargetMap</a>()</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;{</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <a class="code" href="structSpell_1_1TempTargetingData.html">TempTargetingData</a> targetingData;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effToIndex[<a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>] = {0, 1, 2};         <span class="comment">// Helper array, to link to another tmpUnitList, if the targets for both effects match</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>())</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keyword">auto</span> <span class="keyword">const</span>&amp; mod = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">GetAurasByType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ae8ad6fbb57be83baab826d947488b535">SPELL_AURA_MOD_MAX_AFFECTED_TARGETS</a>);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classAura.html">Aura</a>* aura : mod)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">if</span> (!aura-&gt;isAffectedOnSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a> += aura-&gt;GetModifier()-&gt;m_amount;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        }</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    }</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    {</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// not call for empty effect.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="comment">// Also some spells use not used effect targets for store targets for dummy effect in triggered spells</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a62333a50634af5b796a5de9a8cc42084">SPELL_EFFECT_NONE</a>)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160; </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keyword">auto</span>&amp; data = <a class="code" href="classSpellTargetMgr.html#a7cbcb402c05cdbe0f5cb24423e1cce21">SpellTargetMgr::GetSpellTargetingData</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8af">SpellTargetImplicitType</a> effectTargetType = data.implicitType[i]; <span class="comment">// prefilled data on load</span></div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keyword">auto</span>&amp; targetMask = data.targetMask[i];</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keyword">auto</span>&amp; ignoredTargets = data.ignoredTargets[i];</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keyword">auto</span>&amp; filterScheme = <a class="code" href="classSpell.html#ade05873e2d5e60d68fed60995ef56bc4">m_filteringScheme</a>[i];</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[i] = <a class="code" href="classSpell.html#ab0dff4108f46be429308f82a301e310e">m_chainTargetCount</a>[i];</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">if</span> (effectTargetType == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa977aded5972aa7f6e73beb9bece220cc">TARGET_TYPE_SPECIAL_UNIT</a>) <span class="comment">// area auras need custom handling</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetA = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i];</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetB = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[i];</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keywordtype">bool</span> hadTarget = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="comment">// need to pick a single unit target if existant and use it for area aura owner</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">if</span> (targetA &amp;&amp; !ignoredTargets.first)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetA].type == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a> &amp;&amp; <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetA].enumerator == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128aafe7cc364fd8375e47c1e02c7c640aa1">TARGET_ENUMERATOR_SINGLE</a>)</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    hadTarget = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <a class="code" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">SetTargetMap</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), targetA, <span class="keyword">false</span>, targetingData);</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keywordflow">if</span> (targetB &amp;&amp; !ignoredTargets.second)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetB].type == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a> &amp;&amp; <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetB].enumerator == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128aafe7cc364fd8375e47c1e02c7c640aa1">TARGET_ENUMERATOR_SINGLE</a>)</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    hadTarget = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetB].enumerator != <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a6c7f6ab7a64e6d33d3a06ddb6b84e6a4">TARGET_ENUMERATOR_AOE</a>)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                    <a class="code" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">SetTargetMap</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), targetB, <span class="keyword">true</span>, targetingData);</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            }</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">if</span> (!hadTarget &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>) <span class="comment">// if no single targeting available use caster as default</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">tmpUnitList</a>[<span class="keyword">false</span>].push_back(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;        }</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetA = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i];</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetB = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[i];</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">if</span> (targetA == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa16abf06e96a64fa495bb02437ce9e1e5">TARGET_NONE</a> &amp;&amp; targetB == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa16abf06e96a64fa495bb02437ce9e1e5">TARGET_NONE</a>)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;            {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <span class="comment">// if no targeting available, attempt to use entry mask</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a> &amp;&amp; <a class="code" href="classSpellTargetMgr.html#ab4551e29aa15b717b702b6abc3d05b2b">SpellTargetMgr::CanEffectBeFilledWithMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, i, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a>))</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    <a class="code" href="classSpell.html#a65a4dec4a0f7978e9d70e204c81336aa">FillFromTargetFlags</a>(targetingData, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i));</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> defaultTarget = <a class="code" href="SpellEffectDefines_8h.html#a7474a108ebf7ca30ffb3203a3af11009">SpellEffectInfoTable</a>[<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i]].<a class="code" href="structSpellEffectInfo.html#a91328bac43e200011a7d32cc499d1158">defaultTarget</a>) <span class="comment">// else resort to default effect type if it exists</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                    <a class="code" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">SetTargetMap</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), defaultTarget, <span class="keyword">false</span>, targetingData);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;            }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// normal case, use existing spell data</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <span class="keywordflow">if</span> (targetA &amp;&amp; !ignoredTargets.first)</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                    <a class="code" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">SetTargetMap</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), targetA, <span class="keyword">false</span>, targetingData);</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <span class="keywordflow">if</span> (targetB &amp;&amp; !ignoredTargets.second)</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                    <a class="code" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">SetTargetMap</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), targetB, <span class="keyword">true</span>, targetingData);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                <span class="keywordflow">if</span> (effectTargetType == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8f11fdfadfb8c0ce58bfae1901d10948">TARGET_TYPE_UNIT_DEST</a>) <span class="comment">// special case - no unit target, but need to check for valid units</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetA].type != <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a> &amp;&amp; <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetB].type != <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a>) <span class="comment">// no fill for unit out of targets</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                        <a class="code" href="classSpell.html#a65a4dec4a0f7978e9d70e204c81336aa">FillFromTargetFlags</a>(targetingData, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)); <span class="comment">// inefficient call, very rare, less code duplicity</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">if</span> (effectTargetType == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa26d8044284eb711be1d91940d12f2c4a">TARGET_TYPE_LOCATION_TRAJ</a> &amp;&amp; (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>) == 0)</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>())</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                        <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#afa341e13427e2d645c72fb04c55b7922">setSource</a>(caster-&gt;GetPositionX(), caster-&gt;GetPositionY(), caster-&gt;GetPositionZ());</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordtype">bool</span> processedUnits = <span class="keyword">false</span>; <span class="comment">// TODO: Review area aura packet fills for area auras with AOE targets</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="keywordtype">bool</span> processedGOs = <span class="keyword">false</span>; <span class="comment">// likely purpose - animations</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">switch</span> (effectTargetType)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        {</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaf14bf2f7d5c286e6777461e40c41b6d9">TARGET_TYPE_NONE</a>:</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                <a class="code" href="classSpell.html#aad28cf5dd3755b514793c6befa52844b">m_targetlessMask</a> |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8fb995e48c74119f7f7f849a08a66a17">TARGET_TYPE_LOCATION_DEST</a>:</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaac869e5c9689c7f30e88e42206b4780e">TARGET_TYPE_SPECIAL_DEST</a>:</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa26d8044284eb711be1d91940d12f2c4a">TARGET_TYPE_LOCATION_TRAJ</a>:</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <a class="code" href="classSpell.html#ae81fe2336f8471249bbb9b2ed273702d">OnDestTarget</a>();</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                <a class="code" href="classSpell.html#a116a31dab3f9eef313ac5b624214c59f">AddDestExecution</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i));</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                <span class="keywordflow">if</span> (effectTargetType == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaac869e5c9689c7f30e88e42206b4780e">TARGET_TYPE_SPECIAL_DEST</a>)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a7b886ab94bb32bd1d8261a34e2b07241">FillUnitTargets</a>(targetingData, data, i))</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa985a04af38ba4b8eb3ffdb5d7aab4d6d">TARGET_TYPE_CORPSE</a>: <span class="comment">// can be unit and corpse</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                <span class="keywordflow">if</span> (!targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#ad710b44d1df09b198f609d9557212b99">tempCorpseList</a>.empty())</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                    <a class="code" href="EntitiesMgr_8h.html#ac4bbfdc3832b40357f0f08c0e0366bd7">CorpseList</a>&amp; corpseTargetList = targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#ad710b44d1df09b198f609d9557212b99">tempCorpseList</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask = targetMask[0] | targetMask[1];</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="classCorpse.html">Corpse</a>* corpse : corpseTargetList)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                        <a class="code" href="classSpell.html#aad27fceb9d17a8be41a82ff91990750a">AddCorpseTarget</a>(corpse, effectMask);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a>:</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8f11fdfadfb8c0ce58bfae1901d10948">TARGET_TYPE_UNIT_DEST</a>:</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afae50a421df1d4e5542b1bf61864f49903">TARGET_TYPE_PLAYER</a>: <span class="comment">// for now player handled here</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa977aded5972aa7f6e73beb9bece220cc">TARGET_TYPE_SPECIAL_UNIT</a>:</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                <span class="keywordflow">if</span> (effectTargetType == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8f11fdfadfb8c0ce58bfae1901d10948">TARGET_TYPE_UNIT_DEST</a>)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                    <a class="code" href="classSpell.html#ae81fe2336f8471249bbb9b2ed273702d">OnDestTarget</a>();</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                processedUnits = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a7b886ab94bb32bd1d8261a34e2b07241">FillUnitTargets</a>(targetingData, data, i))</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa9e02b36361708a05834cac5b4c153aed">TARGET_TYPE_LOCK</a>:</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaa6ded98eff76a3b61d4c0e3e6d93997d">TARGET_TYPE_ITEM</a>:</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                <span class="keywordflow">if</span> (targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#a97f400e188a5ec71230e0240da3452ef">tempItemList</a>.size() &gt; 0) <span class="comment">// Item case</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="classItem.html">Item</a>* item : targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#a97f400e188a5ec71230e0240da3452ef">tempItemList</a>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                        <a class="code" href="classSpell.html#a796b5e725da29b9ce14918bd8f671a1e">AddItemTarget</a>(item, targetMask[0]); <span class="comment">// no spell in all of vanilla through wotlk has item target in B</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;                <span class="keywordflow">if</span> (effectTargetType == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaa6ded98eff76a3b61d4c0e3e6d93997d">TARGET_TYPE_ITEM</a>)</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                <span class="comment">// [[fallthrough]]</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaff677b466a96dba01f1d816dfef5c33e">TARGET_TYPE_GAMEOBJECT</a>:</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                processedGOs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> rightTarget = 0; rightTarget &lt; 2; ++rightTarget) <span class="comment">// need to process target A and B separately due to effect masks</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    <span class="keywordtype">bool</span> ignored = rightTarget ? ignoredTargets.second : ignoredTargets.first;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    <span class="keywordflow">if</span> (ignored)</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                    <a class="code" href="EntitiesMgr_8h.html#a9a6023581a510c75fe601cd9d7412f15">GameObjectList</a>&amp; goTargetList = targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#a08fca2887b9a0e66e0f86c054982c7b7">tmpGOList</a>[rightTarget];</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask = targetMask[rightTarget];</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                    <span class="keywordflow">if</span> (!goTargetList.empty()) <span class="comment">// GO case</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                    {</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = goTargetList.begin(); iter != goTargetList.end();)</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                        {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">OnCheckTarget</a>(*iter, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)))</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                                ++iter;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;                            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;                                iter = goTargetList.erase(iter);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                        }</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a> &amp;&amp; goTargetList.size() &gt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                        {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                            <span class="comment">// remove random units from the map</span></div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                            <span class="keywordflow">while</span> (goTargetList.size() &gt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                            {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> poz = <a class="code" href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a>(0, goTargetList.size() - 1);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = goTargetList.begin(); itr != goTargetList.end(); ++itr, --poz)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                    <span class="keywordflow">if</span> (!*itr) <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                                    <span class="keywordflow">if</span> (!poz)</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                    {</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                        goTargetList.erase(itr);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                    }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                                }</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                            }</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                        }</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="classGameObject.html">GameObject</a>* go : goTargetList)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                            <a class="code" href="classSpell.html#a19aea7e498ef7d2582a047b22ba6eb1d">AddGOTarget</a>(go, effectMask);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                }</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        }</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a9593bb76a5719b0bdafa3c2e69fbae1d">SPELL_ATTR_EX2_FAIL_ON_ALL_TARGETS_IMMUNE</a>))</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">bool</span> allImmune = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        {</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="keywordflow">if</span> (ihit.missCondition != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a> &amp;&amp; ihit.missCondition != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa4f14819249f6154bab64ccae4c0bf0c5">SPELL_MISS_IMMUNE2</a>)</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            {</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                allImmune = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            }</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        }</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordflow">if</span> (allImmune)</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6c985f3372baa7af2864bb483d1f16a5">SPELL_FAILED_IMMUNE</a>); <span class="comment">// guessed error</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    }</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a154e57d2932847861392103577c42779">SPELL_ATTR_EX_REQUIRE_ALL_TARGETS</a>))</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="keywordflow">if</span> (ihit.targetGUID == <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>() &amp;&amp; ihit.missCondition != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                    ihit.effectHitMask = 0;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                    ihit.effectMask = 0;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;}</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classSpell.html#a7b886ab94bb32bd1d8261a34e2b07241">  794</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a7b886ab94bb32bd1d8261a34e2b07241">Spell::FillUnitTargets</a>(<a class="code" href="structSpell_1_1TempTargetingData.html">TempTargetingData</a>&amp; targetingData, <a class="code" href="structSpellTargetingData.html">SpellTargetingData</a>&amp; data, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;{</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keyword">auto</span>&amp; targetMask = data.<a class="code" href="structSpellTargetingData.html#ac2ccfeeaa07f2ed5c69bf76993bf3c2a">targetMask</a>[i];</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keyword">auto</span>&amp; ignoredTargets = data.<a class="code" href="structSpellTargetingData.html#a295e7a61f7d0d8cd040aa1445bf6c974">ignoredTargets</a>[i];</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keyword">auto</span>&amp; filterScheme = <a class="code" href="classSpell.html#ade05873e2d5e60d68fed60995ef56bc4">m_filteringScheme</a>[i];</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> rightTarget = 0; rightTarget &lt; 2; ++rightTarget) <span class="comment">// need to process target A and B separately due to effect masks</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordtype">bool</span> ignored = rightTarget ? ignoredTargets.second : ignoredTargets.first;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">if</span> (ignored)</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; unitTargetList = targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[i].<a class="code" href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">tmpUnitList</a>[rightTarget];</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask = targetMask[rightTarget];</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985">SpellTargetFilterScheme</a> scheme = filterScheme[rightTarget];</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> target = rightTarget ? <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[i] : <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i];</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8af">SpellTargetImplicitType</a> type = <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[target].<a class="code" href="structSpellTargetInfo.html#a68c229e7f0563a90091445d626addca4">type</a>;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">if</span> (!unitTargetList.empty()) <span class="comment">// Unit case</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = unitTargetList.begin(); itr != unitTargetList.end();)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            {</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a90f0bd6624e63ad55052e7974f7c7cdf">CheckTarget</a>(*itr, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <span class="keywordtype">bool</span>(rightTarget), <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eb">CheckException</a>(targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a2c03f3b6a2eef5380ea2c0514a9d0f3c">magnet</a>)))</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                    itr = unitTargetList.erase(itr);</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                    ++itr;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            <span class="comment">// Special target filter before adding targets to list</span></div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <a class="code" href="classSpell.html#a6f5ff9846deb35f126543a513a1eb0d7">FilterTargetMap</a>(unitTargetList, scheme, targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[i]);</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* me = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = unitTargetList.begin(); itr != unitTargetList.end(); ++itr)</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                {</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                    <a class="code" href="classPlayer.html">Player</a>* targetOwner = (*itr)-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>();</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                    <span class="keywordflow">if</span> (targetOwner &amp;&amp; targetOwner != me &amp;&amp; targetOwner-&gt;<a class="code" href="classUnit.html#a48fcb3d403534171f69d0be3b6003762">IsPvP</a>() &amp;&amp; !me-&gt;<a class="code" href="classPlayer.html#a535278fda7e3c98dcc5f1f28d1c0c6fe">IsInDuelWith</a>(targetOwner))</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                    {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                        me-&gt;<a class="code" href="classPlayer.html#a032cedc4c5b8ec826bfbd36c309da5a4">UpdatePvP</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                        me-&gt;<a class="code" href="classUnit.html#a1ba95f0ad9e204ab1c36f1608e62434b">RemoveAurasWithInterruptFlags</a>(<a class="code" href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011acbbf681ff137361f2832cbb1d424fb8c">AURA_INTERRUPT_FLAG_PVP_ACTIVE_CANCELS</a>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                }</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            }</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a154e57d2932847861392103577c42779">SPELL_ATTR_EX_REQUIRE_ALL_TARGETS</a>) &amp;&amp;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            (type == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a> || type == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afae50a421df1d4e5542b1bf61864f49903">TARGET_TYPE_PLAYER</a>))</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="comment">// spells which should only be cast if a target was found</span></div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keywordflow">if</span> (unitTargetList.size() &lt;= 0)</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;            {</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 51690 ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>);</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classUnit.html">Unit</a>* unit : unitTargetList)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="classSpell.html#a7d4e1605d2b58a6614b2fe5db9a96e95">AddUnitTarget</a>(unit, effectMask);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;}</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno"><a class="line" href="classSpell.html#a3708df24a12e888277bf67285487118e">  857</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a3708df24a12e888277bf67285487118e">Spell::prepareDataForTriggerSystem</a>()</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;{</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">//==========================================================================================</span></div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// Now fill data for trigger system, need know:</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// an spell trigger another or not ( m_canTrigger )</span></div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="comment">// Create base triggers flags for Attacker and Victim ( m_procAttacker and  m_procVictim)</span></div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="comment">//==========================================================================================</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="comment">// Fill flag can spell trigger or not</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    <span class="comment">// TODO: possible exist spell attribute for this</span></div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <a class="code" href="classSpell.html#a657688194c718b1e193bfa0b9caac645">m_canTrigger</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> == <span class="keyword">nullptr</span>) || <a class="code" href="classSpell.html#a95aee0efa022cac01f221d3435736f38">m_doNotProc</a>)</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="classSpell.html#a657688194c718b1e193bfa0b9caac645">m_canTrigger</a> = <span class="keyword">false</span>;                               <span class="comment">// Do not trigger from item cast spell</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">// some negative spells have positive effects to another or same targets</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">// avoid triggering negative hit for only positive targets</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <a class="code" href="classSpell.html#a3ca8244d8c6cdc28ca9e8af8553e168f">m_negativeEffectMask</a> = 0x0;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#ab3038f54f63721701513c9ebc5c3de2e">IsPositiveEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)))</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            <a class="code" href="classSpell.html#a3ca8244d8c6cdc28ca9e8af8553e168f">m_negativeEffectMask</a> |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;}</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160; </div>
<div class="line"><a name="l00879"></a><span class="lineno"><a class="line" href="classSpell.html#a57f1e6a4a1de4ae2f42961b618aa0aa1">  879</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a57f1e6a4a1de4ae2f42961b618aa0aa1">Spell::PrepareMasksForProcSystem</a>(<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; procAttacker, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; procVictim, <a class="code" href="classWorldObject.html">WorldObject</a>* caster, <a class="code" href="classWorldObject.html">WorldObject</a>* target)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;{</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// Get data for type of attack and fill base info for trigger</span></div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a879bfebf33dade7738722746a31bc78b">DmgClass</a>)</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4ad6e0146bc0d96e2ff12e902b53a29fe3">SPELL_DAMAGE_CLASS_MELEE</a>:</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba0364d6ed21318af6a09bcb9e97a0e0ce">PROC_FLAG_DEAL_MELEE_ABILITY</a>;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a> == <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                procAttacker |= <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba0e47443cbbeffae8acb764b444174517">PROC_FLAG_MAIN_HAND_WEAPON_SWING</a>;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a> == <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a>)</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                procAttacker |= <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baaa24701022923cf3128ab18e168d24a5">PROC_FLAG_OFF_HAND_WEAPON_SWING</a>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba7b76c7ee4e3158f61043eb4dcd4cca7d">PROC_FLAG_TAKE_MELEE_ABILITY</a>;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a26638bd2ee5365a4b278420b7dc66956">SPELL_DAMAGE_CLASS_RANGED</a>:</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment">// Auto attack</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a17f8c4ebbd048cdcde447fa5083698f5">SPELL_ATTR_EX2_AUTO_REPEAT</a>))</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba68338843489945531e1ba10e0c0a9e19">PROC_FLAG_DEAL_RANGED_ATTACK</a>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf35ac4894624c305e6bf3aa8fed13bbd">PROC_FLAG_TAKE_RANGED_ATTACK</a>;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="keywordflow">else</span> <span class="comment">// Ranged spell attack</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba41466041b8d8c8d30ff31bf73895a242">PROC_FLAG_DEAL_RANGED_ABILITY</a>;</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9badfbe02020d9532ca0c99060a3fbb7a5c">PROC_FLAG_TAKE_RANGED_ABILITY</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;            }</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#afa7b10fb48285a79d754be9a11a6b30a">IsPositiveEffectMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, effectMask, caster, target))           <span class="comment">// Check for positive spell</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            {</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50afe58958c98a660c731236f863e88d80e">SPELL_ATTR_IS_ABILITY</a>))</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6199565a6a020d7e7e533c54d906e958">PROC_FLAG_DEAL_HELPFUL_ABILITY</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                    procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba3f64d61f9acc0b73d45951487b167010">PROC_FLAG_TAKE_HELPFUL_ABILITY</a>;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;                }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;                {</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                    procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9bac3f15701eb93cfb46beb4f032caad372">PROC_FLAG_DEAL_HELPFUL_SPELL</a>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                    procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba4fc6208f1395f4e74758cd4b95332355">PROC_FLAG_TAKE_HELPFUL_SPELL</a>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                }</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;            }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a17f8c4ebbd048cdcde447fa5083698f5">SPELL_ATTR_EX2_AUTO_REPEAT</a>))   <span class="comment">// Wands auto attack</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;            {</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba68338843489945531e1ba10e0c0a9e19">PROC_FLAG_DEAL_RANGED_ATTACK</a>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf35ac4894624c305e6bf3aa8fed13bbd">PROC_FLAG_TAKE_RANGED_ATTACK</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;            }</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <span class="keywordflow">else</span>                                           <span class="comment">// Negative spell</span></div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50afe58958c98a660c731236f863e88d80e">SPELL_ATTR_IS_ABILITY</a>))</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                    procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba8cfbfb43731d87c3f18b2bfaa2523537">PROC_FLAG_DEAL_HARMFUL_ABILITY</a>;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                    procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf844ac5c2df378e88f50e0e542116c38">PROC_FLAG_TAKE_HARMFUL_ABILITY</a>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                    procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9badaf23b32ed2865f5995e81f2fec996d9">PROC_FLAG_DEAL_HARMFUL_SPELL</a>;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                    procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6dee6718a32d2b2ada5d7c55bdc45546">PROC_FLAG_TAKE_HARMFUL_SPELL</a>;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            }</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">// Hunter traps spells (for Entrapment trigger)</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// Gives your Immolation Trap, Frost Trap, Explosive Trap, and Snake Trap ....</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a> == <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca66df9b34a3b922a8242d3dfb74494026">SPELLFAMILY_HUNTER</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae35b8dc7bc501d5466c150cc6ba8a763">IsFitToFamilyMask</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x000020000000001C), <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0x00040000)))</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        procAttacker |= <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf278f87dd654facbbe75d8acb32a8d0d">PROC_FLAG_ON_TRAP_ACTIVATION</a>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        procAttacker |= <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba466ae386c270f5d40d8f11eece38ab2a">PROC_FLAG_DEAL_MELEE_SWING</a>;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        procVictim |= <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba1276e4b9b12f6a3ce5dd3fd6238fd3ef">PROC_FLAG_TAKE_MELEE_SWING</a>;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    }</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34eaeefa14b79df399ff8c3a9848e925e281">SPELL_ATTR_EX3_TREAT_AS_PERIODIC</a>))</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    {</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba8edd4968ba96d5d73a6983c5982079ce">PROC_FLAG_DEAL_HARMFUL_PERIODIC</a>;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        procVictim = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba0ab87eaab1eb027e27aee1c94f3b691e">PROC_FLAG_TAKE_HARMFUL_PERIODIC</a>;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea5ac6ce4030c3d3d2c9fd8ecde25db77d">SPELL_ATTR_EX3_SUPPRESS_CASTER_PROCS</a>))</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        procAttacker = 0;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160; </div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="comment">// in wotlk SPELL_ATTR_EX3_SUPPRESS_TARGET_PROCS must be done in proc system due to SPELL_ATTR_EX7_CAN_PROC_FROM_SUPPRESSED_TARGET_PROCS</span></div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">//if (m_spellInfo-&gt;HasAttribute(SPELL_ATTR_EX3_SUPPRESS_TARGET_PROCS))</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="comment">//    procVictim = 0;</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;}</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno"><a class="line" href="classSpell.html#a6128294a5ab1a765cc51d55c31edb3f4">  965</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a6128294a5ab1a765cc51d55c31edb3f4">Spell::CleanupTargetList</a>()</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;{</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.clear();</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.clear();</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="classSpell.html#a4ba53019f02abcaff8db6e21aaf4a78e">m_UniqueItemInfo</a>.clear();</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> = 0;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;}</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno"><a class="line" href="classSpell.html#a7d4e1605d2b58a6614b2fe5db9a96e95">  973</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a7d4e1605d2b58a6614b2fe5db9a96e95">Spell::AddUnitTarget</a>(<a class="code" href="classUnit.html">Unit</a>* target, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask, <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eb">CheckException</a> exception)</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;{</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> != target)</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a>; <span class="comment">// all spells with unit target must have this flag</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    effectMask &amp;= (~<a class="code" href="classSpell.html#adba11b52d6d255e575600716d9c87ec5">m_partialApplicationMask</a>); <span class="comment">// remove partially immuned out effects</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> executionlessMask = 0;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    <span class="keyword">auto</span>&amp; data = <a class="code" href="classSpellTargetMgr.html#a7cbcb402c05cdbe0f5cb24423e1cce21">SpellTargetMgr::GetSpellTargetingData</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        <span class="keywordflow">if</span> (data.implicitType[i] == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaac869e5c9689c7f30e88e42206b4780e">TARGET_TYPE_SPECIAL_DEST</a>)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            executionlessMask |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    <span class="comment">// Check for effect immune skip if immuned</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> notImmunedMask = 0;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++effIndex)</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">if</span> ((effectMask &amp; (1 &lt;&lt; effIndex)) != 0)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#a54a4815c604d6106323225732d74a7c2">IsImmuneToSpellEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(effIndex), target == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                notImmunedMask |= (1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035acf1fc17c13e831e402411d6550186109">SPELL_ATTR_EX4_NO_PARTIAL_IMMUNITY</a>) &amp;&amp; notImmunedMask != effectMask)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        notImmunedMask = 0; <span class="comment">// if one effect immunes out, whole target immunes out</span></div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <a class="code" href="classObjectGuid.html">ObjectGuid</a> targetGUID = target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="comment">// Lookup target in already in list</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    {</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;        <span class="keywordflow">if</span> (targetGUID == ihit.targetGUID)                 <span class="comment">// Found in list</span></div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            ihit.effectMask |= (effectMask &amp;~ executionlessMask);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;            ihit.effectHitMask |= (notImmunedMask &amp;~ executionlessMask);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    }</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="comment">// This is new target calculate data for him</span></div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">// Get spell hit result on target</span></div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a> targetInfo;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a> = targetGUID;                         <span class="comment">// Store target GUID</span></div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> = exception != <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba4fafb5864cb471a67bb473eb292c73ba">EXCEPTION_MAGNET</a> ? notImmunedMask : effectMask; <span class="comment">// Store not immuned effects</span></div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a> = effectMask;                         <span class="comment">// Store index of effect</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a31c7a102ca04d466b72ce48cf24b9307">effectMaskProcessed</a> = 0;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ae1661c7a29cbc96d5fc7136f23209ad0">processed</a>  = <span class="keyword">false</span>;                              <span class="comment">// Effects not applied on target</span></div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aa7c1e254efc22ca527aced39915d8d98">magnet</a> = (exception == <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba4fafb5864cb471a67bb473eb292c73ba">EXCEPTION_MAGNET</a>);</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a47253df8c66cc18c8f78bf0e10d89c08">procReflect</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#af2cad39388e6d630ce32c5cec4327624">isCrit</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a2465f3f2446585875bbe50050cd63f4b">heartbeatResistChance</a> = 0;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a> = <a class="code" href="SpellMgr_8cpp.html#adcb922f517a421f170e35fae73441af5">CalculateSpellDuration</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, target, <a class="code" href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">m_auraScript</a>);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a> = targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a>;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a> = <a class="code" href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a686cebb344da5f1a40407c2feb03d2da">DIMINISHING_LEVEL_1</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a> = <a class="code" href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a>;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ad545fbf19e87de3bf7887abb2b61aa93">executionless</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a> = 0;</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160; </div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="comment">// Calculate hit result</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">missCondition</a> = <a class="code" href="classSpell.html#a2802c4efcae1cb5ad2b5a1fbe12d59b7">m_ignoreHitResult</a> ? <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a> : <a class="code" href="classUnit.html#a6089f0c7239aabba634f5833e99c2e9f">Unit::SpellHitResult</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a>, <a class="code" href="classSpell.html#a180d44289121f790927b13253164d1b2">m_reflectable</a>, <span class="keyword">false</span>, &amp;targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a2465f3f2446585875bbe50050cd63f4b">heartbeatResistChance</a>);</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;    <span class="keywordflow">if</span> ((executionlessMask &amp; targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a>) != 0)</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    {</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a> &amp;= ~executionlessMask;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> &amp;= ~executionlessMask;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ad545fbf19e87de3bf7887abb2b61aa93">executionless</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    }</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">// spell fly from visual cast object</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* affectiveObject = <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">GetAffectiveCasterObject</a>();</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="comment">// Spell have speed (possible inherited from triggering spell) - need calculate incoming time</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordtype">float</span> baseSpeed = <a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">GetSpellSpeed</a>();</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="keywordflow">if</span> (baseSpeed &gt; 0.0f &amp;&amp; affectiveObject &amp;&amp; target != affectiveObject)</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <a class="code" href="classWorldObject.html">WorldObject</a> <span class="keyword">const</span>* missileSource = affectiveObject;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035a20aa7fa5fe5e07256d0658fac72d186f">SPELL_ATTR_EX4_BOUNCY_CHAIN_MISSILES</a>))</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        {</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;            <span class="keyword">auto</span> previousTargetItr = std::find_if(<a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.rbegin(), <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.rend(), [effectMask](<a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a> <span class="keyword">const</span>&amp; target)</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;            {</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                return (target.effectMask &amp; effectMask) != 0;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            });</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;            <span class="keywordflow">if</span> (previousTargetItr != std::rend(<a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>))</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;            {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* previousTarget = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a7f47c1b7efbaada5de480afb5d9c48a1">GetWorldObject</a>(previousTargetItr-&gt;targetGUID))</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                    missileSource = previousTarget;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a> += previousTargetItr-&gt;timeDelay;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;            }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;        }</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="comment">// calculate spell incoming interval</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        <span class="keywordtype">float</span> dist = missileSource-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(target-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), target-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), target-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>(), <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        dist = sqrt(dist); <span class="comment">// default distance calculation is raw, apply sqrt before the next step</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordtype">float</span> speed;</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() &gt; 0.0f)</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;            speed = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() * cos(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#abccd1fec97295c282e888a31df1abe77">getElevation</a>());</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        {</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;            speed = baseSpeed;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160; </div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;            <span class="keywordflow">if</span> (dist &lt; 5.0f)</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;                dist = 5.0f;</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        }</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a> += (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>)floor(dist / speed * 1000.0f);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="comment">// Calculate minimum incoming time</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> == 0 || <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> &gt; targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a>)</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> = targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a>;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a> = <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160; </div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <span class="comment">// If target reflect spell back to caster</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">if</span> (targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">missCondition</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="comment">// Objects vs units case: traps and similar</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// TBC+: Reflect simply negates the spell</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>.<a class="code" href="classObjectGuid.html#a6a398c7516c608d7b64c85b9dc08114e">IsUnit</a>())</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;            <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(<span class="keyword">nullptr</span>, target, <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>, <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6dee6718a32d2b2ada5d7c55bdc45546">PROC_FLAG_TAKE_HARMFUL_SPELL</a>, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceac0f0575131b658e1143778206283552a">PROC_EX_REFLECT</a>, 1, <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>));</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> = <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;            <span class="comment">// need to recheck reflect immuned effects</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;            notImmunedMask = 0;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++effIndex)</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;                <span class="keywordflow">if</span> ((effectMask &amp; (1 &lt;&lt; effIndex)) != 0)</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#a54a4815c604d6106323225732d74a7c2">IsImmuneToSpellEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(effIndex), target == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                        notImmunedMask |= (1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> = notImmunedMask;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9ab8497b85f983e0682091317fb0606286">SPELL_ATTR_EX7_REFLECTION_ONLY_DEFENDS</a>))</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> = <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;            <span class="comment">// Calculate reflected spell result on caster</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;            <span class="keywordflow">else</span> if (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> = <a class="code" href="classUnit.html#a6089f0c7239aabba634f5833e99c2e9f">Unit::SpellHitResult</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a>, <a class="code" href="classSpell.html#a180d44289121f790927b13253164d1b2">m_reflectable</a>, <span class="keyword">true</span>, &amp;targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a2465f3f2446585875bbe50050cd63f4b">heartbeatResistChance</a>);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <span class="comment">// Caster reflects back spell which was already reflected by victim</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;            <span class="keywordflow">if</span> (targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a> || !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <span class="comment">// Full circle: it&#39;s impossible to reflect further, &quot;Immune&quot; shows up</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> = <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160; </div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;            <span class="comment">// Store time interval so we know how fast to return it back</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a900f9a1e1ad7bcdf19bdadda3ad08cca">initialDelay</a> = targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a>;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a47253df8c66cc18c8f78bf0e10d89c08">procReflect</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <span class="keywordflow">if</span> (targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">timeDelay</a> == 0) <span class="comment">// if no time delay, proc reflect procs immediately</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                <a class="code" href="classSpell.html#a1f5dac6a66009db412f1a37b7e7b6c7e">ProcReflectProcs</a>(targetInfo);</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        }</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <a class="code" href="classSpell.html#a8de51903353a2351a520711b9b9a187f">m_spellFlags</a> |= <a class="code" href="Spell_8h.html#a68423826ac8d5f2d2aca7e83dfa9d2c2a821083f58cdc2d250afcee151634e757">SPELL_FLAG_REFLECTED</a>;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> = <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="comment">// only check DR for units and unit owned GOs</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* realCaster = <a class="code" href="classSpell.html#af8de4da19951058b9debc1521bb5b954">GetAffectiveCasterOrOwner</a>())</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="keywordtype">bool</span> isReflected = targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">missCondition</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a> &amp;&amp; targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* targetForDiminish = isReflected ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : target;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a08a8e032a6c528587b4165de8e554b20">IsAuraApplyEffects</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a0040fdd9a7192268e855e468c71b68a1">SpellEffectIndexMask</a>(targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a>)))</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a> = targetForDiminish-&gt;<a class="code" href="classUnit.html#a033d2ead3d0eca2389e5e522b4bb6b10">CalculateAuraDuration</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, effectMask, targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a>, realCaster);</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <span class="keywordflow">if</span> ((targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">missCondition</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a> || isReflected) &amp;&amp; <a class="code" href="classSpell.html#a6bd7f2b3578de307b5564396c4170b99">CanSpellDiminish</a>())</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        {</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a> = <a class="code" href="SpellMgr_8cpp.html#a46823309ec434fd0636f6f06099b8919">GetDiminishingReturnsGroupForSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> != <span class="keyword">nullptr</span> || (<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>));</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;            targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a> = targetForDiminish-&gt;<a class="code" href="classUnit.html#a0d74177af4f180c8ec0af151313189c6">GetDiminishing</a>(targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>);</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">if</span> (targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a> &gt; 0)</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            {</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> duration = targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a>;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;                targetForDiminish-&gt;<a class="code" href="classUnit.html#a11e78cce4735a7862255a86005e67e82">ApplyDiminishingToDuration</a>(targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>, duration, realCaster, targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a>, isReflected, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">m_auraScript</a>);</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;                targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a> = duration;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                <span class="keywordflow">if</span> (targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a> == 0 &amp;&amp; targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a> == <a class="code" href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a753de913b5eed5c74aaa9d3b567a3980">DIMINISHING_LEVEL_IMMUNE</a>)</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                    targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> &amp;= ~<a class="code" href="SpellMgr_8h.html#aa6d85cc3b560ba3035bf489e92e69d2d">GetAuraEffectMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;            }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="comment">// Add target to list</span></div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.push_back(targetInfo);</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;}</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"><a class="line" href="classSpell.html#a19aea7e498ef7d2582a047b22ba6eb1d"> 1154</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a19aea7e498ef7d2582a047b22ba6eb1d">Spell::AddGOTarget</a>(<a class="code" href="classGameObject.html">GameObject</a>* target, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask)</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;{</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0cc43eed3775f0742de2f496d9dadc49">TARGET_FLAG_GAMEOBJECT</a>; <span class="comment">// all spells with GO target must have this flag TODO: do this based on target type</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160; </div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="classObjectGuid.html">ObjectGuid</a> targetGUID = target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160; </div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="comment">// Lookup target in already in list</span></div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">if</span> (targetGUID == ihit.targetGUID)                 <span class="comment">// Found in list</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            ihit.effectMask |= effectMask;                 <span class="comment">// Add only effect mask</span></div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        }</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// This is new target calculate data for him</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;    <a class="code" href="structSpell_1_1GOTargetInfo.html">GOTargetInfo</a> targetInfo;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#a619f98bf094d2667048204f733d64d0c">targetGUID</a> = targetGUID;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#a07d70f3c2425f07a36db90e9fd5b3c97">effectMask</a> = effectMask;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#aedfa36678be863a558ecd0ecc07cc544">processed</a> = <span class="keyword">false</span>;                              <span class="comment">// Effects not apply on target</span></div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160; </div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="comment">// spell fly from visual cast object</span></div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* affectiveObject = <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">GetAffectiveCasterObject</a>();</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="comment">// Spell can have speed - need calculate incoming time</span></div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    <span class="keywordtype">float</span> baseSpeed = <a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">GetSpellSpeed</a>();</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (baseSpeed &gt; 0.0f &amp;&amp; affectiveObject &amp;&amp; target != affectiveObject)</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    {</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;        <span class="comment">// calculate spell incoming interval</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        <span class="keywordtype">float</span> dist = affectiveObject-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(target-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), target-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), target-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>(), <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        dist = sqrt(dist); <span class="comment">// default distance calculation is raw, apply sqrt before the next step</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordtype">float</span> speed;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() &gt; 0.0f)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;            speed = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() * cos(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#abccd1fec97295c282e888a31df1abe77">getElevation</a>());</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;            speed = baseSpeed;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            <span class="keywordflow">if</span> (dist &lt; 5.0f)</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                dist = 5.0f;</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#ab552326c0780fe62ff95b02249458492">timeDelay</a> = (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>)floor(dist / speed * 1000.0f);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> == 0 || <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> &gt; targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#ab552326c0780fe62ff95b02249458492">timeDelay</a>)</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;            <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> = targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#ab552326c0780fe62ff95b02249458492">timeDelay</a>;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        targetInfo.<a class="code" href="structSpell_1_1GOTargetInfo.html#ab552326c0780fe62ff95b02249458492">timeDelay</a> = <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0);</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="comment">// Add target to list</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.push_back(targetInfo);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="classSpell.html#aad27fceb9d17a8be41a82ff91990750a"> 1208</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#aad27fceb9d17a8be41a82ff91990750a">Spell::AddCorpseTarget</a>(<a class="code" href="classCorpse.html">Corpse</a>* target, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;{</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> |= <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a>;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;    <span class="comment">// Lookup target in already in list</span></div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#aed136ecf494e152f6953aac8db6cdf4c">m_uniqueCorpseTargetInfo</a>)</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    {</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == ihit.corpseGUID) <span class="comment">// Found in list</span></div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        {</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;            ihit.effectMask |= effectMask;            <span class="comment">// Add only effect mask</span></div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <a class="code" href="structSpell_1_1CorpseTargetInfo.html">CorpseTargetInfo</a> info;</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    info.<a class="code" href="structSpell_1_1CorpseTargetInfo.html#adf8f4c3bb1600d001b685e3ace941709">corpseGUID</a> = target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    info.<a class="code" href="structSpell_1_1CorpseTargetInfo.html#a02b59cc49751fffe6def37668496f83e">effectMask</a> = effectMask;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <a class="code" href="classSpell.html#aed136ecf494e152f6953aac8db6cdf4c">m_uniqueCorpseTargetInfo</a>.push_back(info);</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;}</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160; </div>
<div class="line"><a name="l01229"></a><span class="lineno"><a class="line" href="classSpell.html#a796b5e725da29b9ce14918bd8f671a1e"> 1229</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a796b5e725da29b9ce14918bd8f671a1e">Spell::AddItemTarget</a>(<a class="code" href="classItem.html">Item</a>* item, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask)</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;{</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    <span class="comment">// Lookup target in already in list</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a4ba53019f02abcaff8db6e21aaf4a78e">m_UniqueItemInfo</a>)</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">if</span> (item == ihit.item)                        <span class="comment">// Found in list</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        {</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            ihit.effectMask |= effectMask;            <span class="comment">// Add only effect mask</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        }</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160; </div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// This is new target add data</span></div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160; </div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="structSpell_1_1ItemTargetInfo.html">ItemTargetInfo</a> target;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    target.<a class="code" href="structSpell_1_1ItemTargetInfo.html#afce5eba99c3dc33698dd12af8432f357">item</a> = item;</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    target.<a class="code" href="structSpell_1_1ItemTargetInfo.html#a3161ec2ffdf794c000cc94b91519d009">effectMask</a> = effectMask;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="classSpell.html#a4ba53019f02abcaff8db6e21aaf4a78e">m_UniqueItemInfo</a>.push_back(target);</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;}</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160; </div>
<div class="line"><a name="l01249"></a><span class="lineno"><a class="line" href="classSpell.html#a116a31dab3f9eef313ac5b624214c59f"> 1249</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a116a31dab3f9eef313ac5b624214c59f">Spell::AddDestExecution</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex)</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;{</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">effectMask</a> == 0)</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">timeDelay</a> = <a class="code" href="classSpell.html#a1878cf5afd3ac0ce5c0db53ebe61f201">CalculateDelayMomentForDst</a>();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">GetSpellSpeed</a>() &gt; 0.f)</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> == 0 || <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> &gt; <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">timeDelay</a>)</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;                <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> = <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">timeDelay</a>;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;    }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask = (1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    effectMask &amp;= (~<a class="code" href="classSpell.html#adba11b52d6d255e575600716d9c87ec5">m_partialApplicationMask</a>);</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">effectMask</a> |= effectMask;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;}</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160; </div>
<div class="line"><a name="l01265"></a><span class="lineno"><a class="line" href="classSpell.html#a1878cf5afd3ac0ce5c0db53ebe61f201"> 1265</a></span>&#160;<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <a class="code" href="classSpell.html#a1878cf5afd3ac0ce5c0db53ebe61f201">Spell::CalculateDelayMomentForDst</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    {</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        <a class="code" href="structPosition.html">Position</a> dest = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">getDestination</a>();</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() &gt; 0.0f)</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;        {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            <a class="code" href="structPosition.html">Position</a> src = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a31496bc8861793d11f83b216c94a81e8">getSource</a>();</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;            <span class="keywordtype">float</span> speed = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() * cos(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#abccd1fec97295c282e888a31df1abe77">getElevation</a>());</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;            <span class="keywordflow">if</span> (speed &gt; 0.0f)</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                <span class="keywordflow">return</span> (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>)floor(sqrt(src.<a class="code" href="structPosition.html#ad28cc6a9e6d05fdf8897c37642e70d33">GetDistance2d</a>(dest)) / speed * 1000.0f);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        }</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1cc6fd3348e4f9c66a3b786b38937577">speed</a> &gt; 0.0f)</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <a class="code" href="classWorldObject.html">WorldObject</a>* affectiveObject = <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">GetAffectiveCasterObject</a>();</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            <a class="code" href="structPosition.html">Position</a> src = affectiveObject-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>();</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            <span class="comment">// We should not subtract caster size from dist calculation (fixes execution time desync with animation on client, eg. Malleable Goo cast by PP)</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            <span class="keywordtype">float</span> dist = src.<a class="code" href="structPosition.html#a8e82f7e85a5033b8415272d9a6af7c9c">GetDistance</a>(dest);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>)std::floor(sqrt(dist) / <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1cc6fd3348e4f9c66a3b786b38937577">speed</a> * 1000.0f);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        }</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;    }</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160; </div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <span class="keywordflow">return</span> 0;     </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"><a class="line" href="classSpell.html#a2f18d1c37d38e7ca03c9dddb8879f651"> 1290</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a2f18d1c37d38e7ca03c9dddb8879f651">Spell::RecalculateDelayMomentForDest</a>()</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;{</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;    <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a> = <a class="code" href="classSpell.html#a1878cf5afd3ac0ce5c0db53ebe61f201">CalculateDelayMomentForDst</a>();</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a920fa690fba2ad9af993763052169f94">ModifyEventTime</a>(<a class="code" href="classSpell.html#a642a91a2145c8f2f87024110fe93d036">m_spellEvent</a>, <a class="code" href="classSpell.html#acd106ca9dbe908ea1329c05d1fdbffc4">GetDelayStart</a>() + <a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a>);</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;}</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"><a class="line" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851"> 1296</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">Spell::DoAllEffectOnTarget</a>(<a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a>* target)</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;{</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ae1661c7a29cbc96d5fc7136f23209ad0">processed</a> || target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a> == 0)       <span class="comment">// Check target</span></div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;    target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ae1661c7a29cbc96d5fc7136f23209ad0">processed</a> = <span class="keyword">true</span>;                               <span class="comment">// Target checked in apply effects procedure</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;    <span class="comment">// Get mask of effects for target</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> &amp;~ target-&gt;effectMaskProcessed;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a> ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a>);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (!unit)</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160; </div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="comment">// Get original caster (if exist) and calculate damage/healing from him data</span></div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* affectiveCaster = <a class="code" href="classSpell.html#af8de4da19951058b9debc1521bb5b954">GetAffectiveCasterOrOwner</a>();</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    <span class="comment">// FIXME: in case wild GO heal/damage spells will be used target bonuses</span></div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* caster = affectiveCaster ? affectiveCaster : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65a">SpellMissInfo</a> missInfo = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">missCondition</a>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    <span class="comment">// Need init unitTarget by default unit (can changed in code on reflect)</span></div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    <span class="comment">// Or on missInfo!=SPELL_MISS_NONE unitTarget undefined (but need in trigger subsystem)</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = unit;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* reflectTarget = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160; </div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    <span class="comment">// Reset damage/healing counter</span></div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;    <a class="code" href="classSpell.html#ac34348062658c54529e2d7f0e108e739">ResetEffectDamageAndHeal</a>();</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160; </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="comment">// Fill base trigger info</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procAttacker;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procVictim;</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procEx = <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea07b2f1753e6047dcfef05d8ec0de5b87">PROC_EX_NONE</a>;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    <a class="code" href="classSpell.html#a57f1e6a4a1de4ae2f42961b618aa0aa1">PrepareMasksForProcSystem</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a>, procAttacker, procVictim, caster, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aa7c1e254efc22ca527aced39915d8d98">magnet</a>)</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        procEx |= <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceae057538545abcefc641c676fc33698ac">PROC_EX_MAGNET</a>;</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160; </div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="comment">// drop proc flags in case target not affected negative effects in negative spell</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    <span class="comment">// for example caster bonus or animation,</span></div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    <span class="comment">// except miss case where will assigned PROC_EX_* flags later</span></div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">if</span> (((procAttacker | procVictim) &amp; <a class="code" href="SpellMgr_8h.html#a39d94fd32d1940827be85b280f1d5300">NEGATIVE_TRIGGER_MASK</a>) &amp;&amp;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            !(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> &amp; <a class="code" href="classSpell.html#a3ca8244d8c6cdc28ca9e8af8553e168f">m_negativeEffectMask</a>) &amp;&amp; missInfo == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    {</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        procAttacker = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        procVictim   = <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    }</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a1813d779c7b7efea9cd44d8458252418">damage</a>;</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aea8200356339c1059bb2f0fdb58abaa9">healing</a>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    <span class="keywordflow">if</span> (missInfo == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)                        <span class="comment">// In case spell hit target, do all effect on that target</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;        <a class="code" href="classSpell.html#af0b413dbd852a160c567fc28dc985983">DoSpellHitOnUnit</a>(unit, effectMask, target);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (missInfo != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aab385a91257c762e8ab30ee5ec4a619c7">SPELL_MISS_EVADE</a>)</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    {</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        <span class="keywordflow">if</span> (missInfo == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)                <span class="comment">// In case spell reflect from target, do all effect on caster (if hit)</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        {</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)       <span class="comment">// If reflected spell hit caster -&gt; do all effect on him</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;                <a class="code" href="classSpell.html#af0b413dbd852a160c567fc28dc985983">DoSpellHitOnUnit</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, effectMask, target, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;                reflectTarget = unit;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;                <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            }</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;        }</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="comment">// Failed hostile spell hits count as attack made against target (if detected)</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        <span class="keywordflow">if</span> (affectiveCaster &amp;&amp; affectiveCaster != unit)</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aa092f44b1d861f4e9c6adfb2a94b9b15">CasterHitTargetWithSpell</a>(affectiveCaster, unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    }</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <span class="keywordflow">if</span> (!unit-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a150ecf3de3f3deecf12f8830d4d7d9a2">SPELL_ATTR_EX7_CAN_CAUSE_INTERRUPT</a>))</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(unit, <a class="code" href="Spell_8h.html#a925df27fa7c1cddda3066155bff0ef5c">SPELL_INTERRUPT_NONPLAYER</a>, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a899fa7df360462673111bbfbb0bbd00d">TRIGGERED_IGNORE_GCD</a> | <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aedf85a11ac6fb96d0b2d08509bb40a7d">TRIGGERED_IGNORE_CURRENT_CASTED_SPELL</a>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    <span class="comment">// All calculated do it!</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="comment">// Do healing and triggers</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> &amp;&amp; affectiveCaster) <span class="comment">// does not support GO casts atm</span></div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> addhealth = <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a>;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#af2cad39388e6d630ce32c5cec4327624">isCrit</a>)</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        {</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            procEx |= <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea970bdf3e5f6192a44f1047c0a9c01310">PROC_EX_CRITICAL_HIT</a>;</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            addhealth = affectiveCaster-&gt;<a class="code" href="classUnit.html#a4b052589656cff0d352200a8817af23d">CalculateCritAmount</a>(<span class="keyword">nullptr</span>, addhealth, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;            procEx |= <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceaa0c2a4e7377d6217e94cc8fc7c77b5b2">PROC_EX_NORMAL_HIT</a>;</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160; </div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> absorb = 0;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classUnit.html#a3d16a6eaa62aaad0ea31a39230b044eb">CalculateHealAbsorb</a>(addhealth, &amp;absorb);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        addhealth -= absorb;</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> = addhealth; <span class="comment">// update value so that script handler has access</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">OnHit</a>(missInfo); <span class="comment">// TODO: After spell damage calc is moved to proper handler - move this before the first if</span></div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160; </div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> gain = affectiveCaster-&gt;<a class="code" href="classUnit.html#aa995aca7e6fe95e51400b6e8ec550837">DealHeal</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, addhealth, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#af2cad39388e6d630ce32c5cec4327624">isCrit</a>, absorb);</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160; </div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        <span class="keywordflow">if</span> (affectiveCaster)</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classUnit.html#a89e8ca73fb924186a39d05a9789f6e15">getHostileRefManager</a>().<a class="code" href="classHostileRefManager.html#a073f0560d2543944b684dc8fb581abd2">threatAssist</a>(affectiveCaster, <span class="keywordtype">float</span>(gain) * 0.5f * <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSpellThreatMultiplier(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>), <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">false</span>, <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>);</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160; </div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;        <span class="comment">// Do triggers for unit (reflect triggers passed on hit phase for correct drop charge)</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a657688194c718b1e193bfa0b9caac645">m_canTrigger</a> &amp;&amp; missInfo != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;            <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(affectiveCaster, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, affectiveCaster ? procAttacker : <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>), procVictim, procEx, addhealth, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">this</span>, gain, <span class="keyword">true</span>));</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    }</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="comment">// Do damage and triggers</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a>)</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    {</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;        <span class="comment">// Fill base damage struct (unitTarget - is real spell target)</span></div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;        <a class="code" href="structSpellNonMeleeDamage.html">SpellNonMeleeDamage</a> spellDamageInfo(caster, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>, <span class="keyword">this</span>);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160; </div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a> = <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a>;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a3f99854d163cd672f881f721d5bc8a39">HitInfo</a> = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a1c4c7b936702260fd43837d92419a6c6">HitInfo</a>;</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea1970b8b3ccb8ca34ce646b342cd00421">SPELL_ATTR_EX3_IGNORE_CASTER_MODIFIERS</a>))</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;        {</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#af2cad39388e6d630ce32c5cec4327624">isCrit</a>) <span class="comment">// GOs cant crit</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;            {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a3f99854d163cd672f881f721d5bc8a39">HitInfo</a> |= <a class="code" href="SharedDefines_8h.html#ab804ff2a65c41112bfa1774811d79b26a3d355edb9318b2055f84fdb987832c41">SPELL_HIT_TYPE_CRIT</a>;</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a> = affectiveCaster-&gt;<a class="code" href="classUnit.html#a4b052589656cff0d352200a8817af23d">CalculateCritAmount</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;            }</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160; </div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;            <span class="comment">// damage mitigation</span></div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;            <span class="keywordflow">if</span> (spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a> &gt; 0)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;            {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                <span class="comment">// physical damage =&gt; armor</span></div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a> &amp; <a class="code" href="SharedDefines_8h.html#a4ba1ab72fa9ab5b52fcda8906105c08fa12667dd3f55738c93e1ddb1351779b42">SPELL_SCHOOL_MASK_NORMAL</a>)</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                    spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a> = <a class="code" href="classUnit.html#a21ddd10a4ef054d9ed31ff7b296dffcb">Unit::CalcArmorReducedDamage</a>(affectiveCaster ? affectiveCaster : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;            }</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        }              </div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160; </div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classUnit.html#a23de96036018133a5d20a1cd2e678f3b">CalculateAbsorbResistBlock</a>(affectiveCaster, &amp;spellDamageInfo, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160; </div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        <a class="code" href="classUnit.html#a69603536f743327afeb8e05f18751fd5">Unit::DealDamageMods</a>(affectiveCaster, spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a324ea6c84e005487560de986dceffeba">target</a>, spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a>, &amp;spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a485ee28c6a8cf32a22578e02633df75b">absorb</a>, <a class="code" href="SharedDefines_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54">SPELL_DIRECT_DAMAGE</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160; </div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <a class="code" href="classSpell.html#aaa462a3042ec64054da97bab0f0186a8">m_absorb</a> = spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a485ee28c6a8cf32a22578e02633df75b">absorb</a>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> = spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a>; <span class="comment">// update value so that script handler has access</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">OnHit</a>(missInfo); <span class="comment">// TODO: After spell damage calc is moved to proper handler - move this before the first if</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        <span class="comment">// Send log damage message to client</span></div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        <a class="code" href="classUnit.html#aaf7877cad85523173a7bcd7af163e8cb">Unit::SendSpellNonMeleeDamageLog</a>(&amp;spellDamageInfo);</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        procEx |= <a class="code" href="group__game.html#gafb539370dad036ff97905efdbb4270c0">createProcExtendMask</a>(&amp;spellDamageInfo, missInfo);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        procVictim |= <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba294d96b6f102953561cee232fdf9b5f4">PROC_FLAG_TAKE_ANY_DAMAGE</a>;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160; </div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        <span class="keywordflow">if</span> (reflectTarget)</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;            <a class="code" href="classUnit.html#ab5aafad1af4b12cba6e5b42460738a9e">Unit::DealSpellDamage</a>(affectiveCaster, &amp;spellDamageInfo, <span class="keyword">true</span>, <a class="code" href="classSpell.html#a6aedd6eccb2dc430c199cb5144c5e6f4">m_resetLeash</a>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            <a class="code" href="classUnit.html#ab5aafad1af4b12cba6e5b42460738a9e">Unit::DealSpellDamage</a>(affectiveCaster, &amp;spellDamageInfo, <span class="keyword">true</span>, <a class="code" href="classSpell.html#a6aedd6eccb2dc430c199cb5144c5e6f4">m_resetLeash</a>);</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;        <span class="comment">// Do triggers for unit (reflect triggers passed on hit phase for correct drop charge)</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a657688194c718b1e193bfa0b9caac645">m_canTrigger</a> &amp;&amp; missInfo != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(affectiveCaster, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, affectiveCaster ? procAttacker : <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>), procVictim, procEx, spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a>, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160; </div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;        <span class="comment">// Haunt (NOTE: for avoid use additional field damage stored in dummy value (replace unused 100%)</span></div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        <span class="comment">// apply before deal damage because aura can be removed at target kill</span></div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a> == <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0a134bc75d430da10f6c1df4977c29cf">SPELLFAMILY_WARLOCK</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aadb41c294565428ff67a9a137d01465a">SpellIconID</a> == 3172 &amp;&amp;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0004000000000000)))</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classAura.html">Aura</a>* dummy = <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classUnit.html#acce934b8f6ca08be9d7f7f7e773046d9">GetDummyAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                dummy-&gt;GetModifier()-&gt;m_amount = spellDamageInfo.<a class="code" href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">damage</a>;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    }</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="comment">// Passive spell hits/misses or active spells only misses (only triggers if proc flags set)</span></div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (procAttacker || procVictim)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">OnHit</a>(missInfo); <span class="comment">// TODO: After spell damage calc is moved to proper handler - move this before the first if</span></div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        <span class="comment">// Fill base damage struct (unitTarget - is real spell target)</span></div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <a class="code" href="structSpellNonMeleeDamage.html">SpellNonMeleeDamage</a> damageInfo(caster, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>);</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        procEx = <a class="code" href="group__game.html#gafb539370dad036ff97905efdbb4270c0">createProcExtendMask</a>(&amp;damageInfo, missInfo);</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="comment">// Do triggers for unit (reflect triggers passed on hit phase for correct drop charge)</span></div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a657688194c718b1e193bfa0b9caac645">m_canTrigger</a> &amp;&amp; missInfo != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="comment">// traps need to be procced at trap triggerer</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(affectiveCaster, procAttacker &amp; <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf278f87dd654facbbe75d8acb32a8d0d">PROC_FLAG_ON_TRAP_ACTIVATION</a> ? <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() : unit, affectiveCaster ? procAttacker : <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>), procVictim, procEx, 0, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160; </div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <a class="code" href="classSpell.html#a0b4cba9e81d9533c5acc442797c7df85">OnAfterHit</a>();</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">if</span> (unit-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>())</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;        <span class="comment">// cast at creature (or GO) quest objectives update at successful cast finished (+channel finished)</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;        <span class="comment">// ignore pets or autorepeat/melee casts for speed (not exist quest for spells (hm... )</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;        <span class="keywordflow">if</span> (affectiveCaster &amp;&amp; !<span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(unit)-&gt;IsPet() &amp;&amp; !<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>() &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#aaf9581e80903c8fb7f96ea3e1d9e0173">IsChannelActive</a>())</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* p = affectiveCaster-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>())</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                p-&gt;RewardPlayerAndGroupAtCast(unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160; </div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;    <span class="comment">// Call scripted function for AI if this spell is casted upon a creature</span></div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="keywordflow">if</span> (unit-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>())</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;        unit-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a60339f23985eaf04df5eee4fb9fc9e9b">SpellHit</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="comment">// Call scripted function for AI if this spell is casted by a creature</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>() &amp;&amp; <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;<a class="code" href="classCreature.html#a026fb9fce8e9e74991097c7b626d38e3">AI</a>())</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;AI()-&gt;SpellHitTarget(unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, missInfo);</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">if</span> (affectiveCaster &amp;&amp; affectiveCaster != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; affectiveCaster-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>() &amp;&amp; <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(affectiveCaster)-&gt;AI())</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(affectiveCaster)-&gt;<a class="code" href="classCreature.html#a026fb9fce8e9e74991097c7b626d38e3">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a1c25fa7bf81045336e3f2977f94b7c03">SpellHitTarget</a>(unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, missInfo);</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160; </div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5adeb5739c9662a46819362c9c9aad63">IsSpellProccingHappening</a>())</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af5be270efaac6557f4f394b7bcbbedcd">AddDelayedHolderDueToProc</a>(<a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>);</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;            <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#ab092e45184bc9f7b8c897578567fe5d2">SetState</a>(<a class="code" href="SpellAuras_8h.html#a1b224092d87cd57536cbe0dafe6dc44aa5a4725ef493acd702a0b3f7b46c72c96">SPELLAURAHOLDER_STATE_READY</a>);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;}</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"><a class="line" href="classSpell.html#af0b413dbd852a160c567fc28dc985983"> 1491</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#af0b413dbd852a160c567fc28dc985983">Spell::DoSpellHitOnUnit</a>(<a class="code" href="classUnit.html">Unit</a>* unit, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask, <a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a>* target, <span class="keywordtype">bool</span> isReflected)</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;{</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    <span class="keywordflow">if</span> (!unit)</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> traveling = <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a>;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <span class="comment">// Recheck immune (only for delayed spells)</span></div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <span class="keywordflow">if</span> (traveling &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8a29701b50e8e772029f3da2ad046d35">SPELL_ATTR_NO_IMMUNITIES</a>))</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    {</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> notImmunedMask = 0;</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effIndex = 0; effIndex &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++effIndex)</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            <span class="keywordflow">if</span> ((target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a> &amp; (1 &lt;&lt; effIndex)) != 0)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                <span class="keywordflow">if</span> (!unit-&gt;<a class="code" href="classUnit.html#a54a4815c604d6106323225732d74a7c2">IsImmuneToSpellEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(effIndex), unit == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;                    notImmunedMask |= (1 &lt;&lt; effIndex);</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;        effectMask = notImmunedMask &amp; ~target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a31c7a102ca04d466b72ce48cf24b9307">effectMaskProcessed</a>;</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <span class="keywordflow">if</span> (!notImmunedMask ||</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            unit-&gt;<a class="code" href="classUnit.html#aacd9531d802b8cd7fabaa515a8280388">IsImmuneToDamage</a>(<a class="code" href="SpellMgr_8h.html#a22e0f1c7f488563ce1e10a2ae2d4906d">GetSpellSchoolMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) ||</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            unit-&gt;<a class="code" href="classUnit.html#a01b2890f9e1c804dd31b5849575f99bf">IsImmuneToSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, unit == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, effectMask, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        {</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;            <a class="code" href="classUnit.html#acbcb021453f7b3ebce071a93ad539877">Unit::SendSpellMiss</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a>);</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;            <a class="code" href="classSpell.html#ac34348062658c54529e2d7f0e108e739">ResetEffectDamageAndHeal</a>();</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;        }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="keywordflow">if</span> (unit-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(unit)-&gt;GetAchievementMgr().<a class="code" href="classPlayer.html#a9cf10b1ea6187be4cd0facfd5c691c6d">UpdateAchievementCriteria</a>(<a class="code" href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a16b93c36aa3687bd59c859016b6202c1">ACHIEVEMENT_CRITERIA_TYPE_BE_SPELL_TARGET</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(unit)-&gt;GetAchievementMgr().<a class="code" href="classPlayer.html#a9cf10b1ea6187be4cd0facfd5c691c6d">UpdateAchievementCriteria</a>(<a class="code" href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a048099caa4f6285d05f1f824b1793259">ACHIEVEMENT_CRITERIA_TYPE_BE_SPELL_TARGET2</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    }</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160; </div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;<a class="code" href="classPlayer.html#ac6351ac9ee0e10224edb31cef32292e9">GetAchievementMgr</a>().<a class="code" href="classAchievementMgr.html#a78368ea82c1c770933b636e1a2343e8e">UpdateAchievementCriteria</a>(<a class="code" href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a90f087842f0682fb18ff1b9af67810b0">ACHIEVEMENT_CRITERIA_TYPE_CAST_SPELL2</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, 0, unit);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160; </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="keywordflow">if</span> (traveling &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> != unit)</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    {</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a67762eaa54f1dba00509f655e942e555">CanAttackSpell</a>(unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a87857ee440b15e7e5a0e6c3bd293fe8c">SPELL_ATTR_EX5_IGNORE_AREA_EFFECT_PVP_CHECK</a>)))</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;        {</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;            <span class="comment">// for delayed spells ignore not visible explicit target, if caster is dead, nothing is visible for him</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;            <span class="keywordflow">if</span> (unit == <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() &amp;&amp; ((<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>() &amp;&amp; !unit-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>()) || !unit-&gt;<a class="code" href="classUnit.html#ac771f494288eae7dfad53907ec0fd7e3">IsVisibleForOrDetect</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a1e4d63776ace92d6c631f8f9de87f2df">SPELL_ATTR_EX6_IGNORE_PHASE_SHIFT</a>))))</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;            {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                <a class="code" href="classSpell.html#ac34348062658c54529e2d7f0e108e739">ResetEffectDamageAndHeal</a>();</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            }</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;        }</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;        {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;            <span class="comment">// for delayed spells ignore negative spells (after duel end) for friendly targets</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#aa48055df917f805e2ef4b8e56f78cc93">IsPositiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, unit))</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                <a class="code" href="classUnit.html#acbcb021453f7b3ebce071a93ad539877">Unit::SendSpellMiss</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a>);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                <a class="code" href="classSpell.html#ac34348062658c54529e2d7f0e108e739">ResetEffectDamageAndHeal</a>();</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;            }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        }</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    }</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160; </div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="comment">// Apply additional spell effects to target</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    <a class="code" href="classSpell.html#ae56cd0dc9a0fcece5365d59925da40f1">CastPreCastSpells</a>(unit);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* affectiveCaster = <a class="code" href="classSpell.html#af8de4da19951058b9debc1521bb5b954">GetAffectiveCasterOrOwner</a>();</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a11f87f40d3653c7085578227da35a538">IsSpellAppliesAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, effectMask))</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;        <span class="keywordflow">if</span> (affectiveCaster)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;            <span class="keywordflow">if</span> (traveling) <span class="comment">// if travelling, need to recalculate diminishing level and duration</span></div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;            {</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;                target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a> = unit-&gt;<a class="code" href="classUnit.html#a0d74177af4f180c8ec0af151313189c6">GetDiminishing</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a> &gt; 0)</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;                {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> duration = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">effectDuration</a>;</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                    unit-&gt;<a class="code" href="classUnit.html#a11e78cce4735a7862255a86005e67e82">ApplyDiminishingToDuration</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>, duration, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a>, isReflected, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">m_auraScript</a>);</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;                    target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a> = duration;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                }</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;            }</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160; </div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a> != target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a> &amp;&amp; target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a> == 0 &amp;&amp; target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a> &gt; <a class="code" href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a686cebb344da5f1a40407c2feb03d2da">DIMINISHING_LEVEL_1</a> &amp;&amp; !<a class="code" href="SpellMgr_8h.html#aeb77ce79b009e64c44d67dd7e993cd4e">IsSpellWithNonAuraEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;                <a class="code" href="classUnit.html#acbcb021453f7b3ebce071a93ad539877">Unit::SendSpellMiss</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a>);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;                <a class="code" href="classSpell.html#ac34348062658c54529e2d7f0e108e739">ResetEffectDamageAndHeal</a>();</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;            }</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160; </div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">bool</span> pvp = (unit-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>) &amp;&amp; affectiveCaster-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>));</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            <span class="comment">// Increase Diminishing on unit, actual durations are already calculated</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8cpp.html#a59d0590019858d9eb3b45f9e482f1431">IsSubjectToDiminishingLevels</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>, pvp))</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                unit-&gt;<a class="code" href="classUnit.html#a85b1c936a9aff94dd00fb845f875e01e">IncrDiminishing</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>, pvp);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        }</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;        <span class="comment">// Only unit caster to be passed here</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> = <a class="code" href="SpellAuras_8cpp.html#a89ce2a8162f56943bafaaa4c4f4fb2ea">CreateSpellAuraHolder</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, unit, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>, <a class="code" href="classSpell.html#ab3d3ccf4db3daa4de3bdfd7fe3371eae">m_triggeredBySpellInfo</a>);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#a28a84093e48130837d9a199e4ba50ede">setDiminishGroup</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a>);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160; </div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    <a class="code" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">ExecuteEffects</a>(unit, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, effectMask);</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">if</span> (affectiveCaster &amp;&amp; affectiveCaster != unit &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;        <a class="code" href="classUnit.html#aa092f44b1d861f4e9c6adfb2a94b9b15">Unit::CasterHitTargetWithSpell</a>(affectiveCaster, unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>);</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="comment">// now apply all created auras</span></div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>)</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    {</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        <span class="comment">// normally shouldn&#39;t happen</span></div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#ab7f8cf8e30f83ace3f9b6771e945d51a">IsEmptyHolder</a>())</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;            <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> duration = <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#af69c8cd9624dc41a345e775c075518c3">GetAuraMaxDuration</a>();</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;            <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> originalDuration = duration;</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;            <span class="keywordflow">if</span> (duration &gt; 0 &amp;&amp; target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">diminishGroup</a> &gt; <a class="code" href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a>)</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;            {</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                duration = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">diminishDuration</a>;</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                <span class="comment">// Fully diminished</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                <span class="keywordflow">if</span> (duration == 0)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                {</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                    <span class="keyword">delete</span> <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                    <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                }</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;            }</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;            <span class="keywordflow">if</span> (duration != originalDuration)</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;            {</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;                <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#ab71e0b6735bb181565ca094ac1d0d0e5">SetAuraMaxDuration</a>(duration);</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;                <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#a04ea541571f23194212875bf5a412476">SetAuraDuration</a>(duration);</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;            }</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; </div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            <span class="keywordflow">if</span> (originalDuration &gt; 0 &amp;&amp; target &amp;&amp; target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a2465f3f2446585875bbe50050cd63f4b">heartbeatResistChance</a> &amp;&amp; !<a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#a31ef95e4dcce0b52bace3fc8c5c4049d">IsPositive</a>())</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;            {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                <span class="comment">// TBC+: do not set heartbeat in pvp</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                <span class="keywordflow">if</span> (<span class="keywordtype">bool</span> heartbeat = !(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a1cb0fbec598ac4d9d2507f9e575cfa37">IsControlledByPlayer</a>() &amp;&amp; unit-&gt;<a class="code" href="classUnit.html#a62196e93f86fd56823e665abd41864db">IsPlayerControlled</a>()))</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>-&gt;<a class="code" href="classSpellAuraHolder.html#ae5e37b35a05d2fef0061c637816f1774">SetHeartbeatResist</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a2465f3f2446585875bbe50050cd63f4b">heartbeatResistChance</a>, originalDuration, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">diminishLevel</a>));</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;            }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;            <span class="keywordflow">if</span> (!unit-&gt;<a class="code" href="classUnit.html#af3fdd69056fa0e608f38f5b7579a349e">AddSpellAuraHolder</a>(<a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>))</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;            {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                <span class="keyword">delete</span> <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>;</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;            }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        }</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        {</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;            <span class="keyword">delete</span> <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a>;</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;            <a class="code" href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">m_spellAuraHolder</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    }</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;}</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160; </div>
<div class="line"><a name="l01642"></a><span class="lineno"><a class="line" href="classSpell.html#a1f60430046b242448bfe6509aa1e333d"> 1642</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a1f60430046b242448bfe6509aa1e333d">Spell::DoAllTargetlessEffects</a>(<span class="keywordtype">bool</span> dest)</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;{</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procAttacker;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procVictim;</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procEx = <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea07b2f1753e6047dcfef05d8ec0de5b87">PROC_EX_NONE</a>;</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160; </div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask;</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    <span class="keywordflow">if</span> (dest) <span class="comment">// can have delay</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    {</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;        effectMask = <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">effectMask</a> &amp;~<a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20"> m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#ad9dbe39bea859de7b9a6b3e1efa060dd">effectMaskProcessed</a>;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;        <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#ad9dbe39bea859de7b9a6b3e1efa060dd">effectMaskProcessed</a> = <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">effectMask</a>;</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> j = 0; j &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++j)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;            <span class="keywordflow">if</span> ((effectMask &amp; (1 &lt;&lt; j)) != 0)</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;                <a class="code" href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6">HandleEffect</a>(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j));</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keywordflow">else</span> <span class="comment">// always immediate</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    {</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        effectMask = <a class="code" href="classSpell.html#aad28cf5dd3755b514793c6befa52844b">m_targetlessMask</a>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> j = 0; j &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++j)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        {</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;            <span class="keywordflow">if</span> ((effectMask &amp; (1 &lt;&lt; j)) != 0)</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                <a class="code" href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6">HandleEffect</a>(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j));</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        }</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160; </div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;        <span class="comment">// dest effects that are immediate</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> destMaskImmediate = <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">effectMask</a>;</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a85e2a224d75abe47239cc1c33300cb23">IsEffectHandledImmediatelySpellLaunch</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)))</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                destMaskImmediate &amp;= ~(destMaskImmediate &amp; (1 &lt;&lt; i));</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> j = 0; j &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++j)</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;        {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            <span class="keywordflow">if</span> ((destMaskImmediate &amp; (1 &lt;&lt; j)) != 0)</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                <a class="code" href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6">HandleEffect</a>(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j));</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#ad9dbe39bea859de7b9a6b3e1efa060dd">effectMaskProcessed</a> = destMaskImmediate;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160; </div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">if</span> (effectMask)</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">OnHit</a>(<a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        {</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;            <a class="code" href="classSpell.html#a57f1e6a4a1de4ae2f42961b618aa0aa1">PrepareMasksForProcSystem</a>(effectMask, procAttacker, procVictim, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;            <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, procAttacker &amp; <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf278f87dd654facbbe75d8acb32a8d0d">PROC_FLAG_ON_TRAP_ACTIVATION</a> ? <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() : <span class="keyword">nullptr</span>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> ? procAttacker : <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>), procVictim, procEx, 0, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">this</span>));</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;        }</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    }</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;}</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div>
<div class="line"><a name="l01694"></a><span class="lineno"><a class="line" href="classSpell.html#ae31ef225c3a9ccdcfdc8c0db2b786dda"> 1694</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">Spell::DoAllEffectOnTarget</a>(<a class="code" href="structSpell_1_1GOTargetInfo.html">GOTargetInfo</a>* target)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;{</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1GOTargetInfo.html#aedfa36678be863a558ecd0ecc07cc544">processed</a>)                                  <span class="comment">// Check target</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    target-&gt;<a class="code" href="structSpell_1_1GOTargetInfo.html#aedfa36678be863a558ecd0ecc07cc544">processed</a> = <span class="keyword">true</span>;                               <span class="comment">// Target checked in apply effects procedure</span></div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask = target-&gt;<a class="code" href="structSpell_1_1GOTargetInfo.html#a07d70f3c2425f07a36db90e9fd5b3c97">effectMask</a>;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    <span class="keywordflow">if</span> (!effectMask)</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;    <a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(target-&gt;<a class="code" href="structSpell_1_1GOTargetInfo.html#a619f98bf094d2667048204f733d64d0c">targetGUID</a>);</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;    <span class="keywordflow">if</span> (!go)</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    <a class="code" href="classSpell.html#a0e7f35f88f4bad9f5599c67fde08f98a">gameObjTarget</a> = go; <span class="comment">// redundant but for safety against future change for hook functionality</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <a class="code" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">ExecuteEffects</a>(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, go, effectMask);</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160; </div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;    <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">OnHit</a>(<a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    <span class="comment">// cast at creature (or GO) quest objectives update at successful cast finished (+channel finished)</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    <span class="comment">// ignore autorepeat/melee casts for speed (not exist quest for spells (hm... )</span></div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>() &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#aaf9581e80903c8fb7f96ea3e1d9e0173">IsChannelActive</a>() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* p = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>())</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;            p-&gt;RewardPlayerAndGroupAtCast(go, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    }</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;}</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160; </div>
<div class="line"><a name="l01723"></a><span class="lineno"><a class="line" href="classSpell.html#a32e917a293fa4ebd41a1cd1914debaff"> 1723</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">Spell::DoAllEffectOnTarget</a>(<a class="code" href="structSpell_1_1ItemTargetInfo.html">ItemTargetInfo</a>* target)</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;{</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask = target-&gt;<a class="code" href="structSpell_1_1ItemTargetInfo.html#a3161ec2ffdf794c000cc94b91519d009">effectMask</a>;</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="structSpell_1_1ItemTargetInfo.html#afce5eba99c3dc33698dd12af8432f357">item</a> || !effectMask)</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160; </div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a> = target-&gt;<a class="code" href="structSpell_1_1ItemTargetInfo.html#afce5eba99c3dc33698dd12af8432f357">item</a>; <span class="comment">// redundant but for safety against future change for hook functionality</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160; </div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <a class="code" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">ExecuteEffects</a>(<span class="keyword">nullptr</span>, target-&gt;<a class="code" href="structSpell_1_1ItemTargetInfo.html#afce5eba99c3dc33698dd12af8432f357">item</a>, <span class="keyword">nullptr</span>, effectMask);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">OnHit</a>(<a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>);</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;}</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160; </div>
<div class="line"><a name="l01736"></a><span class="lineno"><a class="line" href="classSpell.html#ab01d88da3ec0343192b27af12a2754b8"> 1736</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">Spell::DoAllEffectOnTarget</a>(<a class="code" href="structSpell_1_1CorpseTargetInfo.html">CorpseTargetInfo</a>* target)</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;{</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask = target-&gt;<a class="code" href="structSpell_1_1CorpseTargetInfo.html#a02b59cc49751fffe6def37668496f83e">effectMask</a>;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="structSpell_1_1CorpseTargetInfo.html#adf8f4c3bb1600d001b685e3ace941709">corpseGUID</a> || !effectMask)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160; </div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <a class="code" href="classCorpse.html">Corpse</a>* corpse = <a class="code" href="classObjectAccessor.html#a0d4a6323d8cf6690976731f16a588fe8">ObjectAccessor::GetCorpseInMap</a>(target-&gt;<a class="code" href="structSpell_1_1CorpseTargetInfo.html#adf8f4c3bb1600d001b685e3ace941709">corpseGUID</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>());</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keywordflow">if</span> (!corpse)</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <a class="code" href="classSpell.html#a04adccf710024da5871ed1f1dfd8fe4a">corpseTarget</a> = corpse;</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <a class="code" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">ExecuteEffects</a>(<span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, effectMask);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;}</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160; </div>
<div class="line"><a name="l01750"></a><span class="lineno"><a class="line" href="classSpell.html#af181a3684cada28607db5b669cb05365"> 1750</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#af181a3684cada28607db5b669cb05365">Spell::HandleImmediateEffectExecution</a>(<a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a>* target)</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;{</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">effectMask</a> == 0)</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">// Get mask of effects for target</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mask = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">effectHitMask</a>;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; </div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a> ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a>);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordflow">if</span> (!unit)</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <span class="comment">// Get original caster (if exist) and calculate damage/healing from him data</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* affectiveCaster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>();</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="comment">// FIXME: in case wild GO heal/damage spells will be used target bonuses</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* caster = affectiveCaster ? affectiveCaster : <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65a">SpellMissInfo</a> missInfo = target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">missCondition</a>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    <span class="comment">// Need init unitTarget by default unit (can changed in code on reflect)</span></div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// Or on missInfo!=SPELL_MISS_NONE unitTarget undefined (but need in trigger subsystem)</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = unit;</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="comment">// Reset damage/healing counter</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> = 0;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <a class="code" href="classSpell.html#aaa462a3042ec64054da97bab0f0186a8">m_absorb</a> = 0;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> = 0; <span class="comment">// healing maybe not needed at this point</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; </div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="comment">// keep damage amount for reflected spells</span></div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <span class="keywordflow">if</span> (missInfo == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a> || (missInfo == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a> &amp;&amp; target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>))</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    {</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a85e2a224d75abe47239cc1c33300cb23">IsEffectHandledImmediatelySpellLaunch</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)))</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;                mask &amp;= ~(mask &amp; (1 &lt;&lt; i));</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        <a class="code" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">ExecuteEffects</a>(unit, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, mask);</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    }</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160; </div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a1813d779c7b7efea9cd44d8458252418">damage</a> = <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a>;</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#aea8200356339c1059bb2f0fdb58abaa9">healing</a> = <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a>;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a1c4c7b936702260fd43837d92419a6c6">HitInfo</a> = 0;</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#a31c7a102ca04d466b72ce48cf24b9307">effectMaskProcessed</a> = mask;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> &gt; 0 || <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> &gt; 0)</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        target-&gt;<a class="code" href="structSpell_1_1TargetInfo.html#af2cad39388e6d630ce32c5cec4327624">isCrit</a> = <a class="code" href="classUnit.html#a8f593b94abdf8507d7be268281111ea0">Unit::RollSpellCritOutcome</a>(affectiveCaster, unit, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;}</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160; </div>
<div class="line"><a name="l01794"></a><span class="lineno"><a class="line" href="classSpell.html#a6bd7f2b3578de307b5564396c4170b99"> 1794</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a6bd7f2b3578de307b5564396c4170b99">Spell::CanSpellDiminish</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a62196e93f86fd56823e665abd41864db">IsPlayerControlled</a>() || <a class="code" href="SpellMgr_8cpp.html#a52622b129525509eb04c79a18ed7661b">IsCreatureDRSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;}</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160; </div>
<div class="line"><a name="l01799"></a><span class="lineno"><a class="line" href="classSpell.html#ac99404294f7725f4bd29e70e015e3d47"> 1799</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ac99404294f7725f4bd29e70e015e3d47">Spell::InitializeDamageMultipliers</a>()</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;{</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    {</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] == 0)</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> EffectChainTarget = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a44ccfe3e8ec838d73c09d1e6aa261c19">EffectChainTarget</a>[i];</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* realCaster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>())</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = realCaster-&gt;<a class="code" href="classPlayer.html#add3944b50311b59aded74efda7fea752">GetSpellModOwner</a>())</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351ac8da41f19ec3dc98d57d14b6ae22ab7f">SPELLMOD_JUMP_TARGETS</a>, EffectChainTarget);</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160; </div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;        <a class="code" href="classSpell.html#a775626fa420464863cbc05128381c5ba">m_damageMultipliers</a>[i] = 1.0f;</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf942ecb11955a03d4b522c3981b71689">TARGET_UNIT_ENEMY</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadda43b90ff97d6de36f0753dfe22253e">TARGET_UNIT_FRIEND_CHAIN_HEAL</a>) &amp;&amp; (EffectChainTarget &gt; 1))</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;            <a class="code" href="classSpell.html#ac63ea9310b09ececfc1eac19133abce1">m_applyMultiplierMask</a> |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;}</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"><a class="line" href="classSpell.html#a389780258153b86d112f9628100d419a"> 1817</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a389780258153b86d112f9628100d419a">Spell::IsAliveUnitPresentInTargetList</a>()</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;{</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">// Not need check return true</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#adcb37c1f1904971b48304f6d18d48ee5">m_needAliveTargetMask</a> == 0)</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> channelTargetEffectMask = <a class="code" href="classSpell.html#adcb37c1f1904971b48304f6d18d48ee5">m_needAliveTargetMask</a>;</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> channelAuraMask = 0;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d">SPELL_EFFECT_APPLY_AURA</a>)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            channelAuraMask |= 1 &lt;&lt; i;</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    channelAuraMask &amp;= channelTargetEffectMask;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    {</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <span class="keywordflow">if</span> (ihit-&gt;missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a> &amp;&amp; (channelAuraMask &amp; ihit-&gt;effectHitMask))</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        {</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == ihit-&gt;targetGUID ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, ihit-&gt;targetGUID);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160; </div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;            <span class="keywordflow">if</span> (!unit)</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160; </div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;            <span class="comment">// either unit is alive and normal spell, or unit dead and deathonly-spell</span></div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abc73b50115c6fa2ad0b3aa51668a2cec">IsValidDeadOrAliveTarget</a>(unit))</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                channelAuraMask &amp;= ~ihit-&gt;effectHitMask;   <span class="comment">// remove from need alive mask effect that have alive target</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;        }</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    }</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160; </div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="comment">// is all effects from m_needAliveTargetMask have alive targets</span></div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">return</span> channelAuraMask == 0;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;}</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160; </div>
<div class="line"><a name="l01850"></a><span class="lineno"><a class="line" href="classSpell.html#abc73b50115c6fa2ad0b3aa51668a2cec"> 1850</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#abc73b50115c6fa2ad0b3aa51668a2cec">Spell::IsValidDeadOrAliveTarget</a>(<a class="code" href="classUnit.html">Unit</a> <span class="keyword">const</span>* target)<span class="keyword"> const</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        <span class="keywordflow">return</span> !<a class="code" href="SpellMgr_8h.html#a2b05b6d33fb015d675684adbf831cf11">IsDeathOnlySpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a4b52705bf9b40c5afc1698bf9a165663">IsAllowingDeadTarget</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;}</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">// Helper for Chain Healing</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment">// Spell target first</span></div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment">// Raidmates then descending by injury suffered (MaxHealth - Health)</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">// Other players/mobs then descending by injury suffered (MaxHealth - Health)</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"><a class="line" href="structChainHealingOrder.html"> 1863</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structChainHealingOrder.html">ChainHealingOrder</a></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;{</div>
<div class="line"><a name="l01865"></a><span class="lineno"><a class="line" href="structChainHealingOrder.html#a225f1143167d0480852039d0bff91968"> 1865</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="structChainHealingOrder.html#a225f1143167d0480852039d0bff91968">MainTarget</a>;</div>
<div class="line"><a name="l01866"></a><span class="lineno"><a class="line" href="structChainHealingOrder.html#ab54f807818bcf805e1d6b4ec729d1fff"> 1866</a></span>&#160;    <a class="code" href="structChainHealingOrder.html#ab54f807818bcf805e1d6b4ec729d1fff">ChainHealingOrder</a>(<a class="code" href="classUnit.html">Unit</a> <span class="keyword">const</span>* <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>) : <a class="code" href="structChainHealingOrder.html#a225f1143167d0480852039d0bff91968">MainTarget</a>(<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>) {};</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">// functor for operator &quot;&gt;&quot;</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"><a class="line" href="structChainHealingOrder.html#a5377e9e938200c8c49b462d7ba5e7ebe"> 1868</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="structChainHealingOrder.html#a5377e9e938200c8c49b462d7ba5e7ebe">operator()</a>(<a class="code" href="classUnit.html">Unit</a> <span class="keyword">const</span>* _Left, <a class="code" href="classUnit.html">Unit</a> <span class="keyword">const</span>* _Right)<span class="keyword"> const</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="structChainHealingOrder.html#a1a7f8e607cb96798badbfe3aba44bc46">ChainHealingHash</a>(_Left) &lt; <a class="code" href="structChainHealingOrder.html#a1a7f8e607cb96798badbfe3aba44bc46">ChainHealingHash</a>(_Right));</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    }</div>
<div class="line"><a name="l01872"></a><span class="lineno"><a class="line" href="structChainHealingOrder.html#a1a7f8e607cb96798badbfe3aba44bc46"> 1872</a></span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> <a class="code" href="structChainHealingOrder.html#a1a7f8e607cb96798badbfe3aba44bc46">ChainHealingHash</a>(<a class="code" href="classUnit.html">Unit</a> <span class="keyword">const</span>* <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;<span class="keyword">    </span>{</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a> == <a class="code" href="structChainHealingOrder.html#a225f1143167d0480852039d0bff91968">MainTarget</a>)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;IsInGroup(<a class="code" href="structChainHealingOrder.html#a225f1143167d0480852039d0bff91968">MainTarget</a>))</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;        {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetHealth() == <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetMaxHealth())</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;                <span class="keywordflow">return</span> 40000;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;            <span class="keywordflow">return</span> 20000 - <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetMaxHealth() + <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetHealth();</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <span class="keywordflow">return</span> 40000 - <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetMaxHealth() + <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetHealth();</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    }</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;};</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; </div>
<div class="line"><a name="l01886"></a><span class="lineno"><a class="line" href="classChainHealingFullHealth.html"> 1886</a></span>&#160;<span class="keyword">class </span><a class="code" href="classChainHealingFullHealth.html">ChainHealingFullHealth</a></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;{</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l01889"></a><span class="lineno"><a class="line" href="classChainHealingFullHealth.html#a508d9e1afb737ddb09df7e0a3b7cbafd"> 1889</a></span>&#160;        <span class="keyword">const</span> <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classChainHealingFullHealth.html#a508d9e1afb737ddb09df7e0a3b7cbafd">MainTarget</a>;</div>
<div class="line"><a name="l01890"></a><span class="lineno"><a class="line" href="classChainHealingFullHealth.html#a888ab51ccd8d272c47ce9288b5782936"> 1890</a></span>&#160;        <a class="code" href="classChainHealingFullHealth.html#a888ab51ccd8d272c47ce9288b5782936">ChainHealingFullHealth</a>(<span class="keyword">const</span> <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>) : <a class="code" href="classChainHealingFullHealth.html#a508d9e1afb737ddb09df7e0a3b7cbafd">MainTarget</a>(<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>) {};</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160; </div>
<div class="line"><a name="l01892"></a><span class="lineno"><a class="line" href="classChainHealingFullHealth.html#a4657de755e44fff4b7c1ebb58dd0d526"> 1892</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classChainHealingFullHealth.html#a4657de755e44fff4b7c1ebb58dd0d526">operator()</a>(<span class="keyword">const</span> <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>)</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        {</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a> != <a class="code" href="classChainHealingFullHealth.html#a508d9e1afb737ddb09df7e0a3b7cbafd">MainTarget</a> &amp;&amp; <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;<a class="code" href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>() == <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetMaxHealth());</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;        }</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;};</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160; </div>
<div class="line"><a name="l01898"></a><span class="lineno"><a class="line" href="classSpell.html#ad06c46067af46fe82c9ec46352ab7ca8"> 1898</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#ad06c46067af46fe82c9ec46352ab7ca8">Spell::CheckAndAddMagnetTarget</a>(<a class="code" href="classUnit.html">Unit</a>* target, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex, <span class="keywordtype">bool</span> targetB, <a class="code" href="structSpell_1_1TempTargetingData.html">TempTargetingData</a>&amp; data)</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;{</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* magnetTarget = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a647422f3abc64359e7daf9930acf2c55">SelectMagnetTarget</a>(target, <span class="keyword">this</span>))</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    {</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        <span class="comment">// Found. Push totem as target instead.</span></div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;        <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">setUnitTarget</a>(magnetTarget);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        data.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[effIndex].<a class="code" href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">tmpUnitList</a>[targetB].push_back(magnetTarget);</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;        data.<a class="code" href="structSpell_1_1TempTargetingData.html#a2c03f3b6a2eef5380ea2c0514a9d0f3c">magnet</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    }</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;}</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160; </div>
<div class="line"><a name="l01912"></a><span class="lineno"><a class="line" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c"> 1912</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">Spell::SetTargetMap</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetMode, <span class="keywordtype">bool</span> targetB, <a class="code" href="structSpell_1_1TempTargetingData.html">TempTargetingData</a>&amp; targetingData)</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;{</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <a class="code" href="structSpell_1_1TempTargetData.html">TempTargetData</a>&amp; data = targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[effIndex];</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keywordtype">float</span> radius;</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> unMaxTargets = <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>;  <span class="comment">// Get spell max affected targets</span></div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <a class="code" href="classSpell.html#ad98b19601a903f26b44cd7e30e347d27">GetSpellRangeAndRadius</a>(effIndex, radius, targetB, targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[effIndex]);</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160; </div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <span class="keywordtype">float</span> cone = <a class="code" href="classSpell.html#a704340f3b83f142c160ec6bd60773386">GetCone</a>();</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160; </div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; tempUnitList = data.<a class="code" href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">tmpUnitList</a>[targetB];</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <a class="code" href="EntitiesMgr_8h.html#a9a6023581a510c75fe601cd9d7412f15">GameObjectList</a>&amp; tempGOList = data.<a class="code" href="structSpell_1_1TempTargetData.html#a08fca2887b9a0e66e0f86c054982c7b7">tmpGOList</a>[targetB];</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160; </div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;    {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3ee0e7ae710be02a672579f9a2cdaa1c">TARGET_LOCATION_UNIT_RANDOM_SIDE</a>:</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa72096d416a65b6afc3bca4b433133076">TARGET_LOCATION_CASTER_RANDOM_SIDE</a>:</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;            <span class="comment">// special case for Fatal Attraction (BT, Mother Shahraz)</span></div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 40869)</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;                radius = 30.0f;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160; </div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;            <span class="comment">// Get a random point in circle. Use sqrt(rand) to correct distribution when converting polar to Cartesian coordinates.</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            radius *= sqrtf(<a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>());</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            <span class="comment">// no &#39;break&#39; expected since we use code in case TARGET_LOCATION_CASTER_RANDOM_CIRCUMFERENCE!!!</span></div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa14b9e05e6fddd8c7f4c22a48f884277d">TARGET_LOCATION_UNIT_RANDOM_CIRCUMFERENCE</a>:</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0aa5ea5eb36299739b7aea83aaf35035">TARGET_LOCATION_CASTER_RANDOM_CIRCUMFERENCE</a>:</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;            <a class="code" href="classWorldObject.html">WorldObject</a>* target;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;            <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;            {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3ee0e7ae710be02a672579f9a2cdaa1c">TARGET_LOCATION_UNIT_RANDOM_SIDE</a>:</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa14b9e05e6fddd8c7f4c22a48f884277d">TARGET_LOCATION_UNIT_RANDOM_CIRCUMFERENCE</a>:</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;                    target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() ? <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;                    target = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;            }</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            <span class="comment">// Get a random point AT the circumference</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            <span class="keywordtype">float</span> angle = 2.0f * <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * <a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>();</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            <a class="code" href="structPosition.html">Position</a> pos = target-&gt;<a class="code" href="classWorldObject.html#a6d6cc94b21f561fe7f46bc63177065c6">GetFirstRandomAngleCollisionPosition</a>(radius, angle);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(pos.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, pos.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, pos.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>);</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        }</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faca4a795bfc72905cda7e69b27f55fad5">TARGET_LOCATION_RANDOM_CIRCUMFERENCE</a>:</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab149d12968885342322cafcd890a69f5">TARGET_LOCATION_RANDOM_SIDE</a>:</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        {</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;            <span class="keywordflow">if</span> (radius &gt; 0.0f) <span class="comment">// Get a random point in the circle around current dest target</span></div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            {</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                <span class="comment">// Use sqrt(rand) to correct distribution when converting polar to Cartesian coordinates.</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                radius *= sqrtf(<a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>());</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                <span class="keywordtype">float</span> angle = 2.0f * <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * <a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>();</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                <a class="code" href="structPosition.html">Position</a> pos = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">getDestination</a>();</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a51ee0969c43fed32eacf1a56e24393eb">MovePositionToFirstCollision</a>(pos, radius, angle);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(pos.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, pos.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, pos.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>);</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;            }</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3eb863d0ed50b7cb140558155fb07a69">TARGET_LOCATION_UNIT_MINION_POSITION</a>: <span class="comment">// unknown how pet summon is different - maybe some formation support?</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8143b77ebd5c7094f838b3706e28e7a5">TARGET_LOCATION_CASTER_FRONT_RIGHT</a>:</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac87a16d4727bd15a2a30716d2a33efc1">TARGET_LOCATION_CASTER_BACK_RIGHT</a>:</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3e384548d63f5185979b9b85fac98260">TARGET_LOCATION_CASTER_BACK_LEFT</a>:</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3927316559e8203c94784bc6312b8f1e">TARGET_LOCATION_CASTER_FRONT_LEFT</a>:</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae926e00811e9e5e3dd31c0145306d783">TARGET_LOCATION_CASTER_FRONT</a>:</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faafa68d7e3edd5e9a880f11c638d90ac2">TARGET_LOCATION_CASTER_BACK</a>:</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae46169d7118e2f9a826dbde4ff6e656f">TARGET_LOCATION_CASTER_LEFT</a>:</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9489af0c1d71883a98d467b641a15701">TARGET_LOCATION_CASTER_RIGHT</a>:</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;            <a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;            <span class="keywordtype">float</span> angle = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>();</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;            <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;            {</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3927316559e8203c94784bc6312b8f1e">TARGET_LOCATION_CASTER_FRONT_LEFT</a>:  angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 0.25f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3e384548d63f5185979b9b85fac98260">TARGET_LOCATION_CASTER_BACK_LEFT</a>:   angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 0.75f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac87a16d4727bd15a2a30716d2a33efc1">TARGET_LOCATION_CASTER_BACK_RIGHT</a>:  angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 1.25f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8143b77ebd5c7094f838b3706e28e7a5">TARGET_LOCATION_CASTER_FRONT_RIGHT</a>: angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 1.75f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae926e00811e9e5e3dd31c0145306d783">TARGET_LOCATION_CASTER_FRONT</a>:                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faafa68d7e3edd5e9a880f11c638d90ac2">TARGET_LOCATION_CASTER_BACK</a>:        angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a>;         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3eb863d0ed50b7cb140558155fb07a69">TARGET_LOCATION_UNIT_MINION_POSITION</a>: caster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>(); <span class="comment">// projected from original caster if necessary</span></div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae46169d7118e2f9a826dbde4ff6e656f">TARGET_LOCATION_CASTER_LEFT</a>:        angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9489af0c1d71883a98d467b641a15701">TARGET_LOCATION_CASTER_RIGHT</a>:       angle -= <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;            }</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160; </div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            <a class="code" href="structPosition.html">Position</a> pos;</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            caster-&gt;<a class="code" href="classWorldObject.html#a8655e3e9a37c11c4da647cd496f8f497">GetFirstCollisionPosition</a>(pos, radius, angle);</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(pos.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, pos.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, pos.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;        }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0045d75513ac7ec4c9f24d1e5298018c">TARGET_LOCATION_CURRENT_REFERENCE</a>:</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;            <span class="comment">// Uses destination supplied to spell or fill caster position</span></div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>) == 0)</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;            {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;                <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>(x, y, z, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a87ee372cff9cd5f87dc4171ad3a7efef">GetTransport</a>());</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(x, y, z);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;            }</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa6d07f243eca1c5b5700d3f458aac14ac">TARGET_LOCATION_CHANNEL_TARGET_DEST</a>:</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            <span class="comment">// if parent spell create dynamic object extract area from it</span></div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* channelObject = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>())</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(channelObject-&gt;GetPositionX(), channelObject-&gt;GetPositionY(), channelObject-&gt;GetPositionZ());</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa68001c3e90363ad1a4c5f757230d16be">TARGET_LOCATION_NORTH</a>:</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac3aa00cf33ff8b8dd6c07d25c6a3a271">TARGET_LOCATION_SOUTH</a>:</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab258945225308f618ff4115a061d5216">TARGET_LOCATION_EAST</a>:</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa7af2a583a54b79cd9ef202bf80034a39">TARGET_LOCATION_WEST</a>:</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9cb75fbf2cf80f4f7c136cbe37cfa24a">TARGET_LOCATION_NE</a>:</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faaf962faa0b0436ea23fa0615d2b7d07f">TARGET_LOCATION_NW</a>:</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05b1b87e8a9598b3146a5bde452c254e">TARGET_LOCATION_SE</a>:</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa90d5a5a4d11d73a97b38d6a517c1be54">TARGET_LOCATION_SW</a>:</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;        {</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>) <span class="comment">// takes current dest and offsets it</span></div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;            {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;                <a class="code" href="classWorldObject.html">WorldObject</a>* currentTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() ? <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;                <span class="keywordtype">float</span> angle = currentTarget != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> ? currentTarget-&gt;<a class="code" href="classWorldObject.html#a7c15606be3c15a33c98032fe4d190379">GetAngle</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>) : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>();</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;                <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;                {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa68001c3e90363ad1a4c5f757230d16be">TARGET_LOCATION_NORTH</a>:                         <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac3aa00cf33ff8b8dd6c07d25c6a3a271">TARGET_LOCATION_SOUTH</a>: angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a>;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab258945225308f618ff4115a061d5216">TARGET_LOCATION_EAST</a>:  angle -= <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa7af2a583a54b79cd9ef202bf80034a39">TARGET_LOCATION_WEST</a>:  angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9cb75fbf2cf80f4f7c136cbe37cfa24a">TARGET_LOCATION_NE</a>:    angle -= <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 4;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faaf962faa0b0436ea23fa0615d2b7d07f">TARGET_LOCATION_NW</a>:    angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 4;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05b1b87e8a9598b3146a5bde452c254e">TARGET_LOCATION_SE</a>:    angle -= 3 * <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 4;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa90d5a5a4d11d73a97b38d6a517c1be54">TARGET_LOCATION_SW</a>:    angle += 3 * <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 4;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;                }</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;                <a class="code" href="structPosition.html">Position</a> pos = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">getDestination</a>();</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;                currentTarget-&gt;<a class="code" href="classWorldObject.html#a51ee0969c43fed32eacf1a56e24393eb">MovePositionToFirstCollision</a>(pos, radius, angle);</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(pos.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, pos.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, pos.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>);</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;            }</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        }</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa2227c3934c959026126c590aa976120c">TARGET_LOCATION_CASTER_DEST</a>:</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;            <span class="keywordflow">if</span> (!(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>))</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>())</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;                    <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(caster-&gt;GetPositionX(), caster-&gt;GetPositionY(), caster-&gt;GetPositionZ());</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        }</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3afaf215630b5f1190a9a01af1647ff8">TARGET_LOCATION_DATABASE</a>:</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        {</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSpellTargetPosition.html">SpellTargetPosition</a> <span class="keyword">const</span>* st = <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSpellTargetPosition(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;            {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(st-&gt;target_X, st-&gt;target_Y, st-&gt;target_Z);</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#ab03b4a5c58b5d266e2505bffc906d21e">o</a> = st-&gt;target_Orientation;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#afd911e74e902f7a8f255b0b92937bc61">m_mapId</a> = st-&gt;target_mapId;</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                <span class="comment">// far-teleport spells are handled in SpellEffect, elsewise report an error about an unexpected map (spells are always locally)</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                <span class="keywordflow">if</span> (st-&gt;target_mapId != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>() &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] != <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aea1b56989980b9b6059bcd31de21bf59">SPELL_EFFECT_TELEPORT_UNITS</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] != <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab12a0929cec4bc67031a93fe03f51e18">SPELL_EFFECT_BIND</a>)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;SPELL: wrong map (%u instead %u) target coordinates for spell ID %u&quot;</span>, st-&gt;target_mapId, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>(), <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;            }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;SPELL: unknown target coordinates for spell ID %u&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        }</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa497adaa813966fde1c3f47c2a9372b52">TARGET_LOCATION_CASTER_HOME_BIND</a>:</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        {</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;            {</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;                <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;GetHomebindLocation(x, y, z, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#afd911e74e902f7a8f255b0b92937bc61">m_mapId</a>);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(x, y, z);</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;            }</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;        }</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa241414530f70f1d99f9fb5ea7e0b2e9a">TARGET_LOCATION_UNIT_FRONT</a>:</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabf4944d6625889f7769894a9af1aef1d">TARGET_LOCATION_UNIT_BACK</a>:</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadfe9fb54503ef1480fee762d58e08388">TARGET_LOCATION_UNIT_RIGHT</a>:</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3c61620f3225fc58bf21fd0b28b03bb1">TARGET_LOCATION_UNIT_LEFT</a>:</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa192bf55bc11e794f05b93959677aaeac">TARGET_LOCATION_UNIT_FRONT_RIGHT</a>:</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa21b3cc1c648b4c7dfd528825f646547b">TARGET_LOCATION_UNIT_BACK_RIGHT</a>:</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa45194d914c53adbad3f5c3ef37e45bb0">TARGET_LOCATION_UNIT_BACK_LEFT</a>:</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab27a47f743380539f673cfe7442e022d">TARGET_LOCATION_UNIT_FRONT_LEFT</a>:</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        {</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <span class="keywordflow">if</span> (target)</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;            {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                <span class="keywordtype">float</span> angle = target-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>();</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160; </div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;                <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                {</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa241414530f70f1d99f9fb5ea7e0b2e9a">TARGET_LOCATION_UNIT_FRONT</a>:                                 <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabf4944d6625889f7769894a9af1aef1d">TARGET_LOCATION_UNIT_BACK</a>:         angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a>;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadfe9fb54503ef1480fee762d58e08388">TARGET_LOCATION_UNIT_RIGHT</a>:        angle += -<a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2;     <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3c61620f3225fc58bf21fd0b28b03bb1">TARGET_LOCATION_UNIT_LEFT</a>:         angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa192bf55bc11e794f05b93959677aaeac">TARGET_LOCATION_UNIT_FRONT_RIGHT</a>:  angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 1.75f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa21b3cc1c648b4c7dfd528825f646547b">TARGET_LOCATION_UNIT_BACK_RIGHT</a>:   angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 1.25f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa45194d914c53adbad3f5c3ef37e45bb0">TARGET_LOCATION_UNIT_BACK_LEFT</a>:    angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 0.75f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab27a47f743380539f673cfe7442e022d">TARGET_LOCATION_UNIT_FRONT_LEFT</a>:   angle += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * 0.25f; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;                }</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;                <a class="code" href="structPosition.html">Position</a> pos;</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;                target-&gt;<a class="code" href="classWorldObject.html#a8655e3e9a37c11c4da647cd496f8f497">GetFirstCollisionPosition</a>(pos, radius, angle);</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(pos.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, pos.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, pos.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>);</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            }</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;        }</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa5b0248090de8cd76bbc9613857c457a3">TARGET_LOCATION_CASTER_FRONT_LEAP</a>:</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;        {</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            <span class="keywordtype">float</span> dist = <a class="code" href="SpellMgr_8h.html#ab4b1d536a5b410eaf601a13235196d3a">GetSpellRadius</a>(<a class="code" href="DBCStores_8cpp.html#a495e62fceccd344a25ba720c9e1966d9">sSpellRadiusStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[effIndex]));</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">float</span> IN_OR_UNDER_LIQUID_RANGE = 0.8f;                <span class="comment">// range to make player under liquid or on liquid surface from liquid level</span></div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160; </div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            G3D::Vector3 prevPos, nextPos;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <span class="keywordtype">float</span> orientation = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>();</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;            prevPos.x = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>();</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            prevPos.y = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>();</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            prevPos.z = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>();</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; </div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            <span class="keywordtype">float</span> groundZ = prevPos.z;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            <span class="keywordtype">bool</span> isPrevInLiquid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <span class="comment">// falling case</span></div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ac0203ff0d2b298c2e4fe6513756e1022">GetHeightInRange</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">GetPhaseMask</a>(), prevPos.x, prevPos.y, groundZ, 3.0f) &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ad7f9a1627d3568f34c381027145f39ee">m_movementInfo</a>.<a class="code" href="classMovementInfo.html#af0b95ddc9ba7d602a37c310fea0bda18">HasMovementFlag</a>(<a class="code" href="Object_8h.html#a083358a25d084fb928e170c453128f9daf7b99f828aa60b4dea8dd12382e5b8e6">MOVEFLAG_FALLING</a>))</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            {</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;                nextPos.x = prevPos.x + dist * cos(orientation);</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;                nextPos.y = prevPos.y + dist * sin(orientation);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;                nextPos.z = prevPos.z - 2.0f; <span class="comment">// little hack to avoid the impression to go up when teleporting instead of continue to fall. This value may need some tweak</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;                <span class="comment">//</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;                <a class="code" href="structGridMapLiquidData.html">GridMapLiquidData</a> liquidData;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a5044d60cdc782574e3f2c3ae5181f14d">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a6d518fd6e2d4279f300ac47da1a88007">IsInWater</a>(nextPos.x, nextPos.y, nextPos.z, &amp;liquidData))</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;                {</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                    <span class="keywordflow">if</span> (fabs(nextPos.z - liquidData.<a class="code" href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">level</a>) &lt; 10.0f)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;                        nextPos.z = liquidData.<a class="code" href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">level</a> - IN_OR_UNDER_LIQUID_RANGE;</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;                }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;                {</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;                    <span class="comment">// fix z to ground if near of it</span></div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ac0203ff0d2b298c2e4fe6513756e1022">GetHeightInRange</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">GetPhaseMask</a>(), nextPos.x, nextPos.y, nextPos.z, 10.0f);</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;                }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160; </div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                <span class="keywordflow">if</span> (fabs(prevPos.z - nextPos.z) &gt; 40.f) <span class="comment">// dont move too high - magical constant - might need verification</span></div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;                {</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;                    nextPos.x = prevPos.x;</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;                    nextPos.y = prevPos.y;</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;                    nextPos.z = prevPos.z - 2.0f;</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;                }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                <span class="keywordflow">else</span> <span class="comment">// check any obstacle and fix coords</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a5d623b174d4deaae0093e80de4cc1423">GetHitPosition</a>(prevPos.x, prevPos.y, prevPos.z + 0.5f, nextPos.x, nextPos.y, nextPos.z, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">GetPhaseMask</a>(), -0.5f);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;            {</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;                <span class="comment">// fix origin position if player was jumping and near of the ground but not in ground</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;                <span class="keywordflow">if</span> (fabs(prevPos.z - groundZ) &gt; 0.5f)</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;                    prevPos.z = groundZ;</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160; </div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                <span class="comment">//check if in liquid</span></div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;                isPrevInLiquid = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a5044d60cdc782574e3f2c3ae5181f14d">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a6d518fd6e2d4279f300ac47da1a88007">IsInWater</a>(prevPos.x, prevPos.y, prevPos.z);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> step = 2.0f;                                    <span class="comment">// step length before next check slope/edge/water</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> maxSlope = 50.0f;                               <span class="comment">// 50(degree) max seem best value for walkable slope</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> MAX_SLOPE_IN_RADIAN = maxSlope / 180.0f * <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a>;</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;                <span class="keywordtype">float</span> nextZPointEstimation = 1.0f;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;                <span class="keywordtype">float</span> destx = prevPos.x + dist * cos(orientation);</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;                <span class="keywordtype">float</span> desty = prevPos.y + dist * sin(orientation);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;                <span class="keyword">const</span> <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> numChecks = ceil(fabs(dist / step));</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> DELTA_X = (destx - prevPos.x) / numChecks;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">float</span> DELTA_Y = (desty - prevPos.y) / numChecks;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 1; i &lt; numChecks + 1; ++i)</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;                {</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;                    <span class="comment">// compute next point average position</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;                    nextPos.x = prevPos.x + DELTA_X;</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;                    nextPos.y = prevPos.y + DELTA_Y;</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;                    nextPos.z = prevPos.z + nextZPointEstimation;</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;                    <span class="keywordtype">bool</span> isInLiquid = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;                    <span class="keywordtype">bool</span> isInLiquidTested = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;                    <span class="keywordtype">bool</span> isOnGround = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;                    <a class="code" href="structGridMapLiquidData.html">GridMapLiquidData</a> liquidData = {};</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;                    <span class="comment">// try fix height for next position</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ac0203ff0d2b298c2e4fe6513756e1022">GetHeightInRange</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">GetPhaseMask</a>(), nextPos.x, nextPos.y, nextPos.z))</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;                    {</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;                        <span class="comment">// we cant so test if we are on water</span></div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a5044d60cdc782574e3f2c3ae5181f14d">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a6d518fd6e2d4279f300ac47da1a88007">IsInWater</a>(nextPos.x, nextPos.y, nextPos.z, &amp;liquidData))</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;                        {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;                            <span class="comment">// not in water and cannot get correct height, maybe flying?</span></div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;                            <span class="comment">//sLog.outString(&quot;Can&#39;t get height of point %u, point value %s&quot;, i, nextPos.toString().c_str());</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;                            nextPos = prevPos;</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;                        }</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;                        isInLiquid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;                        isInLiquidTested = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;                    }</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;                        isOnGround = <span class="keyword">true</span>;                                  <span class="comment">// player is on ground</span></div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;                    <span class="keywordflow">if</span> (isInLiquid || (!isInLiquidTested &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a5044d60cdc782574e3f2c3ae5181f14d">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a6d518fd6e2d4279f300ac47da1a88007">IsInWater</a>(nextPos.x, nextPos.y, nextPos.z, &amp;liquidData)))</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;                    {</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;                        <span class="keywordflow">if</span> (!isPrevInLiquid &amp;&amp; fabs(liquidData.<a class="code" href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">level</a> - prevPos.z) &gt; 2.0f)</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                        {</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;                            <span class="comment">// on edge of water with difference a bit to high to continue</span></div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;                            <span class="comment">//sLog.outString(&quot;Ground vs liquid edge detected!&quot;);</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;                            nextPos = prevPos;</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;                        }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;                        <span class="keywordflow">if</span> ((liquidData.<a class="code" href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">level</a> - IN_OR_UNDER_LIQUID_RANGE) &gt; nextPos.z)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;                            nextPos.z = prevPos.z;                                      <span class="comment">// we are under water so next z equal prev z</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                            nextPos.z = liquidData.<a class="code" href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">level</a> - IN_OR_UNDER_LIQUID_RANGE;    <span class="comment">// we are on water surface, so next z equal liquid level</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;                        isInLiquid = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                        <span class="keywordtype">float</span> ground = nextPos.z;</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;                        if (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ac0203ff0d2b298c2e4fe6513756e1022">GetHeightInRange</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">GetPhaseMask</a>(), nextPos.x, nextPos.y, ground))</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;                        {</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                            <span class="keywordflow">if</span> (nextPos.z &lt; ground)</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;                            {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;                                nextPos.z = ground;</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;                                isOnGround = <span class="keyword">true</span>;                          <span class="comment">// player is on ground of the water</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;                            }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;                        }</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;                    }</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160; </div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                    <span class="comment">//unitTarget-&gt;SummonCreature(VISUAL_WAYPOINT, nextPos.x, nextPos.y, nextPos.z, 0, TEMPSPAWN_TIMED_DESPAWN, 15000);</span></div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;                    <span class="keywordtype">float</span> hitZ = nextPos.z + 1.5f;</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a5d623b174d4deaae0093e80de4cc1423">GetHitPosition</a>(prevPos.x, prevPos.y, prevPos.z + 1.5f, nextPos.x, nextPos.y, hitZ, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">GetPhaseMask</a>(), -1.0f))</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;                    {</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                        <span class="comment">//sLog.outString(&quot;Blink collision detected!&quot;);</span></div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;                        nextPos = prevPos;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;                    }</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;                    <span class="keywordflow">if</span> (isOnGround)</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;                    {</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                        <span class="comment">// project vector to get only positive value</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                        <span class="keywordtype">float</span> ac = fabs(prevPos.z - nextPos.z);</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                        <span class="comment">// compute slope (in radian)</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                        <span class="keywordtype">float</span> slope = atan(ac / step);</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160; </div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                        <span class="comment">// check slope value</span></div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                        <span class="keywordflow">if</span> (slope &gt; MAX_SLOPE_IN_RADIAN)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                        {</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                            <span class="comment">//sLog.outString(&quot;bad slope detected! %4.2f max %4.2f, ac(%4.2f)&quot;, slope * 180 / M_PI_F, maxSlope, ac);</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                            nextPos = prevPos;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                        }</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;                        <span class="comment">//sLog.outString(&quot;slope is ok! %4.2f max %4.2f, ac(%4.2f)&quot;, slope * 180 / M_PI_F, maxSlope, ac);</span></div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;                    }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160; </div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;                    <span class="comment">//sLog.outString(&quot;point %u is ok, coords %s&quot;, i, nextPos.toString().c_str());</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;                    nextZPointEstimation = (nextPos.z - prevPos.z) / 2.0f;</div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                    isPrevInLiquid = isInLiquid;</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    prevPos = nextPos;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                }</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(nextPos.x, nextPos.y, nextPos.z);</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;        }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa2f922538098b12f53c92f45d58f2ace0">TARGET_LOCATION_UNIT_POSITION</a>:</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        {</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* currentTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(currentTarget-&gt;GetPositionX(), currentTarget-&gt;GetPositionY(), currentTarget-&gt;GetPositionZ());</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad4edcef40bb4b4c44e2c069b072dd774">TARGET_LOCATION_CASTER_FISHING_SPOT</a>:</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            <span class="comment">// special code for fishing bobber (TARGET_LOCATION_CASTER_FISHING_SPOT), should not try to avoid objects</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="comment">// nor try to find ground level, but randomly vary in angle</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;            <span class="keywordtype">float</span> min_dis = <a class="code" href="SpellMgr_8h.html#aff490dc835c75af68cdf1ed77d85d798">GetSpellMinRange</a>(<a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>));</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;            <span class="keywordtype">float</span> max_dis = <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(<a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>));</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; 10; ++i)</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                <span class="keywordtype">float</span> dis = <a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>() * (max_dis - min_dis) + min_dis;</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;                <span class="comment">// calculate angle variation for roughly equal dimensions of target area</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                <span class="keywordtype">float</span> max_angle = (max_dis - min_dis) / (max_dis + <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aece2d5aca31571c643be33390ff1ef7a">GetObjectBoundingRadius</a>());</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                <span class="keywordtype">float</span> angle_offset = max_angle * (<a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>() - 0.5f);</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ab440853301a6657f9ab78a912260ad19">GetNearPoint2d</a>(x, y, dis + <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aece2d5aca31571c643be33390ff1ef7a">GetObjectBoundingRadius</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>() + angle_offset);</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160; </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                <a class="code" href="structGridMapLiquidData.html">GridMapLiquidData</a> liqData;</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a35e49e6fd39432117cdbacd76082287a">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a6d518fd6e2d4279f300ac47da1a88007">IsInWater</a>(x, y, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a35e49e6fd39432117cdbacd76082287a">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#ac6bd8033260237f0ce549c986e79d9a5">GetWaterLevel</a>(x, y, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>()) - 1.0f, &amp;liqData))</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;                {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;                    result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6bdfdb4e6881af86168c722df5d0b2dc">SPELL_FAILED_NOT_FISHABLE</a>;</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;                }</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160; </div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;                z = liqData.<a class="code" href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">level</a>;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                <span class="comment">// finally, check LoS</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a26e87ddbab4b2f802e189ecb564e4400">IsWithinLOS</a>(x, y, z + 1.f))</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;                {</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                    result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d">SPELL_FAILED_LINE_OF_SIGHT</a>;</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;                }</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;            }</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;            <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;                <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(result);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;            }</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(x, y, z);</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        }</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9ae0d0fca4f7ea335145567b080452d2">TARGET_LOCATION_CASTER_TARGET_POSITION</a>:</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* currentTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            <span class="keywordflow">if</span> (currentTarget)</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(currentTarget-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), currentTarget-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), currentTarget-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>());</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        }</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae5d790ba3d9643df7cb762af14e36c38">TARGET_LOCATION_TRAJECTORY</a>:</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        {</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <span class="keywordflow">if</span> (!(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>))</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                <a class="code" href="structSpellRangeEntry.html">SpellRangeEntry</a> <span class="keyword">const</span>* rEntry = <a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>);</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                <span class="keywordtype">float</span> minRange = <a class="code" href="SpellMgr_8h.html#aff490dc835c75af68cdf1ed77d85d798">GetSpellMinRange</a>(rEntry);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                <span class="keywordtype">float</span> maxRange = <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(rEntry);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                <span class="keywordtype">float</span> dist = minRange + <a class="code" href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a>() * (maxRange - minRange);</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                <span class="keywordtype">float</span> _target_x, _target_y, _target_z;</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a8c065860771bc89789ff114c0b879657">GetClosePoint</a>(_target_x, _target_y, _target_z, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aefb894f950c193c66d802e6f3c7313d3">GetObjectBoundingRadius</a>(), dist);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(_target_x, _target_y, _target_z);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;            }</div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        }</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a>:</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            tempUnitList.push_back(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faab022171764c300280bec9c133e7dcd0">TARGET_UNIT_ENEMY_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa4f5212bbde3482ca71754fce4a234623">TARGET_UNIT_FRIEND_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9889609489e68c367a004d563122c18">TARGET_UNIT_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;        {</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> = 0;</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            <span class="keywordtype">float</span> max_range = radius + unMaxTargets * <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a>;</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160; </div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempTargetUnitMap;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160; </div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;            {</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faab022171764c300280bec9c133e7dcd0">TARGET_UNIT_ENEMY_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                {</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempTargetUnitMap, max_range, 0.f, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ae187cfead2e915ac383583ad0eaa6f50">SPELL_TARGETS_CHAIN_ATTACKABLE</a>);</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;                }</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9889609489e68c367a004d563122c18">TARGET_UNIT_NEAR_CASTER</a>: <span class="comment">// TODO: Rename TARGET_UNIT_NEAR_CASTER to something better and find real difference with TARGET_UNIT_FRIEND_NEAR_CASTER.</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                {</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempTargetUnitMap, max_range, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3">SPELL_TARGETS_ALL</a>);</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                }</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa4f5212bbde3482ca71754fce4a234623">TARGET_UNIT_FRIEND_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempTargetUnitMap, max_range, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069aaf1e1f6abc10d870a060042c81c9a8ea">SPELL_TARGETS_ASSISTABLE</a>);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;            <span class="keywordflow">if</span> (tempTargetUnitMap.empty())</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; </div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a> bounds = <a class="code" href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a>.<a class="code" href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">getBounds</a>&lt;<a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            <span class="keywordflow">if</span> (bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a> != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a>)</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                <a class="code" href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53">CheckSpellScriptTargets</a>(bounds, tempTargetUnitMap, tempUnitList, effIndex);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                tempUnitList.splice(tempUnitList.end(), tempTargetUnitMap);</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;        }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a>:</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;        {</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* tmpUnit = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                tempUnitList.push_back(tmpUnit);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* charm = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ab8ceebad76b0e65fa1f6c9031070a75c">GetCharm</a>())</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                tempUnitList.push_back(charm);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;        }</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa1c9e6d0a0c1c1f97e8425600d2d59074">TARGET_UNIT</a>:</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* newUnitTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;            <span class="keywordflow">if</span> (!newUnitTarget)</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160; </div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(newUnitTarget, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;            {</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad06c46067af46fe82c9ec46352ab7ca8">CheckAndAddMagnetTarget</a>(newUnitTarget, effIndex, targetB, targetingData))</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;            }</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160; </div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            tempUnitList.push_back(newUnitTarget);</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160; </div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            <span class="comment">// More than one target</span></div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;            <span class="keywordflow">if</span> (targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[effIndex] &gt; 1)</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;            {</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                <span class="comment">// Getting spell casting distance</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                <span class="keywordtype">float</span> minRadiusCaster = 0, maxRadiusTarget = 0;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                <a class="code" href="SpellMgr_8h.html#a08447d37cb40951326a87b9889fa237f">GetChainJumpRange</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, effIndex, minRadiusCaster, maxRadiusTarget);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160; </div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                <span class="comment">// Filling target map</span></div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;                <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempAoeList;</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;                {</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempAoeList, maxRadiusTarget, cone, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a36508afb28bad3c6dbfe30103a3ea46e">SPELL_ATTR_EX2_CHAIN_FROM_CASTER</a>) ? <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a> : <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeabb9c9e877dd5e758ed6738ea93caf4cd">PUSH_TARGET_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3">SPELL_TARGETS_ALL</a>);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                    tempAoeList.erase(std::remove(tempAoeList.begin(), tempAoeList.end(), newUnitTarget), tempAoeList.end());</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                tempUnitList.splice(tempUnitList.end(), tempAoeList);</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;            }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;        }</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf942ecb11955a03d4b522c3981b71689">TARGET_UNIT_ENEMY</a>:</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;        {</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* newUnitTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;            <span class="keywordflow">if</span> (!newUnitTarget)</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;            <span class="comment">// Check if target have Grounding Totem Aura(Magnet target). Check for physical school inside included.</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad06c46067af46fe82c9ec46352ab7ca8">CheckAndAddMagnetTarget</a>(newUnitTarget, effIndex, targetB, targetingData))</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;            tempUnitList.push_back(newUnitTarget);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;            <span class="comment">// More than one target</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            <span class="keywordflow">if</span> (targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[effIndex] &gt; 1)</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            {</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                <a class="code" href="classWorldObject.html">WorldObject</a>* originalCaster = <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">GetAffectiveCasterObject</a>();</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                <span class="keywordflow">if</span> (!originalCaster)</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160; </div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                {</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                    <a class="code" href="classPlayer.html">Player</a>* me = (<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;                    <a class="code" href="classPlayer.html">Player</a>* targetOwner = newUnitTarget-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>();</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                    <span class="keywordflow">if</span> (targetOwner &amp;&amp; targetOwner != me &amp;&amp; targetOwner-&gt;<a class="code" href="classUnit.html#a48fcb3d403534171f69d0be3b6003762">IsPvP</a>() &amp;&amp; !me-&gt;<a class="code" href="classPlayer.html#a535278fda7e3c98dcc5f1f28d1c0c6fe">IsInDuelWith</a>(targetOwner))</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                    {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                        me-&gt;<a class="code" href="classPlayer.html#a032cedc4c5b8ec826bfbd36c309da5a4">UpdatePvP</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                        me-&gt;<a class="code" href="classUnit.html#a1ba95f0ad9e204ab1c36f1608e62434b">RemoveAurasWithInterruptFlags</a>(<a class="code" href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011acbbf681ff137361f2832cbb1d424fb8c">AURA_INTERRUPT_FLAG_PVP_ACTIVE_CANCELS</a>);</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                    }</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                }</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160; </div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                <span class="comment">// Getting spell casting distance</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                <span class="keywordtype">float</span> minRadiusCaster = 0, maxRadiusTarget = 0;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;                <a class="code" href="SpellMgr_8h.html#a08447d37cb40951326a87b9889fa237f">GetChainJumpRange</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, effIndex, minRadiusCaster, maxRadiusTarget);</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                <span class="comment">// Filling target map</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;                <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempAoeList;</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                    <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5bee">SpellNotifyPushType</a> pushType = <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeabb9c9e877dd5e758ed6738ea93caf4cd">PUSH_TARGET_CENTER</a>;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a36508afb28bad3c6dbfe30103a3ea46e">SPELL_ATTR_EX2_CHAIN_FROM_CASTER</a>))</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                        pushType = <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a>;</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734af389b38f76fd80d64d0ea3b37a665c29">SPELL_ATTR_EX5_MELEE_CHAIN_TARGETING</a>))</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;                        pushType = <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea8b8284b655c0fc1cf036759c5b15ec91">PUSH_CONE</a>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempAoeList, maxRadiusTarget, cone, pushType, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ae187cfead2e915ac383583ad0eaa6f50">SPELL_TARGETS_CHAIN_ATTACKABLE</a>);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;                    tempAoeList.erase(std::remove(tempAoeList.begin(), tempAoeList.end(), newUnitTarget), tempAoeList.end());</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = tempAoeList.begin(); itr != tempAoeList.end();)</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                    {</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                        <span class="keywordflow">if</span> (!(*itr)-&gt;IsVisibleForOrDetect(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a15299304003f041f28de7a0fd992c735">m_originalCaster</a>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a1e4d63776ace92d6c631f8f9de87f2df">SPELL_ATTR_EX6_IGNORE_PHASE_SHIFT</a>)))</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                            itr = tempAoeList.erase(itr);</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                            ++itr;</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                    }</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;                }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160; </div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;                <span class="comment">// No targets. No need to process.</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;                <span class="keywordflow">if</span> (tempAoeList.empty())</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;                <span class="keywordflow">if</span> (minRadiusCaster)</div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;                {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;                    <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>(x, y, z);</div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;                    <span class="keyword">auto</span> itr = tempAoeList.begin();</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                    ++itr; <span class="comment">// start from 2nd</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;                    <span class="keywordflow">for</span> (; itr != tempAoeList.end();)</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;                    {</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;                        <span class="keywordflow">if</span> ((*itr)-&gt;GetDistance(x, y, z, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771a54404857d1ada8dc6fb419b57c69014c">DIST_CALC_COMBAT_REACH</a>) &lt; minRadiusCaster)</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;                            itr = tempAoeList.erase(itr);</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;                            ++itr;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;                    }</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                }</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                tempUnitList.splice(tempUnitList.end(), tempAoeList);</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;            }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;        }</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3293d63207f1eacff69d0e5c01f9102e">TARGET_ENUM_UNITS_ENEMY_AOE_AT_SRC_LOC</a>:</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeae489e922bd8a08171622196e027c7b9e">PUSH_SRC_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a>);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa93e38ce98bd2e26008dabeee153d70e7">TARGET_ENUM_UNITS_SCRIPT_AOE_AT_SRC_LOC</a>:</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;        {</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempTargetUnitMap;</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;            <a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a> bounds = <a class="code" href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a>.<a class="code" href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">getBounds</a>&lt;<a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160; </div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;            <span class="comment">// fill real target list if no spell script target defined</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a> != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a> ? tempTargetUnitMap : tempUnitList,</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeae489e922bd8a08171622196e027c7b9e">PUSH_SRC_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3">SPELL_TARGETS_ALL</a>);</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160; </div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            <span class="keywordflow">if</span> (!tempTargetUnitMap.empty())</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;                <a class="code" href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53">CheckSpellScriptTargets</a>(bounds, tempTargetUnitMap, tempUnitList, effIndex);</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;            {</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                <span class="keywordflow">case</span> 45339:</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;                {</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = tempUnitList.begin(); iter != tempUnitList.end();)</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                    {</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                        <span class="keywordflow">if</span> ((*iter)-&gt;HasCharmer(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()))</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                            iter = tempUnitList.erase(iter);</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                            ++iter;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                    }</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                }</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;            }</div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160; </div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        }</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa976b3231fb7f86856ce42df5b0c5d11a">TARGET_ENUM_UNITS_SCRIPT_AOE_AT_DEST_LOC</a>:</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        {</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;            <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempTargetUnitMap;</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;            <a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a> bounds = <a class="code" href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a>.<a class="code" href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">getBounds</a>&lt;<a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;            <span class="comment">// fill real target list if no spell script target defined</span></div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a> != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a> ? tempTargetUnitMap : tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82">PUSH_DEST_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3">SPELL_TARGETS_ALL</a>);</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160; </div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;            <span class="keywordflow">if</span> (!tempTargetUnitMap.empty())</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                <a class="code" href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53">CheckSpellScriptTargets</a>(bounds, tempTargetUnitMap, tempUnitList, effIndex);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160; </div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;        }</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9cf5a201243f1d419decd3fdad93380">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_SRC_LOC</a>:</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa7d217ba9f3a4619509d16df0845c494">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_DEST_LOC</a>:</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa626095e279ff1c2a3bef55233a562e04">TARGET_ENUM_GAMEOBJECTS_IN_CONE</a>:</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        {</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;            <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160; </div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;            <span class="keywordflow">if</span> (targetMode == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9cf5a201243f1d419decd3fdad93380">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_SRC_LOC</a> &amp;&amp; (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>))</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a31496bc8861793d11f83b216c94a81e8">getSource</a>(x, y, z);</div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (targetMode == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa7d217ba9f3a4619509d16df0845c494">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_DEST_LOC</a>)</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">getDestination</a>(x, y, z);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            <span class="keywordflow">else</span>                                            <span class="comment">// can also happen for GO_AROUND_SOURCE without SOURCE_LOCATION</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>(x, y, z);</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160; </div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;            std::set&lt;uint32&gt; entriesToUse;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;            <a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a> bounds = <a class="code" href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a>.<a class="code" href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">getBounds</a>&lt;<a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classSQLMultiStorage_1_1SQLMultiSIterator.html">SQLMultiStorage::SQLMultiSIterator&lt;SpellTargetEntry&gt;</a> i_spellST = bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a>; i_spellST != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a>; ++i_spellST)</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;            {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                <span class="keywordflow">if</span> (i_spellST-&gt;CanNotHitWithSpellEffect(effIndex))</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160; </div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;                <span class="keywordflow">if</span> (i_spellST-&gt;type == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ae7ce658fcd9ebcff46e1c1228325f7dd">SPELL_TARGET_TYPE_GAMEOBJECT</a>)</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;                    entriesToUse.insert(i_spellST-&gt;targetEntry);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;            }</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;            <span class="keywordflow">if</span> (!entriesToUse.empty())</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;            {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;                <a class="code" href="classMaNGOS_1_1AllGameObjectEntriesListInPosRangeCheck.html">MaNGOS::AllGameObjectEntriesListInPosRangeCheck</a> go_check(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, x, y, z, entriesToUse, radius);</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                <a class="code" href="structMaNGOS_1_1GameObjectListSearcher.html">MaNGOS::GameObjectListSearcher&lt;MaNGOS::AllGameObjectEntriesListInPosRangeCheck&gt;</a> checker(tempGOList, go_check);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, checker, radius);</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;            }</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;            {</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;                <span class="comment">// Generic handling for spells that require GO-type 33</span></div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a5200f96531d02c2c5665e418f588a489">SPELL_EFFECT_WMO_DAMAGE</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a35549e2c13c9b3d489d961b8dbf014fe">SPELL_EFFECT_WMO_REPAIR</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abc9a693ab6bbdd32a329d73f299ff125">SPELL_EFFECT_WMO_CHANGE</a>)</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                {</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                    <a class="code" href="classMaNGOS_1_1GameObjectTypeInPosRangeCheck.html">MaNGOS::GameObjectTypeInPosRangeCheck</a> go_check(*<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="SharedDefines_8h.html#a0233096c29a8a39f15373e06434985f9afd1b3271e7a9e6205d5f1dab1d34610f">GAMEOBJECT_TYPE_DESTRUCTIBLE_BUILDING</a>, x, y, z, radius, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a5200f96531d02c2c5665e418f588a489">SPELL_EFFECT_WMO_DAMAGE</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[effIndex] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a35549e2c13c9b3d489d961b8dbf014fe">SPELL_EFFECT_WMO_REPAIR</a>);</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                    <a class="code" href="structMaNGOS_1_1GameObjectListSearcher.html">MaNGOS::GameObjectListSearcher&lt;MaNGOS::GameObjectTypeInPosRangeCheck&gt;</a> checker(tempGOList, go_check);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                    <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, checker, radius + <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(<a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>)));</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                }</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;            }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160; </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;            <span class="comment">// Filter some targets for special target-type</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;            <span class="keywordflow">for</span> (GameObjectList::iterator itr = tempGOList.begin(); itr != tempGOList.end();)</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;            {</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;                <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                {</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa626095e279ff1c2a3bef55233a562e04">TARGET_ENUM_GAMEOBJECTS_IN_CONE</a>:</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae0338558ec4649199ff37b6ae422e0b2">HasInArc</a>(*itr, <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 2))</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                        {</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;                            itr = tempGOList.erase(itr);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;                        }</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                    <span class="comment">// no break here</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9cf5a201243f1d419decd3fdad93380">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_SRC_LOC</a>:</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa7d217ba9f3a4619509d16df0845c494">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_DEST_LOC</a>:</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                        ++itr;</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                }</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            }</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        }</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab6dc6f1ac5022265ef1c62c76c27f173">TARGET_ENUM_UNITS_ENEMY_AOE_AT_DEST_LOC</a>:</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        {</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;            <span class="comment">// targets the ground, not the units in the area</span></div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82">PUSH_DEST_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a>);</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        }</div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3e71172e3097833ab57cfa71a1948e01">TARGET_ENUM_UNITS_PARTY_WITHIN_CASTER_RANGE</a>:</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad858d28d86ff46a5486f44c22633afd1">TARGET_ENUM_UNITS_PARTY_AOE_AT_DEST_LOC</a>:</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabb9be74f0eb3b8751c3c43180c5419fa">TARGET_ENUM_UNITS_PARTY_AOE_AT_SRC_LOC</a>:</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        {</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;            <a class="code" href="classSpell.html#a321d6f8758262f8e47955c53a6f55329">FillRaidOrPartyTargets</a>(tempUnitList, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, radius, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        }</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa849ce98133e98ace927a223200cc9921">TARGET_ENUM_UNITS_RAID_WITHIN_CASTER_RANGE</a>:</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;            <a class="code" href="classSpell.html#a321d6f8758262f8e47955c53a6f55329">FillRaidOrPartyTargets</a>(tempUnitList, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, radius, <span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code" href="SpellMgr_8h.html#aa48055df917f805e2ef4b8e56f78cc93">IsPositiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>));</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;        }</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa293afadabc29273eadc698cf4b8d81a">TARGET_UNIT_FRIEND</a>:</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae1dbf35279c8e9d2da10764df673261e">TARGET_UNIT_RAID</a>:</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;        {</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;            {</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; (targetMode != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae1dbf35279c8e9d2da10764df673261e">TARGET_UNIT_RAID</a> || target-&gt;IsInGroup(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)))</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                    tempUnitList.push_back(target);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                {</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734afa23757176cfe70e555bd7737a7f03c2">SPELL_ATTR_EX5_IMPLIED_TARGETING</a>))</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                    {</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* targetOfUnitTarget = target-&gt;<a class="code" href="classUnit.html#afc3c9a652f2026707440d4e8bdd87930">GetTarget</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;                        {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(targetOfUnitTarget, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; (targetMode != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae1dbf35279c8e9d2da10764df673261e">TARGET_UNIT_RAID</a> || targetOfUnitTarget-&gt;IsInGroup(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)))</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;                                tempUnitList.push_back(targetOfUnitTarget);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;                        }</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;                    }</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;                }</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;            }</div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        }</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa869a42510d816979e688662fbb633ea8">TARGET_UNIT_CASTER_COMPANION</a>:</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;                <span class="keywordflow">if</span> (target-&gt;GetTypeId() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> &amp;&amp; ((<a class="code" href="classCreature.html">Creature</a>*)target)-&gt;IsPet() &amp;&amp; ((<a class="code" href="classPet.html">Pet</a>*)target)-&gt;getPetType() == <a class="code" href="Pet_8h.html#aae4a343750f70898b0f6490e7db6a471ae855adcbda374b2c654ae4e9a9bf2ce1">MINI_PET</a>)</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;                    tempUnitList.push_back(target);</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa928c214f7931bfcfd48ced9324112018">TARGET_UNIT_CASTER_SUMMONER</a>:</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        {</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;            <a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">GetAffectiveCasterObject</a>();</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;            <span class="keywordflow">if</span> (!caster)</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;            <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> &amp;&amp; ((<a class="code" href="classCreature.html">Creature</a>*)caster)-&gt;IsTemporarySummon())</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;                tempUnitList.push_back(((<a class="code" href="classCreature.html">Creature</a>*)caster)-&gt;GetSpawner());</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a91b74ac7ebfe7909332a6eec5054c60d">TYPEID_GAMEOBJECT</a> &amp;&amp; !((<a class="code" href="classGameObject.html">GameObject</a>*)caster)-&gt;HasStaticDBSpawnData())</div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;                tempUnitList.push_back(((<a class="code" href="classGameObject.html">GameObject</a>*)caster)-&gt;GetOwner());</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;SPELL: Spell ID %u with target ID %u was used by non temporary summon object %s.&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, targetMode, caster-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str());</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        }</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0f919e108bdd31c96eaf3ae22e8afc81">TARGET_UNIT_CASTER_VEHICLE</a>:</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae8a0288e2dc30f6a70802970784f8f27">IsBoarded</a>() &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a88b1b9802b42096a12aad50157cf7031">IsOnVehicle</a>())</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;                tempUnitList.push_back(<span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a314642719fc92ee528c2abb228b3a105">GetTransport</a>()));</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8e1ef902fbc13497db3f304f7333e3a9">TARGET_UNIT_CASTER_DRIVER</a>:</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a0414b693087d7f3acc4a13eadb619660">IsVehicle</a>())</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* vehicleDriver = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ab7aa55eb03cc7e7d93894ccaf4e6f250">GetCharmer</a>())</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;                    tempUnitList.push_back(vehicleDriver);</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa9cc352b03a763e4700d42b4a0679da4">TARGET_UNIT_CASTER_PASSENGER_0</a>:</div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac00ea1262694e1b6dd1508248ce627d9">TARGET_UNIT_CASTER_PASSENGER_1</a>:</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa92e3c1771e12ca7d6ade02a2bfb68aac">TARGET_UNIT_CASTER_PASSENGER_2</a>:</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac6f4933c07d252653eb4e176093ab243">TARGET_UNIT_CASTER_PASSENGER_3</a>:</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa803ca1e0762a0164a4878ca4b6ee2574">TARGET_UNIT_CASTER_PASSENGER_4</a>:</div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa540ed708172827ecd79c9c90353a2814">TARGET_UNIT_CASTER_PASSENGER_5</a>:</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8a0acf77fa924aaf8246959c0e9d9056">TARGET_UNIT_CASTER_PASSENGER_6</a>:</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabd53e14fd8c6ef0e080679a91baf5177">TARGET_UNIT_CASTER_PASSENGER_7</a>:</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a0414b693087d7f3acc4a13eadb619660">IsVehicle</a>())</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* passenger = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a7329a53873078dc2ba6fd815f88e90b0">GetVehicleInfo</a>()-&gt;<a class="code" href="group__TransportSystem.html#ga2b0a1367e29e0733cd068edff0c2f0eb">GetPassenger</a>(targetMode - <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa9cc352b03a763e4700d42b4a0679da4">TARGET_UNIT_CASTER_PASSENGER_0</a>))</div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;                    tempUnitList.push_back(passenger);</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadf337d96d4533d435edc95a03b033035">TARGET_LOCATION_CASTER_SRC</a>:</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;        {</div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;            <span class="comment">// Check original caster is GO - set its coordinates as src cast</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>())</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#afa341e13427e2d645c72fb04c55b7922">setSource</a>(caster-&gt;GetPositionX(), caster-&gt;GetPositionY(), caster-&gt;GetPositionZ());</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;        }</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa2285d4c0c11aba1a9ef7624dd73f3154">TARGET_ENUM_UNITS_ENEMY_WITHIN_CASTER_RANGE</a>:</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a>);</div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa1052b305d8ac2bcc0f1615688d85ad87">TARGET_ENUM_UNITS_FRIEND_AOE_AT_SRC_LOC</a>:</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;            <span class="comment">// selected friendly units (for casting objects) around casting object</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069aaf1e1f6abc10d870a060042c81c9a8ea">SPELL_TARGETS_ASSISTABLE</a>, <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>());</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadf47750aa58fa5026d9afefdd3140b64">TARGET_ENUM_UNITS_FRIEND_AOE_AT_DEST_LOC</a>:</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;            <span class="comment">// Death Pact (in fact selection by player selection)</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 48743)</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;            {</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;                <span class="comment">// checked in Spell::CheckCast</span></div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a7c6017ca4c2a442952e50597d6ce0be5">GetPet</a>(((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetSelectionGuid()))</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;                        tempUnitList.push_back(target);</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;            }</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;                <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82">PUSH_DEST_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069aaf1e1f6abc10d870a060042c81c9a8ea">SPELL_TARGETS_ASSISTABLE</a>);</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        <span class="comment">// TARGET_UNIT_PARTY means that the spells can only be casted on a party member and not on the caster (some seals, fire shield from imp, etc..)</span></div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3888b9db5eaa2d6c9c5001a61fed215a">TARGET_UNIT_PARTY</a>:</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        {</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;            <span class="comment">// Those spells apparently can&#39;t be casted on the caster.</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;            <span class="keywordflow">if</span> (target &amp;&amp; target != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;            {</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                <span class="comment">// Can only be casted on group&#39;s members or its pets</span></div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                <a class="code" href="classGroup.html">Group</a>*  pGroup = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160; </div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* owner = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a32d1bc7bcf268626c01fece7409da915">GetMaster</a>();</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* targetOwner = target-&gt;<a class="code" href="classUnit.html#a32d1bc7bcf268626c01fece7409da915">GetMaster</a>();</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                <span class="keywordflow">if</span> (owner)</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;                {</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;                    <span class="keywordflow">if</span> (owner-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;                    {</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;                        <span class="keywordflow">if</span> (target == owner)</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;                        {</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                            tempUnitList.push_back(target);</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                        }</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                        pGroup = ((<a class="code" href="classPlayer.html">Player</a>*)owner)-&gt;GetGroup();</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                    }</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                }</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                {</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                    <span class="keywordflow">if</span> (targetOwner == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> &amp;&amp; ((<a class="code" href="classCreature.html">Creature</a>*)target)-&gt;IsPet())</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                    {</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                        tempUnitList.push_back(target);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                    }</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                    pGroup = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetGroup();</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                }</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                <span class="keywordflow">if</span> (pGroup)</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                    <span class="comment">// Our target can also be a player&#39;s pet who&#39;s grouped with us or our pet. But can&#39;t be controlled player</span></div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;                    <span class="keywordflow">if</span> (targetOwner)</div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;                    {</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                        <span class="keywordflow">if</span> (targetOwner-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp;</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                                target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> &amp;&amp; (((<a class="code" href="classCreature.html">Creature</a>*)target)-&gt;IsPet()) &amp;&amp;</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                                target-&gt;GetOwnerGuid() == targetOwner-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() &amp;&amp;</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                                pGroup-&gt;<a class="code" href="classGroup.html#ab58ef93f327bc8a3e328ee48231aa331">IsMember</a>(((<a class="code" href="classPlayer.html">Player</a>*)targetOwner)-&gt;GetObjectGuid()))</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                        {</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;                            tempUnitList.push_back(target);</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;                        }</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;                    }</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;                    <span class="comment">// 1Our target can be a player who is on our group</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; pGroup-&gt;<a class="code" href="classGroup.html#ab58ef93f327bc8a3e328ee48231aa331">IsMember</a>(((<a class="code" href="classPlayer.html">Player</a>*)target)-&gt;GetObjectGuid()))</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;                    {</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;                        tempUnitList.push_back(target);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;                    }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;                }</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;            }</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;        }</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa330b81de27a4a8f562ae8f60de81d8bf">TARGET_GAMEOBJECT</a>:</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">getGOTarget</a>())</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                tempGOList.push_back(go);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa243315a1a971c411ef893f4a10e89ab8">TARGET_ENUM_UNITS_ENEMY_IN_CONE_24</a>:</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa54b69935ff7431bbb3c212446751e74c">TARGET_ENUM_UNITS_ENEMY_IN_CONE_54</a>:</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa68f754204abfef163e7033e55f110969">TARGET_ENUM_UNITS_FRIEND_IN_CONE</a>:</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf017755d35fc98dfff49309dc15909a6">TARGET_ENUM_UNITS_SCRIPT_IN_CONE_60</a>:</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab44f3e93e122acf78161b2342b778085">TARGET_ENUM_UNITS_ENEMY_IN_CONE_104</a>:</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0b2da5fbf74e11ae1df757694013207b">TARGET_ENUM_UNITS_SCRIPT_IN_CONE_110</a>:</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;            <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069">SpellTargets</a> targetType = <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3">SPELL_TARGETS_ALL</a>;</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;            <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;            {</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab44f3e93e122acf78161b2342b778085">TARGET_ENUM_UNITS_ENEMY_IN_CONE_104</a>:</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa243315a1a971c411ef893f4a10e89ab8">TARGET_ENUM_UNITS_ENEMY_IN_CONE_24</a>:</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa54b69935ff7431bbb3c212446751e74c">TARGET_ENUM_UNITS_ENEMY_IN_CONE_54</a>: targetType = <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa68f754204abfef163e7033e55f110969">TARGET_ENUM_UNITS_FRIEND_IN_CONE</a>: targetType = <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069aaf1e1f6abc10d870a060042c81c9a8ea">SPELL_TARGETS_ASSISTABLE</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            }</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;            <span class="keywordflow">switch</span> (targetMode)</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;            {</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf017755d35fc98dfff49309dc15909a6">TARGET_ENUM_UNITS_SCRIPT_IN_CONE_60</a>:</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0b2da5fbf74e11ae1df757694013207b">TARGET_ENUM_UNITS_SCRIPT_IN_CONE_110</a>:</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                {</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                    <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempTargetUnitMap;</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                    <a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a> bounds = <a class="code" href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a>.<a class="code" href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">getBounds</a>&lt;<a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                    <span class="comment">// fill real target list if no spell script target defined</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a> != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a> ? tempTargetUnitMap : tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea8b8284b655c0fc1cf036759c5b15ec91">PUSH_CONE</a>, targetType);</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                    <span class="keywordflow">if</span> (!tempTargetUnitMap.empty())</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                        <a class="code" href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53">CheckSpellScriptTargets</a>(bounds, tempTargetUnitMap, tempUnitList, effIndex);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                }</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea8b8284b655c0fc1cf036759c5b15ec91">PUSH_CONE</a>, targetType);</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;            }</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        }</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa847b95c95f887aed227e248da6ea7ef1">TARGET_LOCKED</a>:</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">getGOTarget</a>())</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                tempGOList.push_back(go);</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* item = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;                data.<a class="code" href="structSpell_1_1TempTargetData.html#a97f400e188a5ec71230e0240da3452ef">tempItemList</a>.push_back(item);</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0677dd3c8e41efb02de421bcb418e8eb">TARGET_UNIT_CASTER_MASTER</a>:</div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* owner = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a32d1bc7bcf268626c01fece7409da915">GetMaster</a>())</div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;                tempUnitList.push_back(owner);</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa845d637ab032718a6bb70208004c5f77">TARGET_ENUM_UNITS_ENEMY_AOE_AT_DYNOBJ_LOC</a>:</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <span class="comment">// targets the ground, not the units in the area</span></div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;            <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(tempUnitList, radius, cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82">PUSH_DEST_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a>);</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa7463ec8df96cd907f1ee4f4c1d26eec2">TARGET_UNIT_CHANNEL_TARGET</a>:</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;        {</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>()))</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#ad06c46067af46fe82c9ec46352ab7ca8">CheckAndAddMagnetTarget</a>(target, effIndex, targetB, targetingData))</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                    tempUnitList.push_back(target);</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;        }</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa35743402a8e82ed7a0dbf9dc40e765e8">TARGET_UNIT_FRIEND_AND_PARTY</a>:</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;        {</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;            <span class="keywordflow">if</span> (!target || !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            tempUnitList.push_back(target);</div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160; </div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;            <a class="code" href="classPlayer.html">Player</a>* pTarget = <span class="keyword">const_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target-&gt;<a class="code" href="classUnit.html#a6535c9c8175652b8497b1615147636ac">GetControllingPlayer</a>());</div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;            <span class="keywordflow">if</span> (!pTarget)</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160; </div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;            <span class="keywordflow">if</span> (pTarget != target)</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                tempUnitList.push_back(pTarget);</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160; </div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;            <a class="code" href="classGroup.html">Group</a>* pGroup = pTarget-&gt;<a class="code" href="classPlayer.html#a3acf7eadb0ec1ae686858ea11ee87302">GetGroup</a>();</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160; </div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;            <span class="keywordflow">if</span> (pGroup)</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;            {</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> subgroup = pTarget-&gt;<a class="code" href="classPlayer.html#ad2debe6316c3b6ebab131713336f3284">GetSubGroup</a>();</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160; </div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="classGroupReference.html">GroupReference</a>* itr = pGroup-&gt;<a class="code" href="classGroup.html#a39cc0707e5c157b6ff4851e133b0a9dc">GetFirstMember</a>(); itr != <span class="keyword">nullptr</span>; itr = itr-&gt;<a class="code" href="classGroupReference.html#a05b946c0952db094a696093283308cb1">next</a>())</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;                {</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                    <a class="code" href="classPlayer.html">Player</a>* groupTarget = itr-&gt;getSource();</div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160; </div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                    <span class="keywordflow">if</span> (groupTarget == target || groupTarget == pTarget)</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160; </div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                    <span class="comment">// CanAssist check duel and controlled by enemy</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                    <span class="keywordflow">if</span> (groupTarget &amp;&amp; groupTarget-&gt;<a class="code" href="classPlayer.html#ad2debe6316c3b6ebab131713336f3284">GetSubGroup</a>() == subgroup &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(groupTarget, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                    {</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                        <span class="keywordflow">if</span> (pTarget-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(groupTarget, radius))</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;                            tempUnitList.push_back(groupTarget);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = groupTarget-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                            <span class="keywordflow">if</span> (pTarget-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(pet, radius))</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;                                tempUnitList.push_back(pet);</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;                    }</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;                }</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;            }</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pTarget)</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;            {</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = pTarget-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(pet, radius))</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;                        tempUnitList.push_back(pet);</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;            }</div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;        }</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadda43b90ff97d6de36f0753dfe22253e">TARGET_UNIT_FRIEND_CHAIN_HEAL</a>:</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        {</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>)</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160; </div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160; </div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;            tempUnitList.push_back(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160; </div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;            <span class="keywordflow">if</span> (targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[effIndex] &gt; 1)</div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;            {</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;                <span class="keywordtype">float</span> max_range = targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[effIndex] * <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a>;</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;                <a class="code" href="classGroup.html">Group</a>* group = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160; </div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;                <span class="comment">//if target and caster are members in the same group then apply member only filtering</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;                <span class="comment">//in regards to mc by player concerns the mc&#39;ed player has simple toolbar thus chain heal not available</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;                <span class="comment">//TODO: in regards to mc by npc concerns this is something that needs to be answered</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;                {</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classGroup.html">Group</a>* casterGroup = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;<a class="code" href="classPlayer.html#a3acf7eadb0ec1ae686858ea11ee87302">GetGroup</a>())</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;                    {</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;                        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>())</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;                        {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>:</div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;                            {</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;                                <span class="keywordflow">if</span> (casterGroup == <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>)-&gt;<a class="code" href="classPlayer.html#a3acf7eadb0ec1ae686858ea11ee87302">GetGroup</a>())</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;                                    group = casterGroup;</div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160; </div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;                            }</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>:</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                            {</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                                <a class="code" href="classCreature.html">Creature</a>* creature = <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160; </div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* owner = creature-&gt;<a class="code" href="classUnit.html#ac5deedcb47695a681523e416b8456848">GetOwner</a>(<span class="keyword">nullptr</span>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                                {</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                                    <span class="keywordflow">if</span> (owner-&gt;GetTypeId() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; casterGroup == <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(owner)-&gt;GetGroup())</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;                                    {</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;                                        group = casterGroup;</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                                    }</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                                }</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160; </div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                            }</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                        }</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160; </div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;                    }</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;                }</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160; </div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;                <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> tempAoeList;</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;                <a class="code" href="classMaNGOS_1_1AnyFriendlyOrGroupMemberUnitInUnitRangeCheck.html">MaNGOS::AnyFriendlyOrGroupMemberUnitInUnitRangeCheck</a> u_check(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, group, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, max_range);</div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;                <a class="code" href="structMaNGOS_1_1UnitListSearcher.html">MaNGOS::UnitListSearcher&lt;MaNGOS::AnyFriendlyOrGroupMemberUnitInUnitRangeCheck&gt;</a> searcher(tempAoeList, u_check);</div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;                <a class="code" href="structCell.html#a07c1300d6a1d8ee38819103043b89b8f">Cell::VisitAllObjects</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, searcher, max_range);</div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;                tempAoeList.erase(std::remove(tempAoeList.begin(), tempAoeList.end(), <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>), tempAoeList.end());</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;                <span class="keywordflow">if</span> (!tempAoeList.empty())</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;                    tempUnitList.splice(tempUnitList.end(), tempAoeList);</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;            }</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;        }</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa14db836506dc1ea18ce822a31226b09">TARGET_UNIT_RAID_AND_CLASS</a>:</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;        {</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;            <a class="code" href="classPlayer.html">Player</a>* targetPlayer = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a></div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;                                   ? (<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160; </div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;            <a class="code" href="classGroup.html">Group</a>* pGroup = targetPlayer ? targetPlayer-&gt;<a class="code" href="classPlayer.html#a3acf7eadb0ec1ae686858ea11ee87302">GetGroup</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;            <span class="keywordflow">if</span> (pGroup)</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;            {</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;                <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;                targetPlayer-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>(x, y, z);</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="classGroupReference.html">GroupReference</a>* itr = pGroup-&gt;<a class="code" href="classGroup.html#a39cc0707e5c157b6ff4851e133b0a9dc">GetFirstMember</a>(); itr != <span class="keyword">nullptr</span>; itr = itr-&gt;<a class="code" href="classGroupReference.html#a05b946c0952db094a696093283308cb1">next</a>())</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                {</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;                    <a class="code" href="classPlayer.html">Player</a>* target = itr-&gt;getSource();</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160; </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;                    <span class="comment">// CanAssist check duel and controlled by enemy</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;                    <span class="keywordflow">if</span> (target)</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;                    {</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;                        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(x, y, z, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771a54404857d1ada8dc6fb419b57c69014c">DIST_CALC_COMBAT_REACH</a>) &lt;= radius &amp;&amp;</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;                            targetPlayer-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() == target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() &amp;&amp;</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;                            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;                        {</div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;                            tempUnitList.push_back(target);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;                        }</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = target-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;                        {</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;                            <span class="keywordflow">if</span> (pet-&gt;GetDistance(x, y, z, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771a54404857d1ada8dc6fb419b57c69014c">DIST_CALC_COMBAT_REACH</a>) &lt;= radius &amp;&amp;</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;                                targetPlayer-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() == pet-&gt;getClass() &amp;&amp;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;                                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(pet, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;                                tempUnitList.push_back(pet);</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;                        }</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;                    }</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;                }</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;            }</div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;                tempUnitList.push_back(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>());</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        }</div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa43d815f21348faf787193e3f132b4abc">TARGET_CORPSE_ENEMY_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        {</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            <a class="code" href="classWorldObject.html">WorldObject</a>* result = FindCorpseUsing&lt;MaNGOS::TauntFlagObjectCheck&gt;();</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            <span class="keywordflow">if</span> (result)</div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            {</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;                <span class="keywordflow">switch</span> (result-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>())</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                {</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>:</div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>:</div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;                        tempUnitList.push_back(<span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(result));</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2ab20e64ae3f5f5a5ecffa53fee57d7d2f">TYPEID_CORPSE</a>:</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* owner = <a class="code" href="classObjectAccessor.html#a959bcb90b71aacbb8560642c86c3ab63">ObjectAccessor::FindPlayer</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="classCorpse.html">Corpse</a>*<span class="keyword">&gt;</span>(result)-&gt;GetOwnerGuid()))</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;                            tempUnitList.push_back(owner);</div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                }</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;            }</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;        }</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf70a4efa83b11389d844309475184e3e">TARGET_UNIT_SCRIPT_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faedcd06b127e6929ec44b33d36e639b9b">TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a>:</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        {</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;            <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classSpell.html#ab86f89e84f40ab4d68ec2226be0656f3">CheckScriptTargeting</a>(effIndex, targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">chainTargetCount</a>[effIndex], radius, targetMode, tempUnitList, tempGOList);</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;            <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;            {</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(result);</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;            }</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;        }</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;            <span class="comment">// sLog.outError( &quot;SPELL: Unknown implicit target (%u) for spell ID %u&quot;, targetMode, m_spellInfo-&gt;Id );</span></div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    }</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160; </div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="comment">// remove caster from the list if required by attribute</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ac4ec9bdb1506ec6034067363b1a0cea4">SPELL_ATTR_EX_EXCLUDE_CASTER</a>))</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;        <span class="keywordflow">if</span> (targetMode != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a>)</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;            tempUnitList.remove(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;}</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160; </div>
<div class="line"><a name="l03007"></a><span class="lineno"><a class="line" href="classSpell.html#ab86f89e84f40ab4d68ec2226be0656f3"> 3007</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#ab86f89e84f40ab4d68ec2226be0656f3">Spell::CheckScriptTargeting</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> chainTargets, <span class="keywordtype">float</span> radius, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetMode, <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; tempUnitList, <a class="code" href="EntitiesMgr_8h.html#a9a6023581a510c75fe601cd9d7412f15">GameObjectList</a>&amp; tempGOList)</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;{</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;    <a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a> bounds = <a class="code" href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a>.<a class="code" href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">getBounds</a>&lt;<a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160; </div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    <span class="keywordflow">if</span> (bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a> == bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a>)</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    {</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[effIndex] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf70a4efa83b11389d844309475184e3e">TARGET_UNIT_SCRIPT_NEAR_CASTER</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[effIndex] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf70a4efa83b11389d844309475184e3e">TARGET_UNIT_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Spell entry %u, effect %i has EffectImplicitTargetA/EffectImplicitTargetB = TARGET_UNIT_SCRIPT_NEAR_CASTER, but creature are not defined in `spell_script_target`&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, effIndex);</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160; </div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[effIndex] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[effIndex] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Spell entry %u, effect %i has EffectImplicitTargetA/EffectImplicitTargetB = TARGET_LOCATION_SCRIPT_NEAR_CASTER, but gameobject or creature are not defined in `spell_script_target`&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, effIndex);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160; </div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[effIndex] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faedcd06b127e6929ec44b33d36e639b9b">TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[effIndex] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faedcd06b127e6929ec44b33d36e639b9b">TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outErrorDb(<span class="stringliteral">&quot;Spell entry %u, effect %i has EffectImplicitTargetA/EffectImplicitTargetB = TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER, but gameobject are not defined in `spell_script_target`&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, effIndex);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160; </div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;    }</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160; </div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <a class="code" href="EntitiesMgr_8h.html#a2004a3d83184c385811859562ee39089">CreatureList</a> foundScriptCreatureTargets;</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <a class="code" href="EntitiesMgr_8h.html#a9a6023581a510c75fe601cd9d7412f15">GameObjectList</a> foundScriptGOTargets;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    std::set&lt;uint32&gt; entriesToUse;</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> type = <a class="code" href="SpellMgr_8h.html#aac877d83d1d2b22d02c52c695a5c6402">MAX_SPELL_TARGET_TYPE</a>;</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordtype">bool</span> foundButOutOfRange = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    <span class="comment">// corrections for numerous spells missing it</span></div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetCount = std::max(chainTargets, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(1));</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160; </div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classSQLMultiStorage_1_1SQLMultiSIterator.html">SQLMultiStorage::SQLMultiSIterator&lt;SpellTargetEntry&gt;</a> i_spellST = bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a>; i_spellST != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a>; ++i_spellST)</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    {</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;        <span class="keywordflow">if</span> (i_spellST-&gt;CanNotHitWithSpellEffect(effIndex))</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160; </div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        type = i_spellST-&gt;type;</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;        <span class="keywordflow">switch</span> (i_spellST-&gt;type)</div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;        {</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ae7ce658fcd9ebcff46e1c1228325f7dd">SPELL_TARGET_TYPE_GAMEOBJECT</a>:</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a0b85aa6e0df9762ad1548fd70ac84962">SPELL_TARGET_TYPE_CREATURE</a>:</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d">SPELL_TARGET_TYPE_DEAD</a>:</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a>:</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b">SPELL_TARGET_TYPE_GAMEOBJECT_GUID</a>:</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;                entriesToUse.insert(i_spellST-&gt;targetEntry);</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;        }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    }</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <span class="keywordflow">if</span> (radius == 50000.f)</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    {</div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;        <span class="keywordflow">if</span> (type != <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a> &amp;&amp; type != <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b">SPELL_TARGET_TYPE_GAMEOBJECT_GUID</a>)</div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;            radius = 200.f;</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;    }</div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radius == 0.f)</div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;        radius = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0c80d50b012dc8d560e256201970f3b3">IsDungeon</a>() ? <a class="code" href="ObjectDefines_8h.html#ae3422c6c7104690fcfcf1158c4c8abef">DEFAULT_VISIBILITY_INSTANCE</a> : <a class="code" href="ObjectDefines_8h.html#a3b8ab5f5010c80810475c2054abc0cde">DEFAULT_VISIBILITY_DISTANCE</a>;</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; </div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">GetAffectiveCasterObject</a>();</div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; </div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;    <span class="keywordflow">switch</span> (type) <span class="comment">// TODO: Unify logic with all other spell_script_target uses</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;    {</div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ae7ce658fcd9ebcff46e1c1228325f7dd">SPELL_TARGET_TYPE_GAMEOBJECT</a>:</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b">SPELL_TARGET_TYPE_GAMEOBJECT_GUID</a>:</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;        {</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;            <span class="keywordflow">if</span> (type == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b">SPELL_TARGET_TYPE_GAMEOBJECT_GUID</a>)</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;            {</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> guid : entriesToUse)</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(guid))</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                        <span class="keywordflow">if</span> (go-&gt;IsWithinDist(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, radius))</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                            foundScriptGOTargets.push_back(go);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;            }</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            {</div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;                <a class="code" href="classMaNGOS_1_1AllGameObjectEntriesListInObjectRangeCheck.html">MaNGOS::AllGameObjectEntriesListInObjectRangeCheck</a> go_check(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, entriesToUse, radius);</div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;                <a class="code" href="structMaNGOS_1_1GameObjectListSearcher.html">MaNGOS::GameObjectListSearcher&lt;MaNGOS::AllGameObjectEntriesListInObjectRangeCheck&gt;</a> checker(foundScriptGOTargets, go_check);</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;                <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, checker, radius);</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;            }</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160; </div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;        }</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a0b85aa6e0df9762ad1548fd70ac84962">SPELL_TARGET_TYPE_CREATURE</a>:</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d">SPELL_TARGET_TYPE_DEAD</a>:</div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a>:</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;        {</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;            {</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;                <span class="keywordflow">if</span> (target-&gt;GetTypeId() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> &amp;&amp; entriesToUse.find(type == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a> ? target-&gt;GetDbGuid() : target-&gt;GetEntry()) != entriesToUse.end())</div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;                {</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;                    <span class="keywordflow">if</span> ((type == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a0b85aa6e0df9762ad1548fd70ac84962">SPELL_TARGET_TYPE_CREATURE</a> &amp;&amp; target-&gt;IsAlive()) ||</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;                        (type == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d">SPELL_TARGET_TYPE_DEAD</a> &amp;&amp; ((<a class="code" href="classCreature.html">Creature</a>*)target)-&gt;IsCorpse()))</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;                    {</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;                        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(caster, radius) &amp;&amp; <a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">OnCheckTarget</a>(target, effIndex))</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;                            foundScriptCreatureTargets.push_back((<a class="code" href="classCreature.html">Creature</a>*)target);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;                            foundButOutOfRange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;                    }</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;                }</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;            }</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;            <span class="keywordflow">if</span> (foundScriptCreatureTargets.size() &lt; targetCount)</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;            {</div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;                <span class="keywordflow">if</span> (radius == 50000.f) <span class="comment">// only guid scripting</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;                {</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;                    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> guid : entriesToUse)</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classCreature.html">Creature</a>* creature = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ae312641f498f3df725b4156156b7f012">GetCreature</a>(guid))</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;                            foundScriptCreatureTargets.push_back(creature);</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;                }</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;                {</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;                    <a class="code" href="classMaNGOS_1_1AllCreatureEntriesWithLiveStateInObjectRangeCheck.html">MaNGOS::AllCreatureEntriesWithLiveStateInObjectRangeCheck</a> u_check(*caster, entriesToUse, type != <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d">SPELL_TARGET_TYPE_DEAD</a>, radius, type == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;                    <a class="code" href="structMaNGOS_1_1CreatureListSearcher.html">MaNGOS::CreatureListSearcher&lt;MaNGOS::AllCreatureEntriesWithLiveStateInObjectRangeCheck&gt;</a> searcher(foundScriptCreatureTargets, u_check);</div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;                    <a class="code" href="structCell.html#a07c1300d6a1d8ee38819103043b89b8f">Cell::VisitAllObjects</a>(caster, searcher, radius); <span class="comment">// Visit all, need to find also Pet* objects</span></div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;                    <span class="keywordflow">if</span> (u_check.<a class="code" href="classMaNGOS_1_1AllCreatureEntriesWithLiveStateInObjectRangeCheck.html#a8c990ac643b2051328700e32d8660cf8">FoundOutOfRange</a>())</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;                        foundButOutOfRange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;                }</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;            }</div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        }</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ab1c1ebb7458162f26377e273a8a779fa">SPELL_TARGET_TYPE_STRING_ID</a>:</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        {</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> stringId : entriesToUse)</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;            {</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;                <span class="keyword">auto</span> creatures = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a9bd1fe5bb4a9f00fd1d4ed5d729dbf8d">GetCreatures</a>(stringId);</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="classCreature.html">Creature</a>* creature : *creatures)</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;                {</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;                    <span class="keywordflow">if</span> (creature-&gt;IsWithinCombatDistInMap(caster, radius, <span class="keyword">true</span>))</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;                        foundScriptCreatureTargets.push_back(creature);</div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;                        foundButOutOfRange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                }</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                <span class="keyword">auto</span> gameObjects = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a512201251b4b320f7f1171a04031e201">GetGameObjects</a>(stringId);</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="classGameObject.html">GameObject</a>* gameObject : *gameObjects)</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                {</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                    <span class="keywordflow">if</span> (gameObject-&gt;IsWithinDist(caster, radius, <span class="keyword">true</span>))</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;                        foundScriptGOTargets.push_back(gameObject);</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;                        foundButOutOfRange = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;                }</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;            }</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;        }</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;    }</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160; </div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    <span class="keywordflow">if</span> (!foundScriptCreatureTargets.empty())</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    {</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> iter = foundScriptCreatureTargets.begin(); iter != foundScriptCreatureTargets.end();)</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;        {</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;            <span class="keywordtype">bool</span> failed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">OnCheckTarget</a>(*iter, effIndex))</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;                failed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ac4ec9bdb1506ec6034067363b1a0cea4">SPELL_ATTR_EX_EXCLUDE_CASTER</a>) &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> == (*iter))</div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;                failed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;            <span class="keywordflow">if</span> (failed)</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;                iter = foundScriptCreatureTargets.erase(iter);</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;                ++iter;</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;        }</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160; </div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;        foundScriptCreatureTargets.sort([=](<span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a>* a, <span class="keyword">const</span> <a class="code" href="classCreature.html">Creature</a>* b) -&gt; <span class="keywordtype">bool</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;        {</div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;            <span class="keywordflow">return</span> caster-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(a, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>) &lt; caster-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(b, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>);</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;        });</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160; </div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        <span class="keywordflow">if</span> (foundScriptCreatureTargets.size() &gt; targetCount) <span class="comment">// if we have too many targets, we need to trim the list</span></div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;            foundScriptCreatureTargets.resize(targetCount);</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;    }</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;    <span class="keywordflow">if</span> (!foundScriptGOTargets.empty())</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;    {</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = foundScriptGOTargets.begin(); itr != foundScriptGOTargets.end();)</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;        {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">OnCheckTarget</a>(*itr, effIndex))</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                itr = foundScriptGOTargets.erase(itr);</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;                ++itr;</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        }</div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        foundScriptGOTargets.sort([=](<span class="keyword">const</span> <a class="code" href="classGameObject.html">GameObject</a>* a, <span class="keyword">const</span> <a class="code" href="classGameObject.html">GameObject</a>* b) -&gt; <span class="keywordtype">bool</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;        {</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;            <span class="keywordflow">return</span> caster-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(a, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>) &lt; caster-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(b, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;        });</div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160; </div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;        <span class="keywordflow">if</span> (foundScriptGOTargets.size() &gt; targetCount) <span class="comment">// if we have too many targets, we need to trim the list</span></div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;            foundScriptGOTargets.resize(targetCount);</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    }</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160; </div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;    <span class="keywordflow">if</span> (!foundScriptCreatureTargets.empty())</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    {</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;        <span class="comment">// store coordinates for TARGET_LOCATION_SCRIPT_NEAR_CASTER</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;        <span class="keywordflow">if</span> (targetMode == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;        {</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;            <a class="code" href="classCreature.html">Creature</a>* creatureScriptTarget = foundScriptCreatureTargets.front(); <span class="comment">// can only have one target in this case</span></div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(creatureScriptTarget-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), creatureScriptTarget-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), creatureScriptTarget-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>());</div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;        }</div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;        <span class="comment">// store explicit target for TARGET_UNIT_SCRIPT_NEAR_CASTER</span></div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classCreature.html">Creature</a>* creature : foundScriptCreatureTargets)</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;                tempUnitList.push_back(creature);</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;    }</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!foundScriptGOTargets.empty())</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;    {</div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        <span class="comment">// store coordinates for TARGET_LOCATION_SCRIPT_NEAR_CASTER</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        <span class="keywordflow">if</span> (targetMode == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;        {</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;            <a class="code" href="classGameObject.html">GameObject</a>* goScriptTarget = foundScriptGOTargets.front(); <span class="comment">// can only have one target in this case</span></div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(goScriptTarget-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), goScriptTarget-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), goScriptTarget-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>());</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        <span class="comment">// store explicit target for TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</span></div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;            tempGOList.splice(tempGOList.end(), foundScriptGOTargets);</div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;    }</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;    <span class="comment">// Missing DB Entry or targets for this spellEffect.</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;    {</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <span class="comment">/* For TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER makes DB targets optional not required for now</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">         * TODO: Makes more research for this target type</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        <span class="keywordflow">if</span> (targetMode != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faedcd06b127e6929ec44b33d36e639b9b">TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        {</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;            <span class="comment">// not report target not existence for triggered spells</span></div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;            <span class="keywordflow">return</span> foundButOutOfRange ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        }</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (foundButOutOfRange)</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    }</div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;}</div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160; </div>
<div class="line"><a name="l03231"></a><span class="lineno"><a class="line" href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53"> 3231</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53">Spell::CheckSpellScriptTargets</a>(<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds&lt;SpellTargetEntry&gt;</a>&amp; bounds, <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; tempTargetUnitMap, <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; targetUnitMap, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex)</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;{</div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;    <span class="keywordflow">for</span> (UnitList::const_iterator iter = tempTargetUnitMap.begin(); iter != tempTargetUnitMap.end(); ++iter)</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    {</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* target = (*iter);</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>)</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classSQLMultiStorage_1_1SQLMultiSIterator.html">SQLMultiStorage::SQLMultiSIterator&lt;SpellTargetEntry&gt;</a> i_spellST = bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">first</a>; i_spellST != bounds.<a class="code" href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">second</a>; ++i_spellST)</div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;        {</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;            <a class="code" href="structSpellTargetEntry.html">SpellTargetEntry</a> <span class="keyword">const</span>* spellST = (*i_spellST);</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;            <span class="keywordflow">if</span> (spellST-&gt;<a class="code" href="structSpellTargetEntry.html#aa98cb1c37e596c8d9d963983e2270727">CanNotHitWithSpellEffect</a>(effIndex))</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160; </div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;            <span class="comment">// only creature entries supported for this target type</span></div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;            <span class="keywordflow">if</span> (spellST-&gt;<a class="code" href="structSpellTargetEntry.html#a5b55f617927e81360f6c524e2c66c02b">type</a> == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ae7ce658fcd9ebcff46e1c1228325f7dd">SPELL_TARGET_TYPE_GAMEOBJECT</a> || spellST-&gt;<a class="code" href="structSpellTargetEntry.html#a5b55f617927e81360f6c524e2c66c02b">type</a> == <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b">SPELL_TARGET_TYPE_GAMEOBJECT_GUID</a>)</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160; </div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;            <span class="keywordtype">bool</span> fail = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;            <span class="keywordflow">switch</span> (spellST-&gt;<a class="code" href="structSpellTargetEntry.html#a5b55f617927e81360f6c524e2c66c02b">type</a>)</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;            {</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a>:</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;                    fail = target-&gt;<a class="code" href="classObject.html#a65ccb03ef30ffbb9456d7a0a9ad1fa29">GetDbGuid</a>() != spellST-&gt;<a class="code" href="structSpellTargetEntry.html#ad1a36a1a665637d605e3d46f880e34a3">targetEntry</a>;</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ab1c1ebb7458162f26377e273a8a779fa">SPELL_TARGET_TYPE_STRING_ID</a>:</div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;                    fail = target-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() != spellST-&gt;<a class="code" href="structSpellTargetEntry.html#ad1a36a1a665637d605e3d46f880e34a3">targetEntry</a>;</div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;            }</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;            <span class="keywordflow">if</span> (fail)</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160; </div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;            <span class="keywordflow">switch</span> (spellST-&gt;<a class="code" href="structSpellTargetEntry.html#a5b55f617927e81360f6c524e2c66c02b">type</a>)</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;            {</div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d">SPELL_TARGET_TYPE_DEAD</a>:</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;                    <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(target)-&gt;IsCorpse())</div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;                        targetUnitMap.push_back(target);</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a0b85aa6e0df9762ad1548fd70ac84962">SPELL_TARGET_TYPE_CREATURE</a>:</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;                        targetUnitMap.push_back(target);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a>:</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;                    targetUnitMap.push_back(target);</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ab1c1ebb7458162f26377e273a8a779fa">SPELL_TARGET_TYPE_STRING_ID</a>:</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#a0288e97fcb616db1a040b76dd53e01e8">HasStringId</a>(spellST-&gt;<a class="code" href="structSpellTargetEntry.html#ad1a36a1a665637d605e3d46f880e34a3">targetEntry</a>))</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;                        targetUnitMap.push_back(target);</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            }</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;        }</div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;    }</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;}</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160; </div>
<div class="line"><a name="l03289"></a><span class="lineno"><a class="line" href="classSpell.html#a80d021c71f13bcf84ed30fdf87a62031"> 3289</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#a80d021c71f13bcf84ed30fdf87a62031">Spell::PreCastCheck</a>(<a class="code" href="classAura.html">Aura</a>* triggeredByAura <span class="comment">/*= nullptr*/</span>)</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;{</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d">CheckCast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a> &amp;&amp; (!<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>() || <a class="code" href="classSpell.html#a11b87f50b82300c30c1d17dd079c1fd5">m_triggerAutorepeat</a>)) <span class="comment">// always cast autorepeat dummy for triggering</span></div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    {</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;        <span class="keywordflow">if</span> (triggeredByAura)</div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;        {</div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;            <a class="code" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">SendChannelUpdate</a>(0);</div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;            triggeredByAura-&gt;<a class="code" href="classAura.html#a147025fb57da9da66ff1ca2ed6d9331e">GetHolder</a>()-&gt;<a class="code" href="classSpellAuraHolder.html#a04ea541571f23194212875bf5a412476">SetAuraDuration</a>(0);</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;        }</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    }</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160; </div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;}</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160; </div>
<div class="line"><a name="l03305"></a><span class="lineno"><a class="line" href="classSpell.html#a2391bf1bfb54f70998c4374d59eb308c"> 3305</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#a2391bf1bfb54f70998c4374d59eb308c">Spell::SpellStart</a>(<a class="code" href="classSpellCastTargets.html">SpellCastTargets</a> <span class="keyword">const</span>* targets, <a class="code" href="classAura.html">Aura</a>* triggeredByAura)</div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;{</div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;        <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa763d6493fb2b6b556c84aee4e0f1bad3">SPELL_STATE_TARGETING</a>;</div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a> = *targets;</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160; </div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="keywordflow">if</span> (triggeredByAura)</div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;        <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> = triggeredByAura-&gt;<a class="code" href="classAura.html#a2ed87e20905a61440fd9b0420182eb0a">GetSpellProto</a>();</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160; </div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;    <span class="comment">// create and add update event for this spell</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;    <a class="code" href="classSpell.html#a642a91a2145c8f2f87024110fe93d036">m_spellEvent</a> = <span class="keyword">new</span> <a class="code" href="classSpellEvent.html">SpellEvent</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">AddEvent</a>(<a class="code" href="classSpell.html#a642a91a2145c8f2f87024110fe93d036">m_spellEvent</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a1a92f983f1dd415146c2875f80cba433">CalculateTime</a>(1));</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>()) <span class="comment">// gameobjects dont have a sense of already casting a spell</span></div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;    {</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;        <span class="comment">// Prevent casting at cast another spell (ServerSide check)</span></div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af0cab5ed9e6a02a565198db1d3db13a8">IsNonMeleeSpellCasted</a>(<span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>) &amp;&amp; <a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a> &amp;&amp; !<a class="code" href="classSpell.html#a3ae4f6a6ff1cf1d52d5e2dce4bcd43fa">m_ignoreConcurrentCasts</a>)</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        {</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaeecb06edf432f8f464c1e4ba2704095a">SPELL_FAILED_SPELL_IN_PROGRESS</a>);</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaeecb06edf432f8f464c1e4ba2704095a">SPELL_FAILED_SPELL_IN_PROGRESS</a>;</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        }</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    }</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160; </div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classSpell.html#a80d021c71f13bcf84ed30fdf87a62031">PreCastCheck</a>();</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    {</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;        <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(result);</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;        <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;    }</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;    <a class="code" href="classSpell.html#a626975cd2349dcc40c11fac67440f6df">Prepare</a>();</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160; </div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;}</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160; </div>
<div class="line"><a name="l03342"></a><span class="lineno"><a class="line" href="classSpell.html#a626975cd2349dcc40c11fac67440f6df"> 3342</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a626975cd2349dcc40c11fac67440f6df">Spell::Prepare</a>()</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;{</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aae175109189bc7f989a42de7f088cb6fa">SPELL_STATE_CASTING</a>;</div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    <span class="comment">// Prepare data for triggers</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <a class="code" href="classSpell.html#a3708df24a12e888277bf67285487118e">prepareDataForTriggerSystem</a>();</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160; </div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    <span class="comment">// calculate cast time (calculated after first CheckCast check to prevent charge counting for first CheckCast fail)</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a840b081d5abbcaeda47b522fbdd36e62">m_ignoreCastTime</a>)</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;    {</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;        <a class="code" href="classSpellModRAII.html">SpellModRAII</a> spellModController(<span class="keyword">this</span>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>(), <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;        <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a> = <a class="code" href="SpellMgr_8cpp.html#a21276e72bb353d9930509922bfc6243b">GetSpellCastTime</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <span class="keyword">this</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;    }</div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160; </div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;    <span class="comment">// set timer base at cast time</span></div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    <a class="code" href="classSpell.html#ab59bbf4428bcb938c7e9af5a6ee9812a">ReSetTimer</a>();</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160; </div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>())</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;    {</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a1203bc676452b3a3902e4c824734156d">SPELL_ATTR_EX2_NOT_AN_ACTION</a>))</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae74959b340f7d8d2874bc62a507b0d7e">RemoveAurasOnCast</a>(<a class="code" href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a7c60f7f30376f851d3c8921d4140390d">AURA_INTERRUPT_FLAG_ACTION</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a14ffa28e0a73efac742dceb71e7cc731">SPELL_ATTR_EX7_RESET_SWING_TIMER_AT_SPELL_START</a>))</div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;        {</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a6e293fbb4665079fb8b3aa753018f66c">SPELL_ATTR_EX6_DOESNT_RESET_SWING_TIMER_IF_INSTANT</a>) || <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a> &gt; 0)</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;            {</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae7f942c448b14628617639978bf6bd00">resetAttackTimer</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>);</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a8c4f494ad07fd452587995799a295199">hasOffhandWeaponForAttack</a>())</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae7f942c448b14628617639978bf6bd00">resetAttackTimer</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a>);</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            }</div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;        }</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160; </div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;        <span class="comment">// Orientation changes inside</span></div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a8425d18c430e7f6f47cc66f8576b62df">m_notifyAI</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>())</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a3dc9c4944fab218d9a215df9dbb7fa35">OnSpellCastStateChange</a>(<span class="keyword">this</span>, <span class="keyword">true</span>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>());</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;    }</div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160; </div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;    <a class="code" href="classSpell.html#a72d630ee8147b4197d46503dd2c9ed34">m_castPositionX</a> = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>();</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;    <a class="code" href="classSpell.html#a7a1b42fb496a662f928a3f3f2e738bcc">m_castPositionY</a> = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>();</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;    <a class="code" href="classSpell.html#a5e4e64d34f282231e10ec16596700432">m_castPositionZ</a> = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>();</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;    <a class="code" href="classSpell.html#a7bdeaabf8fa127e4269e683c2bd76499">m_castOrientation</a> = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>();</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160; </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <a class="code" href="classSpell.html#a3ae62069047a5c7606f932e95d144562">OnSuccessfulStart</a>();</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160; </div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;    <span class="comment">// add non-triggered (with cast time and without)</span></div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>)</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;    {</div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>())</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;        {</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            <span class="comment">// add to cast type slot</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            <span class="keywordflow">if</span> ((!<a class="code" href="classSpell.html#a3ae4f6a6ff1cf1d52d5e2dce4bcd43fa">m_ignoreConcurrentCasts</a> || <a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) &amp;&amp; !<a class="code" href="classSpell.html#a11b87f50b82300c30c1d17dd079c1fd5">m_triggerAutorepeat</a>)</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a81f3332259cc30966e133c4e3c60b159">SetCurrentCastedSpell</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160; </div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            <span class="comment">// add gcd server side (client side is handled by client itself)</span></div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a1aa5c63d01bca4b25f03a715554ea7a1">AddGCD</a>(*<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;        }</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160; </div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        <span class="comment">// will show cast bar</span></div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;        <a class="code" href="classSpell.html#a84132b0daaea7cd01095c64dce0ab385">SendSpellStart</a>();</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160; </div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;        <span class="comment">// Execute instant spells immediate</span></div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> == 0 &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; (!<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>() || <a class="code" href="classSpell.html#a11b87f50b82300c30c1d17dd079c1fd5">m_triggerAutorepeat</a>))</div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            <a class="code" href="classSpell.html#a0af004d00c37bf3849719452e2b9deaa">cast</a>();</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    }</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    <span class="comment">// execute triggered without cast time explicitly in call point</span></div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;    {</div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="comment">// Channeled spell is always one per caster and needs to be tracked and removed on death</span></div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) <span class="comment">// GO casters cant cast channeled spells</span></div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a81f3332259cc30966e133c4e3c60b159">SetCurrentCastedSpell</a>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160; </div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> == 0)</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;            <a class="code" href="classSpell.html#a0af004d00c37bf3849719452e2b9deaa">cast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;    }</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;    <span class="comment">// else triggered with cast time will execute execute at next tick or later</span></div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    <span class="comment">// without adding to cast type slot</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;    <span class="comment">// will not show cast bar but will show effects at casting time etc</span></div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;}</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160; </div>
<div class="line"><a name="l03421"></a><span class="lineno"><a class="line" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28"> 3421</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">Spell::cancel</a>()</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;{</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>)</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160; </div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;    <span class="comment">// channeled spells don&#39;t display interrupted message even if they are interrupted, possible other cases with no &quot;Interrupted&quot; message</span></div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;    <span class="keywordtype">bool</span> sendInterrupt = !(<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) || <a class="code" href="classSpell.html#af8e7a207583b68ff524b4372e995664a">m_autoRepeat</a>);</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160; </div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* player = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>()) <span class="comment">// reset casting time mods</span></div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;        <span class="keywordflow">if</span> (player-&gt;GetSpellModSpell() != <span class="keyword">this</span> &amp;&amp; !<a class="code" href="classSpell.html#a3265dd73fd4d1e72de3ca47f4a2e8b3f">m_usedAuraCharges</a>.empty())</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            player-&gt;ResetSpellModsDueToCanceledSpell(<a class="code" href="classSpell.html#a3265dd73fd4d1e72de3ca47f4a2e8b3f">m_usedAuraCharges</a>);</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160; </div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;    <a class="code" href="classSpell.html#af8e7a207583b68ff524b4372e995664a">m_autoRepeat</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a>)</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;    {</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa2469fe6b82004a0a40c5f2162b362dd0">SPELL_STATE_CREATED</a>:</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa763d6493fb2b6b556c84aee4e0f1bad3">SPELL_STATE_TARGETING</a>:</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aae175109189bc7f989a42de7f088cb6fa">SPELL_STATE_CASTING</a>:</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a6cfca946eb93ed200cbda369751000bb">ResetGCD</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;            <span class="comment">// [[fallthrough]]</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a>:</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;            <a class="code" href="classSpell.html#a0170aeace8c572eb70d4436c8b93fe4c">SendInterrupted</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd0beaff636dbf2950814f9697dcb341">SPELL_FAILED_INTERRUPTED</a>);</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;            <span class="keywordflow">if</span> (sendInterrupt)</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;                <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd0beaff636dbf2950814f9697dcb341">SPELL_FAILED_INTERRUPTED</a>);</div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aaf3ec0c7a0bbd78bc7ee9137522143073">SPELL_STATE_LANDING</a>:</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell [%u] is interrupted while processing&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;            <span class="comment">// [[fallthrough]]</span></div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>:</div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;            {</div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;                <span class="keywordflow">if</span> (ihit.missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;                {</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;                    <a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == ihit.targetGUID ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, ihit.targetGUID);</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;                    <span class="keywordflow">if</span> (unit &amp;&amp; unit-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                        unit-&gt;<a class="code" href="classUnit.html#a48f6b76622c977dc6110c8f427781286">RemoveAurasByCasterSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>());</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160; </div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;                    <span class="comment">// prevent other effects applying if spell is already interrupted</span></div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;                    <span class="comment">// i.e. if effects have different targets and it was interrupted on one of them when</span></div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;                    <span class="comment">// haven&#39;t yet applied to another</span></div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;                    ihit.processed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;                }</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;            }</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a3c12174ecf9e1ff874ff49c83793e3b1">SPELL_ATTR_COOLDOWN_ON_EVENT</a>))</div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a5499518dd6ee5f72a817f6084727aaa7">RemoveSpellCooldown</a>(*<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">true</span>); <span class="comment">// need to clear cooldown in client</span></div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160; </div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;            <a class="code" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">SendChannelUpdate</a>(0);</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;            <a class="code" href="classSpell.html#a0170aeace8c572eb70d4436c8b93fe4c">SendInterrupted</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd0beaff636dbf2950814f9697dcb341">SPELL_FAILED_INTERRUPTED</a>);</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;            <span class="keywordflow">if</span> (sendInterrupt)</div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;                <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd0beaff636dbf2950814f9697dcb341">SPELL_FAILED_INTERRUPTED</a>);</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>: <span class="keywordflow">break</span>; <span class="comment">// should not occur</span></div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;    }</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160; </div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;    {</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae5ea31897d0b7ba45822920e7d69e21d">RemoveDynObject</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5a5e8db4955d382177621efa3c711a3d">RemoveGameObject</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a3fb2f210c37c2fe4b78abb0c9ab5f822">RemoveCreature</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    }</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;}</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160; </div>
<div class="line"><a name="l03485"></a><span class="lineno"><a class="line" href="classSpell.html#a0af004d00c37bf3849719452e2b9deaa"> 3485</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#a0af004d00c37bf3849719452e2b9deaa">Spell::cast</a>(<span class="keywordtype">bool</span> skipCheck)</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;{</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <a class="code" href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">SetExecutedCurrently</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;    <a class="code" href="classSpellModRAII.html">SpellModRAII</a> spellModController(<span class="keyword">this</span>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>());</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160; </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aea0bc6446269c155fb3d9153e877588a">CheckAndIncreaseCastCounter</a>())</div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;    {</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>)</div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell %u triggered by aura spell %u too deep in cast chain for cast. Cast not allowed for prevent overflow stack crash.&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell %u too deep in cast chain for cast. Cast not allowed for prevent overflow stack crash.&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160; </div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;        <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>);</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;        <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;        <a class="code" href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">SetExecutedCurrently</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>;</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;    }</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160; </div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;    <span class="comment">// update pointers base at GUIDs to prevent access to already nonexistent object</span></div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;    <a class="code" href="classSpell.html#a00dbf3e8c4ec3aa165e7bddb7cfeecd8">UpdatePointers</a>();</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160; </div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;    <span class="comment">// cancel at lost main target unit</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>() &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>() != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;    {</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a30575160f50527439663406d3fa3991e">DecreaseCastCounter</a>();</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;        <a class="code" href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">SetExecutedCurrently</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>;</div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;    }</div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160; </div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>() &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734ad4e0ee8d9bd227b06b832fcc75c9f80f">SPELL_ATTR_EX5_AI_DOESNT_FACE_TARGET</a>))</div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;    {</div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* charmer = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ab7aa55eb03cc7e7d93894ccaf4e6f250">GetCharmer</a>();</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;        <span class="keywordflow">if</span> (charmer &amp;&amp; !(charmer-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; ((<a class="code" href="classPlayer.html">Player</a>*)charmer)-&gt;GetCamera().GetBody() == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)) <span class="comment">// need to check if target doesnt have a player controlling it</span></div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a22379af759e2f2948923cf84f773799d">SetInFront</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>());</div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;    }</div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160; </div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;    <span class="comment">// triggered cast called from Spell::prepare where it was already checked</span></div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> castResult = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;    <span class="keywordflow">if</span> (!skipCheck)</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;    {</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;        castResult = <a class="code" href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d">CheckCast</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;        <span class="keywordflow">if</span> (castResult != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;            <a class="code" href="classSpell.html#a155729c79b2273c8aa062c13e8dd4e08">StopCast</a>(castResult);</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;            <span class="keywordflow">return</span> castResult;</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;        }</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;    }</div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160; </div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;    <span class="comment">// different triggered (for caster and main target after main cast) and pre-cast (casted before apply effect to each target) cases</span></div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a>)</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;    {</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0ebbb6206eb92cdc484b416eb6f41743">SPELLFAMILY_GENERIC</a>:</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;        {</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;            <span class="comment">// Bandages</span></div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a00a5387370626b3d3226aad2d6cbd1e7">Mechanic</a> == <a class="code" href="SharedDefines_8h.html#ad2aeb5ae42fe35df2fb10f017c9eed66a91b90a0714fac244c510d1bcde9456a9">MECHANIC_BANDAGE</a>)</div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(11196);                     <span class="comment">// Recently Bandaged</span></div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;            <span class="comment">// Stoneskin</span></div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 20594)</div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(65116);                   <span class="comment">// Stoneskin - armor 10% for 8 sec</span></div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;            <span class="comment">// Chaos Bane strength buff</span></div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 71904)</div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(73422);</div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;            <span class="comment">// Weak Alcohol</span></div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aadb41c294565428ff67a9a137d01465a">SpellIconID</a> == 1306 &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a39b26f93bb0f756875d72cb4338333c9">SpellVisual</a>[0] == 11359)</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(51655);                   <span class="comment">// BOTM - Create Empty Brew Bottle</span></div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;        }</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a>:</div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;        {</div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;            <span class="comment">// Ice Block</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000008000000000))</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(41425);                     <span class="comment">// Hypothermia</span></div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;            <span class="comment">// Icy Veins</span></div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 12472)</div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;            {</div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(56374))               <span class="comment">// Glyph of Icy Veins</span></div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                {</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;                    <span class="comment">// not exist spell do it so apply directly</span></div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a71eb7e701f65d94e214db3eccf3b5b5e">RemoveSpellsCausingAura</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab3987db9e154ae9a2086efb43e5af610">SPELL_AURA_MOD_DECREASE_SPEED</a>);</div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a71eb7e701f65d94e214db3eccf3b5b5e">RemoveSpellsCausingAura</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a409384ae03726c8805f7148ce3867853">SPELL_AURA_HASTE_SPELLS</a>);</div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                }</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;            }</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;        }</div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca52acbcf14a96b5ed01b8a43052a26a11">SPELLFAMILY_WARRIOR</a>:</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;        {</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;            <span class="comment">// Shield Slam</span></div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000020000000000)) &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac553667d97b29d8ad7e682d4c55e4263">Category</a> == 1209)</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;            {</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(58375))               <span class="comment">// Glyph of Blocking</span></div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;                    <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(58374);               <span class="comment">// Glyph of Blocking</span></div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;            }</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;            <span class="comment">// Bloodrage</span></div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000000000100))</div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;            {</div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(70844))               <span class="comment">// Item - Warrior T10 Protection 4P Bonus</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;                    <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(70845);               <span class="comment">// Stoicism</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;            }</div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;            <span class="comment">// Bloodsurge (triggered), Sudden Death (triggered)</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 46916 || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 52437)</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;                <span class="comment">// Item - Warrior T10 Melee 4P Bonus</span></div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classAura.html">Aura</a>* aur = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a87b4688e7aef0ea4562efb17f01971de">GetAura</a>(70847, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>))</div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="Util_8h.html#a50320d4edff86db31b25138ae72161ad">roll_chance_i</a>(aur-&gt;GetModifier()-&gt;m_amount))</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;                        <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(70849);           <span class="comment">// Extra Charge!</span></div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;        }</div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a>:</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;        {</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;            <span class="comment">// Power Word: Shield</span></div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a00a5387370626b3d3226aad2d6cbd1e7">Mechanic</a> == <a class="code" href="SharedDefines_8h.html#ad2aeb5ae42fe35df2fb10f017c9eed66ae896bc0b0a0eb3df2b85c317074e3383">MECHANIC_SHIELD</a> &amp;&amp;</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;                    (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000000000001)))</div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(6788);                      <span class="comment">// Weakened Soul</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160; </div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;            {</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;                <span class="keywordflow">case</span> 15237: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(23455); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 1</span></div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;                <span class="keywordflow">case</span> 15430: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(23458); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 2</span></div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;                <span class="keywordflow">case</span> 15431: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(23459); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 3</span></div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;                <span class="keywordflow">case</span> 27799: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(27803); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 4</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;                <span class="keywordflow">case</span> 27800: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(27804); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 5</span></div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160;                <span class="keywordflow">case</span> 27801: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(27805); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 6</span></div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;                <span class="keywordflow">case</span> 25331: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(25329); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 7</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;                <span class="keywordflow">case</span> 48077: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(48075); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 8</span></div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;                <span class="keywordflow">case</span> 48078: <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(48076); <span class="keywordflow">break</span>;<span class="comment">// Holy Nova, rank 9</span></div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;                <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;            }</div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;        }</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a>:</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;        {</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;            <span class="comment">// Faerie Fire (Feral)</span></div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 16857 &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a373a25c8d6ff3ca2f5653267c1269ad4">GetShapeshiftForm</a>() != <a class="code" href="SharedDefines_8h.html#ab1b67dd15f243c850f589f66747e547caa28b6421a1efdc3a6377c480e1f80809">FORM_CAT</a>)</div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(60089);</div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;            <span class="comment">// Clearcasting</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 16870)</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;            {</div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(70718))               <span class="comment">// Item - Druid T10 Balance 2P Bonus</span></div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;                    <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(70721);                 <span class="comment">// Omen of Doom</span></div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;            }</div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;            <span class="comment">// Berserk (Bear Mangle part)</span></div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 50334)</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(58923);</div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;        }</div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a>:</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;            <span class="comment">// Fan of Knives (main hand)</span></div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 51723 &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a8c4f494ad07fd452587995799a295199">hasOffhandWeaponForAttack</a>())</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;            {</div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(52874);                   <span class="comment">// Fan of Knives (offhand)</span></div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;            }</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca66df9b34a3b922a8242d3dfb74494026">SPELLFAMILY_HUNTER</a>:</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;        {</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            <span class="comment">// Deterrence</span></div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 19263)</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(67801);</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        }</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a>:</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;        {</div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;            <span class="comment">// Divine Illumination</span></div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 31842)</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;            {</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(70755))               <span class="comment">// Item - Paladin T10 Holy 2P Bonus</span></div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;                    <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(71166);                 <span class="comment">// Divine Illumination</span></div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;            }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;            <span class="comment">// Hand of Reckoning</span></div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 62124)</div>
<div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;            {</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() || !<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classUnit.html#a78f36dfd898563ca5f10a8e3f0d9739e">HasTarget</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()))</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;                    <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(67485);                 <span class="comment">// Hand of Rekoning (no typos in name ;) )</span></div>
<div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;            }</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;            <span class="comment">// Divine Shield, Divine Protection or Hand of Protection</span></div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000000400080))</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;            {</div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(25771);                     <span class="comment">// Forbearance</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(61987);                     <span class="comment">// Avenging Wrath Marker</span></div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;            }</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;            <span class="comment">// Lay on Hands</span></div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000000008000))</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;            {</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;                <span class="comment">// only for self cast</span></div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> == <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;                    <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(25771);                 <span class="comment">// Forbearance</span></div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;            }</div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;            <span class="comment">// Avenging Wrath</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000200000000000))</div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(61987);                     <span class="comment">// Avenging Wrath Marker</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;        }</div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9c8a9c6e102c760263471a93e58e80ea">SPELLFAMILY_SHAMAN</a>:</div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        {</div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;            <span class="comment">// Bloodlust</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 2825)</div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(57724);                     <span class="comment">// Sated</span></div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;            <span class="comment">// Heroism</span></div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 32182)</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(57723);                     <span class="comment">// Exhaustion</span></div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;            <span class="comment">// Spirit Walk</span></div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 58875)</div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;                <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">AddPrecastSpell</a>(58876);</div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;            <span class="comment">// Totem of Wrath</span></div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f">SPELL_EFFECT_APPLY_AREA_AURA_RAID</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000004000000))</div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;                <span class="comment">// only for main totem spell cast</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(30708);                   <span class="comment">// Totem of Wrath</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;        }</div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cadc34b27f2cd523716d80c51d4e1d6f02">SPELLFAMILY_DEATHKNIGHT</a>:</div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;        {</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;            <span class="comment">// Chains of Ice</span></div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 45524)</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;                <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">AddTriggeredSpell</a>(55095);                   <span class="comment">// Frost Fever</span></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;        }</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    }</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160; </div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;    <span class="comment">// traded items have trade slot instead of guid in m_itemTargetGUID</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;    <span class="comment">// set to real guid to be sent later to the client</span></div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;    <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ac6ff9f0e2814bcdb4b2e36798724252e">updateTradeSlotItem</a>();</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160; </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;    <a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a> = <a class="code" href="SpellMgr_8cpp.html#adcb922f517a421f170e35fae73441af5">CalculateSpellDuration</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <span class="keyword">nullptr</span>, <a class="code" href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">m_auraScript</a>);</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;    {</div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;            <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetAchievementMgr().<a class="code" href="classPlayer.html#a9cf10b1ea6187be4cd0facfd5c691c6d">UpdateAchievementCriteria</a>(<a class="code" href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a09cd8a896a5a8785223068bbbaa65135">ACHIEVEMENT_CRITERIA_TYPE_USE_ITEM</a>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>());</div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160; </div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetAchievementMgr().<a class="code" href="classPlayer.html#a9cf10b1ea6187be4cd0facfd5c691c6d">UpdateAchievementCriteria</a>(<a class="code" href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a2644bcc963aae857b4e9a20ce22ac048">ACHIEVEMENT_CRITERIA_TYPE_CAST_SPELL</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;    }</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160; </div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;    <a class="code" href="classSpell.html#aae8b05fa2c3fad700a3dca8c4d154e94">FillTargetMap</a>();</div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160; </div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>)               <span class="comment">// stop cast if spell marked as finish somewhere in FillTargetMap</span></div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;    {</div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;        <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a30575160f50527439663406d3fa3991e">DecreaseCastCounter</a>();</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;        <a class="code" href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">SetExecutedCurrently</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>; <span class="comment">// currently not propagating right error here but it should not be needed</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    }</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160; </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    spellModController.<a class="code" href="classSpellModRAII.html#aae2aecd7b406edaa84c61a2c6ff20a26">SetSuccess</a>();</div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160; </div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* unitCaster = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>))</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = unitCaster-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;                pet-&gt;Unsummon(<a class="code" href="Pet_8h.html#a006372e9693754ac0d923d8764ec55fdae55abbb64855962852c91fb8638ad6cd">PET_SAVE_NOT_IN_SLOT</a>, unitCaster);</div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160; </div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    <span class="comment">// CAST SPELL</span></div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;    <a class="code" href="classSpell.html#a7e93f29ca09727fabcd6d4445029ca4a">SendSpellCooldown</a>();</div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a8425d18c430e7f6f47cc66f8576b62df">m_notifyAI</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>())</div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#aeb4a9728df30ea71cde347892f8888c4">OnSpellCooldownAdded</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160; </div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;    <a class="code" href="classSpell.html#ab191335cf0379cfc4483c6404eebd285">TakePower</a>();</div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;    <a class="code" href="classSpell.html#a39bddfec4b1d97d380972515a7d26314">TakeReagents</a>();                                         <span class="comment">// we must remove reagents before HandleEffects to allow place crafted item in same slot</span></div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;    <a class="code" href="classSpell.html#a6b2f1ff698d8d27a90461ed99fb51500">TakeAmmo</a>();</div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160; </div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(castResult);</div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;    <a class="code" href="classSpell.html#a3244e8c8f24aa8fdaec7b236a9532724">SendSpellGo</a>();                                          <span class="comment">// we must send smsg_spell_go packet before m_castItem delete in TakeCastItem()...</span></div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160; </div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;    <a class="code" href="classSpell.html#ac99404294f7725f4bd29e70e015e3d47">InitializeDamageMultipliers</a>();</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160; </div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;    <a class="code" href="classSpell.html#a3baff69e3d6bff9c02248e290cfb2e30">OnCast</a>();</div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160; </div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>() &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a1203bc676452b3a3902e4c824734156d">SPELL_ATTR_EX2_NOT_AN_ACTION</a>))</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae74959b340f7d8d2874bc62a507b0d7e">RemoveAurasOnCast</a>(<a class="code" href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a1bac192f38d1aa42f3ed728832e1f5ad">AURA_INTERRUPT_FLAG_ACTION_LATE</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160; </div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160;    <span class="comment">// process immediate effects (items, ground, etc.) also initialize some variables</span></div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;    <a class="code" href="classSpell.html#a7e2f06d9f8d074db174bce10f2c5165e">_handle_immediate_phase</a>();</div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160; </div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* procTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;    <span class="keywordflow">if</span> (!procTarget)</div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;        procTarget = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160; </div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;    <span class="comment">// Okay, everything is prepared. Now we need to distinguish between immediate and evented delayed spells</span></div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5003eeaba08c841f12b72a3010420eec">IsDelayedSpell</a>())</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;    {</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;        <span class="comment">// For channels, delay starts at channel end</span></div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> != <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>)</div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;        {</div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;            <span class="comment">// Okay, maps created, now prepare flags</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;            <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a>;</div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;            <a class="code" href="classSpell.html#a9572cd3b12252c7c177b0f6151a1c57b">SetDelayStart</a>(0);</div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;            <a class="code" href="classSpell.html#a49eda4ec0b6d63e0a4f54b67aff5549b">SetSpellStartTravelling</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a753346ed8fd6a52a17aa1bccb0652990">GetCurrentMSTime</a>());</div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160; </div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ab8b7943d1cb9e62f6f5cb6720ec59d32">SPELL_ATTR_EX_NO_THREAT</a>) &amp;&amp;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;                !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a6e67c0304fea4fcb36f77265f52ffed2">SPELL_ATTR_EX_THREAT_ONLY_ON_MISS</a>) &amp;&amp;</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;                !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a858aae561517cebb142e6af5691d3ef5">SPELL_ATTR_EX2_NO_INITIAL_THREAT</a>)) <span class="comment">// attribute checks</span></div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;            {</div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a62196e93f86fd56823e665abd41864db">IsPlayerControlled</a>()) <span class="comment">// only player casters</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;                {</div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;                    {</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;                        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;                        {</div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;                            <span class="keywordflow">if</span> (target-&gt;GetObjectGuid() == ihit.targetGUID)                 <span class="comment">// Found in list</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;                            {</div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a08cbed215e32eaeb4d9716da830e72b8">CanAttack</a>(target)) <span class="comment">// can attack</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;                                    <span class="keywordflow">if</span> ((!<a class="code" href="SpellMgr_8h.html#afa7b10fb48285a79d754be9a11a6b30a">IsPositiveEffectMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, ihit.effectMask, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, target)</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;                                        &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac771f494288eae7dfad53907ec0fd7e3">IsVisibleForOrDetect</a>(target, target, <span class="keyword">false</span>)</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;                                        &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a618359e05114a5682c9205d03a70f5bd">CanEnterCombat</a>() &amp;&amp; target-&gt;CanEnterCombat())) <span class="comment">// can see and enter combat</span></div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;                                    {</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;                                        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a952ba21efc9b49995494c485733dabd8">SetInCombatWithVictim</a>(target);</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;                                        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a71a4aa9c406af1ebf0c0eb7d77db04f6">GetCombatManager</a>().<a class="code" href="classCombatManager.html#af07085c25f35ca9e97119b313810e433">TriggerCombatTimer</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(ihit.timeDelay + 500));</div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;                                    }</div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;                            }</div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;                        }</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;                    }</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;                }</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;            }</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;        }</div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160; </div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;        <span class="comment">// on spell cast end proc,</span></div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;        <span class="comment">// critical hit related part is currently done on hit so proc there,</span></div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;        <span class="comment">// 0 damage since any damage based procs should be on hit</span></div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;        <span class="comment">// 0 victim proc since there is no victim proc dependent on successfull cast for caster</span></div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;        <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, procTarget, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceaa0c2a4e7377d6217e94cc8fc7c77b5b2">PROC_EX_NORMAL_HIT</a>, 0, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea368fb0746e60a288bf2d28cd0002b30f">PROC_EX_CAST_END</a>, 0, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>));</div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;    }</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;    {</div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;        <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, procTarget, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceaa0c2a4e7377d6217e94cc8fc7c77b5b2">PROC_EX_NORMAL_HIT</a>, 0, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea368fb0746e60a288bf2d28cd0002b30f">PROC_EX_CAST_END</a>, 0, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>));</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160; </div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;        <span class="comment">// Immediate spell, no big deal</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;        <a class="code" href="classSpell.html#a323570cf86a1b20a8e64a9db971cab8c">handle_immediate</a>();</div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;    }</div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160; </div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a30575160f50527439663406d3fa3991e">DecreaseCastCounter</a>();</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    <a class="code" href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">SetExecutedCurrently</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;}</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160; </div>
<div class="line"><a name="l03817"></a><span class="lineno"><a class="line" href="classSpell.html#a323570cf86a1b20a8e64a9db971cab8c"> 3817</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a323570cf86a1b20a8e64a9db971cab8c">Spell::handle_immediate</a>()</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;{</div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    <span class="comment">// AOE caps implementation - only works for non-travelling spells</span></div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;    <a class="code" href="classSpell.html#a20e082dbb8f2742409b11338bd65b025">ProcessAOECaps</a>();</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160; </div>
<div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;        <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ihit);</div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160; </div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#aed136ecf494e152f6953aac8db6cdf4c">m_uniqueCorpseTargetInfo</a>)</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;        <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ihit);</div>
<div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160; </div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>)</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;        <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ihit);</div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160; </div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;    <span class="comment">// spell is finished, perform some last features of the spell here</span></div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;    <a class="code" href="classSpell.html#a4678d2bf3013f3bef4c29e6b11245b3c">_handle_finish_phase</a>();</div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160; </div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> != <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>)</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;        <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>();                                       <span class="comment">// successfully finish spell cast (not last in case autorepeat or channel spell)</span></div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;}</div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160; </div>
<div class="line"><a name="l03838"></a><span class="lineno"><a class="line" href="classSpell.html#a98e6d38fef38925272ed77fae54903b2"> 3838</a></span>&#160;<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <a class="code" href="classSpell.html#a98e6d38fef38925272ed77fae54903b2">Spell::handle_delayed</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> t_offset)</div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;{</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;    <a class="code" href="classSpellModRAII.html">SpellModRAII</a> spellModController(<span class="keyword">this</span>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160; </div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;    <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> next_time = 0;</div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160; </div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#ad9dbe39bea859de7b9a6b3e1efa060dd">effectMaskProcessed</a> != <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">effectMask</a>)</div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;    {</div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">timeDelay</a> &lt;= t_offset)</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;            <a class="code" href="classSpell.html#a1f60430046b242448bfe6509aa1e333d">DoAllTargetlessEffects</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_time == 0 || <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">timeDelay</a> &lt; next_time)</div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;            next_time = <a class="code" href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">m_destTargetInfo</a>.<a class="code" href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">timeDelay</a>;</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;    }</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160; </div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;    <span class="comment">// now recheck units targeting correctness (need before any effects apply to prevent adding immunity at first effect not allow apply second spell effect and similar cases)</span></div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    {</div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;        <span class="keywordflow">if</span> (!ihit.processed)</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;        {</div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;            <span class="keywordflow">if</span> (ihit.timeDelay &lt;= t_offset)</div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;            {</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;                <span class="keywordflow">if</span> (ihit.procReflect)</div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;                {</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;                    ihit.timeDelay = ihit.initialDelay / 2; <span class="comment">// return it at twice the speed</span></div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;                    ihit.procReflect = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;                    <a class="code" href="classSpell.html#a1f5dac6a66009db412f1a37b7e7b6c7e">ProcReflectProcs</a>(ihit);</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;                    <span class="keywordflow">if</span> (next_time == 0 || ihit.timeDelay &lt; next_time)</div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;                        next_time = ihit.timeDelay;</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;                }</div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;                    <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ihit);</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;            }</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_time == 0 || ihit.timeDelay &lt; next_time)</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;                next_time = ihit.timeDelay;</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;        }</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;    }</div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160; </div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;    <span class="comment">// now recheck gameobject targeting correctness</span></div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ighit : <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>)</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;    {</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;        <span class="keywordflow">if</span> (!ighit.processed)</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;        {</div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;            <span class="keywordflow">if</span> (ighit.timeDelay &lt;= t_offset)</div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;                <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ighit);</div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (next_time == 0 || ighit.timeDelay &lt; next_time)</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;                next_time = ighit.timeDelay;</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;        }</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;    }</div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;    <span class="comment">// All targets passed - need finish phase</span></div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;    <span class="keywordflow">if</span> (next_time == 0)</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;    {</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;        <span class="comment">// spell is finished, perform some last features of the spell here</span></div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;        <a class="code" href="classSpell.html#a4678d2bf3013f3bef4c29e6b11245b3c">_handle_finish_phase</a>();</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160; </div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;        <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>();                                       <span class="comment">// successfully finish spell cast</span></div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160; </div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;        <span class="comment">// return zero, spell is finished now</span></div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;    }</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;    <span class="comment">// spell is unfinished, return next execution time</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;    <span class="keywordflow">return</span> next_time;</div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;}</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160; </div>
<div class="line"><a name="l03901"></a><span class="lineno"><a class="line" href="classSpell.html#a7e2f06d9f8d074db174bce10f2c5165e"> 3901</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a7e2f06d9f8d074db174bce10f2c5165e">Spell::_handle_immediate_phase</a>()</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;{</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;    <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aaf3ec0c7a0bbd78bc7ee9137522143073">SPELL_STATE_LANDING</a>;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160; </div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a477d202997ee1650e937c3b6804f93e1">IsMeleeAttackResetSpell</a>() &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a14ffa28e0a73efac742dceb71e7cc731">SPELL_ATTR_EX7_RESET_SWING_TIMER_AT_SPELL_START</a>))</div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    {</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a6e293fbb4665079fb8b3aa753018f66c">SPELL_ATTR_EX6_DOESNT_RESET_SWING_TIMER_IF_INSTANT</a>) || <a class="code" href="classSpell.html#a5fd7b2fa3f7559c425c367852e187846">GetCastTime</a>() != 0)</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;        {</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a81ca961d68c744b94e14d93303f3eb22">SPELL_ATTR_EX2_DO_NOT_RESET_COMBAT_TIMERS</a>))</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;            {</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae7f942c448b14628617639978bf6bd00">resetAttackTimer</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>);</div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a8c4f494ad07fd452587995799a295199">hasOffhandWeaponForAttack</a>())</div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae7f942c448b14628617639978bf6bd00">resetAttackTimer</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a>);</div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;            }</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;        }</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;    }</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160; </div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;    <span class="comment">// handle some immediate features of the spell here</span></div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;    <a class="code" href="classSpell.html#a68b7071f7708ddf46cb20e2e76e414ad">HandleThreatSpells</a>();</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160; </div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;    <span class="comment">// handle none targeted effects</span></div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;    <a class="code" href="classSpell.html#a1f60430046b242448bfe6509aa1e333d">DoAllTargetlessEffects</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160; </div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;    <span class="comment">// process items</span></div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a4ba53019f02abcaff8db6e21aaf4a78e">m_UniqueItemInfo</a>)</div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;        <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ihit);</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160; </div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    <span class="comment">// take cast item after processing items</span></div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;    <a class="code" href="classSpell.html#ad827f88458117266b82decb339b9ff88">TakeCastItem</a>();</div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160; </div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;    <span class="comment">// fill initial spell damage from caster for immediate effects</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;        <a class="code" href="classSpell.html#af181a3684cada28607db5b669cb05365">HandleImmediateEffectExecution</a>(&amp;ihit);</div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160; </div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    <span class="comment">// process self immediately</span></div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    {</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;        <span class="keywordflow">if</span> (ihit.targetGUID == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;        {</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;            <a class="code" href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">DoAllEffectOnTarget</a>(&amp;ihit);</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;        }</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;    }</div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160; </div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    <span class="comment">// must be after self</span></div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a5003eeaba08c841f12b72a3010420eec">IsDelayedSpell</a>())</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;        <a class="code" href="classSpell.html#a1f60430046b242448bfe6509aa1e333d">DoAllTargetlessEffects</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160; </div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <a class="code" href="classSpell.html#abe41422e439fe882c04760475e3c3072">ProcSpellAuraTriggers</a>();</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160; </div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;    <span class="comment">// start channeling if applicable (after _handle_immediate_phase for get persistent effect dynamic object for channel target</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; <a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a>)</div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    {</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;        <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>;</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;        <a class="code" href="classSpell.html#a1efb9631f004c31d06b0552c2edbc10f">SendChannelStart</a>(<a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a>);</div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    }</div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;}</div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160; </div>
<div class="line"><a name="l03959"></a><span class="lineno"><a class="line" href="classSpell.html#a4678d2bf3013f3bef4c29e6b11245b3c"> 3959</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a4678d2bf3013f3bef4c29e6b11245b3c">Spell::_handle_finish_phase</a>()</div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;{</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;    <span class="comment">// spell log</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#af880d166ee53ab6614c4bd885fa6e466">m_needSpellLog</a>)</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;        <a class="code" href="classSpell.html#ab226199131a3f1c8ce11239ac01c3617">m_spellLog</a>.<a class="code" href="classSpellLog.html#a234368e990a795b9af41ba158e4d9db4">SendToSet</a>();</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160; </div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a73967a331de4701d8202f10fce96550b">m_extraAttacks</a> &amp;&amp; <a class="code" href="SpellMgr_8h.html#af992734f80d9f691f34ebc42ffdbae93">IsSpellHaveEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a8505f4858ac2e4cdcf252b949f082c36">SPELL_EFFECT_ADD_EXTRA_ATTACKS</a>))</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    {</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">GetVictim</a>())</div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a3ab5e0391df86f60b87c859c3ae64526">DoExtraAttacks</a>(target);</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a73967a331de4701d8202f10fce96550b">m_extraAttacks</a> = 0;</div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;    }</div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;}</div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160; </div>
<div class="line"><a name="l03974"></a><span class="lineno"><a class="line" href="classSpell.html#a20e082dbb8f2742409b11338bd65b025"> 3974</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a20e082dbb8f2742409b11338bd65b025">Spell::ProcessAOECaps</a>()</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;{</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a325173c0e664945846d1f4c1e858c20bab9f5044522a05a5a5a25d8371a868149">SPELL_ATTR_SS_AOE_CAP</a>))</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160; </div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i;</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abd12cbfc6a8daf7ca788d06a77256e01">SPELL_EFFECT_SCHOOL_DAMAGE</a>)</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160; </div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> aggregatedDamage = 0;</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 0;</div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;    {</div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;        <span class="keywordflow">if</span> (ihit.effectMask &amp; (1 &lt;&lt; i))</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;        {</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;            aggregatedDamage += ihit.damage;</div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;            ++count;</div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;        }</div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;    }</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160; </div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> value = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <span class="keyword">nullptr</span>, <span class="keyword">true</span>) * 10;</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(aggregatedDamage) &gt; value)</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;    {</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;            ihit.damage = (value / count);</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    }</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;}</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160; </div>
<div class="line"><a name="l04003"></a><span class="lineno"><a class="line" href="classSpell.html#a92c4c13e99061c50fcc9eccef232e0c8"> 4003</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a92c4c13e99061c50fcc9eccef232e0c8">Spell::SetCastItem</a>(<a class="code" href="classItem.html">Item</a>* item)</div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;{</div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;    <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> = item;</div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;    <span class="keywordflow">if</span> (item)</div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;        <a class="code" href="classSpell.html#a8159f0f9fef838bc5f506d3e6950e71c">m_itemCastSpell</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;}</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160; </div>
<div class="line"><a name="l04010"></a><span class="lineno"><a class="line" href="classSpell.html#a7e93f29ca09727fabcd6d4445029ca4a"> 4010</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a7e93f29ca09727fabcd6d4445029ca4a">Spell::SendSpellCooldown</a>()</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;{</div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordtype">bool</span> permanent = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a3c12174ecf9e1ff874ff49c83793e3b1">SPELL_ATTR_COOLDOWN_ON_EVENT</a>);</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;    {</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* casterPlayer = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> category = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac553667d97b29d8ad7e682d4c55e4263">Category</a>;</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;        {</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; spell : <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>)</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;            {</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;                <span class="keywordflow">if</span> (spell.SpellId == <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> &amp;&amp; spell.SpellCategory)</div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;                {</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;                    category = spell.SpellCategory;</div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;                }</div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;            }</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;        }</div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;        <span class="keywordflow">if</span> (category)</div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;        {</div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSpellCategoryEntry.html">SpellCategoryEntry</a> <span class="keyword">const</span>* categoryEntry = <a class="code" href="DBCStores_8cpp.html#a85005b81c129bd976cb43f44a9c0fa42">sSpellCategoryStore</a>.LookupEntry(category))</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;            {</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;                <span class="keywordflow">if</span> (categoryEntry-&gt;Flags &amp; <a class="code" href="SpellDefines_8h.html#aa0ddf79b3067038e8f35cecd153cef58ad974738974feec8a1f2cc2415159afbe">SPELL_CATEGORY_FLAG_EVENT_ON_LEAVE_COMBAT</a>)</div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;                {</div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;                    <span class="comment">// need in some way provided data for Spell::finish SendCooldownEvent</span></div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> &amp;&amp; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a624d681e272089b22f37cfe66b114dc1">IsPotion</a>())</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;                        casterPlayer-&gt;<a class="code" href="classPlayer.html#a6e31b8016173bc5f6f4e00279032a474">SetLastPotionId</a>(<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>());</div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160; </div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;                    permanent |= <span class="keyword">true</span>;</div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;                    casterPlayer-&gt;<a class="code" href="classPlayer.html#ae0022e08b3e294bf9baa7a1fea848504">SetCooldownEventOnLeaveCombatSpellId</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;                }</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;            }</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;        }</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160;    }</div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160; </div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;    <span class="comment">// (SPELL_ATTR_DISABLED_WHILE_ACTIVE) have infinity cooldown, (SPELL_ATTR_PASSIVE) passive cooldown at triggering</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a48c3c085b4868f5e7ff01b5f10da9050">SPELL_ATTR_PASSIVE</a>) || <a class="code" href="classSpell.html#afbeb295ad7652c0abf129066e76a4a10">m_channelOnly</a>)</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160; </div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a175245431183066010c97936d9d901d7">AddCooldown</a>(*<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> ? <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>() : <span class="keyword">nullptr</span>, permanent);</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;}</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160; </div>
<div class="line"><a name="l04052"></a><span class="lineno"><a class="line" href="classSpell.html#acc435ce7ca5fc0510122e720a6aea580"> 4052</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#acc435ce7ca5fc0510122e720a6aea580">Spell::update</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> difftime)</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;{</div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a9bbf21780bd930bcb9855935743bec2f">m_updated</a>)</div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;    {</div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;        <a class="code" href="classSpell.html#a9bbf21780bd930bcb9855935743bec2f">m_updated</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a566fd7627f0840d8a2cc69fbdc9d4c25">m_creationTime</a> == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a753346ed8fd6a52a17aa1bccb0652990">GetCurrentMSTime</a>()) <span class="comment">// do not update in the same tick as created</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;    }</div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160; </div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;    <span class="comment">// update pointers based at it&#39;s GUIDs</span></div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;    <a class="code" href="classSpell.html#a00dbf3e8c4ec3aa165e7bddb7cfeecd8">UpdatePointers</a>();</div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160; </div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>() &amp;&amp; !<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;    {</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;        <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;    }</div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160; </div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;    <span class="comment">// check if the player or unit caster has moved before the spell finished (exclude casting on vehicles)</span></div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>() &amp;&amp; <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> != 0) &amp;&amp;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;            (<a class="code" href="classSpell.html#a72d630ee8147b4197d46503dd2c9ed34">m_castPositionX</a> != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>() || <a class="code" href="classSpell.html#a7a1b42fb496a662f928a3f3f2e738bcc">m_castPositionY</a> != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>() || <a class="code" href="classSpell.html#a5e4e64d34f282231e10ec16596700432">m_castPositionZ</a> != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>()) &amp;&amp;</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;            (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] != <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a39bbbdfde62217be6a4d4166366aca56">SPELL_EFFECT_STUCK</a> || !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ad7f9a1627d3568f34c381027145f39ee">m_movementInfo</a>.<a class="code" href="classMovementInfo.html#af0b95ddc9ba7d602a37c310fea0bda18">HasMovementFlag</a>(<a class="code" href="Object_8h.html#a083358a25d084fb928e170c453128f9da139108986e314c8c0a315acb06760742">MOVEFLAG_FALLINGFAR</a>)))</div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;    {</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;        <span class="comment">// always cancel for channeled spells</span></div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>)</div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;        {</div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a8e36fc5d26dd251ab1169ac80c68c80d">ChannelInterruptFlags</a> &amp; <a class="code" href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a5de74105b5a79acfa17c7d9db359de38">AURA_INTERRUPT_FLAG_MOVING</a> &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734aecac7642facd23e9417444b47534355b">SPELL_ATTR_EX5_ALLOW_ACTIONS_DURING_CHANNEL</a>))</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;                <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;        }            </div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;        <span class="comment">// don&#39;t cancel for melee, autorepeat, triggered and instant spells</span></div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>() &amp;&amp; !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a5dc75f632a583e7d59c9fd780d939246">InterruptFlags</a> &amp; <a class="code" href="SpellDefines_8h.html#abadf2f982fd866917c372d16ab99c109a986dc87f6033e6ccfb4510dfdb0f41fd">SPELL_INTERRUPT_FLAG_MOVEMENT</a>))</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;            <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;    }</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160; </div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a>)</div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;    {</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aae175109189bc7f989a42de7f088cb6fa">SPELL_STATE_CASTING</a>:</div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;        {</div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>)</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;            {</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;                <span class="keywordflow">if</span> (difftime &gt;= <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>)</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;                    <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> = 0;</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;                    <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> -= difftime;</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;            }</div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160; </div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> == 0 &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>())</div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;                <a class="code" href="classSpell.html#a0af004d00c37bf3849719452e2b9deaa">cast</a>();</div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>:</div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;        {</div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> &gt; 0)</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;            {</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>())</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;                {</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;                    <span class="comment">// check if player has jumped before the channeling finished</span></div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ad7f9a1627d3568f34c381027145f39ee">m_movementInfo</a>.<a class="code" href="classMovementInfo.html#af0b95ddc9ba7d602a37c310fea0bda18">HasMovementFlag</a>(<a class="code" href="Object_8h.html#a083358a25d084fb928e170c453128f9daf7b99f828aa60b4dea8dd12382e5b8e6">MOVEFLAG_FALLING</a>))</div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;                        <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160; </div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;                    <span class="comment">// check for incapacitating player states</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aec7a5e4c0b6c77a57a2fb20b2c96ceb6">IsCrowdControlled</a>())</div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;                    {</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;                        <span class="comment">// certain channel spells are not interrupted</span></div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a4d92db4bb064cb51ad9716a543a720cf">SPELL_ATTR_EX_IS_CHANNELED</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34eaac5b3a2eda0f211532c20f52e02454ae">SPELL_ATTR_EX3_IGNORE_CASTER_AND_TARGET_RESTRICTIONS</a>))</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;                            <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;                    }</div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160; </div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a5bbf6c6c2171512553c182a2f1946a06">SPELL_ATTR_EX2_SPECIAL_TAMING_FLAG</a>)) <span class="comment">// these fail on lost target attention (aggro)</span></div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;                    {</div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>()))</div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;                        {</div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;                            <a class="code" href="classUnit.html">Unit</a>* targetsTarget = target-&gt;<a class="code" href="classUnit.html#afc3c9a652f2026707440d4e8bdd87930">GetTarget</a>();</div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;                            <span class="keywordflow">if</span> (targetsTarget &amp;&amp; targetsTarget != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;                                <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;                        }</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                    }</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160; </div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a773f4c5cfef9eb087607ad1414706532">SPELL_ATTR_EX_TRACK_TARGET_IN_CHANNEL</a>) &amp;&amp; <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin() != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end())</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;                    {</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>())</div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;                        {</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;                            <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;                            {</div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;                                <span class="keywordtype">float</span> orientation = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a7c15606be3c15a33c98032fe4d190379">GetAngle</a>(target);</div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;                                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5861302a7c0e64113cfc5bc6d5660fa4">IsClientControlled</a>())</div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;                                {</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;                                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a14343f33471333537df2c5ad4815d880">SetOrientation</a>(orientation);</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;                                    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a15935c3f574e8b3e72952561c75e6faf">SetFacingTo</a>(orientation);</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;                                }</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                                <a class="code" href="classSpell.html#a7bdeaabf8fa127e4269e683c2bd76499">m_castOrientation</a> = orientation; <span class="comment">// need to update cast orientation due to the attribute</span></div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;                            }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;                        }</div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;                    }</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160; </div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;                    <span class="comment">// check if player has turned if flag is set</span></div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a8e36fc5d26dd251ab1169ac80c68c80d">ChannelInterruptFlags</a> &amp; <a class="code" href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a7ff7b6e5eb8b89e335cbed2efcc61ec3">AURA_INTERRUPT_FLAG_TURNING</a>)</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                    {</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>())</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;                        {</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>:</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a7bdeaabf8fa127e4269e683c2bd76499">m_castOrientation</a> != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>())</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;                                    <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>:</div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;                            {</div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;                                <span class="keywordtype">float</span> targetOrientationDiff = 0.10f; <span class="comment">// Diff due to client server mismatch</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a773f4c5cfef9eb087607ad1414706532">SPELL_ATTR_EX_TRACK_TARGET_IN_CHANNEL</a>)) <span class="comment">// On start, client turns player to face object, need leeway so that we dont break unnecessarily</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;                                    targetOrientationDiff += <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> * (std::max(1200 - (<a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a> - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>)), 0) / 1200.f);</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;                                <span class="keywordflow">if</span> ((<a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> - std::abs(std::abs(<a class="code" href="classSpell.html#a7bdeaabf8fa127e4269e683c2bd76499">m_castOrientation</a> - <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">GetOrientation</a>()) - <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a>)) &gt; targetOrientationDiff)</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;                                    <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;                            }</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                        }</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;                    }</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160; </div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;                    <span class="comment">// need check distance for channeled target only - but only when its set</span></div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a1eccb88ab5fe5367817bcbbdbb368b81">m_maxRange</a> &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6d62b1278097a22ea1ac17edf8b3203e">HasChannelObject</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()))</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;                    {</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* channelTarget = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>())</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;                        {</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0fb2dd50d97003331ae785f47767823d">IsWithinCombatDistInMap</a>(channelTarget, <a class="code" href="classSpell.html#a1eccb88ab5fe5367817bcbbdbb368b81">m_maxRange</a> * 1.5f))</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;                            {</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;                                <a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;                            }</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;                        }</div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;                    }</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;                }</div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160; </div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;                <span class="comment">// check if there are alive targets left</span></div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a389780258153b86d112f9628100d419a">IsAliveUnitPresentInTargetList</a>())</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;                {</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;                    <a class="code" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">SendChannelUpdate</a>(0);</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;                    <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>();</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;                }</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160; </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;                <span class="keywordflow">if</span> (difftime &gt;= <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>)</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;                    <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> = 0;</div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;                    <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> -= difftime;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;            }</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160; </div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> == 0)</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;            {</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;                <a class="code" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">SendChannelUpdate</a>(0, difftime);</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160; </div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;                <span class="comment">// channeled spell processed independently for quest targeting</span></div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;                <span class="comment">// cast at creature (or GO) quest objectives update at successful cast channel finished</span></div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;                <span class="comment">// ignore autorepeat/melee casts for speed (not exist quest for spells (hm... )</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>() &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;                {</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* p = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>())</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;                    {</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;                        <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;                        {</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;                            <a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a> <span class="keyword">const</span>&amp; target = *ihit;</div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;                            <span class="keywordflow">if</span> (!target.<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a>.<a class="code" href="classObjectGuid.html#ade14ec1d80126d20f64db8f9adaf0ef8">IsCreatureOrVehicle</a>())</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160; </div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;                            <a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == target.<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a> ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, target.<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a>);</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;                            <span class="keywordflow">if</span> (unit == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160; </div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                            p-&gt;RewardPlayerAndGroupAtCast(unit, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;                        }</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160; </div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;                        <span class="keywordflow">for</span> (GOTargetList::const_iterator ihit = <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;                        {</div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;                            <a class="code" href="structSpell_1_1GOTargetInfo.html">GOTargetInfo</a> <span class="keyword">const</span>&amp; target = *ihit;</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160; </div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;                            <a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(target.<a class="code" href="structSpell_1_1GOTargetInfo.html#a619f98bf094d2667048204f733d64d0c">targetGUID</a>);</div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;                            <span class="keywordflow">if</span> (!go)</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160; </div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                            p-&gt;RewardPlayerAndGroupAtCast(go, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                        }</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;                    }</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;                }</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160; </div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">GetSpellSpeed</a>() &gt; 0.0f)</div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;                {</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;                    <span class="comment">// Okay, maps created, now prepare flags</span></div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;                    <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a>;</div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;                    <a class="code" href="classSpell.html#a9572cd3b12252c7c177b0f6151a1c57b">SetDelayStart</a>(0);</div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;                    <a class="code" href="classSpell.html#a49eda4ec0b6d63e0a4f54b67aff5549b">SetSpellStartTravelling</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a753346ed8fd6a52a17aa1bccb0652990">GetCurrentMSTime</a>());</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                }</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;                    <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>();</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;            }</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;        {</div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    }</div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;}</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160; </div>
<div class="line"><a name="l04246"></a><span class="lineno"><a class="line" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6"> 4246</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">Spell::finish</a>(<span class="keywordtype">bool</span> ok)</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;{</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160; </div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>)</div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160; </div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;    <span class="keywordtype">bool</span> channeledChannel = <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;    <a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> = <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160; </div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a8425d18c430e7f6f47cc66f8576b62df">m_notifyAI</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>())</div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a3dc9c4944fab218d9a215df9dbb7fa35">OnSpellCastStateChange</a>(<span class="keyword">this</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160; </div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;    <span class="comment">// other code related only to successfully finished spells</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;    <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160; </div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;    <span class="comment">// Heal caster for all health leech from all targets</span></div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aeea292e4bbbeb073f624dabda6420903">m_healthLeech</a>)</div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    {</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> absorb = 0;</div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a3d16a6eaa62aaad0ea31a39230b044eb">CalculateHealAbsorb</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#aeea292e4bbbeb073f624dabda6420903">m_healthLeech</a>), &amp;absorb);</div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aa995aca7e6fe95e51400b6e8ec550837">DealHeal</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#aeea292e4bbbeb073f624dabda6420903">m_healthLeech</a>) - absorb, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">false</span>, absorb);</div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    }</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160; </div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a9255c95e4790afbc6f750c9af860114a">SPELL_ATTR_EX_DISCOUNT_POWER_ON_MISS</a>) || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ab5f4362a2cdc7da05c8c28e80c5e13b7">SPELL_ATTR_EX_FINISHING_MOVE_DAMAGE</a>))</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    {</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;        <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;        {</div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;            <span class="keywordtype">bool</span> end = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;            <span class="keywordflow">switch</span> (ihit-&gt;missCondition)</div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;            {</div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa92c5d2d6d9802d16764163ddfc01c364">SPELL_MISS_MISS</a>:</div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa3d25ac2e6bf2195d7f10f70d1c07c809">SPELL_MISS_DODGE</a>:</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa1c71c106427627a9403f8a338e929d27">SPELL_MISS_PARRY</a>:</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aafcddc76d7d93f87266de9113d8402150">SPELL_MISS_DEFLECT</a>:</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;                {</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;                    <span class="keywordtype">float</span> coeff = 0.8f;</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ab5f4362a2cdc7da05c8c28e80c5e13b7">SPELL_ATTR_EX_FINISHING_MOVE_DAMAGE</a>)) <span class="comment">// optimization in wotlk because no other utilize it</span></div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;                    {</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;                        coeff = 1;</div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>())</div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;                            modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a7251c33da097f1bf91b7b55df34c42cc">SPELLMOD_SPELL_COST_REFUND_ON_FAIL</a>, coeff);</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;                        coeff = 1 - coeff;</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;                    }</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                    <span class="keywordflow">if</span> (coeff &gt; 0)</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6591e720a2cfa309b6d693231b1fdbc0">ModifyPower</a>(<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>), <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<span class="keywordtype">float</span>(<a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a>) * coeff));</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;                    end = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;                }</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;            }</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;            <span class="keywordflow">if</span> (end)</div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;        }</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;    }</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160; </div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;    <a class="code" href="classSpell.html#af93fc378bb91e3d416c59835b3760d3d">OnSuccessfulFinish</a>();</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160; </div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;    <span class="comment">// Clear combo at finish state</span></div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; <a class="code" href="SpellMgr_8h.html#a1283f17a75d0faa251cb81d1b847c24a">NeedsComboPoints</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;    {</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;        <span class="comment">// Not drop combopoints if negative spell and if any miss on enemy exist</span></div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;        <span class="keywordtype">bool</span> needDrop = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#aa48055df917f805e2ef4b8e56f78cc93">IsPositiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;        {</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;            <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;            {</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;                <span class="keywordflow">if</span> (ihit-&gt;missCondition != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a> &amp;&amp; ihit-&gt;targetGUID != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;                {</div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;                    needDrop = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;                }</div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;            }</div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;        }</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;        <span class="keywordflow">if</span> (needDrop)</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a3fc13158f07e653acbf26ac015e9c248">ClearComboPoints</a>();</div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    }</div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160; </div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;    <span class="comment">// potions disabled by client, send event &quot;not in combat&quot; if need</span></div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;UpdatePotionCooldown(<span class="keyword">this</span>);</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160; </div>
<div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;    <span class="comment">// call triggered spell only at successful cast (after clear combo points -&gt; for add some if need)</span></div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#ab74dcb259c27daf0a123cc30049d1b37">m_TriggerSpells</a>.empty())</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;        <a class="code" href="classSpell.html#a704cd4f425ebf48be2bed2fd22b22571">CastTriggerSpells</a>();</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160; </div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;    <span class="comment">// Stop Attack for some spells</span></div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a63e2ffc5cf25a1bd13bae9a3f99a181a">SPELL_ATTR_CANCELS_AUTO_ATTACK_COMBAT</a>))</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;    {</div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ae13ca73b08aafc7636ee0449c186b0ab">IsRangedSpell</a>()) <span class="comment">// blizzlike order</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac02ccd551f5a7a64d197ceecfc3b3eee">InterruptSpell</a>(<a class="code" href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1faf4d9017fa01b68842e61b948323e93c1">CURRENT_AUTOREPEAT_SPELL</a>);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160; </div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a13049af5fc1e99bf71e9a6c5a04cf10e">AttackStop</a>();</div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160; </div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5861302a7c0e64113cfc5bc6d5660fa4">IsClientControlled</a>())</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;            <span class="keyword">const_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae014a899d063f9eeb155e59a29e5c8b9">GetClientControlling</a>())-&gt;SendAttackSwingCancelAttack();</div>
<div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;    }</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160; </div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;    <span class="comment">// update encounter state if needed</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>()) <span class="comment">// some teleport spells put caster in between maps, need to check</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    {</div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;        <a class="code" href="classMap.html">Map</a>* map = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>();</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;        <span class="keywordflow">if</span> (map-&gt;<a class="code" href="classMap.html#a0c80d50b012dc8d560e256201970f3b3">IsDungeon</a>())</div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;            ((<a class="code" href="classDungeonMap.html">DungeonMap</a>*)map)-&gt;GetPersistanceState()-&gt;UpdateEncounterState(<a class="code" href="SharedDefines_8h.html#a0b496ae912a68ca7a6f8fd555cf62437aca618c5b7ae69c151ea4da7955578b02">ENCOUNTER_CREDIT_CAST_SPELL</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    }</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;}</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160; </div>
<div class="line"><a name="l04356"></a><span class="lineno"><a class="line" href="classSpell.html#a946c99674b343f372d7489f8da442267"> 4356</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">Spell::SendCastResult</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result)<span class="keyword"> const</span></div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>) <span class="comment">// should not report these</span></div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160; </div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;    <a class="code" href="classPlayer.html">Player</a> <span class="keyword">const</span>* recipient;</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;    {</div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a08f2d24b9c2b77d5638a8f7d8aa4d4a1">m_petCast</a>)</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;        {</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;            <a class="code" href="classPlayer.html">Player</a> <span class="keyword">const</span>* master = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6535c9c8175652b8497b1615147636ac">GetControllingPlayer</a>();</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;            <span class="keywordflow">if</span> (!master)</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160; </div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;            recipient = master;</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;        }</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    }</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;        recipient = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160; </div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a76a9a8e0d3fe43183e01de34214f31f7">SPELL_ATTR_EX7_REPORT_SPELL_FAILURE_TO_UNIT_TARGET</a>))</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;            <span class="keywordflow">if</span> (target-&gt;IsPlayer())</div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;                recipient = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target);</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160; </div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;    <span class="keywordflow">if</span> (recipient-&gt;<a class="code" href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">GetSession</a>()-&gt;<a class="code" href="classWorldSession.html#a6518fa6d76b730689eb44f2256af3726">PlayerLoading</a>()) <span class="comment">// don&#39;t send cast results at loading time</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160; </div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> param1 = <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a>, param2 = <a class="code" href="classSpell.html#a654c6400b8537dd520231fe998080855">m_param2</a>;</div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a9b65eb8aa8619909c395167731696193">m_spellScript</a>)</div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;        <a class="code" href="classSpell.html#a9b65eb8aa8619909c395167731696193">m_spellScript</a>-&gt;<a class="code" href="structSpellScript.html#acdfff6b3d3675c5234e3c9bfa939a6fa">OnSpellCastResultOverride</a>(result, param1, param2);</div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;    <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(recipient, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a>, result, <a class="code" href="classSpell.html#a08f2d24b9c2b77d5638a8f7d8aa4d4a1">m_petCast</a>, param1, param2);</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;}</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160; </div>
<div class="line"><a name="l04392"></a><span class="lineno"><a class="line" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d"> 4392</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">Spell::SendCastResult</a>(<a class="code" href="classPlayer.html">Player</a> <span class="keyword">const</span>* caster, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellInfo, <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> cast_count, <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result, <span class="keywordtype">bool</span> isPetCastResult <span class="comment">/*=false*/</span>, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> param1 <span class="comment">/*=0*/</span>, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> param2 <span class="comment">/*=0*/</span>)</div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;{</div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    <span class="keywordflow">if</span> (result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160; </div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801af942d225af4211007c4da68ddbce6857">SPELL_ATTR_EX2_DO_NOT_REPORT_SPELL_FAILURE</a>))</div>
<div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;        result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160; </div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(isPetCastResult ? <a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacad959b31adf2335af92f9a58c7240f305">SMSG_PET_CAST_FAILED</a> : <a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacaa825dfa6e5caf5277b9061d1d89b2c5e">SMSG_CAST_RESULT</a>, (4 + 1 + 2));</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(cast_count);                              <span class="comment">// single cast or multi 2.3 (0/1)</span></div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(!<a class="code" href="SpellMgr_8cpp.html#a28b958e9db34bdad035df1f81ed2a280">IsPassiveSpell</a>(spellInfo) ? result : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>); <span class="comment">// do not report failed passive spells</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;    <span class="keywordflow">switch</span> (result)</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;    {</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba8b8a8978f57575bd089e2da378bf03ad">SPELL_FAILED_NOT_READY</a>:</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;            <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a3c12174ecf9e1ff874ff49c83793e3b1">SPELL_ATTR_COOLDOWN_ON_EVENT</a>))</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(caster-&gt;<a class="code" href="classWorldObject.html#ac3a9048da8804951dcf3f639f4c957c5">IsSpellOnPermanentCooldown</a>(*spellInfo));</div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf43ad3199e8e395f348d768f4f11b39c">SPELL_FAILED_REQUIRES_SPELL_FOCUS</a>:</div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa8df07a2ebac695b4e72f5db374a451e">RequiresSpellFocus</a>);  <span class="comment">// SpellFocusObject.dbc id</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf8d707921901db4647124ccbc08dc83c">SPELL_FAILED_REQUIRES_AREA</a>:</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;            <span class="comment">// hardcode areas limitation case</span></div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;            <span class="keywordflow">switch</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;            {</div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;                <span class="keywordflow">case</span> 41617:                                 <span class="comment">// Cenarion Mana Salve</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;                <span class="keywordflow">case</span> 41619:                                 <span class="comment">// Cenarion Healing Salve</span></div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(3905);</div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;                <span class="keywordflow">case</span> 41618:                                 <span class="comment">// Bottled Nethergon Energy</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;                <span class="keywordflow">case</span> 41620:                                 <span class="comment">// Bottled Nethergon Vapor</span></div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(3842);</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;                <span class="keywordflow">case</span> 45373:                                 <span class="comment">// Bloodberry Elixir</span></div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(4075);</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;                <span class="keywordflow">default</span>:                                    <span class="comment">// default case (don&#39;t must be)</span></div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;            }</div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba85507d5434460a32675c0e5601110d3f">SPELL_FAILED_TOTEMS</a>:</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : spellInfo-&gt;<a class="code" href="structSpellEntry.html#a3d7ab889f71d22afbfb78329c4bb0f16">Totem</a>)</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;                <span class="keywordflow">if</span> (i)</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(i);    <span class="comment">// client needs only one id, not 2...</span></div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf5c8961a3681a64ace4b65bd9927d31a">SPELL_FAILED_TOTEM_CATEGORY</a>:</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : spellInfo-&gt;<a class="code" href="structSpellEntry.html#afd59039a969e14a54f39a372a6541d0b">TotemCategory</a>)</div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;                <span class="keywordflow">if</span> (i)</div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;                    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(i);<span class="comment">// client needs only one id, not 2...</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba189024402cf4723fd717ba84cde101fa">SPELL_FAILED_EQUIPPED_ITEM_CLASS</a>:</div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaedcd1b6ac24138162134e6987ea74d5e">SPELL_FAILED_EQUIPPED_ITEM_CLASS_MAINHAND</a>:</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba145cdf9d18f777b5f93858ce52d27581">SPELL_FAILED_EQUIPPED_ITEM_CLASS_OFFHAND</a>:</div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#a2a1761914824472cbc7eb55293d1ff46">EquippedItemClass</a>);</div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa65895491d8fd7f44b5a86443c32f8be">EquippedItemSubClassMask</a>);</div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6ff414333f83deadfa05e6b4406af895">SPELL_FAILED_PREVENTED_BY_MECHANIC</a>:</div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;            data &lt;&lt; param1;                                 <span class="comment">// SpellMechanic.dbc id</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3edca33213e571cce6e1c1039ee33751">SPELL_FAILED_CUSTOM_ERROR</a>:</div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;            data &lt;&lt; param1;                                 <span class="comment">// custom error id (see enum SpellCastResultCustom)</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba02f640e1a5bbadb65809043082d521e9">SPELL_FAILED_NEED_EXOTIC_AMMO</a>:</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa65895491d8fd7f44b5a86443c32f8be">EquippedItemSubClassMask</a>);<span class="comment">// seems correct...</span></div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa628da71e8ecb35003c937c46662d243">SPELL_FAILED_REAGENTS</a>:</div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;            data &lt;&lt; param1;                                 <span class="comment">// item id</span></div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad844177691a3eb714772f0bf8bf85bb6">SPELL_FAILED_NEED_MORE_ITEMS</a>:</div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;            data &lt;&lt; param1;</div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;            data &lt;&lt; param2;</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1e0deafa01f42a456c4f425717997989">SPELL_FAILED_MIN_SKILL</a>:</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                              <span class="comment">// SkillLine.dbc id</span></div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                              <span class="comment">// required skill value</span></div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac434f4f7f84bea20939be3067eb33c5f">SPELL_FAILED_TOO_MANY_OF_ITEM</a>:</div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;            data &lt;&lt; param1;                                 <span class="comment">// ItemLimitCategory.dbc id</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0c67457bbdc9de5c80ae6894f6129f90">SPELL_FAILED_FISHING_TOO_LOW</a>:</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                              <span class="comment">// required fishing skill</span></div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;    }</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;    caster-&gt;<a class="code" href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">GetSession</a>()-&gt;<a class="code" href="classWorldSession.html#a15a10b125d9f54c3945a3daf319b228f">SendPacket</a>(data);</div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;}</div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160; </div>
<div class="line"><a name="l04481"></a><span class="lineno"><a class="line" href="classSpell.html#a84132b0daaea7cd01095c64dce0ab385"> 4481</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a84132b0daaea7cd01095c64dce0ab385">Spell::SendSpellStart</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3ed06c7cdee02042bd42e23a21733bdd">IsNeedSendToClient</a>())</div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160; </div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;    <a class="code" href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Sending SMSG_SPELL_START id=%u&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160; </div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> castFlags = <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5af886177dd798d8295ddce2bfd2499d5b">CAST_FLAG_UNKNOWN2</a>;</div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> || <a class="code" href="classSpell.html#a9b11d1180294970c027d069197dd57c7">m_hideInCombatLog</a>)</div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a8980c27eb74f67451b1a58348b6583a2">CAST_FLAG_HIDDEN_COMBATLOG</a>;</div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160; </div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> schoolImmunityMask = 0;</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mechanicImmunityMask = 0;</div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>())</div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;    {</div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;        schoolImmunityMask = <span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetSchoolImmunityMask();</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;        mechanicImmunityMask = <span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetMechanicImmunityMask();</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;    }</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160; </div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;    <span class="keywordflow">if</span> (schoolImmunityMask || mechanicImmunityMask)</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5aeb6eabdc1379fa5bc61395a9ea1d29ab">CAST_FLAG_IMMUNITY</a>;</div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160; </div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a4d820016ef9a87e1742734b8d7b45dfa">IsSpellRequiringAmmo</a>())</div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a0c8ef953a07121a38ba7875e32720953">CAST_FLAG_AMMO</a>;</div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160; </div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#ae14122cf8c3c2468d64d5582e9574dfb">HasPersistentAuraEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a953c4436ce4e0d1ef72b926c51f8fd76">CAST_FLAG_PERSISTENT_AA</a>;</div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160; </div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0c3b77487bffa0d4e0da8e71cc7e5c4b">runeCostID</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ad2662f90ffd864b9483e8265c2cc08df">POWER_RUNE</a>)</div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a736df7bee6e7361d9637de90959f9169">CAST_FLAG_NO_GCD</a>; <span class="comment">// not needed, but B sends it</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160; </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>) &amp;&amp; (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() &gt; 0.0f))</div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a262d78c35fb74238ec4a1afdb28219db">CAST_FLAG_ADJUST_MISSILE</a>;              <span class="comment">// spell has trajectory</span></div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160; </div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacadcc6ea3886766911a099ffe2ea85b707">SMSG_SPELL_START</a>, (8 + 8 + 4 + 4 + 2));</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160; </div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>()) <span class="comment">// write empty guid if GO</span></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;        data &lt;&lt; <a class="code" href="classObjectGuid.html">ObjectGuid</a>().<a class="code" href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160; </div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a>);                            <span class="comment">// pending spell cast</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);                        <span class="comment">// spellId</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(castFlags);                              <span class="comment">// cast flags</span></div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>);                                <span class="comment">// delay?</span></div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160; </div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>;</div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160; </div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a0c8ef953a07121a38ba7875e32720953">CAST_FLAG_AMMO</a>)                         <span class="comment">// projectile info</span></div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;        <a class="code" href="classSpell.html#abd83294e164945d1a6af5c268f610da5">WriteAmmoToPacket</a>(data);</div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160; </div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5aeb6eabdc1379fa5bc61395a9ea1d29ab">CAST_FLAG_IMMUNITY</a>)                     <span class="comment">// cast immunity</span></div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;    {</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(schoolImmunityMask);                 <span class="comment">// used for SetCastSchoolImmunities</span></div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(mechanicImmunityMask);               <span class="comment">// used for SetCastImmunities</span></div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;    }</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160; </div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;}</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160; </div>
<div class="line"><a name="l04545"></a><span class="lineno"><a class="line" href="classSpell.html#a3244e8c8f24aa8fdaec7b236a9532724"> 4545</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a3244e8c8f24aa8fdaec7b236a9532724">Spell::SendSpellGo</a>()</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;{</div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    <span class="comment">// not send invisible spell casting</span></div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3ed06c7cdee02042bd42e23a21733bdd">IsNeedSendToClient</a>())</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160; </div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;    <a class="code" href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Sending SMSG_SPELL_GO id=%u&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160; </div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> castFlags = <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a04f23993f9ac92c42034f26148fae84a">CAST_FLAG_UNKNOWN9</a>;</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> || <a class="code" href="classSpell.html#a9b11d1180294970c027d069197dd57c7">m_hideInCombatLog</a>)</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a8980c27eb74f67451b1a58348b6583a2">CAST_FLAG_HIDDEN_COMBATLOG</a>;</div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160; </div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a4d820016ef9a87e1742734b8d7b45dfa">IsSpellRequiringAmmo</a>())</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a0c8ef953a07121a38ba7875e32720953">CAST_FLAG_AMMO</a>;                        <span class="comment">// arrows/bullets visual</span></div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160; </div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a392ab315fc9125f98dbd806ceaf711b0">CAST_FLAG_UNKNOWN7</a>;</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160; </div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() == <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058">CLASS_DEATH_KNIGHT</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0c3b77487bffa0d4e0da8e71cc7e5c4b">runeCostID</a>)</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;    {</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a736df7bee6e7361d9637de90959f9169">CAST_FLAG_NO_GCD</a>;                      <span class="comment">// same as in SMSG_SPELL_START</span></div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a2c68cf73413c91489ff4405cf2b49797">CAST_FLAG_PREDICTED_RUNES</a>;             <span class="comment">// rune cooldowns list</span></div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a25ea230a991929d0783ee73277ceeaa0">CAST_FLAG_PREDICTED_POWER</a>;</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;    }</div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160; </div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> != <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a>)</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a25ea230a991929d0783ee73277ceeaa0">CAST_FLAG_PREDICTED_POWER</a>;             <span class="comment">// all powerCost spells have this</span></div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160; </div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;    <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>) &amp;&amp; (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>() &gt; 0.0f))</div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a262d78c35fb74238ec4a1afdb28219db">CAST_FLAG_ADJUST_MISSILE</a>;              <span class="comment">// spell has trajectory</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160; </div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a80a913517752997715c466105d227ad1">StartRecoveryTime</a>)</div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;        castFlags |= <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a736df7bee6e7361d9637de90959f9169">CAST_FLAG_NO_GCD</a>;</div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160; </div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca8c842ffb79613ffdbd170f8022690027">SMSG_SPELL_GO</a>, 50);                    <span class="comment">// guess size</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160; </div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801ad5039b579aed0c0c6d07284fa29bfb10">SPELL_ATTR_EX2_RETAIN_ITEM_CAST</a>) &amp;&amp; <a class="code" href="classSpell.html#a0543a24550bc5092b4c2060430290d0f">m_forwardedCastItemGuid</a>)</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#a0543a24550bc5092b4c2060430290d0f">m_forwardedCastItemGuid</a>.<a class="code" href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160; </div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>()) <span class="comment">// write empty guid if GO</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;        data &lt;&lt; <a class="code" href="classObjectGuid.html">ObjectGuid</a>().<a class="code" href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">WriteAsPacked</a>();</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160; </div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a>);                            <span class="comment">// pending spell cast?</span></div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);                        <span class="comment">// spellId</span></div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(castFlags);                              <span class="comment">// cast flags</span></div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a753346ed8fd6a52a17aa1bccb0652990">GetCurrentMSTime</a>()); <span class="comment">// timestamp</span></div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160; </div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;    <a class="code" href="classSpell.html#ae21b0dbb08c6a06f834049d8407dfd8b">WriteSpellGoTargets</a>(data);</div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160; </div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>;</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160; </div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a25ea230a991929d0783ee73277ceeaa0">CAST_FLAG_PREDICTED_POWER</a>)              <span class="comment">// predicted power</span></div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ad7e475d80b9af430cc076d7c01f967e9">GetPower</a>((<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>)<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>));</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160; </div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a2c68cf73413c91489ff4405cf2b49797">CAST_FLAG_PREDICTED_RUNES</a>)              <span class="comment">// predicted runes</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;    {</div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> runeMaskInitial = <a class="code" href="classSpell.html#a99fe4ec78e157666a7fefdb8fce5342b">GetOldRuneState</a>();</div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> runeMaskAfterCast = <a class="code" href="classSpell.html#ac93ca9fa6252919df20e2467214fdec5">GetNewRuneState</a>();</div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(runeMaskInitial);                                  <span class="comment">// runes state before</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(runeMaskAfterCast);                                  <span class="comment">// runes state after</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="Player_8h.html#a2a50815668e7443f20a14ff3fa353db4">MAX_RUNES</a>; ++i)</div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;        {</div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;            <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> mask = (1 &lt;&lt; i);</div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;            <span class="keywordflow">if</span> (mask &amp; runeMaskInitial &amp;&amp; (!(mask &amp; runeMaskAfterCast))) <span class="comment">// usable before...but on cooldown now...</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;            {</div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;                <span class="comment">// float casts ensure the division is performed on floats as we need float result</span></div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;                <span class="keywordtype">float</span> baseCd = float(<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetRuneBaseCooldown(i));</div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>((baseCd - <span class="keywordtype">float</span>(<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetRuneCooldown(i))) / baseCd * 255);</div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;            }</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;        }</div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;    }</div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160; </div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a262d78c35fb74238ec4a1afdb28219db">CAST_FLAG_ADJUST_MISSILE</a>)               <span class="comment">// adjust missile trajectory duration</span></div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;    {</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;        data &lt;&lt; float(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#abccd1fec97295c282e888a31df1abe77">getElevation</a>());</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a>);</div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;    }</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160; </div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a0c8ef953a07121a38ba7875e32720953">CAST_FLAG_AMMO</a>)                         <span class="comment">// projectile info</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;        <a class="code" href="classSpell.html#abd83294e164945d1a6af5c268f610da5">WriteAmmoToPacket</a>(data);</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160; </div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;    <span class="keywordflow">if</span> (castFlags &amp; <a class="code" href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a20c95c624718076edc4b69e74aba3b69">CAST_FLAG_VISUAL_CHAIN</a>)                 <span class="comment">// spell visual chain effect</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;    {</div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                                  <span class="comment">// SpellVisual.dbc id?</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                                  <span class="comment">// overrides previous field if &gt; 0 and violencelevel client cvar &lt; 2</span></div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;    }</div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160; </div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;    <span class="keywordtype">bool</span> sendDestLoc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> destLocCounter = 0;</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;    {</div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;        sendDestLoc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;        destLocCounter = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#af64e9d16476e179813628d3bfda46059">GetDestLocCounter</a>();</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;        <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5ccf191b3f924cd6af5a03e84e8f38d3">IncrementDestLocCounter</a>();</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(destLocCounter);                                   <span class="comment">// The value increase for each time, can remind of a cast count for the spell</span></div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;    }</div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160; </div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa75b709f5c716c261658a88f578e15899">TARGET_FLAG_VISUAL_CHAIN</a>)  <span class="comment">// probably used (or can be used) with CAST_FLAG_VISUAL_CHAIN flag</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;    {</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);                                  <span class="comment">// count</span></div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160; </div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;        <span class="comment">// for(int = 0; i &lt; count; ++i)</span></div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;        <span class="comment">//{</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;        <span class="comment">//    // position and guid?</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;        <span class="comment">//    data &lt;&lt; float(0) &lt;&lt; float(0) &lt;&lt; float(0) &lt;&lt; uint64(0);</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;        <span class="comment">//}</span></div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;    }</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160; </div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;    <span class="keywordflow">if</span> (!sendDestLoc)</div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;        <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;    {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;        <a class="code" href="classWorldPacket.html">WorldPacket</a> destLocData(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca831df7c06a76c1d7d2ee0b93e4196bd8">SMSG_NOTIFY_DEST_LOC_SPELL_CAST</a>);</div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;        destLocData &lt;&lt; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;        destLocData &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a18f1ccb896d907c949744401f31d4780">getDestTransportGuid</a>();</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;        destLocData &lt;&lt; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>;</div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;        destLocData &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;        destLocData &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a> &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a> &lt;&lt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>;</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;        destLocData &lt;&lt; float(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#abccd1fec97295c282e888a31df1abe77">getElevation</a>());</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;        destLocData &lt;&lt; float(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">getSpeed</a>());</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;        destLocData &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">m_delayMoment</a>);</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;        destLocData &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(destLocCounter);</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a> &gt; 0)</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;            destLocData &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a>);</div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160; </div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;        <a class="code" href="structMaNGOS_1_1SpellMessageDestLocDeliverer.html">MaNGOS::SpellMessageDestLocDeliverer</a> notifier(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, data); <span class="comment">// broadcast around caster normal packet to those who see caster</span></div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;        <a class="code" href="structCell.html#a07c1300d6a1d8ee38819103043b89b8f">Cell::VisitAllObjects</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>(), notifier, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a467ff0b4f5ae28f987aa368f1b095a7a">GetVisibilityData</a>().<a class="code" href="classVisibilityData.html#abd5843be98f68600b1d2d33e4c79f989">GetVisibilityDistance</a>());</div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;        notifier.<a class="code" href="structMaNGOS_1_1SpellMessageDestLocDeliverer.html#a8c132c13b010975bbf96636c30ef5264">StopAccumulating</a>(); <span class="comment">// broadcast around destination to those who dont see caster</span></div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;        <span class="keywordtype">float</span> destX = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, destY = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>;</div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;        <span class="comment">// TODO: Add transport coords transformation to real space for grid search</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;        <a class="code" href="structCell.html#a07c1300d6a1d8ee38819103043b89b8f">Cell::VisitAllObjects</a>(destX, destY, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>(), notifier, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a467ff0b4f5ae28f987aa368f1b095a7a">GetVisibilityData</a>().<a class="code" href="classVisibilityData.html#abd5843be98f68600b1d2d33e4c79f989">GetVisibilityDistance</a>());</div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;    }</div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;}</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160; </div>
<div class="line"><a name="l04685"></a><span class="lineno"><a class="line" href="classSpell.html#abd83294e164945d1a6af5c268f610da5"> 4685</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#abd83294e164945d1a6af5c268f610da5">Spell::WriteAmmoToPacket</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data)<span class="keyword"> const</span></div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> ammoInventoryType = 0;</div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> ammoDisplayID = 0;</div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160; </div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;    {</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;        <a class="code" href="classItem.html">Item</a>* pItem = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetWeaponForAttack(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a>);</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;        <span class="keywordflow">if</span> (pItem)</div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;        {</div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;            ammoInventoryType = pItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#a912c943c6d40c3537c319eda5393604a">InventoryType</a>;</div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;            <span class="keywordflow">if</span> (ammoInventoryType == <a class="code" href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1a8baed7484de6618b6a471f07ae065e20">INVTYPE_THROWN</a>)</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;                ammoDisplayID = pItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#a547d8fb983ba4c47d8803940a04fa521">DisplayInfoID</a>;</div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;            {</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> ammoID = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetUInt32Value(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a98b3337ada4a0939a660090381c648b6">PLAYER_AMMO_ID</a>);</div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                <span class="keywordflow">if</span> (ammoID)</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                {</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;                    <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* pProto = <a class="code" href="classObjectMgr.html#a85a1155c667c781dff3258c751fcde60">ObjectMgr::GetItemPrototype</a>(ammoID);</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;                    <span class="keywordflow">if</span> (pProto)</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                    {</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;                        ammoDisplayID = pProto-&gt;<a class="code" href="structItemPrototype.html#a547d8fb983ba4c47d8803940a04fa521">DisplayInfoID</a>;</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                        ammoInventoryType = pProto-&gt;<a class="code" href="structItemPrototype.html#a912c943c6d40c3537c319eda5393604a">InventoryType</a>;</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                    }</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;                }</div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#acce934b8f6ca08be9d7f7f7e773046d9">GetDummyAura</a>(46699))     <span class="comment">// Requires No Ammo</span></div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;                {</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;                    ammoDisplayID = 5996;                   <span class="comment">// normal arrow</span></div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;                    ammoInventoryType = <a class="code" href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1acde5d85868749e487a7662f649df11ad">INVTYPE_AMMO</a>;</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;                }</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;            }</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;        }</div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;    }</div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;    {</div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> nonRangedAmmoDisplayID = 0;</div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> nonRangedAmmoInventoryType = 0;</div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="Creature_8h.html#a8f7d803e051a8bcb43a44f16b01f9c09">MAX_VIRTUAL_ITEM_SLOT</a>; ++i)</div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;        {</div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> item_id = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#aebc9e7589e372ab99544e474c07609f0">GetUInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a89f1b8c28d6c8813b9ece7c17144995c">UNIT_VIRTUAL_ITEM_SLOT_ID</a> + i))</div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;            {</div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structItemEntry.html">ItemEntry</a> <span class="keyword">const</span>* itemEntry = <a class="code" href="DBCStores_8cpp.html#a637df65a6f7f0354010d82cace781499">sItemStore</a>.LookupEntry(item_id))</div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;                {</div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;                    <span class="keywordflow">if</span> (itemEntry-&gt;Class == <a class="code" href="ItemPrototype_8h.html#ab76605e05d3b13f61472b9a89cd22a68aeaefdfc527a31c7c733104c01368ac2a">ITEM_CLASS_WEAPON</a>)</div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;                    {</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;                        <span class="keywordflow">switch</span> (itemEntry-&gt;SubClass)</div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;                        {</div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556add7a582e0a83334e929d740fbf31f820">ITEM_SUBCLASS_WEAPON_THROWN</a>:</div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;                                ammoDisplayID = itemEntry-&gt;DisplayId;</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;                                ammoInventoryType = itemEntry-&gt;InventoryType;</div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556aa314812b34af0583ded09e09f915c9b7">ITEM_SUBCLASS_WEAPON_BOW</a>:</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a0e2041adefa9c4b36bf9fcc5cc9f6a4f">ITEM_SUBCLASS_WEAPON_CROSSBOW</a>:</div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;                                ammoDisplayID = 5996;       <span class="comment">// is this need fixing?</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;                                ammoInventoryType = <a class="code" href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1acde5d85868749e487a7662f649df11ad">INVTYPE_AMMO</a>;</div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a109fce85f20ce2e44432377b64a7e02c">ITEM_SUBCLASS_WEAPON_GUN</a>:</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;                                ammoDisplayID = 5998;       <span class="comment">// is this need fixing?</span></div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;                                ammoInventoryType = <a class="code" href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1acde5d85868749e487a7662f649df11ad">INVTYPE_AMMO</a>;</div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;                            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;                                nonRangedAmmoDisplayID = itemEntry-&gt;DisplayId;</div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;                                nonRangedAmmoInventoryType = itemEntry-&gt;InventoryType;</div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                        }</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160; </div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;                        <span class="keywordflow">if</span> (ammoDisplayID)</div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;                    }</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;                }</div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;            }</div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;        }</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160; </div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;        <span class="keywordflow">if</span> (!ammoDisplayID &amp;&amp; !ammoInventoryType)</div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;        {</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;            ammoDisplayID = nonRangedAmmoDisplayID;</div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;            ammoInventoryType = nonRangedAmmoInventoryType;</div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;        }</div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;    }</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160; </div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(ammoDisplayID);</div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(ammoInventoryType);</div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;}</div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160; </div>
<div class="line"><a name="l04769"></a><span class="lineno"><a class="line" href="classSpell.html#ae21b0dbb08c6a06f834049d8407dfd8b"> 4769</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae21b0dbb08c6a06f834049d8407dfd8b">Spell::WriteSpellGoTargets</a>(<a class="code" href="classWorldPacket.html">WorldPacket</a>&amp; data)</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;{</div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;    <span class="keywordtype">size_t</span> count_pos = data.<a class="code" href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">wpos</a>();</div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(0);                                      <span class="comment">// placeholder</span></div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160; </div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.size() &gt; 255) <span class="comment">// 53010 confirmed to do this legally</span></div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell ID %u cast by %s hit/missed too many unit targets %u. General warning. Only 255 sent&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>().<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str(), (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)<a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.size());</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.size() &gt; 255)</div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell ID %u cast by %s hit/missed too many GO targets %u. General warning. Only 255 sent&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>().<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str(), (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)<a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.size());</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.size() + <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.size() &gt; 255)</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell ID %u cast by %s hit/missed too many targets %u. General warning. Only 255 sent&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>().<a class="code" href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">GetString</a>().c_str(), (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>)(<a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.size() + <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.size()));</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160; </div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;    <span class="comment">// This function also fill data for channeled spells:</span></div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;    <span class="comment">// m_needAliveTargetMask req for stop channeling if one target die</span></div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> hit = <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.size();              <span class="comment">// Always hits on GO</span></div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> miss = 0;</div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160; </div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;    {</div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;        <span class="keywordflow">if</span> (ihit.effectHitMask == 0 &amp;&amp; ihit.effectMask != 0) <span class="comment">// No effect apply - all immuned add state</span></div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;        {</div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;            <span class="comment">// possibly SPELL_MISS_IMMUNE2 for this??</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; ihit.targetGUID == <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>()) <span class="comment">// can happen due to DR</span></div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;            {</div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;                <a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a> = 0;                              <span class="comment">// cancel aura to avoid visual effect continue</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;                ihit.effectDuration = 0;</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;            }</div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;            ihit.missCondition = <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa4f14819249f6154bab64ccae4c0bf0c5">SPELL_MISS_IMMUNE2</a>;</div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;            ++miss;</div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;        }</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ihit.missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)    <span class="comment">// Add only hits</span></div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;        {</div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;            <span class="keywordflow">if</span> (hit &lt; 255)</div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;            {</div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                ++hit;</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                data &lt;&lt; ihit.targetGUID;</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;                <a class="code" href="classSpell.html#adcb37c1f1904971b48304f6d18d48ee5">m_needAliveTargetMask</a> |= ihit.effectHitMask;</div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;            }</div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;        }</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;        {</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; (ihit.missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa8ccbb0208849d542de83f9b638e877ea">SPELL_MISS_RESIST</a> || ihit.missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>))</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;            {</div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                <a class="code" href="classSpell.html#a0c1365668be6064fbd231e068c77686a">m_duration</a> = 0;                              <span class="comment">// cancel aura to avoid visual effect continue</span></div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                ihit.effectDuration = 0;</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;            }</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;            ++miss;</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;        }</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    }</div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160; </div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ighit : <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>)</div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;        data &lt;&lt; ighit.targetGUID;                         <span class="comment">// Always hits</span></div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160; </div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;    hit = std::min(hit, 255u);</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;    data.<a class="code" href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">put</a>&lt;<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>&gt;(count_pos, hit);</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160; </div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;    miss = std::min(miss, 255u);</div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;    data &lt;&lt; (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>)miss;</div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160; </div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> missCounter = 0;</div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; ihit : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    {</div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;        <span class="keywordflow">if</span> (ihit.missCondition != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)         <span class="comment">// Add only miss</span></div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;        {</div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;            ++missCounter;</div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;            data &lt;&lt; ihit.targetGUID;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;            data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(ihit.missCondition);</div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;            <span class="keywordflow">if</span> (ihit.missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;                data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(ihit.reflectResult);</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160; </div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;            <span class="keywordflow">if</span> (missCounter &gt;= 255)</div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;        }</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;    }</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;    <span class="comment">// Reset m_needAliveTargetMask for non channeled spell</span></div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;        <a class="code" href="classSpell.html#adcb37c1f1904971b48304f6d18d48ee5">m_needAliveTargetMask</a> = 0;</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;}</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160; </div>
<div class="line"><a name="l04848"></a><span class="lineno"><a class="line" href="classSpell.html#a0170aeace8c572eb70d4436c8b93fe4c"> 4848</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a0170aeace8c572eb70d4436c8b93fe4c">Spell::SendInterrupted</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result)<span class="keyword"> const</span></div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca29bc97615577d9b5ae49dfdcc0cd89c0">SMSG_SPELL_FAILURE</a>, (8 + 4 + 1));</div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a>);</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(result);</div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160; </div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;    data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacaafad81ba0b53d7dee67d2be33d440aa0">SMSG_SPELL_FAILED_OTHER</a>, (8 + 4));</div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(<a class="code" href="classSpell.html#a6997d5f606e25d2380de24ef96825257">m_cast_count</a>);</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a>(result);</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;}</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160; </div>
<div class="line"><a name="l04865"></a><span class="lineno"><a class="line" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2"> 4865</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">Spell::SendChannelUpdate</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> time, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> lastTick)<span class="keyword"> const</span></div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;    <span class="keywordflow">if</span> (time == 0)</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;    {</div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;        <span class="keywordflow">if</span> (lastTick)</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;        {</div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpellAuraHolder.html">SpellAuraHolder</a>* holder = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac7ae0a42b6a31508ab24e2d1cf0bb983">GetSpellAuraHolder</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()))</div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;                holder-&gt;UpdateHolder(lastTick);</div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;        }</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160; </div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;        <span class="keywordtype">bool</span> stackable = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a800c4530cf509731e4c51d1c14e21c99">StackAmount</a> &gt; 0;</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160; </div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;        <span class="comment">// Channel aura is removed during its update when channel ends properly</span></div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;        <span class="keywordflow">if</span> (stackable)</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a81ad6a307a801355b33808d2f1e1ceee">RemoveAuraStack</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a48f6b76622c977dc6110c8f427781286">RemoveAurasByCasterSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>(), <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> == 0 ? <a class="code" href="group__game.html#gga9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a> : <a class="code" href="group__game.html#gga9a4f502870485ba32e759067c9adca94a132c6993498600b4a3cfda2b1639c166">AURA_REMOVE_BY_CANCEL</a>);</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160; </div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6d62b1278097a22ea1ac17edf8b3203e">HasChannelObject</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()))</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;        {</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>()))</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;            {</div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;                <span class="keywordflow">if</span> (lastTick)</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;                {</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpellAuraHolder.html">SpellAuraHolder</a>* holder = target-&gt;GetSpellAuraHolder(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()))</div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;                        holder-&gt;UpdateHolder(lastTick);</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;                }</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160; </div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;                <span class="keywordflow">if</span> (stackable)</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;                    target-&gt;RemoveAuraStack(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;                    target-&gt;RemoveAurasByCasterSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>(), <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> == 0 ? <a class="code" href="group__game.html#gga9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a> : <a class="code" href="group__game.html#gga9a4f502870485ba32e759067c9adca94a132c6993498600b4a3cfda2b1639c166">AURA_REMOVE_BY_CANCEL</a>);</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;            }</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;        }</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160; </div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;        <span class="comment">// Only finish channeling when latest channeled spell finishes</span></div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#aebc9e7589e372ab99544e474c07609f0">GetUInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881ab0b0eb5c95c9a8b5a1ff279e5f8bfb03">UNIT_FIELD_CHANNEL_SPELL</a>) != <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160; </div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a7a2d19989c95ebef07fa00acf3ac9a0d">SetChannelObject</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#adc7e9b205f35f9894ec9a4f0ec0871f9">SetUInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881ab0b0eb5c95c9a8b5a1ff279e5f8bfb03">UNIT_FIELD_CHANNEL_SPELL</a>, 0);</div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a8ae08365d2c318258d41e5f96fda5c3a">clearUnitState</a>(<a class="code" href="group__game.html#ggae51d2ecb71f7a5cb3882982a622c9544a37563edfd6dad95b9c7ffaeff337f597">UNIT_STAT_CHANNELING</a>);</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>())</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a15986c0151cfab77feb24aac3cb22474">OnChannelStateChange</a>(<span class="keyword">this</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;    }</div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160; </div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca894ec5b9322d0af11bb595ecdc682d0c">MSG_CHANNEL_UPDATE</a>, 8 + 4);</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(time);</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;}</div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160; </div>
<div class="line"><a name="l04917"></a><span class="lineno"><a class="line" href="classSpell.html#a1efb9631f004c31d06b0552c2edbc10f"> 4917</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a1efb9631f004c31d06b0552c2edbc10f">Spell::SendChannelStart</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> duration)</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;{</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* target = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160; </div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> diminishDuration = duration;</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;    <a class="code" href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50">DiminishingGroup</a> diminishGroup = <a class="code" href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a>;</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;    <a class="code" href="group__game.html#gaa8baff9cbdf61bbb483c1e7ae739f930">DiminishingLevels</a> diminishLevel = <a class="code" href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a686cebb344da5f1a40407c2feb03d2da">DIMINISHING_LEVEL_1</a>;</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160; </div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;    <span class="comment">// select dynobject created by first effect if any</span></div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa3290e738b6cd09859039989143f9ac1">SPELL_EFFECT_PERSISTENT_AREA_AURA</a>)</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;        target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#afb9b0972d880f4325cacf77b56af970f">GetDynObject</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>);</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;    <span class="comment">// select first not resisted target from target list for _0_ effect</span></div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.empty())</div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;    {</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;        <span class="keywordflow">for</span> (TargetList::const_iterator itr = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); itr != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++itr)</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;        {</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;            <span class="keywordflow">if</span> (((itr-&gt;effectHitMask &amp; (1 &lt;&lt; <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>)) &amp;&amp; itr-&gt;reflectResult == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>) || itr-&gt;targetGUID != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;            {</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;                <span class="comment">// when immune, duration is already 0, still need to fetch data for caster</span></div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;                <span class="keywordflow">if</span> (itr-&gt;diminishGroup &gt; <a class="code" href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a> &amp;&amp; (itr-&gt;diminishDuration != duration || diminishLevel == <a class="code" href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a753de913b5eed5c74aaa9d3b567a3980">DIMINISHING_LEVEL_IMMUNE</a>))</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;                {</div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;                    diminishDuration = itr-&gt;diminishDuration;</div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;                    diminishGroup = itr-&gt;diminishGroup;</div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;                    diminishLevel = itr-&gt;diminishLevel;</div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;                }</div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;                target = <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, itr-&gt;targetGUID);</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] != 0 &amp;&amp;</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;                    (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">EffectApplyAuraName</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] == <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea">SPELL_AURA_MOD_POSSESS</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">EffectApplyAuraName</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] == <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aff313dd31d66c100086b4d9b6a81d329">SPELL_AURA_BIND_SIGHT</a>))</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;                    <a class="code" href="classSpell.html#a1eccb88ab5fe5367817bcbbdbb368b81">m_maxRange</a> = <a class="code" href="SpellMgr_8h.html#ab4b1d536a5b410eaf601a13235196d3a">GetSpellRadius</a>(<a class="code" href="DBCStores_8cpp.html#a495e62fceccd344a25ba720c9e1966d9">sSpellRadiusStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>]));</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;            }</div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;        }</div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;    }</div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.empty())</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;    {</div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;        <span class="keywordflow">for</span> (GOTargetList::const_iterator itr = <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.begin(); itr != <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>.end(); ++itr)</div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;        {</div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;            <span class="keywordflow">if</span> (itr-&gt;effectMask &amp; (1 &lt;&lt; <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>))</div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;            {</div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;                target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(itr-&gt;targetGUID);</div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;            }</div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;        }</div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;    }</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 27360) <span class="comment">// override for research - is not used in targeting but supplied as unittarget</span></div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    {</div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;        target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;    }</div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160; </div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;    <span class="comment">// change channel duration to account for DR if neccessary, also store in caster&#39;s targetInfo to use later for setting aura duration</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;    <span class="keywordflow">if</span> (diminishDuration != duration || diminishLevel == <a class="code" href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a753de913b5eed5c74aaa9d3b567a3980">DIMINISHING_LEVEL_IMMUNE</a>)</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;    {</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;        duration = diminishDuration;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; target : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;        {</div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;            <span class="keywordflow">if</span> (target.targetGUID == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;            {</div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;                target.diminishDuration = diminishDuration;</div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;                target.diminishGroup = diminishGroup;</div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;                target.diminishLevel = diminishLevel;</div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;            }</div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;        }</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;    }</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160; </div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca791453a04d198ad003a1e894f8f1afdb">MSG_CHANNEL_START</a>, (8 + 4 + 4));</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(duration);</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160; </div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;    <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> = duration;</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160; </div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a4d92db4bb064cb51ad9716a543a720cf">SPELL_ATTR_EX_IS_CHANNELED</a>))</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;    {</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;        data.<a class="code" href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">Initialize</a>(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca3c2614e3c2f2de0ab73cb59fcb74aa67">SMSG_SPELL_UPDATE_CHAIN_TARGETS</a>);</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;        data &lt;&lt; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;        <span class="keywordtype">size_t</span> count_pos = data.<a class="code" href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">wpos</a>();</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;        data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(0);</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> hit = 0;</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;        <span class="keywordflow">for</span> (TargetList::const_iterator itr = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); itr != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++itr)</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;        {</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;            <span class="keywordflow">if</span> (((itr-&gt;effectHitMask &amp; (1 &lt;&lt; <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>)) &amp;&amp; itr-&gt;reflectResult == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a> &amp;&amp;</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;                <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>) || itr-&gt;targetGUID != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;            {</div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, itr-&gt;targetGUID))</div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;                {</div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;                    ++hit;</div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;                    data &lt;&lt; target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>();</div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;                }</div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;            }</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;        }</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;        <span class="keywordflow">if</span> (hit)</div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;        {</div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;            data.<a class="code" href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">put</a>&lt;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&gt;(count_pos, hit);</div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;        }</div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;    }</div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160; </div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;    <span class="keywordflow">if</span> (target)</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a7a2d19989c95ebef07fa00acf3ac9a0d">SetChannelObject</a>(target);</div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160; </div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#adc7e9b205f35f9894ec9a4f0ec0871f9">SetUInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881ab0b0eb5c95c9a8b5a1ff279e5f8bfb03">UNIT_FIELD_CHANNEL_SPELL</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a169ef33de0d0e646b4fe7d1d6d01444d">addUnitState</a>(<a class="code" href="group__game.html#ggae51d2ecb71f7a5cb3882982a622c9544a37563edfd6dad95b9c7ffaeff337f597">UNIT_STAT_CHANNELING</a>);</div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160; </div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>())</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a15986c0151cfab77feb24aac3cb22474">OnChannelStateChange</a>(<span class="keyword">this</span>, <span class="keyword">true</span>, target);</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;}</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160; </div>
<div class="line"><a name="l05027"></a><span class="lineno"><a class="line" href="classSpell.html#ad827f88458117266b82decb339b9ff88"> 5027</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ad827f88458117266b82decb339b9ff88">Spell::TakeCastItem</a>()</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;{</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> || !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160; </div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;    <span class="comment">// not remove cast item at triggered spell (equipping, weapon damage, etc)</span></div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>))</div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160; </div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;    <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* proto = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>();</div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160; </div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;    <span class="keywordflow">if</span> (!proto)</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;    {</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;        <span class="comment">// This code is to avoid a crash</span></div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;        <span class="comment">// I&#39;m not sure, if this is really an error, but I guess every item needs a prototype</span></div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Cast item (%s) has no item prototype&quot;</span>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str());</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;    }</div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160; </div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;    <span class="comment">// these effects change the item</span></div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#af992734f80d9f691f34ebc42ffdbae93">IsSpellHaveEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a07034baa2b6fe31ad40f733e0b943764">SPELL_EFFECT_SUMMON_CHANGE_ITEM</a>))</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160; </div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;    <span class="keywordtype">bool</span> expendable = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;    <span class="keywordtype">bool</span> withoutCharges = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160; </div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="ItemPrototype_8h.html#a9e238c2727e820f5207cccdb26e2ce95">MAX_ITEM_PROTO_SPELLS</a>; ++i)</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    {</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;        <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>[i].<a class="code" href="struct__Spell.html#aed47853f0d0a19643f9667a8af115d4d">SpellId</a>)</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;        {</div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;            <span class="comment">// item has limited charges</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;            <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>[i].<a class="code" href="struct__Spell.html#a16909465a3a20dbab6e3ca2e3c807f17">SpellCharges</a>)</div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;            {</div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;                <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>[i].<a class="code" href="struct__Spell.html#a16909465a3a20dbab6e3ca2e3c807f17">SpellCharges</a> &lt; 0)</div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;                    expendable = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160; </div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> charges = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a345485448a4b18c8ef2e8805f16ce458">GetSpellCharges</a>(i);</div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160; </div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;                <span class="comment">// item has charges left</span></div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;                <span class="keywordflow">if</span> (charges)</div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;                {</div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;                    (charges &gt; 0) ? --charges : ++charges;  <span class="comment">// abs(charges) less at 1 after use</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;                    <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ad84fbcdf7890c7bad885a8ae5a02f19e">Stackable</a> == 1)</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;                        <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a1835a0d8efcb30778b0fc7c3a4531aba">SetSpellCharges</a>(i, charges);</div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;                    <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a02ee6e52edbee35375b164767b94b0c9">SetState</a>(<a class="code" href="Item_8h.html#a744ce838494e4dc6eb5f123b9a38bd04a20da1bef68b2abe402a3c2b96e8287af">ITEM_CHANGED</a>, <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>));</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160;                }</div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160; </div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;                <span class="comment">// all charges used</span></div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;                withoutCharges = (charges == 0);</div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;            }</div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;        }</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;    }</div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160; </div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;    <span class="keywordflow">if</span> (expendable &amp;&amp; withoutCharges)</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;    {</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;            <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a01443ad39de8bab4cd61c71e4a7f35bd">SetUsedInSpell</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 1;</div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;        <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;DestroyItemCount(<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>, count, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160; </div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;        <span class="comment">// prevent crash at access to deleted m_targets.getItemTarget</span></div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;        <a class="code" href="classSpell.html#ad93507f6abc44a9a3334f3e9a5cc8825">ClearCastItem</a>();</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;    }</div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;}</div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160; </div>
<div class="line"><a name="l05092"></a><span class="lineno"><a class="line" href="classSpell.html#ab191335cf0379cfc4483c6404eebd285"> 5092</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ab191335cf0379cfc4483c6404eebd285">Spell::TakePower</a>()</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;{</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> || <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> || !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0adc2a8bfee369bdbfd6bf659e60029ecb">SPELL_ATTR_EX6_DO_NOT_CONSUME_RESOURCES</a>))</div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160; </div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;    <span class="comment">// health as power used</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a>)</div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;    {</div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a959cfb5dafa2f964adb440d2b53c02f6">ModifyHealth</a>(-(<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)<a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a>);</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;    }</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160; </div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> &gt;= <a class="code" href="SharedDefines_8h.html#a78fcc691229c7bc57dff4fcb8d744f1b">MAX_POWERS</a>)</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;    {</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell::TakePower: Unknown power type &#39;%d&#39;&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>);</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;    }</div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160; </div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;    <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a> powerType = <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>);</div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160; </div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;    <span class="keywordflow">if</span> (powerType == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ad2662f90ffd864b9483e8265c2cc08df">POWER_RUNE</a>)</div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;    {</div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;        <a class="code" href="classSpell.html#ab3ffd4cc75d8108d2602ae767ea3d5df">CheckOrTakeRunePower</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;    }</div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160; </div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6591e720a2cfa309b6d693231b1fdbc0">ModifyPower</a>(powerType, -(<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)<a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a>);</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160; </div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;    <span class="comment">// Set the five second timer</span></div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;    <span class="keywordflow">if</span> (powerType == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a> &amp;&amp; <a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a> &gt; 0 &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a264c19f3c0c7e399eba0f121e35e17e6">SPELL_ATTR_EX2_DONT_BLOCK_MANA_REGEN</a>))</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a0e30ad1b4802103bac5736d0486c021c">SetLastManaUse</a>();</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;}</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160; </div>
<div class="line"><a name="l05125"></a><span class="lineno"><a class="line" href="classSpell.html#ab3ffd4cc75d8108d2602ae767ea3d5df"> 5125</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#ab3ffd4cc75d8108d2602ae767ea3d5df">Spell::CheckOrTakeRunePower</a>(<span class="keywordtype">bool</span> take)</div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;{</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160; </div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;    <a class="code" href="classPlayer.html">Player</a>* plr = (<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160; </div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;    <span class="keywordflow">if</span> (plr-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058">CLASS_DEATH_KNIGHT</a>)</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160; </div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;    <a class="code" href="structSpellRuneCostEntry.html">SpellRuneCostEntry</a> <span class="keyword">const</span>* src = <a class="code" href="DBCStores_8cpp.html#a9a542d9b7a00cab69edf5db46e90f718">sSpellRuneCostStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0c3b77487bffa0d4e0da8e71cc7e5c4b">runeCostID</a>);</div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160; </div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;    <span class="keywordflow">if</span> (!src)</div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160; </div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;    <span class="keywordflow">if</span> (src-&gt;<a class="code" href="structSpellRuneCostEntry.html#a599b2089d52bf4a009c5fbac3b0d3279">NoRuneCost</a>() &amp;&amp; (!take || src-&gt;<a class="code" href="structSpellRuneCostEntry.html#a97da075ecd116ef27fd4265bb8380667">NoRunicPowerGain</a>()))</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160; </div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;    <span class="keywordflow">if</span> (take)</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;        <a class="code" href="classSpell.html#af6bea341ebc74608726857671d92bb6d">m_runesState</a> = plr-&gt;<a class="code" href="classPlayer.html#a6608e0d531ea6565e894dd6a01b482b7">GetRunesState</a>();                <span class="comment">// store previous state</span></div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160; </div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;    <span class="comment">// at this moment for rune cost exist only no cost mods, and no percent mods</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> runeCostMod = 10000;</div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = plr-&gt;<a class="code" href="classPlayer.html#add3944b50311b59aded74efda7fea752">GetSpellModOwner</a>())</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;        modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351af20b74239c863da128fdb51f2d37bdd7">SPELLMOD_COST</a>, runeCostMod);</div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160; </div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;    <span class="keywordflow">if</span> (runeCostMod &gt; 0)</div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;    {</div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;        <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> runeCost[<a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a6690183338755f52259fe9eb8332db35">NUM_RUNE_TYPES</a>];                     <span class="comment">// blood, frost, unholy, death</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160; </div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;        <span class="comment">// init cost data and apply mods</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>; ++i)</div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;            runeCost[i] = runeCostMod &gt; 0 ? src-&gt;<a class="code" href="structSpellRuneCostEntry.html#a18c2e6daaaefe1c8be4a83c55a3670ff">RuneCost</a>[i] : 0;</div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160; </div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;        runeCost[<a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>] = 0;                           <span class="comment">// calculated later</span></div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160; </div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;        <span class="comment">// scan non-death runes (death rune not used explicitly in rune costs)</span></div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;        for (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="Player_8h.html#a2a50815668e7443f20a14ff3fa353db4">MAX_RUNES</a>; ++i)</div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;        {</div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;            <a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11">RuneType</a> rune = plr-&gt;<a class="code" href="classPlayer.html#a9df30430ce60344703a33ae012e92531">GetCurrentRune</a>(i);</div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;            <span class="keywordflow">if</span> (runeCost[rune] &lt;= 0)</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160; </div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;            <span class="comment">// already used</span></div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;            <span class="keywordflow">if</span> (plr-&gt;<a class="code" href="classPlayer.html#ac803ce7abf2d0990d93db9969f24f567">GetRuneCooldown</a>(i) != 0)</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160; </div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;            <span class="keywordflow">if</span> (take)</div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;                plr-&gt;<a class="code" href="classPlayer.html#a31676c416fec6c27ec5f3449b1a1de46">SetRuneCooldown</a>(i, plr-&gt;<a class="code" href="classPlayer.html#a48da370a4f54c57756a87ab7ccffdf36">GetRuneBaseCooldown</a>(i));     <span class="comment">// 5*2=10 sec</span></div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160; </div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;            --runeCost[rune];</div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;        }</div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160; </div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;        <span class="comment">// collect all not counted rune costs to death runes cost</span></div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>; ++i)</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;            <span class="keywordflow">if</span> (runeCost[i] &gt; 0)</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                runeCost[<a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>] += runeCost[i];</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160; </div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;        <span class="comment">// scan death runes</span></div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;        <span class="keywordflow">if</span> (runeCost[<a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>] &gt; 0)</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;        {</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="Player_8h.html#a2a50815668e7443f20a14ff3fa353db4">MAX_RUNES</a> &amp;&amp; runeCost[<a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>]; ++i)</div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;            {</div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;                <a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11">RuneType</a> rune = plr-&gt;<a class="code" href="classPlayer.html#a9df30430ce60344703a33ae012e92531">GetCurrentRune</a>(i);</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;                <span class="keywordflow">if</span> (rune != <a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>)</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160; </div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;                <span class="comment">// already used</span></div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;                <span class="keywordflow">if</span> (plr-&gt;<a class="code" href="classPlayer.html#ac803ce7abf2d0990d93db9969f24f567">GetRuneCooldown</a>(i) != 0)</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160; </div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;                <span class="keywordflow">if</span> (take)</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;                    plr-&gt;<a class="code" href="classPlayer.html#a31676c416fec6c27ec5f3449b1a1de46">SetRuneCooldown</a>(i, <a class="code" href="Player_8h.html#a41120073d2b85118df1dfb7c61cce5b2">RUNE_COOLDOWN</a>); <span class="comment">// 5*2=10 sec</span></div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160; </div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;                --runeCost[rune];</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160; </div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;                <span class="keywordflow">if</span> (take)</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;                    plr-&gt;<a class="code" href="classPlayer.html#a6a09c85604274c12a16c1ff805cfb786">RestoreBaseRune</a>(i);</div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;            }</div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;        }</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160; </div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;        <span class="keywordflow">if</span> (!take &amp;&amp; runeCost[<a class="code" href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a>] &gt; 0)</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba24fad721a4cf3b105b67b9d0613be0c3">SPELL_FAILED_NO_POWER</a>;                   <span class="comment">// not sure if result code is correct</span></div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;    }</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160; </div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    <span class="keywordflow">if</span> (take)</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;    {</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;        <span class="comment">// you can gain some runic power when use runes</span></div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;        <span class="keywordtype">float</span> rp = float(src-&gt;<a class="code" href="structSpellRuneCostEntry.html#ac5f9c69d83ff9cf230124b9dad10008b">runePowerGain</a>);</div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;        rp *= <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#ggad7288d27ab8a1132a5f30148c227f2bea1246d762d53d8197c3c4b7efb7fd2c73">CONFIG_FLOAT_RATE_POWER_RUNICPOWER_INCOME</a>);</div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;        plr-&gt;<a class="code" href="classUnit.html#a6591e720a2cfa309b6d693231b1fdbc0">ModifyPower</a>(<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a4c504424e60c95f01e0ec1468a52d221">POWER_RUNIC_POWER</a>, (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>)rp);</div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160; </div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;        <a class="code" href="classSpell.html#aa1e44566b72ceb6915fc6ea3d2f92f26">m_runesStateAfterCast</a> = plr-&gt;<a class="code" href="classPlayer.html#a6608e0d531ea6565e894dd6a01b482b7">GetRunesState</a>();</div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;    }</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160; </div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;}</div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160; </div>
<div class="line"><a name="l05223"></a><span class="lineno"><a class="line" href="classSpell.html#a6b2f1ff698d8d27a90461ed99fb51500"> 5223</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a6b2f1ff698d8d27a90461ed99fb51500">Spell::TakeAmmo</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a> == <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a> &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;    {</div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* player = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>);</div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;        <a class="code" href="classItem.html">Item</a>* pItem = player-&gt;<a class="code" href="classPlayer.html#a9ddba282e25d1585271207900b33e25f">GetWeaponForAttack</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160; </div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;        <span class="comment">// wands don&#39;t have ammo</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;        <span class="keywordflow">if</span> (!pItem || pItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#ad09dd92ab1fcf2a86060fb36120459b3">SubClass</a> == <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556acfba60aacffd401146e4b0eefcb3dc48">ITEM_SUBCLASS_WEAPON_WAND</a>)</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160; </div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;        <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#a912c943c6d40c3537c319eda5393604a">InventoryType</a> == <a class="code" href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1a8baed7484de6618b6a471f07ae065e20">INVTYPE_THROWN</a>)</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;        {</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;            <span class="keywordflow">if</span> (pItem-&gt;<a class="code" href="classItem.html#ae6722dd0d72d33bc1840151549993f16">GetMaxStackCount</a>() == 1)</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;            {</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;                <span class="comment">// decrease durability for non-stackable throw weapon</span></div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;                player-&gt;<a class="code" href="classPlayer.html#a476849b867b48d2e7d8fbbb2178a7ed7">DurabilityPointLossForEquipSlot</a>(<a class="code" href="Player_8h.html#a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a">EQUIPMENT_SLOT_RANGED</a>);</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;            }</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;            {</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;                <span class="comment">// decrease items amount for stackable throw weapon</span></div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = 1;</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;                player-&gt;<a class="code" href="classPlayer.html#a2d88517ac7f496c6a7f05eeaafe3a0a5">DestroyItemCount</a>(pItem, count, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;            }</div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;        }</div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> ammo = player-&gt;<a class="code" href="classObject.html#aebc9e7589e372ab99544e474c07609f0">GetUInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a98b3337ada4a0939a660090381c648b6">PLAYER_AMMO_ID</a>)) {</div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;            <span class="comment">// some spells may be exempt from ammo cost (Wild Quiver talent for MM Hunters)</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; aura : player-&gt;<a class="code" href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">GetAurasByType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a39ea3fa62739b733008d71ebe24a0842">AuraType::SPELL_AURA_ABILITY_CONSUME_NO_AMMO</a>)) {</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;                <span class="keywordflow">if</span> (aura-&gt;isAffectedOnSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) {</div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;                    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;                }</div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;            }</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;            player-&gt;<a class="code" href="classPlayer.html#a2d88517ac7f496c6a7f05eeaafe3a0a5">DestroyItemCount</a>(ammo, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;        }</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;    }</div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;}</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160; </div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160; </div>
<div class="line"><a name="l05261"></a><span class="lineno"><a class="line" href="classSpell.html#a39bddfec4b1d97d380972515a7d26314"> 5261</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a39bddfec4b1d97d380972515a7d26314">Spell::TakeReagents</a>()</div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;{</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0adc2a8bfee369bdbfd6bf659e60029ecb">SPELL_ATTR_EX6_DO_NOT_CONSUME_RESOURCES</a>))</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160; </div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#af84a8ccfbfa113458cd96927a0bd65d6">IgnoreItemRequirements</a>())                           <span class="comment">// reagents used in triggered spell removed by original spell or don&#39;t must be removed.</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160; </div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;    <a class="code" href="classPlayer.html">Player</a>* p_caster = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;    <span class="keywordflow">if</span> (p_caster-&gt;<a class="code" href="classPlayer.html#ae6a51221f478bb16c116402295880786">CanNoReagentCast</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160; </div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> x = 0; x &lt; <a class="code" href="DBCStructure_8h.html#a7dfd9b5e0adb5c5e3ebf3173f80fbcce">MAX_SPELL_REAGENTS</a>; ++x)</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    {</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1c912ec366db72086130df35f219f46b">Reagent</a>[x] &lt;= 0)</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160; </div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> itemid = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1c912ec366db72086130df35f219f46b">Reagent</a>[x];</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> itemcount = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0fdf9afa2dbe95e2e8b2aeb31dc7dfa1">ReagentCount</a>[x];</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160; </div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;        <span class="comment">// if CastItem is also spell reagent</span></div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;        {</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;            <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* proto = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>();</div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;            <span class="keywordflow">if</span> (proto &amp;&amp; proto-&gt;<a class="code" href="structItemPrototype.html#a6b5f71419f275de1891c1464d72af61c">ItemId</a> == itemid)</div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;            {</div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; <a class="code" href="ItemPrototype_8h.html#a9e238c2727e820f5207cccdb26e2ce95">MAX_ITEM_PROTO_SPELLS</a>; ++s)</div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;                {</div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;                    <span class="comment">// CastItem will be used up and does not count as reagent</span></div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;                    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> charges = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a345485448a4b18c8ef2e8805f16ce458">GetSpellCharges</a>(s);</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;                    <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>[s].<a class="code" href="struct__Spell.html#a16909465a3a20dbab6e3ca2e3c807f17">SpellCharges</a> &lt; 0 &amp;&amp; abs(charges) &lt; 2)</div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;                    {</div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;                        ++itemcount;</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;                    }</div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;                }</div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160; </div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;                <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a01443ad39de8bab4cd61c71e4a7f35bd">SetUsedInSpell</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;                <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;            }</div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;        }</div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160; </div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;        <span class="comment">// if getItemTarget is also spell reagent</span></div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a872c670896e98cb2ca74948e0639ba15">getItemTargetEntry</a>() == itemid)</div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5ddeb0e96775789e553286c9cc879c27">setItemTarget</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160; </div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;        p_caster-&gt;<a class="code" href="classPlayer.html#a2d88517ac7f496c6a7f05eeaafe3a0a5">DestroyItemCount</a>(itemid, itemcount, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;    }</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;}</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160; </div>
<div class="line"><a name="l05311"></a><span class="lineno"><a class="line" href="classSpell.html#a68b7071f7708ddf46cb20e2e76e414ad"> 5311</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a68b7071f7708ddf46cb20e2e76e414ad">Spell::HandleThreatSpells</a>()</div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;{</div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.empty())</div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160; </div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;    <a class="code" href="structSpellThreatEntry.html">SpellThreatEntry</a> <span class="keyword">const</span>* threatEntry = <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSpellThreatEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160; </div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    <span class="keywordflow">if</span> (!threatEntry || (!threatEntry-&gt;<a class="code" href="structSpellThreatEntry.html#a37a1ab2189023660b7122b6d151147b5">threat</a> &amp;&amp; threatEntry-&gt;<a class="code" href="structSpellThreatEntry.html#af97fdc4231ddb87574a48565aa28182d">ap_bonus</a> == 0.0f))</div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160; </div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* affectiveCaster = <a class="code" href="classSpell.html#af8de4da19951058b9debc1521bb5b954">GetAffectiveCasterOrOwner</a>();</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;    <span class="keywordflow">if</span> (!affectiveCaster) <span class="comment">// GO cast spells do not need threat processing</span></div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160; </div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;    <span class="keywordtype">float</span> threat = threatEntry-&gt;<a class="code" href="structSpellThreatEntry.html#a37a1ab2189023660b7122b6d151147b5">threat</a>;</div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    <span class="keywordflow">if</span> (threatEntry-&gt;<a class="code" href="structSpellThreatEntry.html#af97fdc4231ddb87574a48565aa28182d">ap_bonus</a> != 0.0f)</div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;        threat += threatEntry-&gt;<a class="code" href="structSpellThreatEntry.html#af97fdc4231ddb87574a48565aa28182d">ap_bonus</a> * affectiveCaster-&gt;<a class="code" href="classUnit.html#af873da0c7f334e3162d13ed19b32fc8b">GetTotalAttackPowerValue</a>(<a class="code" href="SpellMgr_8cpp.html#a8a6c654559ee1eedaa1c460dd60f1823">GetWeaponAttackType</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>));</div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160; </div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;    <span class="keywordtype">bool</span> positive = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effectMask = 0;</div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i])</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;            effectMask |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160; </div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3ca8244d8c6cdc28ca9e8af8553e168f">m_negativeEffectMask</a> &amp; effectMask)</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;    {</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;        <span class="comment">// can only handle spells with clearly defined positive/negative effect, check at spell_threat loading probably not perfect</span></div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;        <span class="comment">// so abort when only some effects are negative.</span></div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a3ca8244d8c6cdc28ca9e8af8553e168f">m_negativeEffectMask</a> &amp; effectMask) != effectMask)</div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;        {</div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;            <a class="code" href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Spell %u, rank %u, is not clearly positive or negative, ignoring bonus threat&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSpellRank(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>));</div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;        }</div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;        positive = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;    }</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160; </div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;    <span class="comment">// since 2.0.1 threat from positive effects also is distributed among all targets, so the overall caused threat is at most the defined bonus</span></div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;    threat /= <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.size();</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160; </div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;    <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;    {</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;        <span class="keywordflow">if</span> (ihit-&gt;missCondition != <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160; </div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == ihit-&gt;targetGUID ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, ihit-&gt;targetGUID);</div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;        <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160; </div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;        <span class="comment">// positive spells distribute threat among all units that are in combat with target, like healing</span></div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;        <span class="keywordflow">if</span> (positive)</div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;        {</div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;            target-&gt;<a class="code" href="classUnit.html#a89e8ca73fb924186a39d05a9789f6e15">getHostileRefManager</a>().<a class="code" href="classHostileRefManager.html#a073f0560d2543944b684dc8fb581abd2">threatAssist</a>(affectiveCaster, threat, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;        }</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;        <span class="comment">// for negative spells threat gets distributed among affected targets</span></div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;        {</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#a8be0778766438c8076a946f3cd275406">CanHaveThreatList</a>())</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160; </div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;            target-&gt;<a class="code" href="classUnit.html#adbad9a4cab962a2d72abbbc22d32f79d">AddThreat</a>(affectiveCaster, threat, <span class="keyword">false</span>, <a class="code" href="SpellMgr_8h.html#a22e0f1c7f488563ce1e10a2ae2d4906d">GetSpellSchoolMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>), <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;        }</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;    }</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160; </div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;    <a class="code" href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Spell %u added an additional %f threat for %s &quot;</span> <a class="code" href="Common_8h.html#a25c83491d5877e166e36a591e84c1b76">SIZEFMTD</a> <span class="stringliteral">&quot; target(s)&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, threat, positive ? <span class="stringliteral">&quot;assisting&quot;</span> : <span class="stringliteral">&quot;harming&quot;</span>, <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.size());</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;}</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160; </div>
<div class="line"><a name="l05377"></a><span class="lineno"><a class="line" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8"> 5377</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">Spell::ExecuteEffects</a>(<a class="code" href="classUnit.html">Unit</a>* unitTarget, <a class="code" href="classItem.html">Item</a>* itemTarget, <a class="code" href="classGameObject.html">GameObject</a>* GOTarget, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectMask)</div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;{</div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* affectiveCaster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>();</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;    {</div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;        <span class="keywordflow">if</span> (effectMask &amp; (1 &lt;&lt; i))</div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;        {</div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;            <a class="code" href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6">HandleEffect</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>, GOTarget, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <a class="code" href="classSpell.html#a775626fa420464863cbc05128381c5ba">m_damageMultipliers</a>[i]);</div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ac63ea9310b09ececfc1eac19133abce1">m_applyMultiplierMask</a> &amp; (1 &lt;&lt; i))</div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;            {</div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;                <span class="comment">// Get multiplier</span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;                <span class="keywordtype">float</span> multiplier = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa6e55236825637838639206a2231ceed">DmgMultiplier</a>[i];</div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;                <span class="comment">// Apply multiplier mods</span></div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;                <span class="keywordflow">if</span> (affectiveCaster)</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = affectiveCaster-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>())</div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;                        modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a4729e945549bbeef20534fbd511eab78">SPELLMOD_EFFECT_PAST_FIRST</a>, multiplier);</div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;                <a class="code" href="classSpell.html#a775626fa420464863cbc05128381c5ba">m_damageMultipliers</a>[i] *= multiplier;</div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;            }</div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;        }</div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;    }</div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;}</div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160; </div>
<div class="line"><a name="l05399"></a><span class="lineno"><a class="line" href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6"> 5399</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6">Spell::HandleEffect</a>(<a class="code" href="classUnit.html">Unit</a>* pUnitTarget, <a class="code" href="classItem.html">Item</a>* pItemTarget, <a class="code" href="classGameObject.html">GameObject</a>* pGOTarget, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> i, <span class="keywordtype">float</span> DamageMultiplier)</div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;{</div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a33a3b5316aef596513c831765ece5cae">m_effectTriggerChance</a>[i] != -1)</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;    {</div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a33a3b5316aef596513c831765ece5cae">m_effectTriggerChance</a>[i] == 0 || <a class="code" href="Util_8cpp.html#a6ae07d2bb0593d8339e65c136f63ecc0">irand</a>(1, 100) &gt; <a class="code" href="classSpell.html#a33a3b5316aef596513c831765ece5cae">m_effectTriggerChance</a>[i])</div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;    }</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160; </div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;    <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = pUnitTarget;</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;    <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a> = pItemTarget;</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;    <a class="code" href="classSpell.html#a0e7f35f88f4bad9f5599c67fde08f98a">gameObjTarget</a> = pGOTarget;</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160; </div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;    <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> eff = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i];</div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160; </div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a77286525a5c1dd28a09c9fc5f903f554">IsEffectWithImplementedMultiplier</a>(eff))</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;    {</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;        <a class="code" href="classSpell.html#ad3059c20d67c7b1325c545ac188c74d5">m_healingPerEffect</a>[i] = 0;</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;        <a class="code" href="classSpell.html#a6fbd0a36487bc7e0b088d044d667c4c1">m_damagePerEffect</a>[i] = 0;</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;        <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a> = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(i, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;    }</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;        <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a> = <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(i, <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>) * DamageMultiplier);</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160; </div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;    <a class="code" href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Spell %u Effect%d : %u Targets: %s, %s, %s&quot;</span>,</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;                     <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, i, eff,</div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;                     <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> ? <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str() : <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;                     <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a> ? <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str() : <span class="stringliteral">&quot;-&quot;</span>,</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;                     <a class="code" href="classSpell.html#a0e7f35f88f4bad9f5599c67fde08f98a">gameObjTarget</a> ? <a class="code" href="classSpell.html#a0e7f35f88f4bad9f5599c67fde08f98a">gameObjTarget</a>-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str() : <span class="stringliteral">&quot;-&quot;</span>);</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160; </div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;    <span class="keywordflow">if</span> (eff &lt; <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a38f4a390f591eee0f8f7873d4ef4ec49">MAX_SPELL_EFFECTS</a>)</div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;    {</div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        <a class="code" href="classSpell.html#a6c3094450c157ad61c00375270392d5c">OnEffectExecute</a>(i);</div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;        <a class="code" href="classSpell.html#a3255c4ac70b615c4bbb9f77305038ac0">damagePerEffect</a>[i] = <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a>;</div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;        (*this.*<a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97">SpellEffects</a>[eff])(i);</div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;    }</div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;WORLD: Spell FX %d &gt; MAX_SPELL_EFFECTS &quot;</span>, eff);</div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160; </div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a77286525a5c1dd28a09c9fc5f903f554">IsEffectWithImplementedMultiplier</a>(eff))</div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;    {</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad3059c20d67c7b1325c545ac188c74d5">m_healingPerEffect</a>[i] &gt; 0)</div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;            <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> += <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#ad3059c20d67c7b1325c545ac188c74d5">m_healingPerEffect</a>[i] * DamageMultiplier);</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a6fbd0a36487bc7e0b088d044d667c4c1">m_damagePerEffect</a>[i] &gt; 0)</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;            <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> += <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a6fbd0a36487bc7e0b088d044d667c4c1">m_damagePerEffect</a>[i] * DamageMultiplier);</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;    }</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;}</div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160; </div>
<div class="line"><a name="l05446"></a><span class="lineno"><a class="line" href="classSpell.html#af2e2b62fc427c19fa9e1dfff19534a1b"> 5446</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">Spell::AddTriggeredSpell</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId)</div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;{</div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;    <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellInfo = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(spellId);</div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160; </div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;    <span class="keywordflow">if</span> (!spellInfo)</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;    {</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell::AddTriggeredSpell: unknown spell id %u used as triggred spell for spell %u)&quot;</span>, spellId, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;    }</div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160; </div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;    <a class="code" href="classSpell.html#ab74dcb259c27daf0a123cc30049d1b37">m_TriggerSpells</a>.push_back(spellInfo);</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;}</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160; </div>
<div class="line"><a name="l05459"></a><span class="lineno"><a class="line" href="classSpell.html#aee79a6cf1400ecc2a06a04db0359585c"> 5459</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">Spell::AddPrecastSpell</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId)</div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;{</div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;    <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellInfo = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(spellId);</div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160; </div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;    <span class="keywordflow">if</span> (!spellInfo)</div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;    {</div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell::AddPrecastSpell: unknown spell id %u used as pre-cast spell for spell %u)&quot;</span>, spellId, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;    }</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160; </div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;    <a class="code" href="classSpell.html#a9bc6be667fcb649021e8c4b8d6a0cc1f">m_preCastSpells</a>.push_back(spellInfo);</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;}</div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160; </div>
<div class="line"><a name="l05472"></a><span class="lineno"><a class="line" href="classSpell.html#a704cd4f425ebf48be2bed2fd22b22571"> 5472</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a704cd4f425ebf48be2bed2fd22b22571">Spell::CastTriggerSpells</a>()</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;{</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;    <span class="keywordflow">for</span> (SpellInfoList::const_iterator si = <a class="code" href="classSpell.html#ab74dcb259c27daf0a123cc30049d1b37">m_TriggerSpells</a>.begin(); si != <a class="code" href="classSpell.html#ab74dcb259c27daf0a123cc30049d1b37">m_TriggerSpells</a>.end(); ++si)</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;    {</div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;        <a class="code" href="classSpell.html">Spell</a>* spell = <span class="keyword">new</span> <a class="code" href="classSpell.html#aebdf5cc0847865b97bf8f4b06a5921f6">Spell</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, (*si), <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a>, <a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>);</div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;        spell-&gt;<a class="code" href="classSpell.html#a2391bf1bfb54f70998c4374d59eb308c">SpellStart</a>(&amp;<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>);                      <span class="comment">// use original spell original targets</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;    }</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;}</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160; </div>
<div class="line"><a name="l05481"></a><span class="lineno"><a class="line" href="classSpell.html#ae56cd0dc9a0fcece5365d59925da40f1"> 5481</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae56cd0dc9a0fcece5365d59925da40f1">Spell::CastPreCastSpells</a>(<a class="code" href="classUnit.html">Unit</a>* target)</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;{</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;    <span class="keywordflow">for</span> (SpellInfoList::const_iterator si = <a class="code" href="classSpell.html#a9bc6be667fcb649021e8c4b8d6a0cc1f">m_preCastSpells</a>.begin(); si != <a class="code" href="classSpell.html#a9bc6be667fcb649021e8c4b8d6a0cc1f">m_preCastSpells</a>.end(); ++si)</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;        <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, (*si), <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>);</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;}</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160; </div>
<div class="line"><a name="l05487"></a><span class="lineno"><a class="line" href="classSpell.html#a3a4197aaeee37c45d2d5bcd915475f1e"> 5487</a></span>&#160;<a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classSpell.html#a3a4197aaeee37c45d2d5bcd915475f1e">Spell::GetPrefilledUnitTargetOrUnitTarget</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex)<span class="keyword"> const</span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; itr : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;        <span class="keywordflow">if</span> (itr.effectHitMask &amp; (1 &lt;&lt; effIndex))</div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ab43d810423c37ee09da95346fae09f32">GetUnit</a>(itr.targetGUID);</div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160; </div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;}</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160; </div>
<div class="line"><a name="l05496"></a><span class="lineno"><a class="line" href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d"> 5496</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d">Spell::CheckCast</a>(<span class="keywordtype">bool</span> strict)</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;{</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;    <span class="comment">// check cooldowns to prevent cheating (ignore passive spells, that client side visual only)</span></div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#aeef1431d123d73b176f47567a0e01647">m_ignoreCooldowns</a> &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a48c3c085b4868f5e7ff01b5f10da9050">SPELL_ATTR_PASSIVE</a>)</div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;            &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a0725cae3f5e238dd7dbb15885cebc07c">IsSpellReady</a>(*<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> ? <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>() : <span class="keyword">nullptr</span>))</div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;    {</div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>)</div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba8b8a8978f57575bd089e2da378bf03ad">SPELL_FAILED_NOT_READY</a>;</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;    }</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160; </div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a48c3c085b4868f5e7ff01b5f10da9050">SPELL_ATTR_PASSIVE</a>))</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;    {</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;        {</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;            <span class="comment">// can cast triggered (by aura only?) spells while have this flag</span></div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;HasFlag(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a65a8142f4727b52425e593eb2727d9f4">PLAYER_FLAGS</a>, <a class="code" href="Player_8h.html#a486dd000e9a9532459d9dd9010570621a0d4e89dc06c8c0976de45352f9800b9b">PLAYER_ALLOW_ONLY_ABILITY</a>) &amp;&amp; <a class="code" href="classSpell.html#a2999180c9cb3caf82303f88dd2f3e6e3">m_clientCast</a>)</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;            {</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;                <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;                <span class="keywordflow">for</span> (<a class="code" href="classAura.html">Aura</a>* aura : <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">GetAurasByType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a914df68f2d9f91943ee1c79f30eb81c2">SPELL_AURA_ALLOW_ONLY_ABILITY</a>))</div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;                {</div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;                    <span class="keywordflow">if</span> (aura-&gt;isAffectedOnSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;                    {</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;                        found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;                    }</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;                }</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160; </div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;                <span class="keywordflow">if</span> (!found)</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaeecb06edf432f8f464c1e4ba2704095a">SPELL_FAILED_SPELL_IN_PROGRESS</a>;</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;            }</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;        }</div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;    }</div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160; </div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;    <span class="comment">// check global cooldown</span></div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;    <span class="keywordflow">if</span> (strict &amp;&amp; !<a class="code" href="classSpell.html#ad496cad5a2082b8d8b4afa249855417a">m_ignoreGCD</a> &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a0ad6f9e175dfd2cace9daf23c8b1d116">HasGCD</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba8b8a8978f57575bd089e2da378bf03ad">SPELL_FAILED_NOT_READY</a>;</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160; </div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;    {</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50aa96ea1ca361d7bcfd729ef6548e1c141">SPELL_ATTR_ALLOW_CAST_WHILE_DEAD</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a48c3c085b4868f5e7ff01b5f10da9050">SPELL_ATTR_PASSIVE</a>))</div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbab46f3fd2e85aca9f1293d380385bf0d8">SPELL_FAILED_CASTER_DEAD</a>;</div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160; </div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a66120644adf09a45c139d48d4e4dce5b">IsStandState</a>() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a778ac54f29659923e15fc33483600862">SPELL_ATTR_ALLOW_WHILE_SITTING</a>))</div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2ecfb8aa0b123d8a065470434835075e">SPELL_FAILED_NOT_STANDING</a>;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160; </div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;        <span class="keywordflow">if</span> ((!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>) &amp;&amp; <a class="code" href="SpellMgr_8h.html#ad87d37c678e30ca6731dbecf89a7f2b9">IsNonCombatSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af5e75d013dfa8a8b888d7714992e3f2a">IsInCombat</a>() &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a987ecf860896e270fa44229a59ca3d64">IsIgnoreUnitState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1fa9ab5671633372236664220b6e7c55ebe">IGNORE_UNIT_COMBAT_STATE</a>))</div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba14dbc498af8458773a0095bb98957889">SPELL_FAILED_AFFECTING_COMBAT</a>;</div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160; </div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;        <span class="comment">// only allow triggered spells if at an ended battleground</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classBattleGround.html">BattleGround</a>* bg = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetBattleGround())</div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;                <span class="keywordflow">if</span> (bg-&gt;GetStatus() == <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8">STATUS_WAIT_LEAVE</a>)</div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160; </div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; !((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;IsGameMaster() &amp;&amp;</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;            <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.getConfig(<a class="code" href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda0cb97e67445e4083344ab8e1f8792525">CONFIG_BOOL_VMAP_INDOOR_CHECK</a>) &amp;&amp;</div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;            <a class="code" href="classVMAP_1_1VMapFactory.html#a4399cce3ece415fdddee4f9268eef318">VMAP::VMapFactory::createOrGetVMapManager</a>()-&gt;<a class="code" href="classVMAP_1_1IVMapManager.html#a8133e2ccf88d4289a15d2b06c2fc5d09">isLineOfSightCalcEnabled</a>())</div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;        {</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50ab0252a3ac57073ca5c330cbb5decd35d">SPELL_ATTR_ONLY_OUTDOORS</a>) &amp;&amp;</div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;                !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a35e49e6fd39432117cdbacd76082287a">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a88601853eed2beb56da806fea75059cf">IsOutdoors</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>()))</div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb39054d5491d07a158b74ffc64c30e6">SPELL_FAILED_ONLY_OUTDOORS</a>; <span class="comment">// TODO: If at least one effect is SPELL_AURA_MOUNTED return mounts not allowed</span></div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160; </div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a5197612e32becb781a08c667015ea477">SPELL_ATTR_ONLY_INDOORS</a>) &amp;&amp;</div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a35e49e6fd39432117cdbacd76082287a">GetTerrain</a>()-&gt;<a class="code" href="classTerrainInfo.html#a88601853eed2beb56da806fea75059cf">IsOutdoors</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>()))</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafe03e4549529ce5f78d26d7c2c46e414">SPELL_FAILED_ONLY_INDOORS</a>;</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;        }</div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160; </div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;        <span class="comment">// only check at first call, Stealth auras are already removed at second call</span></div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;        <span class="comment">// for now, ignore triggered spells</span></div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;        <span class="keywordflow">if</span> (strict &amp;&amp; !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>)</div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;        {</div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;            <span class="comment">// Ignore form req aura</span></div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45d6ec1693da1f1240b8569dd1b31d50">HasAffectedAura</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a2b7765cedd0bccc0e79d4281e871dee0">SPELL_AURA_MOD_IGNORE_SHAPESHIFT</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;            {</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;                <span class="comment">// Cannot be used in this stance/form</span></div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;                <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> shapeError = <a class="code" href="SpellMgr_8cpp.html#ab4874b247401539ddc5f6838fb5abf6b">GetErrorAtShapeshiftedCast</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a373a25c8d6ff3ca2f5653267c1269ad4">GetShapeshiftForm</a>());</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;                <span class="keywordflow">if</span> (shapeError != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;                    <span class="keywordflow">return</span> shapeError;</div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160; </div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a657869ba309551b6af22e53d919c3d6e">SPELL_ATTR_ONLY_STEALTHED</a>) &amp;&amp; !(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a671aa59743c8e3919295551a5f113ce1">HasStealthAura</a>()))</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9619c758351ce747a4c0a575673ae07f">SPELL_FAILED_ONLY_STEALTHED</a>;</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;            }</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;        }</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160; </div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a22ae6db8535f6286991968288ab5ee78">HasAuraTypeWithMiscvalue</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aee5e77a6c01eb9fcd338ebf36599e51d">SPELL_AURA_BLOCK_SPELL_FAMILY</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a>))</div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf7e1c974889123cf0b779d9508c46c2f">SPELL_FAILED_SPELL_UNAVAILABLE</a>;</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160; </div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;        <span class="comment">// caster state requirements</span></div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a43b825d0ab18a266e5ba77aa377f2abf">CasterAuraState</a> &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af79f29debc23c415fc9d3f2b02693552">HasAuraState</a>(<a class="code" href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8">AuraState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a43b825d0ab18a266e5ba77aa377f2abf">CasterAuraState</a>)))</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160; </div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac1efa813941d492073f9a516e8dd91fe">CasterAuraStateNot</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af79f29debc23c415fc9d3f2b02693552">HasAuraState</a>(<a class="code" href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8">AuraState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac1efa813941d492073f9a516e8dd91fe">CasterAuraStateNot</a>)))</div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160; </div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;        <span class="comment">// Caster aura req check if need</span></div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91a53f218d982cc7eefc77c0e4c5142a">casterAuraSpell</a> &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91a53f218d982cc7eefc77c0e4c5142a">casterAuraSpell</a>))</div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a624bafa9c5ef1f5bdfa1d45d67763118">excludeCasterAuraSpell</a>)</div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;        {</div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;            <span class="comment">// Special cases of non existing auras handling</span></div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a624bafa9c5ef1f5bdfa1d45d67763118">excludeCasterAuraSpell</a> == 61988)</div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;            {</div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;                <span class="comment">// Avenging Wrath Marker</span></div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(61987))</div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;            }</div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a624bafa9c5ef1f5bdfa1d45d67763118">excludeCasterAuraSpell</a>))</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;        }</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160; </div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; <a class="code" href="SpellMgr_8h.html#a1283f17a75d0faa251cb81d1b847c24a">NeedsComboPoints</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a987ecf860896e270fa44229a59ca3d64">IsIgnoreUnitState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1fa32371c6eaf349ea13184f0734dba531a">IGNORE_UNIT_TARGET_STATE</a>) &amp;&amp;</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;                (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() || <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a640729ba10ac4fab61d1eb89cc38e762">GetComboTargetGuid</a>()))</div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;            <span class="comment">// warrior not have real combo-points at client side but use this way for mark allow Overpower use</span></div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() == <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa679de5e410197d42cea53f371aba7f59">CLASS_WARRIOR</a> ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba49c5a69312003b5a03234fbac6b460b0">SPELL_FAILED_NO_COMBO_POINTS</a>;</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160; </div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;        <span class="comment">// Nefarian class calls spell failed</span></div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a>)</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;        {</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a>:</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;            {</div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a2763a918baa144ce10d9dcbf1d6f9c70">IsSpellHaveAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1c3516bb8442ba5d970c928ffc976689">SPELL_AURA_MOD_SHAPESHIFT</a>))</div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aba59d4f43e3bef7a98ee904af4c60e73">HasOverrideScript</a>(3655))</div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234">SPELL_FAILED_TARGET_AURASTATE</a>;</div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;            }</div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a>:</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9c8a9c6e102c760263471a93e58e80ea">SPELLFAMILY_SHAMAN</a>:</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a>:</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;            {</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#af992734f80d9f691f34ebc42ffdbae93">IsSpellHaveEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4882157067be8542f9192927816acda1">SPELL_EFFECT_HEAL</a>) ||</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;                    <a class="code" href="SpellMgr_8h.html#a2763a918baa144ce10d9dcbf1d6f9c70">IsSpellHaveAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6442a4a379f82e2f08734296e1e21c9f">SPELL_AURA_PERIODIC_HEAL</a>) ||</div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;                    <a class="code" href="SpellMgr_8h.html#af992734f80d9f691f34ebc42ffdbae93">IsSpellHaveEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a610efccb231f65a5c00189122f7ef907">SPELL_EFFECT_DISPEL</a>))</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;                {</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aba59d4f43e3bef7a98ee904af4c60e73">HasOverrideScript</a>(4327))</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac5b4c7f6ad3c18c893d7183117bcbbda">SPELL_FAILED_FIZZLE</a>;</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;                }</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;            }</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca52acbcf14a96b5ed01b8a43052a26a11">SPELLFAMILY_WARRIOR</a>:</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;            {</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a2763a918baa144ce10d9dcbf1d6f9c70">IsSpellHaveAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1c3516bb8442ba5d970c928ffc976689">SPELL_AURA_MOD_SHAPESHIFT</a>))</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aba59d4f43e3bef7a98ee904af4c60e73">HasOverrideScript</a>(3654))</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234">SPELL_FAILED_TARGET_AURASTATE</a>;</div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;            }</div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;        }</div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160; </div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a363a771ef7a91ce3a4f06e9948760119">SPELL_ATTR_EX7_DEBUG_SPELL</a>) &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a6b03ad8147a368bbf29c0b92b12b0679">UNIT_FIELD_FLAGS_2</a>, <a class="code" href="group__game.html#ggafd9f193edd86cc61d3f2413e3a1eaef5a75265f2aee2789b6ff926cb193a3954c">UNIT_FLAG2_ALLOW_CHEAT_SPELLS</a>))</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;        {</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;            <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a> = <a class="code" href="SpellDefines_8h.html#aa7550118be028897d7ad49cae5a652dea84a18aebfa58f0d225b15fef9c2f2534">SPELL_FAILED_CUSTOM_ERROR_65</a>;</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3edca33213e571cce6e1c1039ee33751">SPELL_FAILED_CUSTOM_ERROR</a>;</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;        }</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;    }</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160; </div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> affectedMask = <a class="code" href="SpellMgr_8h.html#afdaaa77d67a9fc399f5f74453f5967ad">GetCheckCastEffectMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734afa23757176cfe70e555bd7737a7f03c2">SPELL_ATTR_EX5_IMPLIED_TARGETING</a>) &amp;&amp; target)</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;    {</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)))</div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;        {</div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734afa23757176cfe70e555bd7737a7f03c2">SPELL_ATTR_EX5_IMPLIED_TARGETING</a>))</div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;            {</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* targetOfUnitTarget = target-&gt;<a class="code" href="classUnit.html#afc3c9a652f2026707440d4e8bdd87930">GetTarget</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;                {</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(targetOfUnitTarget, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;                        target = targetOfUnitTarget;</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;                }</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;            }</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;        }</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;    }</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160; </div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;    <span class="keywordtype">bool</span> selfTargeting = <span class="keyword">false</span>;</div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;    <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;    {</div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> selfImmuneMask = <a class="code" href="SpellMgr_8h.html#a3ea1c5b64fc74502330c53095ada0cf1">GetCheckCastSelfEffectMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;        <span class="keywordflow">if</span> (selfImmuneMask)</div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;        {</div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;            target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;            affectedMask = selfImmuneMask;</div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;            selfTargeting = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;        }</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;    }</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160; </div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;    <span class="keywordflow">if</span> (target)</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;    {</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;        <span class="comment">// TARGET_UNIT_SCRIPT_NEAR_CASTER fills unit target per client requirement but should not be checked against common things</span></div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;        <span class="comment">// TODO: Find a nicer and more efficient way to check for this</span></div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#ac32804d06d237ef6a0a61714ca168ae3">IsSpellWithScriptUnitTarget</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;        {</div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;            <span class="comment">// target state requirements (not allowed state), apply to self also</span></div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0bfb2cfeb7394ef0313a3517bb3f2607">TargetAuraStateNot</a> &amp;&amp; target-&gt;<a class="code" href="classUnit.html#af79f29debc23c415fc9d3f2b02693552">HasAuraState</a>(<a class="code" href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8">AuraState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0bfb2cfeb7394ef0313a3517bb3f2607">TargetAuraStateNot</a>)))</div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234">SPELL_FAILED_TARGET_AURASTATE</a>;</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160; </div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; <a class="code" href="SpellMgr_8h.html#a2b05b6d33fb015d675684adbf831cf11">IsDeathOnlySpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l05694"></a><span class="lineno"> 5694</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba32fda87d13db4d9c3e234cc4e4e90bf6">SPELL_FAILED_TARGET_NOT_DEAD</a>;</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160; </div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;            <span class="comment">// Target aura req check if need</span></div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1a38754e34ac547b505c44daf69ef6d1">targetAuraSpell</a> &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1a38754e34ac547b505c44daf69ef6d1">targetAuraSpell</a>))</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a98564191a14bd1ababaef07a96fddfbb">excludeTargetAuraSpell</a>)</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;            {</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;                <span class="comment">// Special cases of non existing auras handling</span></div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a98564191a14bd1ababaef07a96fddfbb">excludeTargetAuraSpell</a> == 61988)</div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;                {</div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;                    <span class="comment">// Avenging Wrath Marker</span></div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(61987))</div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;                }</div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a98564191a14bd1ababaef07a96fddfbb">excludeTargetAuraSpell</a>))</div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;            }</div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160; </div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;            <span class="comment">// totem immunity for channeled spells(needs to be before spell cast)</span></div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;            <span class="comment">// spell attribs for player channeled spells</span></div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a773f4c5cfef9eb087607ad1414706532">SPELL_ATTR_EX_TRACK_TARGET_IN_CHANNEL</a>) <span class="comment">// TODO: Investigate this condition</span></div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;                &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734ab726258a5e89ba7a1bd14e197b486901">SPELL_ATTR_EX5_SPELL_HASTE_AFFECTS_PERIODIC</a>)</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;                &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> &amp;&amp; ((<a class="code" href="classCreature.html">Creature</a>*)target)-&gt;IsTotem())</div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6c985f3372baa7af2864bb483d1f16a5">SPELL_FAILED_IMMUNE</a>;</div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160; </div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;            <span class="keywordtype">bool</span> non_caster_target = target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a12b5a317cf83d3b2e09b6aad48050362">IsSpellWithCasterSourceTargetsOnly</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160; </div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;            <span class="keywordflow">if</span> (non_caster_target)</div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;            {</div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;                <span class="comment">// target state requirements (apply to non-self only), to allow cast affects to self like Dirty Deeds</span></div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>() &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a617fd6e64ab83548172c3029d1902328">TargetAuraState</a> &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#ac8514107959844cf3c748d30659241b6">HasAuraStateForCaster</a>(<a class="code" href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8">AuraState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a617fd6e64ab83548172c3029d1902328">TargetAuraState</a>), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()) &amp;&amp;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;                    !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a987ecf860896e270fa44229a59ca3d64">IsIgnoreUnitState</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a617fd6e64ab83548172c3029d1902328">TargetAuraState</a> == <a class="code" href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8a2d367a773fa7878bff424e1c11aa2906">AURA_STATE_FROZEN</a> ? <a class="code" href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1faaf094ca60b104fc78b2b53be31de934c">IGNORE_UNIT_TARGET_NON_FROZEN</a> : <a class="code" href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1fa32371c6eaf349ea13184f0734dba531a">IGNORE_UNIT_TARGET_STATE</a>))</div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234">SPELL_FAILED_TARGET_AURASTATE</a>;</div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160; </div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;                <span class="comment">// Not allow casting on flying player</span></div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a598220bd7032e604abfdb838b9d60f66">IsTaxiFlying</a>())</div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;                {</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;                    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;                    {</div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;                        <span class="comment">// Except some spells from Taxi Flying cast</span></div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;                        <span class="keywordflow">case</span> 7720:                              <span class="comment">// Ritual of Summoning Effect</span></div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;                        <span class="keywordflow">case</span> 36573:                             <span class="comment">// Vision Guide</span></div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;                        <span class="keywordflow">case</span> 42316:                             <span class="comment">// Alcaz Survey Credit</span></div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;                        <span class="keywordflow">case</span> 42385:                             <span class="comment">// Alcaz Survey Aura</span></div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;                        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;                    }</div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;                }</div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160; </div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734aee2774e1e020ab2de7912a0b4cb0aaba">SPELL_ATTR_EX5_ALWAYS_LINE_OF_SIGHT</a>) ||</div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;                    (!<a class="code" href="SpellMgr_8h.html#a99b33426a4b89335f7f93b0a630f658d">IsIgnoreLosSpellCast</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>))</div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(target, <span class="keyword">true</span>))</div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d">SPELL_FAILED_LINE_OF_SIGHT</a>;</div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160; </div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;                {</div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;                    <span class="comment">// auto selection spell rank implemented in WorldSession::HandleCastSpellOpcode</span></div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;                    <span class="comment">// this case can be triggered if rank not found (too low-level target for first rank)</span></div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> &amp;&amp; !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a44f12da1bb63fe2d31a8ce70b6acde88">SPELL_ATTR_EX2_ALLOW_LOW_LEVEL_BUFF</a>))</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;                        <span class="comment">// spell expected to be auto-downranking in cast handle, so must be same</span></div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a> != <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.SelectAuraRankForLevel(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, target-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>()))</div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf">SPELL_FAILED_LOWLEVEL</a>;</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160; </div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;                    <span class="comment">// Do not allow these spells to target creatures not tapped by us (Banish, Polymorph, many quest spells)</span></div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;                    <span class="comment">// Checked here, for single target spells, checked in CheckTarget to take care of AoE spells</span></div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801af854beb3bfcbb2fa59f784fa54c9e5b0">SPELL_ATTR_EX2_CANNOT_CAST_ON_TAPPED</a>) &amp;&amp; !<a class="code" href="SpellMgr_8h.html#ae1cd216886dd278e680ec76fd40fba4e">IsAreaOfEffectSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classCreature.html">Creature</a> <span class="keyword">const</span>* targetCreature = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(target))</div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;                            <span class="keywordflow">if</span> ((!targetCreature-&gt;GetLootRecipientGuid().IsEmpty()) &amp;&amp; !targetCreature-&gt;IsTappedBy(<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)))</div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba7d281dd496eaa35f843af512b12edb2b">SPELL_FAILED_CANT_CAST_ON_TAPPED</a>;</div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;                    </div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;                    <span class="comment">// Do not allow spells to complete which are targeting players that are invisible to the caster since the time of cast start</span></div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>() &amp;&amp; target-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>) &amp;&amp; !<a class="code" href="SpellMgr_8h.html#afa7b10fb48285a79d754be9a11a6b30a">IsPositiveEffectMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, affectedMask, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, target) &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#ac771f494288eae7dfad53907ec0fd7e3">IsVisibleForOrDetect</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a1e4d63776ace92d6c631f8f9de87f2df">SPELL_ATTR_EX6_IGNORE_PHASE_SHIFT</a>)))</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;                }</div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160; </div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;                <span class="keywordflow">if</span> (strict &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea065cd304dcdf77d6d2fdef81f2a72b87">SPELL_ATTR_EX3_ONLY_ON_PLAYER</a>) &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; !<a class="code" href="SpellMgr_8h.html#ae1cd216886dd278e680ec76fd40fba4e">IsAreaOfEffectSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160; </div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;                <span class="keywordflow">if</span> (strict &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734af314637b5b06e3f25a2bb8e87abc68d3">SPELL_ATTR_EX5_NOT_ON_PLAYER</a>) &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; !<a class="code" href="SpellMgr_8h.html#ae1cd216886dd278e680ec76fd40fba4e">IsAreaOfEffectSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160; </div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;                <span class="keywordflow">if</span> (strict &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a65ee564b8f7e72b199e6d6ae55ad8488">SPELL_ATTR_EX5_NOT_ON_PLAYER_CONTROLLED_NPC</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#a62196e93f86fd56823e665abd41864db">IsPlayerControlled</a>() &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; !<a class="code" href="SpellMgr_8h.html#ae1cd216886dd278e680ec76fd40fba4e">IsAreaOfEffectSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;            }</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> == target)</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;            {</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>())</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;                {</div>
<div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;                    <span class="comment">// Additional check for some spells</span></div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;                    <span class="comment">// If 0 spell effect empty - client not send target data (need use selection)</span></div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;                    <span class="comment">// TODO: check it on next client version</span></div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> == <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fafe9a52eb16cad63aeb4202ecae8e2c18">TARGET_FLAG_SELF</a> &amp;&amp;</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;                        <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db">EFFECT_INDEX_1</a>] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf942ecb11955a03d4b522c3981b71689">TARGET_UNIT_ENEMY</a>)</div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;                    {</div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;                        target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ab43d810423c37ee09da95346fae09f32">GetUnit</a>(((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetSelectionGuid());</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;                        <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160; </div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;                        <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">setUnitTarget</a>(target);</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;                    }</div>
<div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;                }</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160; </div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;                <span class="comment">// Some special spells with non-caster only mode</span></div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160; </div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;                <span class="comment">// Fire Shield</span></div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a> == <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0a134bc75d430da10f6c1df4977c29cf">SPELLFAMILY_WARLOCK</a> &amp;&amp;</div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;                    <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aadb41c294565428ff67a9a137d01465a">SpellIconID</a> == 16)</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160; </div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;                <span class="comment">// Focus Magic (main spell)</span></div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 54646)</div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160; </div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;                <span class="comment">// Lay on Hands (self cast)</span></div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a> == <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a> &amp;&amp;</div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;                    <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellFamilyFlags</a> &amp; <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000000008000))</div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;                {</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(25771))                 <span class="comment">// Forbearance</span></div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(61987))                 <span class="comment">// Avenging Wrath Marker</span></div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;                }</div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;            }</div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160; </div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;            <span class="keywordflow">if</span> (!selfTargeting &amp;&amp; (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> == <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fafe9a52eb16cad63aeb4202ecae8e2c18">TARGET_FLAG_SELF</a> || <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> == target) &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ac4ec9bdb1506ec6034067363b1a0cea4">SPELL_ATTR_EX_EXCLUDE_CASTER</a>))</div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;            {</div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa411d9ba79e820e95f1e03d5be4b5a08">IsOnlySelfTargeting</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;                    <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outCustomLog(<span class="stringliteral">&quot;Spell ID %u cast at self explicitly even though it has SPELL_ATTR_EX_EXCLUDE_CASTER&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160; </div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;            }</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160; </div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;            <span class="keywordflow">if</span> (!selfTargeting &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a241a5d4ba7a1aa5228ecb67793f31400">SPELL_ATTR_EX6_CAN_TARGET_UNTARGETABLE</a>) &amp;&amp;  target-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a5aa9f8e6a27782a3f628e9b44c9e6528">UNIT_FLAG_UNTARGETABLE</a>))</div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160; </div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;            <span class="comment">// check creature type</span></div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;            <span class="comment">// ignore self casts (including area casts when caster selected as target)</span></div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;            <span class="keywordflow">if</span> (non_caster_target)</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;            {</div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a80a8c95f25b8275f1d2b50a8155dd52e">CheckTargetCreatureType</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;                {</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba65ebd8801e5a2b6424e3a7064f09c011">SPELL_FAILED_TARGET_IS_PLAYER</a>;</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;                }</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;            }</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160; </div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa48055df917f805e2ef4b8e56f78cc93">IsPositiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, target) &amp;&amp; affectedMask)</div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classCreature.html#a95420bfae733fac3cc9939e3cbd94862">IsImmuneToSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, target == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, affectedMask, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>))</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234">SPELL_FAILED_TARGET_AURASTATE</a>;</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160; </div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;            <span class="comment">// Caster must be facing the targets back</span></div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801ab5d894f98237bbbff5e65f9497081078">SPELL_ATTR_EX2_INITIATE_COMBAT_POST_CAST</a>) &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ac4f26223051a108cbe9c2b010450ae02">SPELL_ATTR_EX_INITIATES_COMBAT_ENABLES_AUTO_ATTACK</a>) &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ac44de3d5f62990a31781ac8522ebeb68">IsFacingTargetsBack</a>(target))</div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;            {</div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;                <span class="comment">// Exclusion for Pounce: Facing Limitation was removed in 2.0.1, but it still uses the same, old Ex-Flags</span></div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;                <span class="comment">// Exclusion for Mutilate:Facing Limitation was removed in 2.0.1 and 3.0.3, but they still use the same, old Ex-Flags</span></div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;                <span class="comment">// Exclusion for Throw: Facing limitation was added in 3.2.x, but that shouldn&#39;t be</span></div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a2eddc830a14874e89224d76f7e94900a">IsFitToFamily</a>(<a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a>, <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0000000000020000)) &amp;&amp;</div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;                    !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a2eddc830a14874e89224d76f7e94900a">IsFitToFamily</a>(<a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a>, <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a>(0x0020000000000000)) &amp;&amp;</div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;                    <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> != 2764)</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6ee4ae4e17351b6ba37cc731e814062e">SPELL_FAILED_NOT_BEHIND</a>;</div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;            }</div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160; </div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;            <span class="comment">// duplicate block to avoid previous block complex logic</span></div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a325173c0e664945846d1f4c1e858c20ba503742f0c152ec55d428f07cc2320f3b">SPELL_ATTR_SS_FACING_BACK</a>) &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ac44de3d5f62990a31781ac8522ebeb68">IsFacingTargetsBack</a>(target))</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6ee4ae4e17351b6ba37cc731e814062e">SPELL_FAILED_NOT_BEHIND</a>;</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160; </div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;            <span class="comment">// Caster must be facing the targets front</span></div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;            <span class="keywordflow">if</span> (((<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a7a2226ccf62201d46c40b90ac7d35305">Attributes</a> == (<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50afe58958c98a660c731236f863e88d80e">SPELL_ATTR_IS_ABILITY</a> | <a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8ceeeda77dcebd27daf92f9c1087c036">SPELL_ATTR_NOT_SHAPESHIFT</a> | <a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a556b7c848105f28f2604159798340755">SPELL_ATTR_DO_NOT_SHEATH</a> | <a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a63e2ffc5cf25a1bd13bae9a3f99a181a">SPELL_ATTR_CANCELS_AUTO_ATTACK_COMBAT</a>)) &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a3d968e0985931ee8bf2ebfd925e39563">IsFacingTargetsFront</a>(target)))</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0418a0d501e729bbd540dcfab1e88556">SPELL_FAILED_NOT_INFRONT</a>;</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160; </div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;            <span class="comment">// check if target is in combat</span></div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;            <span class="keywordflow">if</span> (non_caster_target &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a11629ba94e35782022fabd1f567551df">SPELL_ATTR_EX_ONLY_PEACEFUL_TARGETS</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#af5e75d013dfa8a8b888d7714992e3f2a">IsInCombat</a>())</div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd13b78a42399b124398e3b039cfd0f2">SPELL_FAILED_TARGET_AFFECTING_COMBAT</a>;</div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160; </div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;            <span class="comment">// check if target is affected by Spirit of Redemption (Aura: 27827) unless death persistent</span></div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a9cd076c7f1e10e71af51ffc1ea1f9136">HasAuraType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a5b09d71c8d286bff5c7cfd7ccec9a5f3">SPELL_AURA_SPIRIT_OF_REDEMPTION</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea8840d7716c30eddbc8b0bb0e32bd4834">SPELL_ATTR_EX3_ALLOW_AURA_WHILE_DEAD</a>))</div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160; </div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;            <span class="comment">// Check if more powerful spell applied on target (if spell only contains non-aoe auras)</span></div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a08a8e032a6c528587b4165de8e554b20">IsAuraApplyEffects</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a0040fdd9a7192268e855e468c71b68a1">SpellEffectIndexMask</a>(affectedMask)) &amp;&amp; !<a class="code" href="SpellMgr_8h.html#ae1cd216886dd278e680ec76fd40fba4e">IsAreaOfEffectSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="SpellMgr_8h.html#af84ca241db09e811f5d3ef3ccdff8188">HasAreaAuraEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !selfTargeting &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035ac9c6721936fd1ae1bdd9e4e06021670b">SPELL_ATTR_EX4_AURA_NEVER_BOUNCES</a>))</div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;            {</div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;                <span class="keywordtype">bool</span> computed = <span class="keyword">false</span>; <span class="comment">// optimization</span></div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> amounts[<a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>];</div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keyword">const</span>&amp; pair : target-&gt;<a class="code" href="classUnit.html#a7b9262f2f3fb35fed66a1807edcd7fc0">GetSpellAuraHolderMap</a>())</div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;                {</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classSpellAuraHolder.html">SpellAuraHolder</a>* existing = pair.second;</div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;                    <span class="keyword">const</span> <a class="code" href="structSpellEntry.html">SpellEntry</a>* existingSpell = existing-&gt;<a class="code" href="classSpellAuraHolder.html#a1fd2e2389179ee0daeb7cdbb3a67a294">GetSpellProto</a>();</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160; </div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() != existing-&gt;<a class="code" href="classSpellAuraHolder.html#a2424ccc610b10ff5e89e86d46522c178">GetCasterGuid</a>())</div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;                    {</div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.IsSpellStackableWithSpellForDifferentCasters(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, existingSpell))</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;                            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;                    }</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.IsSpellStackableWithSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, existingSpell))</div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160; </div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;                    <span class="keywordflow">if</span> (!computed)</div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;                    {</div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;                        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;                        {</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;                            <span class="keywordflow">if</span> (affectedMask &amp; (1 &lt;&lt; i))</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;                            {</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;                                amounts[i] = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), target, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;                                amounts[i] = <a class="code" href="classAura.html#abc74e38ede7bee870179bd17df589f7f">Aura::CalculateAuraEffectValue</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), amounts[i]);</div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">m_auraScript</a>)</div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;                                {</div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;                                    <a class="code" href="structAuraCalcData.html">AuraCalcData</a> data(<span class="keyword">nullptr</span>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i));</div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;                                    amounts[i] = <a class="code" href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">m_auraScript</a>-&gt;<a class="code" href="structAuraScript.html#a200049c04ed6f2ce65168d5f3edf5d70">OnAuraValueCalculate</a>(data, amounts[i]);</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;                                }</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;                            }</div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;                        }</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;                        computed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;                    }</div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160; </div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a53853caca4c1bcb4809cfc22ef9fd199">IsSimilarExistingAuraStronger</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, existing, affectedMask, amounts))</div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaab6c81dc718677e5461e405c0140ed84">SPELL_FAILED_AURA_BOUNCED</a>;</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160; </div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.IsSpellAnotherRankOfSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, existingSpell-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.IsSpellHigherRankOfSpell(existingSpell-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaab6c81dc718677e5461e405c0140ed84">SPELL_FAILED_AURA_BOUNCED</a>;</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;                }</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;            }</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160; </div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#abe316061c52c1e6fdcc778232efac1ac">MaxTargetLevel</a> &amp;&amp; target-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>() &gt; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#abe316061c52c1e6fdcc778232efac1ac">MaxTargetLevel</a>)</div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba76455f29fb795f37f695bc796e17459e">SPELL_FAILED_HIGHLEVEL</a>;</div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160; </div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a5db6cd44014f24b32b2ec27d54c66d2b">SPELL_ATTR_EX5_NOT_ON_TRIVIAL</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#ae1e6fbada450b9dc47424b2a20718ea5">IsTrivialForTarget</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba466e084dd0f4d95636614c0f00105d09">SPELL_FAILED_TARGET_IS_TRIVIAL</a>;</div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;        }</div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;    }</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160; </div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;    <span class="comment">// check targets</span></div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;    {</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetType = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i];</div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;        <span class="keywordflow">switch</span> (targetType)</div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;        {</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa9cc352b03a763e4700d42b4a0679da4">TARGET_UNIT_CASTER_PASSENGER_0</a>:</div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac00ea1262694e1b6dd1508248ce627d9">TARGET_UNIT_CASTER_PASSENGER_1</a>:</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa92e3c1771e12ca7d6ade02a2bfb68aac">TARGET_UNIT_CASTER_PASSENGER_2</a>:</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac6f4933c07d252653eb4e176093ab243">TARGET_UNIT_CASTER_PASSENGER_3</a>:</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa803ca1e0762a0164a4878ca4b6ee2574">TARGET_UNIT_CASTER_PASSENGER_4</a>:</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa540ed708172827ecd79c9c90353a2814">TARGET_UNIT_CASTER_PASSENGER_5</a>:</div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8a0acf77fa924aaf8246959c0e9d9056">TARGET_UNIT_CASTER_PASSENGER_6</a>:</div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabd53e14fd8c6ef0e080679a91baf5177">TARGET_UNIT_CASTER_PASSENGER_7</a>:</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0f919e108bdd31c96eaf3ae22e8afc81">TARGET_UNIT_CASTER_VEHICLE</a>:</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faab022171764c300280bec9c133e7dcd0">TARGET_UNIT_ENEMY_NEAR_CASTER</a>:</div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa4f5212bbde3482ca71754fce4a234623">TARGET_UNIT_FRIEND_NEAR_CASTER</a>:</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9889609489e68c367a004d563122c18">TARGET_UNIT_NEAR_CASTER</a>:</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0677dd3c8e41efb02de421bcb418e8eb">TARGET_UNIT_CASTER_MASTER</a>:</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a>: <span class="keywordflow">break</span>; <span class="comment">// never check anything</span></div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a>: <span class="comment">// special pet checks</span></div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;            {</div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>();</div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;                    pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ab8ceebad76b0e65fa1f6c9031070a75c">GetCharm</a>();</div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;                {</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;                    <span class="keywordflow">if</span> (!pet-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaa8582c07f58c05e32b1885a14e8320a">SPELL_FAILED_TARGETS_DEAD</a>;</div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#ae21aa77332ab7e86c1fef7ec58d3c866">IsIgnoreLosSpellEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)) &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(pet, <span class="keyword">true</span>))</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d">SPELL_FAILED_LINE_OF_SIGHT</a>;</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;                }</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;            }</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;            <span class="keywordflow">default</span>: <span class="comment">// needs target</span></div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;            {</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;                <span class="keyword">auto</span>&amp; data = <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetType];</div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;                <a class="code" href="classWorldObject.html">WorldObject</a>* originalCaster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>();</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;                <span class="keywordflow">if</span> (!originalCaster)</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;                    originalCaster = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;                <span class="keywordflow">if</span> (data.type == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a> &amp;&amp; data.filter != <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a76152bae5512ab0aeaf68f34c550d33a">TARGET_SCRIPT</a> &amp;&amp; (data.enumerator == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128aafe7cc364fd8375e47c1e02c7c640aa1">TARGET_ENUMERATOR_SINGLE</a> || data.enumerator == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a8e5483b8a18d10590d68cbeba15ce870">TARGET_ENUMERATOR_CHAIN</a>))</div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;                {</div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;                    <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;                    <span class="keywordflow">switch</span> (data.filter)</div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;                    {</div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a91709d6ba94197217509324cb71783b5">TARGET_HARMFUL</a>: <span class="keywordflow">if</span> (!originalCaster-&gt;<a class="code" href="classWorldObject.html#a67762eaa54f1dba00509f655e942e555">CanAttackSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502ad09d82da366aedd07fc12f30cdc8163a">TARGET_HELPFUL</a>: <span class="keywordflow">if</span> (!originalCaster-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)) <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a570a3901e62080a86098350ecafeec2e">TARGET_PARTY</a>:</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502ab28844a73c37b35cde400ace4704ac9f">TARGET_GROUP</a>: <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) || !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#afc35f58684e81ba4956b79fc1434eb7b">IsInGroup</a>(target, targetType == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3888b9db5eaa2d6c9c5001a61fed215a">TARGET_UNIT_PARTY</a>)) <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;                        <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;                    }</div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;                }</div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;            }</div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;        }</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;    }</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160; </div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;    <span class="comment">// zone check</span></div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> zone, area;</div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae1a8efe701e885f0ed1eaeb93bbece8e">GetZoneAndAreaId</a>(zone, area);</div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160; </div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> locRes = <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSpellAllowedInLocationError(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>(), zone, area,</div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;                             <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>() : <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;    <span class="keywordflow">if</span> (locRes != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;    {</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#aa0a17355e9a81e14b37013cd45e4aa75">IsSpellDoNotReportFailure</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;            <span class="keywordflow">return</span> locRes;</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;    }</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160; </div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160; </div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;    <span class="comment">// not let players cast spells at mount (and let do it to creatures)</span></div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abefb328ba7a52fc7c5a16c60855b4d6a">GetMountID</a>() &amp;&amp; !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp;</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;            !<a class="code" href="SpellMgr_8cpp.html#a28b958e9db34bdad035df1f81ed2a280">IsPassiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8eb753addae32fb84984d8c1c613108f">SPELL_ATTR_ALLOW_WHILE_MOUNTED</a>))</div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;    {</div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a598220bd7032e604abfdb838b9d60f66">IsTaxiFlying</a>())</div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafede20d779c776cfb3cf819a7589801b">SPELL_FAILED_NOT_ON_TAXI</a>;</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba11cd41b98b17d534ca5a171df834d909">SPELL_FAILED_NOT_MOUNTED</a>;</div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;    }</div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160; </div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;    <span class="comment">// always (except passive spells) check items</span></div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8cpp.html#a28b958e9db34bdad035df1f81ed2a280">IsPassiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;    {</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> castResult = <a class="code" href="classSpell.html#a516f3d4404f0ca2010d21d8c64d478ee">CheckItems</a>();</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;        <span class="keywordflow">if</span> (castResult != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;            <span class="keywordflow">return</span> castResult;</div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;    }</div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160; </div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;    <span class="comment">// check spell focus object</span></div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa8df07a2ebac695b4e72f5db374a451e">RequiresSpellFocus</a>)</div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;    {</div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;        <a class="code" href="classGameObject.html">GameObject</a>* ok = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;        <a class="code" href="classMaNGOS_1_1GameObjectFocusCheck.html">MaNGOS::GameObjectFocusCheck</a> go_check(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa8df07a2ebac695b4e72f5db374a451e">RequiresSpellFocus</a>);</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;        <a class="code" href="structMaNGOS_1_1GameObjectSearcher.html">MaNGOS::GameObjectSearcher&lt;MaNGOS::GameObjectFocusCheck&gt;</a> checker(ok, go_check);</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;        <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, checker, <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#afd94bb4369509da2eaa0d461df6e43c2">GetVisibilityDistance</a>());</div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160; </div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;        <span class="keywordflow">if</span> (!ok)</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf43ad3199e8e395f348d768f4f11b39c">SPELL_FAILED_REQUIRES_SPELL_FOCUS</a>;</div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160; </div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;        <a class="code" href="classSpell.html#af20339d17376838e640f9cc2f9b01308">m_eventTarget</a> = ok;                                   <span class="comment">// game object found in range</span></div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;    }</div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160; </div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>)</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;    {</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> castResult;</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>)</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;        {</div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;            castResult = <a class="code" href="classSpell.html#af29009de4460469d4a4157fa1eda8173">CheckRange</a>(strict);</div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;            <span class="keywordflow">if</span> (castResult != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;                <span class="keywordflow">return</span> castResult;</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;        }</div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;    }</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160; </div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#aa2b31e212fc2a2b6608c464b428976d1">m_ignoreCosts</a>)</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;    {</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> castResult = <a class="code" href="classSpell.html#a3b98230b66cde204babd4bf0f3a73789">CheckPower</a>(strict);</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;        <span class="keywordflow">if</span> (castResult != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;            <span class="keywordflow">return</span> castResult;</div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160; </div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;        <span class="comment">// triggered spell not affected by stun/etc</span></div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;        castResult = <a class="code" href="classSpell.html#af471902fa858fc71b299d69d88272be5">CheckCasterAuras</a>(<a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a>);</div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;        <span class="keywordflow">if</span> (castResult != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;            <span class="keywordflow">return</span> castResult;</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;    }</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160; </div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#afbeb295ad7652c0abf129066e76a4a10">m_channelOnly</a>)</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;    {</div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;        <a class="code" href="classSpell.html#adba11b52d6d255e575600716d9c87ec5">m_partialApplicationMask</a> = <a class="code" href="DBCEnums_8h.html#a0040fdd9a7192268e855e468c71b68a1a1b9f5fd9fb33c4b9012f42d680914c30">EFFECT_MASK_ALL</a>; <span class="comment">// no effects to be executed but spell needs to go through</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;    }</div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160; </div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> availableEffectMask = 0;</div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i])</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;            availableEffectMask |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160; </div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;    <span class="keyword">auto</span> partialApplication = [&amp;](<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i) -&gt; <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a></div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;    {</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;        availableEffectMask &amp;= (~(1 &lt;&lt; i));</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;        <span class="keywordflow">if</span> (availableEffectMask == 0)</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;            <a class="code" href="classSpell.html#adba11b52d6d255e575600716d9c87ec5">m_partialApplicationMask</a> |= (1 &lt;&lt; i);</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160; </div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;    };</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160; </div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;    {</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;        <span class="comment">// for effects of spells that have only one target</span></div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i])</div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;        {</div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ad7703a913968b0c340aa072bec1182fb">SPELL_EFFECT_INSTAKILL</a>:</div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;                <span class="comment">// Death Pact</span></div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 48743)</div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;                {</div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>;</div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160; </div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;                    <span class="keywordflow">if</span> (!((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetSelectionGuid())</div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;                    <a class="code" href="classPet.html">Pet</a>* target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a7c6017ca4c2a442952e50597d6ce0be5">GetPet</a>(((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetSelectionGuid());</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160; </div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;                    <span class="comment">// alive</span></div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;                    <span class="keywordflow">if</span> (!target || target-&gt;<a class="code" href="classUnit.html#a82ab342b3d9aef32e6fe61405eff82f3">IsDead</a>())</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;                    <span class="comment">// undead</span></div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a80140b04cc4277697de8f853e7da90e8">GetCreatureType</a>() != <a class="code" href="SharedDefines_8h.html#a5bc40f1116d89138cda8ebd1a04694dfa90dea51445e88ead6218aa0a5a5e4344">CREATURE_TYPE_UNDEAD</a>)</div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;                    <span class="comment">// owned</span></div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a6d1af92863df5e94a0d4431c454f5b2d">GetOwnerGuid</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160; </div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;                    <span class="keywordtype">float</span> dist = <a class="code" href="SpellMgr_8h.html#ab4b1d536a5b410eaf601a13235196d3a">GetSpellRadius</a>(<a class="code" href="DBCStores_8cpp.html#a495e62fceccd344a25ba720c9e1966d9">sSpellRadiusStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[i]));</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;                    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, dist))</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160; </div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;                    <span class="comment">// will set in target selection code</span></div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;                }</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a027bcdf3b42e90e7374802fe61fd776d">SPELL_EFFECT_DUMMY</a>:</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;            {</div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;                <span class="comment">// By Spell ID</span></div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 19938)               <span class="comment">// Awaken Lazy Peon</span></div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;                {</div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;                    <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;                    <span class="comment">// 17743 = Lazy Peon Sleep | 10556 = Lazy Peon</span></div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;                    <span class="keywordflow">if</span> (!target || !target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(17743) || target-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() != 10556)</div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;                }</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 20577)</div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;                {</div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;                    <a class="code" href="classWorldObject.html">WorldObject</a>* result = FindCorpseUsing&lt;MaNGOS::CannibalizeObjectCheck&gt;();</div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;                    <span class="keywordflow">if</span> (result)</div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;                    {</div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;                        <span class="keywordflow">switch</span> (result-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>())</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;                        {</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>:</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>:</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;                                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a90f0bd6624e63ad55052e7974f7c7cdf">CheckTarget</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(result), <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <span class="keyword">false</span>, <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba1d50ba8ddaa28f38304b557bbf8cdfc6">EXCEPTION_NONE</a>))</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafcdfe7569de0abc1be48e73fc20e29c3">SPELL_FAILED_NO_EDIBLE_CORPSES</a>;</div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2ab20e64ae3f5f5a5ecffa53fee57d7d2f">TYPEID_CORPSE</a>:</div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* owner = <a class="code" href="classObjectAccessor.html#a959bcb90b71aacbb8560642c86c3ab63">ObjectAccessor::FindPlayer</a>(<span class="keyword">static_cast&lt;</span><a class="code" href="classCorpse.html">Corpse</a>*<span class="keyword">&gt;</span>(result)-&gt;GetOwnerGuid()))</div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;                                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a90f0bd6624e63ad55052e7974f7c7cdf">CheckTarget</a>(owner, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <span class="keyword">false</span>, <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba1d50ba8ddaa28f38304b557bbf8cdfc6">EXCEPTION_NONE</a>))</div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;                                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafcdfe7569de0abc1be48e73fc20e29c3">SPELL_FAILED_NO_EDIBLE_CORPSES</a>;</div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;                        }</div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;                    }</div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafcdfe7569de0abc1be48e73fc20e29c3">SPELL_FAILED_NO_EDIBLE_CORPSES</a>;</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;                }</div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 51582)          <span class="comment">// Rocket Boots Engaged</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;                {</div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9556ed3ef1d6b11bc0a50966a4d38e70">IsInWater</a>() &amp;&amp; (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> || <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;<a class="code" href="classPlayer.html#a6fa4db05df1d6e6cd7b680b045e383ab">IsInHighLiquid</a>()))</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa6cc63143dadc031b5c849e25b6b6647">SPELL_FAILED_ONLY_ABOVEWATER</a>;</div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;                }</div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aadb41c294565428ff67a9a137d01465a">SpellIconID</a> == 156)   <span class="comment">// Holy Shock</span></div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;                {</div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;                    <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;                    <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160; </div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;                    <span class="comment">// Prevents usage when cant neither attack or assist and not in front for shock attack</span></div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a08cbed215e32eaeb4d9716da830e72b8">CanAttack</a>(target))</div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;                    {</div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae0338558ec4649199ff37b6ae422e0b2">HasInArc</a>(target))</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0201f3ee2e3101af63e54aafbf14c226">SPELL_FAILED_UNIT_NOT_INFRONT</a>;</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;                    }</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;                }</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;                <span class="comment">// Fire Nova</span></div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a> == <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9c8a9c6e102c760263471a93e58e80ea">SPELLFAMILY_SHAMAN</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aadb41c294565428ff67a9a137d01465a">SpellIconID</a> == 33)</div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;                {</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;                    <span class="comment">// fire totems slot</span></div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5581f255ed1a06845549822b93734a8a">GetTotemGuid</a>(<a class="code" href="SharedDefines_8h.html#a8e779c285da3368f4301e8ff21653960ac22ac2f620eb2d8c0eb3d3161a04113d">TOTEM_SLOT_FIRE</a>))</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba85507d5434460a32675c0e5601110d3f">SPELL_FAILED_TOTEMS</a>;</div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;                }</div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;            }</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a28e7a1160ba7ba1c53fff6591320ae32">SPELL_EFFECT_DISTRACT</a>:                     <span class="comment">// All nearby enemies must not be in combat</span></div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;            {</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>))</div>
<div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;                {</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;                    <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> targetsCombat;</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;                    <span class="keywordtype">float</span> radius = <a class="code" href="SpellMgr_8h.html#ab4b1d536a5b410eaf601a13235196d3a">GetSpellRadius</a>(<a class="code" href="DBCStores_8cpp.html#a495e62fceccd344a25ba720c9e1966d9">sSpellRadiusStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[i]));</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160; </div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;                    <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">FillAreaTargets</a>(targetsCombat, radius, 0.f, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82">PUSH_DEST_CENTER</a>, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a>);</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160; </div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;                    <span class="keywordflow">if</span> (targetsCombat.empty())</div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160; </div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;                    <span class="keywordtype">bool</span> inCombat = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; itr : targetsCombat)</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;                    {</div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;                        <span class="keywordflow">if</span> (!itr-&gt;IsInCombat())</div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;                        {</div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;                            inCombat = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;                        }</div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;                    }</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;                            </div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;                    <span class="keywordflow">if</span> (inCombat)</div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba379308e1f442458eb4d1f1dde308b7c7">SPELL_FAILED_TARGET_IN_COMBAT</a>;</div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;                }</div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;            }</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abd12cbfc6a8daf7ca788d06a77256e01">SPELL_EFFECT_SCHOOL_DAMAGE</a>:</div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;            {</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;                <span class="comment">// Hammer of Wrath</span></div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a39b26f93bb0f756875d72cb4338333c9">SpellVisual</a>[0] == 7250)</div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;                {</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160; </div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>() &gt; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classUnit.html#a5173c1774b09b42c409bf31280c37d36">GetMaxHealth</a>() * 0.2)</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;                }</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;            }</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af5abf258b008fbff818ad32ac7a95fbb">SPELL_EFFECT_CREATE_ITEM</a>:</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;            {</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;                {</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;                    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[i] != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a>)</div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160; </div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;                    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;                        target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160; </div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;                    <span class="keywordflow">if</span> (i != <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>) <span class="comment">// TODO: Partial application</span></div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160; </div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), target);</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;                    <a class="code" href="Player_8h.html#a06f492a0a20f5264c8395684220fec84">ItemPosCountVec</a> dest;</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> no_space = 0;</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;                    <a class="code" href="Item_8h.html#a73617af2b3e5e935646638fa13678391">InventoryResult</a> msg = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target)-&gt;CanStoreNewItem(<a class="code" href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5a843659af0a40139bfa505d7e7982477b">NULL_BAG</a>, <a class="code" href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5aeb5cbd7990d2f5e679ec4ecc65e83130">NULL_SLOT</a>, dest, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i], count, &amp;no_space);</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;                    <span class="keywordflow">if</span> (msg != <a class="code" href="Item_8h.html#a73617af2b3e5e935646638fa13678391a939b6661cd19d6c18274906abb28021c">EQUIP_ERR_OK</a>)</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;                    {</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;                        <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* proto = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetItemPrototype(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i]);</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;                        <span class="keywordflow">if</span> (proto &amp;&amp; proto-&gt;<a class="code" href="structItemPrototype.html#a8fe5d2c25f9cf0dc186c1ce8533410db">ItemLimitCategory</a>)</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;                            <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a> = proto-&gt;<a class="code" href="structItemPrototype.html#a8fe5d2c25f9cf0dc186c1ce8533410db">ItemLimitCategory</a>;</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac434f4f7f84bea20939be3067eb33c5f">SPELL_FAILED_TOO_MANY_OF_ITEM</a>;</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;                    }</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;                }</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160; </div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;            }</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a6a7c4e6691a082baa4ccf8e8c2efe6b3">SPELL_EFFECT_TAMECREATURE</a>:</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;            {</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;                <span class="comment">// Spell can be triggered, we need to check original caster prior to caster</span></div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* caster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>();</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* tameTarget;</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160; </div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;                <span class="keywordtype">bool</span> gmmode = <a class="code" href="classSpell.html#ab3d3ccf4db3daa4de3bdfd7fe3371eae">m_triggeredBySpellInfo</a> == <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;                <span class="keywordflow">if</span> (gmmode)</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;                    tameTarget = caster-&gt;<a class="code" href="classUnit.html#afc3c9a652f2026707440d4e8bdd87930">GetTarget</a>();</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;                    tameTarget = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">GetChannelObject</a>());</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160; </div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;                <span class="keywordflow">if</span> (!caster || caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> ||</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;                        !tameTarget || tameTarget-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160; </div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* plrCaster = (<a class="code" href="classPlayer.html">Player</a>*)caster;</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160; </div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;                <span class="keywordflow">if</span> (gmmode &amp;&amp; !<a class="code" href="classChatHandler.html">ChatHandler</a>(plrCaster).<a class="code" href="classChatHandler.html#ae6e3e55f3307001fe04387f2f9e80074">FindCommand</a>(<span class="stringliteral">&quot;npc tame&quot;</span>))</div>
<div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;                {</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa8eb9f589293d6756399e98596c8583eb">PETTAME_UNKNOWNERROR</a>);</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;                }</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160; </div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                <span class="keywordflow">if</span> (plrCaster-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa1c7c740a229946b31a477913e2e38fd8">CLASS_HUNTER</a> &amp;&amp; !gmmode)</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;                {</div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa2677a8f323ffd8e91068f897d112c826">PETTAME_UNITSCANTTAME</a>);</div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;                }</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160; </div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;                <a class="code" href="classCreature.html">Creature</a>* target = (<a class="code" href="classCreature.html">Creature</a>*)tameTarget;</div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160; </div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classCreature.html#a5645c3877ec9f0e68c8e26b76cebcf68">IsPet</a>() || target-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;                {</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa0756188c4255061315a9172a12eace4a">PETTAME_CREATUREALREADYOWNED</a>);</div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;                }</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160; </div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>() &gt; plrCaster-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>() &amp;&amp; !gmmode)</div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;                {</div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154faa6e6ed17785e5c16d1944dd8770688b6">PETTAME_TOOHIGHLEVEL</a>);</div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;                }</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160; </div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classCreature.html#a013409bd4b6d0286c0243cfff4221e0d">GetCreatureInfo</a>()-&gt;<a class="code" href="structCreatureInfo.html#a0522fb9f0ed5b0181419a05c48488c36">IsExotic</a>() &amp;&amp; !plrCaster-&gt;<a class="code" href="classPlayer.html#a37acea1f67951ec8b125cae412ddbe4e">CanTameExoticPets</a>() &amp;&amp; !gmmode)</div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;                {</div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa730c5ae2ccd2cd5abf9de16c78a89175">PETTAME_CANTCONTROLEXOTIC</a>);</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;                }</div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160; </div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;                <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classCreature.html#a013409bd4b6d0286c0243cfff4221e0d">GetCreatureInfo</a>()-&gt;<a class="code" href="structCreatureInfo.html#a4f708c2c90352dbcfd9bb23cb66238b3">isTameable</a>(plrCaster-&gt;<a class="code" href="classPlayer.html#a37acea1f67951ec8b125cae412ddbe4e">CanTameExoticPets</a>()))</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;                {</div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa356ff068f2e441e3a1899031a405bce4">PETTAME_NOTTAMEABLE</a>);</div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;                }</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160; </div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;                <span class="keywordflow">if</span> (plrCaster-&gt;<a class="code" href="classUnit.html#a57870b79c2a356567afd5febedf79a61">GetPetGuid</a>() || plrCaster-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;                {</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;                    plrCaster-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fad714798a413a2ddcdcbb9ce9ec83357b">PETTAME_ANOTHERSUMMONACTIVE</a>);</div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;                }</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160; </div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;            }</div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97acef490c9f3480852d33dbbec7727fa7f">SPELL_EFFECT_LEARN_SPELL</a>:</div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;            {</div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a>)</div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160; </div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;                <a class="code" href="classPet.html">Pet</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>();</div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160; </div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160; </div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;                <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* learn_spellproto = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1d14e6dd0b955eb76e4bb65171368518">EffectTriggerSpell</a>[i]);</div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160; </div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;                <span class="keywordflow">if</span> (!learn_spellproto)</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba270280418a53c9d018219f9cddda4e3c">SPELL_FAILED_NOT_KNOWN</a>;</div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160; </div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;                <span class="keywordflow">if</span> (learn_spellproto-&gt;<a class="code" href="structSpellEntry.html#aa401405fe3221db2723b2b8e6fe48c9b">spellLevel</a> &gt; pet-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>())</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf">SPELL_FAILED_LOWLEVEL</a>;</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160; </div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;            }</div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af8a88e3b930f739bc8327f4df29d9904">SPELL_EFFECT_LEARN_PET_SPELL</a>:</div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;            {</div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;                <a class="code" href="classPet.html">Pet</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>();</div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160; </div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160; </div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;                <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* learn_spellproto = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1d14e6dd0b955eb76e4bb65171368518">EffectTriggerSpell</a>[i]);</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160; </div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;                <span class="keywordflow">if</span> (!learn_spellproto)</div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba270280418a53c9d018219f9cddda4e3c">SPELL_FAILED_NOT_KNOWN</a>;</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160; </div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;                <span class="keywordflow">if</span> (learn_spellproto-&gt;<a class="code" href="structSpellEntry.html#aa401405fe3221db2723b2b8e6fe48c9b">spellLevel</a> &gt; pet-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>())</div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf">SPELL_FAILED_LOWLEVEL</a>;</div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160; </div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;            }</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4709170900adb00870701e66eb1b2837">SPELL_EFFECT_APPLY_GLYPH</a>:</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;            {</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> glyphId = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i];</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structGlyphPropertiesEntry.html">GlyphPropertiesEntry</a> <span class="keyword">const</span>* gp = <a class="code" href="DBCStores_8cpp.html#af61cd8fbbd2bde6fd6763ce7301e728e">sGlyphPropertiesStore</a>.LookupEntry(glyphId))</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(gp-&gt;SpellId))</div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad611ba5231ffb877f1c3652394038d6c">SPELL_FAILED_UNIQUE_GLYPH</a>;</div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;            }</div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4bf59655f967f14cdb70296778f47d20">SPELL_EFFECT_FEED_PET</a>:</div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;            {</div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160; </div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;                <a class="code" href="classItem.html">Item</a>* foodItem = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>();</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;                <span class="keywordflow">if</span> (!foodItem)</div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160; </div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;                <a class="code" href="classPet.html">Pet</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>();</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160; </div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160; </div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;                <span class="keywordflow">if</span> (!pet-&gt;<a class="code" href="classPet.html#a14dac45e5b46ed30df4713f98a69bece">HaveInDiet</a>(foodItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()))</div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3c4802dcde9c3d8be05c8028764a7ff4">SPELL_FAILED_WRONG_PET_FOOD</a>;</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160; </div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;                <span class="keywordflow">if</span> (!pet-&gt;<a class="code" href="classPet.html#ad5eaac78f6eace6db0d40d2f388c90f5">GetCurrentFoodBenefitLevel</a>(foodItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#a8eca0641dc694b14de2db0e23a341328">ItemLevel</a>))</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2978fb13bfa559f6fe707282f9ae209e">SPELL_FAILED_FOOD_LOWLEVEL</a>;</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160; </div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;                <span class="keywordflow">if</span> (pet-&gt;<a class="code" href="classUnit.html#af5e75d013dfa8a8b888d7714992e3f2a">IsInCombat</a>())</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba14dbc498af8458773a0095bb98957889">SPELL_FAILED_AFFECTING_COMBAT</a>;</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160; </div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;            }</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a0a43a6be2a57b573021530d45a1e367e">SPELL_EFFECT_POWER_BURN</a>:</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab7df9b34a249eff2c2ee82925fbc87d9">SPELL_EFFECT_POWER_DRAIN</a>:</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;            {</div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;                <span class="comment">// Can be area effect, Check only for players and not check if target - caster (spell can have multiply drain/burn effects)</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;                        <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(target-&gt;<a class="code" href="classUnit.html#a4ae648f71881fd67bcdd861ec4ef2363">GetPowerType</a>()) != <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i])</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;            }</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab9f95780d14ce3a3d80b05f6955a5814">SPELL_EFFECT_CHARGE</a>:</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97adca1c3aa0e67875dd6c075066aafe6b9">SPELL_EFFECT_JUMP</a>:</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ac9e93e2be484a200e2198e609ca8224e">SPELL_EFFECT_CHARGE_DEST</a>:</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a6b546cbd034b7414776e260f8431789b">SPELL_EFFECT_JUMP_DEST</a>:</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;            {</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a5df90e7aa2cdd206ade4afdacdf679c0">m_ignoreRoot</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a4aefdbd94d5d5957bac3c0c5b0defc4c">hasUnitState</a>(<a class="code" href="group__game.html#ggae51d2ecb71f7a5cb3882982a622c9544a3b8c8f9de407420c730803e54454b841">UNIT_STAT_ROOT</a>))</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3146bc5b21d4e3b9a68e89d834b543fc">SPELL_FAILED_ROOTED</a>;</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160; </div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;                <a class="code" href="structPosition.html">Position</a> pos;</div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;                <span class="keywordtype">bool</span> check = <span class="keyword">false</span>;</div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i])</div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;                {</div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab9f95780d14ce3a3d80b05f6955a5814">SPELL_EFFECT_CHARGE</a>:</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97adca1c3aa0e67875dd6c075066aafe6b9">SPELL_EFFECT_JUMP</a>:</div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;                        {</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;                            target-&gt;<a class="code" href="classWorldObject.html#a8655e3e9a37c11c4da647cd496f8f497">GetFirstCollisionPosition</a>(pos, target-&gt;<a class="code" href="classUnit.html#a5f8e38db03da1828c7f5447548b393e3">GetCombatReach</a>(), target-&gt;<a class="code" href="classWorldObject.html#a7c15606be3c15a33c98032fe4d190379">GetAngle</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>));</div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;                            check = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;                        }</div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ac9e93e2be484a200e2198e609ca8224e">SPELL_EFFECT_CHARGE_DEST</a>:</div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a6b546cbd034b7414776e260f8431789b">SPELL_EFFECT_JUMP_DEST</a>:</div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;                        {</div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;                            pos = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">getDestination</a>();</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;                            check = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;                        }</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;                }</div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160; </div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;                <span class="keywordflow">if</span> (check &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a99b6da32b575b04d705fc8254d41b352">SPELL_ATTR_EX6_NO_JUMP_PATHING</a>))</div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;                {</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;                    <span class="keywordtype">float</span> range = <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(<a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>));</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160; </div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;                    <a class="code" href="classPathFinder.html">PathFinder</a> pathFinder(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;                    pathFinder.<a class="code" href="classPathFinder.html#a493fa952a7a3a66f8c7598fe47a1c8e4">setPathLengthLimit</a>(range * 1.5f);</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;                    <span class="keywordtype">bool</span> result = pathFinder.<a class="code" href="classPathFinder.html#a82f17d19c5123e2b113026961580c7d2">calculate</a>(pos.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, pos.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, pos.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>);</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160; </div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;                    <span class="keywordflow">if</span> (pathFinder.<a class="code" href="classPathFinder.html#a16f97a42236045337ddc92d3b6d7f556">getPathType</a>() &amp; <a class="code" href="PathFinder_8h.html#ae093c9a96eda0463cdd2501ba83f10c3a8a25c1fe0f8142291e2183102e647cc2">PATHFIND_SHORT</a>)</div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;                    <span class="keywordflow">if</span> (!result || pathFinder.<a class="code" href="classPathFinder.html#a16f97a42236045337ddc92d3b6d7f556">getPathType</a>() &amp; <a class="code" href="PathFinder_8h.html#ae093c9a96eda0463cdd2501ba83f10c3a5ab66bcba6eb689d881b4ebc85188984">PATHFIND_NOPATH</a>)</div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf4769b8c59264918bb4ae14e2452eb8f">SPELL_FAILED_NOPATH</a>;</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;                }</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;            }</div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ae183bb456e27ed2416c7b0d2a78dd2c0">SPELL_EFFECT_SKINNING</a>:</div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;            {</div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> || !<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() || <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>)</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160; </div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ad990ec1dc8c9d2fd611f145e9f752885">UNIT_FLAG_SKINNABLE</a>))</div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad08fa9eaa1789401b21326a44252763a">SPELL_FAILED_TARGET_UNSKINNABLE</a>;</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160; </div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;                <a class="code" href="classCreature.html">Creature</a>* creature = (<a class="code" href="classCreature.html">Creature</a>*)<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160; </div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;                <span class="keywordflow">if</span> (creature-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba32fda87d13db4d9c3e234cc4e4e90bf6">SPELL_FAILED_TARGET_NOT_DEAD</a>;</div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160; </div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;                <span class="keywordflow">if</span> (creature-&gt;<a class="code" href="classCreature.html#a4104af1a1e3d70a82cd92d16f8378147">GetLootStatus</a>() != <a class="code" href="SharedDefines_8h.html#af5bcca146183dc0013aeea53f940d121af45ce69153311c323432adb88af93c81">CREATURE_LOOT_STATUS_LOOTED</a>)<span class="comment">// || creature-&gt;GetCreatureType() != CREATURE_TYPE_CRITTER)</span></div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba010f9248a8f946a89ed5afa1a71d9bbc">SPELL_FAILED_TARGET_NOT_LOOTED</a>;</div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160; </div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> skill = creature-&gt;<a class="code" href="classCreature.html#a013409bd4b6d0286c0243cfff4221e0d">GetCreatureInfo</a>()-&gt;<a class="code" href="structCreatureInfo.html#a88de6cb7b80a9bcd956f0571a9584f67">GetRequiredLootSkill</a>();</div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160; </div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> skillValue = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetSkillValue(skill);</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> TargetLevel = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>();</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> ReqValue = (skillValue &lt; 100 ? (TargetLevel - 10) * 10 : TargetLevel * 5);</div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;                <span class="keywordflow">if</span> (ReqValue &gt; skillValue)</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505">SPELL_FAILED_LOW_CASTLEVEL</a>;</div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160; </div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;            }</div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aef9e266be3bbaf4fb858584a5a61bf7e">SPELL_EFFECT_OPEN_LOCK</a>:</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;            {</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>) <span class="comment">// only players can open locks, gather etc.</span></div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160; </div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;                <span class="comment">// we need a go target in case of TARGET_GAMEOBJECT (for other targets acceptable GO and items)</span></div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa330b81de27a4a8f562ae8f60de81d8bf">TARGET_GAMEOBJECT</a>)</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;                {</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">getGOTarget</a>())</div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;                }</div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160; </div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;                <span class="comment">// get the lock entry</span></div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> lockId;</div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">getGOTarget</a>())</div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;                {</div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;                    <span class="comment">// In BattleGround players can use only flags and banners</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;                    <span class="keywordflow">if</span> (((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;InBattleGround() &amp;&amp;</div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;                            !((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;CanUseBattleGroundObject())</div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba47a5ddf521d02893e0a4132fc8d3ef90">SPELL_FAILED_TRY_AGAIN</a>;</div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160; </div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;                    lockId = go-&gt;GetGOInfo()-&gt;GetLockId();</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;                    <span class="keywordflow">if</span> (!lockId)</div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba502cb600f20a34621d9b04b897c1046b">SPELL_FAILED_ALREADY_OPEN</a>;</div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160; </div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;                    <span class="comment">// check if its in use only when cast is finished (called from spell::cast() with strict = false)</span></div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;                    <span class="keywordflow">if</span> (!strict &amp;&amp; go-&gt;IsInUse())</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3396957a80f674588a97d40eb1a2f064">SPELL_FAILED_CHEST_IN_USE</a>;</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160; </div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;                    <span class="keywordflow">if</span> (!strict &amp;&amp; go-&gt;HasFlag(<a class="code" href="UpdateFields_8h.html#aee9d327a38d3cfe074ba81a44817491fad08f691f9fe08339350689b33ca12d66">GAMEOBJECT_FLAGS</a>, <a class="code" href="SharedDefines_8h.html#abb1a2beaa12ca034ba4388d83708a89dabfea4f1275e85265f1637b0f1123389d">GO_FLAG_IN_USE</a>))</div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3396957a80f674588a97d40eb1a2f064">SPELL_FAILED_CHEST_IN_USE</a>;</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160; </div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;                    <span class="comment">// done in client but we need to recheck anyway</span></div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;                    <span class="keywordflow">if</span> (go-&gt;GetGOInfo()-&gt;CannotBeUsedUnderImmunity() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a61338f487648d7d4fadaa8480d623593">UNIT_FLAG_IMMUNE</a>))</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4333fb3114462db8facc40c46d92c40e">SPELL_FAILED_DAMAGE_IMMUNE</a>;</div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;                }</div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* item = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;                {</div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;                    <span class="comment">// not own (trade?)</span></div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;                    <span class="keywordflow">if</span> (item-&gt;GetOwner() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba56178933380524354520fc81ffa3b350">SPELL_FAILED_ITEM_GONE</a>;</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160; </div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;                    lockId = item-&gt;GetProto()-&gt;LockID;</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160; </div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;                    <span class="comment">// if already unlocked</span></div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;                    <span class="keywordflow">if</span> (!lockId || item-&gt;HasFlag(<a class="code" href="UpdateFields_8h.html#a529e4bfaaee7e3c2dc52aaa447287cfba3fdc4d82d91ec74b4223b5233aa78efe">ITEM_FIELD_FLAGS</a>, <a class="code" href="Item_8h.html#a0f5184076c22295de05457493ab1e476a57d2e5e22d11497cfb9a1cf92c00521c">ITEM_DYNFLAG_UNLOCKED</a>))</div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba502cb600f20a34621d9b04b897c1046b">SPELL_FAILED_ALREADY_OPEN</a>;</div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;                }</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160; </div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;                <span class="comment">// check lock compatibility</span></div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;                <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIdx = <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i);</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;                <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> res = <a class="code" href="classSpell.html#aea24ad8716a09b612bf4856b99c9c978">CanOpenLock</a>(effIdx, lockId, <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillId, <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].reqSkillValue, <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillValue);</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;                <span class="keywordflow">if</span> (res != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;                    <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160; </div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;                <span class="comment">// Failing gathering attempt for mining and herbalism was removed in patch 3.1.0: http://wowwiki.wikia.com/wiki/Patch_3.1.0</span></div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;                <span class="comment">// chance for fail at orange LockPicking gathering attempt</span></div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;                <span class="comment">// second check prevent fail at rechecks</span></div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;                <span class="keywordflow">if</span> (!strict &amp;&amp; <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillId != <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a984419a280ad5111b03d5d5ecdcd9a0f">SKILL_NONE</a> &amp;&amp; <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillId != <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234af833460db5b970aa092fb57e38593ba9">SKILL_HERBALISM</a> &amp;&amp; <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillId != <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a77d73a39948d0b12d05f2a8431738b95">SKILL_MINING</a>)</div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;                {</div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;                    <span class="keywordtype">bool</span> canFailAtMax = <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].<a class="code" href="structSpell_1_1EffectSkillInfo.html#a712ff9894f1286566d59d8b3e2367ef1">skillId</a> != <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234af833460db5b970aa092fb57e38593ba9">SKILL_HERBALISM</a> &amp;&amp; <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].<a class="code" href="structSpell_1_1EffectSkillInfo.html#a712ff9894f1286566d59d8b3e2367ef1">skillId</a> != <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a77d73a39948d0b12d05f2a8431738b95">SKILL_MINING</a>;</div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160; </div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;                    <span class="comment">// chance for failure in orange gather / lockpick (gathering skill can&#39;t fail at maxskill)</span></div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;                    <span class="keywordflow">if</span> ((canFailAtMax || <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillValue &lt; <a class="code" href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a>.GetConfigMaxSkillValue())</div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;                        &amp;&amp; <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].<a class="code" href="structSpell_1_1EffectSkillInfo.html#aa38ce859b0ffcecf28251a391827de70">reqSkillValue</a> &gt; <a class="code" href="Util_8cpp.html#a6ae07d2bb0593d8339e65c136f63ecc0">irand</a>(<a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillValue - 25, <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].skillValue + 37))</div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba47a5ddf521d02893e0a4132fc8d3ef90">SPELL_FAILED_TRY_AGAIN</a>;</div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                }</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;                    <a class="code" href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">m_effectSkillInfo</a>[effIdx].<a class="code" href="structSpell_1_1EffectSkillInfo.html#a712ff9894f1286566d59d8b3e2367ef1">skillId</a> = <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a984419a280ad5111b03d5d5ecdcd9a0f">SKILL_NONE</a>;</div>
<div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;            }</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a80153156c6cdcf1436c5a4fc33ae95c7">SPELL_EFFECT_PICKPOCKET</a>:</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;            {</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;                <span class="comment">// should always fail above if not exists</span></div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;                <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>())</div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160; </div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;                <a class="code" href="classCreature.html">Creature</a>* creatureTarget = <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(target);</div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;                <span class="keywordflow">if</span> (!creatureTarget-&gt;<a class="code" href="classCreature.html#a013409bd4b6d0286c0243cfff4221e0d">GetCreatureInfo</a>()-&gt;<a class="code" href="structCreatureInfo.html#a29c2544ffdafdff1fc3b382d44dd4474">PickpocketLootId</a>)</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba57bf9e02ebe1906a99001f3de731f757">SPELL_FAILED_TARGET_NO_POCKETS</a>;</div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;            }</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ac4b6fe5309268ff656d1606ebdc637ce">SPELL_EFFECT_SUMMON_DEAD_PET</a>:</div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;            {</div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;                <a class="code" href="classCreature.html">Creature</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>();</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;                {</div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;                    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classPet.html#aff5ffb9a757e225ce15e00e718a335d9">Pet::TryLoadFromDB</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;                    <span class="keywordflow">if</span> (result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>)</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160; </div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;                    <span class="keywordflow">if</span> (result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;                    {</div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;                        ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;SendPetTameFailure(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fab38e2c8f7365784032dad0dac40ac7de">PETTAME_NOTDEAD</a>);</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;                    }</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160; </div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;                    <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaa8582c07f58c05e32b1885a14e8320a">SPELL_FAILED_TARGETS_DEAD</a>)</div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba413f89a20f52b5ee916ca64f50fc4467">SPELL_FAILED_UNKNOWN</a>;</div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;                }</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pet-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a>;</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160; </div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;            }</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;            <span class="comment">// This is generic summon effect</span></div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa7be476935ce81144c2b383b7af7bf47">SPELL_EFFECT_SUMMON</a>:</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;            {</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="structSummonPropertiesEntry.html">SummonPropertiesEntry</a> <span class="keyword">const</span>* summon_prop = <a class="code" href="DBCStores_8cpp.html#ab1c80e434031e07ffd42dc18640e5b26">sSummonPropertiesStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab0c175d928e13ac47a1a0125e16d048c">EffectMiscValueB</a>[i]))</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;                {</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;                    <span class="keywordflow">if</span> (summon_prop-&gt;Group == <a class="code" href="DBCEnums_8h.html#a24fca3b9586dfe1d08bbea5f78626640a4d0533929599bc8711fd2152978a2426">SUMMON_PROP_GROUP_PETS</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;                    {</div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>) &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a57870b79c2a356567afd5febedf79a61">GetPetGuid</a>())</div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a>;</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160; </div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c">SPELL_FAILED_ALREADY_HAVE_CHARM</a>;</div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;                    }</div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;                }</div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160; </div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>))</div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a59c69d64e6062cd5d429791a5ce986d6">FindGuardianWithEntry</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i]))</div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a>;</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160; </div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;            }</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a0e77fe9c0e808131a2440afe38a856af">SPELL_EFFECT_SUMMON_PET</a>:</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;            {</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c">SPELL_FAILED_ALREADY_HAVE_CHARM</a>;</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160; </div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> plClass = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>();</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;                <span class="keywordflow">if</span> (plClass == <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa1c7c740a229946b31a477913e2e38fd8">CLASS_HUNTER</a>)</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;                {</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classCreature.html">Creature</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;                    {</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;                        <span class="keywordflow">if</span> (!pet-&gt;IsAlive())</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;                        {</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;                            ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;SendPetTameFailure(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa2221baaca0a792d55236f5a502517956">PETTAME_DEAD</a>);</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;                        }</div>
<div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>))</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a>;</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;                    }</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;                    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classPet.html#aff5ffb9a757e225ce15e00e718a335d9">Pet::TryLoadFromDB</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;                    <span class="keywordflow">if</span> (result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaa8582c07f58c05e32b1885a14e8320a">SPELL_FAILED_TARGETS_DEAD</a>)</div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;                    {</div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;                        ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;SendPetTameFailure(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa2221baaca0a792d55236f5a502517956">PETTAME_DEAD</a>);</div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;                    }</div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;                    <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;                        <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;                }</div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a57870b79c2a356567afd5febedf79a61">GetPetGuid</a>())</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;                {</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;                    <span class="keywordflow">if</span> (plClass == <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa72922255ea5f13ce70f2c5cec3e33369">CLASS_WARLOCK</a>)                  <span class="comment">// let warlock do a replacement summon</span></div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;                    {</div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;                        <span class="keywordflow">if</span> (strict)     <span class="comment">// Summoning Disorientation, trigger pet stun (cast by pet so it doesn&#39;t attack player)</span></div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetPet())</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;                                pet-&gt;CastSpell(pet, 32752, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, pet-&gt;GetObjectGuid());</div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;                    }</div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>))</div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a>;</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;                }</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160; </div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;            }</div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a61ab002c9f8774c1c907da108a721328">SPELL_EFFECT_TRIGGER_SPELL_2</a>:</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;            {</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160; </div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* caster = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;                <span class="keywordflow">if</span> (!caster-&gt;<a class="code" href="classPlayer.html#af79d4d1f2be3a95ee1b31c7966b71d32">GetSelectionGuid</a>())</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160; </div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* target = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(caster-&gt;<a class="code" href="classPlayer.html#af79d4d1f2be3a95ee1b31c7966b71d32">GetSelectionGuid</a>());</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;                <span class="keywordflow">if</span> (!target || caster == target || !target-&gt;<a class="code" href="classPlayer.html#a026e2788ccea4b7fd6b69be8cc0a0f4a">IsInGroup</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160; </div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;<span class="preprocessor">#ifdef PRENERF_2_3</span></div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;                <span class="comment">// pre 2.4 - could not summon to netherstorm</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ad498d690fbe69bb99a8a2ffdcb2f5169">GetZoneId</a>() == 3523)</div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac5b4c7f6ad3c18c893d7183117bcbbda">SPELL_FAILED_FIZZLE</a>;</div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160; </div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mapId = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>();</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;                <span class="keyword">const</span> <a class="code" href="structMapEntry.html">MapEntry</a>* map = <a class="code" href="DBCStores_8cpp.html#ac28198d1c28605951e9debe1298b8304">sMapStore</a>.LookupEntry(mapId);</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;                <span class="keywordflow">if</span> (map-&gt;<a class="code" href="structMapEntry.html#ad9902fc9b28ba9b555b45c0662aa0397">IsDungeon</a>())</div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;                {</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;                    <span class="comment">// pre 2.4 - could not summon to instance</span></div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>() != mapId)</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba731c7dfda368c8bfdb1b9cc7d3f696b8">SPELL_FAILED_TARGET_NOT_IN_INSTANCE</a>;</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;                }</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;            }</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4ef88119cf7545ebf2a3402027bf112a">SPELL_EFFECT_SUMMON_PLAYER</a>:</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;            {</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* caster = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;                <span class="keywordflow">if</span> (!caster-&gt;<a class="code" href="classPlayer.html#af79d4d1f2be3a95ee1b31c7966b71d32">GetSelectionGuid</a>())</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160; </div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* target = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetPlayer(caster-&gt;<a class="code" href="classPlayer.html#af79d4d1f2be3a95ee1b31c7966b71d32">GetSelectionGuid</a>());</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;                <span class="keywordflow">if</span> (!target || caster == target || !target-&gt;<a class="code" href="classPlayer.html#a026e2788ccea4b7fd6b69be8cc0a0f4a">IsInGroup</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160; </div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;                <span class="comment">// check if our map is dungeon</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> mapId = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>();</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;                <span class="keyword">const</span> <a class="code" href="structMapEntry.html">MapEntry</a>* map = <a class="code" href="DBCStores_8cpp.html#ac28198d1c28605951e9debe1298b8304">sMapStore</a>.LookupEntry(mapId);</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;                <span class="keywordflow">if</span> (map-&gt;<a class="code" href="structMapEntry.html#ad9902fc9b28ba9b555b45c0662aa0397">IsDungeon</a>())</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;                {</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;<span class="preprocessor">#ifdef PRENERF_2_3</span></div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;                    <span class="comment">// pre 2.4 - could not summon to instance</span></div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>() != mapId)</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba731c7dfda368c8bfdb1b9cc7d3f696b8">SPELL_FAILED_TARGET_NOT_IN_INSTANCE</a>;</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160; </div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;                    <a class="code" href="structInstanceTemplate.html">InstanceTemplate</a> <span class="keyword">const</span>* instance = <a class="code" href="classObjectMgr.html#a04b135181eba4a7d564400855d9aeebf">ObjectMgr::GetInstanceTemplate</a>(mapId);</div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;                    <span class="keywordflow">if</span> (!instance)</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba731c7dfda368c8bfdb1b9cc7d3f696b8">SPELL_FAILED_TARGET_NOT_IN_INSTANCE</a>;</div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;                    <span class="keywordflow">if</span> (instance-&gt;<a class="code" href="structInstanceTemplate.html#aa3fadb2df1c8094a50db302c6c8de15b">levelMin</a> &gt; target-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>())</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf">SPELL_FAILED_LOWLEVEL</a>;</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;                    <span class="keywordflow">if</span> (instance-&gt;<a class="code" href="structInstanceTemplate.html#abb52f9da39919323cbdcbdf1e736ec00">levelMax</a> &amp;&amp; instance-&gt;<a class="code" href="structInstanceTemplate.html#abb52f9da39919323cbdcbdf1e736ec00">levelMax</a> &lt; target-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>())</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba76455f29fb795f37f695bc796e17459e">SPELL_FAILED_HIGHLEVEL</a>;</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160; </div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;                    <a class="code" href="DBCEnums_8h.html#a43efb0a2e61815a66134dfa5ccea0a83">Difficulty</a> difficulty = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ace981bca7a407e53d8f3506b5eecb2da">GetDifficulty</a>();</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="structInstancePlayerBind.html">InstancePlayerBind</a>* targetBind = target-&gt;<a class="code" href="classPlayer.html#af890a4dc7cf4546a399bf05b3fb26c31">GetBoundInstance</a>(mapId, difficulty))</div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structInstancePlayerBind.html">InstancePlayerBind</a>* casterBind = caster-&gt;<a class="code" href="classPlayer.html#af890a4dc7cf4546a399bf05b3fb26c31">GetBoundInstance</a>(mapId, difficulty))</div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;                            <span class="keywordflow">if</span> (targetBind-&gt;perm &amp;&amp; targetBind-&gt;state != casterBind-&gt;state)</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf0978a4bf6c56edcecb0fdc39b56ea85">SPELL_FAILED_TARGET_LOCKED_TO_RAID_INSTANCE</a>;</div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160; </div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="structAreaTrigger.html">AreaTrigger</a> <span class="keyword">const</span>* at = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetMapEntranceTrigger(mapId))</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;                    {</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;                        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> miscRequirement;</div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="SharedDefines_8h.html#a0f323c1b17777bed7ec77789ee6642c2a3f4a9671aaf4bc04157666f4f08be8f8">AREA_LOCKSTATUS_OK</a> != target-&gt;<a class="code" href="classPlayer.html#aba46f31b2dbdee8ef622f8be4a605ad1">GetAreaTriggerLockStatus</a>(at, difficulty, miscRequirement))</div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>; <span class="comment">// TODO: Verify this result</span></div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;                    }</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;                }</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;            }</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab9b202bef395b4217a5b4c47011e1d18">SPELL_EFFECT_RESURRECT</a>:</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abb61d351517b94c04b1b9da9369691ae">SPELL_EFFECT_RESURRECT_NEW</a>:</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;            {</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11">TARGET_FLAG_CORPSE_ALLY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b">TARGET_FLAG_CORPSE_ENEMY</a>))</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;                {</div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classCorpse.html">Corpse</a>* corpse = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a42612925011d01e872fad7e915a8ba2a">GetCorpse</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a98eee6778ea2cc05bd0073affde7f37d">getCorpseTargetGuid</a>()))</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;                    {</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* owner = <a class="code" href="classObjectAccessor.html#a959bcb90b71aacbb8560642c86c3ab63">ObjectAccessor::FindPlayer</a>(corpse-&gt;GetOwnerGuid()))</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;                        {</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;                            <span class="keywordflow">if</span> (owner-&gt;HasAuraType(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a007ec89b67aa5358a7da6c3dd899e4d2">SPELL_AURA_PREVENT_RESURRECTION</a>))</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a>;</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;                        }</div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;                        <span class="keywordflow">else</span></div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a>;</div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;                    }</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a>;</div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;                }</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a>)</div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;                {</div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;                    <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;                    <span class="keywordflow">if</span> (!target || target-&gt;<a class="code" href="classUnit.html#a9cd076c7f1e10e71af51ffc1ea1f9136">HasAuraType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a007ec89b67aa5358a7da6c3dd899e4d2">SPELL_AURA_PREVENT_RESURRECTION</a>))</div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a>;</div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;                }</div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a>;</div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160; </div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;            }</div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a1ab15c363eaea4e2bc8d7f8fc0c564cf">SPELL_EFFECT_SELF_RESURRECT</a>:</div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;            {</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9cd076c7f1e10e71af51ffc1ea1f9136">HasAuraType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a007ec89b67aa5358a7da6c3dd899e4d2">SPELL_AURA_PREVENT_RESURRECTION</a>))</div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a>;</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160; </div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;            }</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a07e1f1c3187108c179e65e9b313258cd">SPELL_EFFECT_LEAP</a>:</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a7382f976f2e8ff06e041558e5292f32e">SPELL_EFFECT_TELEPORT_UNITS_FACE_CASTER</a>:</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;            {</div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> || <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a598220bd7032e604abfdb838b9d60f66">IsTaxiFlying</a>())</div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafede20d779c776cfb3cf819a7589801b">SPELL_FAILED_NOT_ON_TAXI</a>;</div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160; </div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a5df90e7aa2cdd206ade4afdacdf679c0">m_ignoreRoot</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a4aefdbd94d5d5957bac3c0c5b0defc4c">hasUnitState</a>(<a class="code" href="group__game.html#ggae51d2ecb71f7a5cb3882982a622c9544a3b8c8f9de407420c730803e54454b841">UNIT_STAT_ROOT</a>))</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3146bc5b21d4e3b9a68e89d834b543fc">SPELL_FAILED_ROOTED</a>;</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160; </div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;                {</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;                    <span class="keywordflow">if</span> (((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;HasMovementFlag(<a class="code" href="Object_8h.html#a083358a25d084fb928e170c453128f9dadad97ca67c796fc2a563dd47dd03c5be">MOVEFLAG_ONTRANSPORT</a>))</div>
<div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5166b7133ecb3db49d7ce2e94d470e2">SPELL_FAILED_NOT_ON_TRANSPORT</a>;</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160; </div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;                    <span class="comment">// not allow use this effect at battleground until battleground start</span></div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classBattleGround.html">BattleGround</a> <span class="keyword">const</span>* bg = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetBattleGround())</div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;                        <span class="keywordflow">if</span> (bg-&gt;GetStatus() != <a class="code" href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eafaf0b6349b8a93b543f64c744e321d5a">STATUS_IN_PROGRESS</a>)</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba47a5ddf521d02893e0a4132fc8d3ef90">SPELL_FAILED_TRY_AGAIN</a>;</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;                }</div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160; </div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;            }</div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af49d37b2af49b03941198276e9599e60">SPELL_EFFECT_STEAL_BENEFICIAL_BUFF</a>:</div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;            {</div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;            }</div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a43e6a57d62764387de4c1dd5d4aeed33">SPELL_EFFECT_SUMMON_RAF_FRIEND</a>:</div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;            {</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160; </div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;                <a class="code" href="classPlayer.html">Player</a>* caster = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;                <span class="keywordflow">if</span> (!caster-&gt;<a class="code" href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">GetSession</a>()-&gt;<a class="code" href="classWorldSession.html#a90b597b1f9fd50438e1a555bd31aee54">GetRecruitingFriendId</a>())</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;            }</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ad67447fe7865d527f6408501a8fabd11">SPELL_EFFECT_CREATE_PET</a>:</div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;            {</div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;                {</div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>) &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>()-&gt;<a class="code" href="classUnit.html#a57870b79c2a356567afd5febedf79a61">GetPetGuid</a>())</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a>;</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;                }</div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;            }</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;            <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;        }</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;    }</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160; </div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;    {</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;        <span class="comment">// Do not check in case of junk in DBC</span></div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#acbfba02f9156a417c23e91207de7ee8a">IsAuraApplyEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i)))</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160; </div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;        <span class="comment">// Possible Unit-target for the spell</span></div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* expectedTarget = <a class="code" href="classSpell.html#a3a4197aaeee37c45d2d5bcd915475f1e">GetPrefilledUnitTargetOrUnitTarget</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i));</div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160; </div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">EffectApplyAuraName</a>[i])</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;        {</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf">SPELL_AURA_DUMMY</a>:</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;            {</div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;                <span class="comment">// custom check</span></div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;                <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;                {</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;                    <span class="keywordflow">case</span> 34026:                             <span class="comment">// Kill Command</span></div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;                        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;                    <span class="keywordflow">case</span> 61336:                             <span class="comment">// Survival Instincts</span></div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> || !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a23f974c6e648ec1c037d93458d96a8ab">IsNoWeaponShapeShift</a>())</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9d6ef68d218b7aa9b8cf1677a1c7bba8">SPELL_FAILED_ONLY_SHAPESHIFT</a>;</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;                }</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;            }</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea">SPELL_AURA_MOD_POSSESS</a>:</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;            {</div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba413f89a20f52b5ee916ca64f50fc4467">SPELL_FAILED_UNKNOWN</a>;</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160; </div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>) &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c">SPELL_FAILED_ALREADY_HAVE_CHARM</a>;</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160; </div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160; </div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;                <span class="keywordflow">if</span> (expectedTarget) <span class="comment">// target may not be known at CheckCast time - TODO: add support for these checks on CheckTarget</span></div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;                {</div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160; </div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160; </div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(expectedTarget-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>()) &gt; <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), expectedTarget))</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba76455f29fb795f37f695bc796e17459e">SPELL_FAILED_HIGHLEVEL</a>;</div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160; </div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#ac5deedcb47695a681523e416b8456848">GetOwner</a>())</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;                        <span class="keywordflow">return</span> expectedTarget-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>) ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa596afe8da53297dd96515ebba6adc5a">SPELL_FAILED_TARGET_IS_PLAYER_CONTROLLED</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaf1433b9120020e34699cd0774d09830">SPELL_FAILED_CANT_BE_CHARMED</a>;</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;                }</div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;            }</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9">SPELL_AURA_MOD_CHARM</a>:</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;            {</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a>) &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c">SPELL_FAILED_ALREADY_HAVE_CHARM</a>;</div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160; </div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160; </div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;                <span class="keywordflow">if</span> (expectedTarget) <span class="comment">// target may not be known at CheckCast time - TODO: add support for these checks on CheckTarget</span></div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;                {</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160; </div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160; </div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(expectedTarget-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>()) &gt; <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), expectedTarget))</div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba76455f29fb795f37f695bc796e17459e">SPELL_FAILED_HIGHLEVEL</a>;</div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160; </div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#ac5deedcb47695a681523e416b8456848">GetOwner</a>())</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;                        <span class="keywordflow">return</span> expectedTarget-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>) ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa596afe8da53297dd96515ebba6adc5a">SPELL_FAILED_TARGET_IS_PLAYER_CONTROLLED</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaf1433b9120020e34699cd0774d09830">SPELL_FAILED_CANT_BE_CHARMED</a>;</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;                }</div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;            }</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a30ae3c9499778cc5f920e81dc86cd020">SPELL_AURA_MOD_POSSESS_PET</a>:</div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;            {</div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba413f89a20f52b5ee916ca64f50fc4467">SPELL_FAILED_UNKNOWN</a>;</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160; </div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c">SPELL_FAILED_ALREADY_HAVE_CHARM</a>;</div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160; </div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160; </div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;                <a class="code" href="classPet.html">Pet</a>* pet = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>();</div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;                <span class="keywordflow">if</span> (!pet)</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a>;</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160; </div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;                <span class="keywordflow">if</span> (pet-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160; </div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;            }</div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1">SPELL_AURA_AOE_CHARM</a>:</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;            {</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>())</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160; </div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;            }</div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adaa58e2c604243da285d64f4a95b42f7">SPELL_AURA_MOD_CONFUSE</a>:</div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a44cf043145f5a78c5a4e36ecff8a034d">SPELL_AURA_MOD_FEAR</a>:</div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799afdf00dd634aaa25017ad329f58bd6cfd">SPELL_AURA_MOD_STUN</a>:</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;            {</div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;                <span class="keywordflow">if</span> (expectedTarget)</div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;                {</div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;                    <span class="comment">// flying players on mounts are immune to cc</span></div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#aa8ff700c8aec70f3ab1e1385262959b1">IsMounted</a>() &amp;&amp; expectedTarget-&gt;<a class="code" href="classUnit.html#a74941197e0d88770ff7ae3d5f5d735f0">IsFlying</a>() &amp;&amp; expectedTarget-&gt;<a class="code" href="classUnit.html#a62196e93f86fd56823e665abd41864db">IsPlayerControlled</a>() &amp;&amp; expectedTarget-&gt;<a class="code" href="classUnit.html#a9dfc2f86240462ac4fed816628251fc0">IsAboveGround</a>())</div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;                    {</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a00a5387370626b3d3226aad2d6cbd1e7">Mechanic</a>)</div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6c985f3372baa7af2864bb483d1f16a5">SPELL_FAILED_IMMUNE</a>;</div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160; </div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a5c19327a3007d70a2404dba4deab3745">EffectMechanic</a>[i])</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;                        {</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;                            <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = partialApplication(i);</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;                            <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6c985f3372baa7af2864bb483d1f16a5">SPELL_FAILED_IMMUNE</a>;</div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;                        }</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;                    }</div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;                }</div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;            }</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a8cec8a45f78b8555b8f13b8b00995acf">SPELL_AURA_MOUNTED</a>:</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;            {</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9556ed3ef1d6b11bc0a50966a4d38e70">IsInWater</a>() &amp;&amp; (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> || <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;<a class="code" href="classPlayer.html#a6fa4db05df1d6e6cd7b680b045e383ab">IsInHighLiquid</a>()))</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa6cc63143dadc031b5c849e25b6b6647">SPELL_FAILED_ONLY_ABOVEWATER</a>;</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160; </div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetTransport())</div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6084b07c392d47c533ddb7fc2660f602">SPELL_FAILED_NO_MOUNTS_ALLOWED</a>;</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160; </div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;                <span class="comment">// Ignore map check if spell have AreaId. AreaId already checked and this prevent special mount spells</span></div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp;</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;                        !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp;</div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;                        !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a04f28f2ea6566ac47831c7b7489b80f9">AreaGroupId</a> &amp;&amp;</div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;                        (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>() &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#ad4a998ad26db4bc8b571189e6d3f5d32">IsMountAllowed</a>()))</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;                {</div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6084b07c392d47c533ddb7fc2660f602">SPELL_FAILED_NO_MOUNTS_ALLOWED</a>;</div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;                }</div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160; </div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a435dd4706662b27b8e2885db11f788bb">IsInDisallowedMountForm</a>())</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad371eadb638a77bf90ef71652bed1ea4">SPELL_FAILED_NOT_SHAPESHIFT</a>;</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160; </div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;            }</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a38d26a7bb616c3ee2b31ff72e98ffd71">SPELL_AURA_RANGED_ATTACK_POWER_ATTACKER_BONUS</a>:</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;            {</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;                <span class="keywordflow">if</span> (!expectedTarget)</div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160; </div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;                <span class="comment">// can be casted at non-friendly unit or own pet/charm</span></div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a08cbed215e32eaeb4d9716da830e72b8">CanAttack</a>(expectedTarget))</div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafee5892d26e2d5331a343b1e0a40097e">SPELL_FAILED_TARGET_FRIENDLY</a>;</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160; </div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;            }</div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6b0ccd5195567a4744da1763b92159e3">SPELL_AURA_FLY</a>:</div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aba4cc8813262b13c7f9f10d41f2ca6a9">SPELL_AURA_MOD_FLIGHT_SPEED_MOUNTED</a>:</div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;            {</div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;                <span class="comment">// not allow cast fly spells if not have req. skills  (all spells is self target)</span></div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;                <span class="comment">// allow always ghost flight spells</span></div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;                {</div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;                    <span class="keywordflow">if</span> (!((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;CanStartFlyInArea(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>(), zone, area, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a9bc68a96c5126296e4cdc116685168e1">SPELL_ATTR_EX7_IGNORES_COLD_WEATHER_FLYING_REQUIREMENT</a>)))</div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2afb5e4b72a353abe6677d7d9ee8eeec">SPELL_FAILED_NOT_HERE</a>;</div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;                }</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;            }</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a2eb3f6e6a49bc0b70fa9726b1fa12bb3">SPELL_AURA_PERIODIC_MANA_LEECH</a>:</div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;            {</div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;                <span class="keywordflow">if</span> (expectedTarget)</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;                {</div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#a4ae648f71881fd67bcdd861ec4ef2363">GetPowerType</a>() != <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>)</div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;                    {</div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;                        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = partialApplication(i);</div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;                        <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;                            <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;                    }</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;                }</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160; </div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;            }</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a>:</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;            {</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9cd076c7f1e10e71af51ffc1ea1f9136">HasAuraType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a8cec8a45f78b8555b8f13b8b00995acf">SPELL_AURA_MOUNTED</a>))</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba11cd41b98b17d534ca5a171df834d909">SPELL_FAILED_NOT_MOUNTED</a>;</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160; </div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;                <span class="keywordflow">if</span> (expectedTarget)</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;                {</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;                    <span class="keywordflow">if</span> (!expectedTarget-&gt;<a class="code" href="classUnit.html#a0414b693087d7f3acc4a13eadb619660">IsVehicle</a>())</div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160; </div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;                    <span class="comment">// It is possible to change between vehicles that are boarded on each other</span></div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae8a0288e2dc30f6a70802970784f8f27">IsBoarded</a>() &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a88b1b9802b42096a12aad50157cf7031">IsOnVehicle</a>())</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;                    {</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;                        <span class="comment">// Check if trying to board a vehicle that is boarded on current transport</span></div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;                        <span class="keywordtype">bool</span> boardedOnEachOther = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a49d85ec7bb9bb57bee44f01d1b0a9d87">HasOnBoard</a>(expectedTarget);</div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;                        <span class="comment">// Check if trying to board a vehicle that has the current transport on board</span></div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;                        <span class="keywordflow">if</span> (!boardedOnEachOther)</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;                            boardedOnEachOther = expectedTarget-&gt;<a class="code" href="classUnit.html#a7329a53873078dc2ba6fd815f88e90b0">GetVehicleInfo</a>()-&gt;<a class="code" href="group__TransportSystem.html#ga29a9f9d1fcb4ec7d2d292379dad9ca69">HasOnBoard</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160; </div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;                        <span class="keywordflow">if</span> (!boardedOnEachOther)</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5166b7133ecb3db49d7ce2e94d470e2">SPELL_FAILED_NOT_ON_TRANSPORT</a>;</div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;                    }</div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160; </div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;                    <span class="keywordflow">if</span> (!expectedTarget-&gt;<a class="code" href="classUnit.html#a7329a53873078dc2ba6fd815f88e90b0">GetVehicleInfo</a>()-&gt;<a class="code" href="group__TransportSystem.html#ga072cf20fae85daa021188d1933cb193d">CanBoard</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;                }</div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;            }</div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1e21f5318c8c9e357646f5791c1e69ea">SPELL_AURA_MIRROR_IMAGE</a>:</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;            {</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;                <span class="keywordflow">if</span> (expectedTarget)</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;                {</div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;                    <span class="comment">// Target must be creature. TODO: Check if target can also be player</span></div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a>)</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160; </div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)             <span class="comment">// Clone self can&#39;t be accepted</span></div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160; </div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;                    <span class="comment">// It is assumed that target can not be cloned if already cloned by same or other clone auras</span></div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;                    <span class="keywordflow">if</span> (expectedTarget-&gt;<a class="code" href="classUnit.html#a9cd076c7f1e10e71af51ffc1ea1f9136">HasAuraType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1e21f5318c8c9e357646f5791c1e69ea">SPELL_AURA_MIRROR_IMAGE</a>))</div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;                }</div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;            }</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1e7e5c8d0e92113d05321ff57d81578b">SPELL_AURA_MOD_DISARM</a>: <span class="comment">// supports partial application</span></div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;            {</div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;                <span class="keywordflow">if</span> (expectedTarget)</div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;                {</div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;                    <span class="comment">// Target must be a weapon wielder</span></div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;                    <span class="keywordflow">if</span> (!expectedTarget-&gt;<a class="code" href="classUnit.html#ae7cb6d1cd6098219c4bf0ce064a34476">hasMainhandWeapon</a>())</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;                    {</div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;                        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = partialApplication(i);</div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;                        <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad9886ecfbc82a37ce9448c2706100668">SPELL_FAILED_TARGET_NO_WEAPONS</a>;</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;                    }</div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;                }</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;            }</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;        }</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;    }</div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160; </div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;    <span class="comment">// check trade slot case (last, for allow catch any another cast problems)</span></div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;    {</div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba545130a442f0e0877608381ba7bc0458">SPELL_FAILED_NOT_TRADING</a>;</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160; </div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62">TradeSlots</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#aebd9cd7110f9711cd2bd94e154920cd6">getItemTargetGuid</a>().<a class="code" href="classObjectGuid.html#a65626f4640cb4f79c66ce9d5dda8ab27">GetRawValue</a>()) != <a class="code" href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62abdab7c30065c4b145dd2e6ce0e27c45f">TRADE_SLOT_NONTRADED</a>)</div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba529a897ba353bc5fcaba4711ed78c02f">SPELL_FAILED_ITEM_NOT_READY</a>;</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160; </div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;        <span class="comment">// if trade not complete then remember it in trade data</span></div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classTradeData.html">TradeData</a>* my_trade = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetTradeData())</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;        {</div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;            <span class="keywordflow">if</span> (!my_trade-&gt;IsInAcceptProcess())</div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;            {</div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;                <span class="comment">// Spell will be casted at completing the trade. Silently ignore at this place</span></div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;                my_trade-&gt;SetSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>);</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;            }</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;        }</div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba545130a442f0e0877608381ba7bc0458">SPELL_FAILED_NOT_TRADING</a>;</div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;    }</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160; </div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a7f7f49eff2aef7a7c3340cd812c876c7">SPELL_ATTR_EX2_NO_ACTIVE_PETS</a>))</div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;    {</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* player = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;        <span class="keywordflow">if</span> (player-&gt;<a class="code" href="classUnit.html#a57870b79c2a356567afd5febedf79a61">GetPetGuid</a>() || player-&gt;<a class="code" href="classUnit.html#abe91abe7303db7af828a1e5044785295">HasCharm</a>())</div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;        {</div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;            player-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fad714798a413a2ddcdcbb9ce9ec83357b">PETTAME_ANOTHERSUMMONACTIVE</a>);</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;        }</div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classPet.html#aff5ffb9a757e225ce15e00e718a335d9">Pet::TryLoadFromDB</a>(player);</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;        <span class="keywordflow">if</span> (result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaa8582c07f58c05e32b1885a14e8320a">SPELL_FAILED_TARGETS_DEAD</a> || result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;        {</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;            player-&gt;<a class="code" href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">SendPetTameFailure</a>(<a class="code" href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fad714798a413a2ddcdcbb9ce9ec83357b">PETTAME_ANOTHERSUMMONACTIVE</a>);</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;        }</div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;    }</div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160; </div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;    <span class="comment">// all ok</span></div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#ab1e0f40468f5a385b5d6bf22afb55459">OnCheckCast</a>(strict);</div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;}</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160; </div>
<div class="line"><a name="l07082"></a><span class="lineno"><a class="line" href="classSpell.html#ab1dea568ff32c16850a58cf34aa5b5ea"> 7082</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#ab1dea568ff32c16850a58cf34aa5b5ea">Spell::CheckPetCast</a>(<a class="code" href="classUnit.html">Unit</a>* target)</div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;{</div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbab46f3fd2e85aca9f1293d380385bf0d8">SPELL_FAILED_CASTER_DEAD</a>;</div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160; </div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af0cab5ed9e6a02a565198db1d3db13a8">IsNonMeleeSpellCasted</a>(<span class="keyword">false</span>) &amp;&amp; !<a class="code" href="classSpell.html#a3ae4f6a6ff1cf1d52d5e2dce4bcd43fa">m_ignoreConcurrentCasts</a>)             <span class="comment">// prevent spellcast interruption by another spellcast</span></div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaeecb06edf432f8f464c1e4ba2704095a">SPELL_FAILED_SPELL_IN_PROGRESS</a>;</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af5e75d013dfa8a8b888d7714992e3f2a">IsInCombat</a>() &amp;&amp; <a class="code" href="SpellMgr_8h.html#ad87d37c678e30ca6731dbecf89a7f2b9">IsNonCombatSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba14dbc498af8458773a0095bb98957889">SPELL_FAILED_AFFECTING_COMBAT</a>;</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160; </div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>() &amp;&amp; (<span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;<a class="code" href="classCreature.html#a5645c3877ec9f0e68c8e26b76cebcf68">IsPet</a>() || <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">HasCharmer</a>()))</div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;    {</div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;        <span class="comment">// dead owner (currently only ghouled players can have alive pet casting)</span></div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* charmer = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a32d1bc7bcf268626c01fece7409da915">GetMaster</a>();</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;        <span class="keywordflow">if</span> (charmer)</div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;        {</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;            <a class="code" href="classPlayer.html">Player</a>* pCharmer = charmer-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> ? <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(charmer) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;            <span class="keywordflow">if</span> (!charmer-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>() &amp;&amp; (!pCharmer || !pCharmer-&gt;<a class="code" href="classPlayer.html#afc860537b2180ddf911cd3a752bb7b79">IsGhouled</a>()))</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbab46f3fd2e85aca9f1293d380385bf0d8">SPELL_FAILED_CASTER_DEAD</a>;</div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;        }</div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160; </div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;        <span class="keywordflow">if</span> (!target &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;            target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160; </div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;        <span class="keywordtype">bool</span> need = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;        <span class="keywordtype">bool</span> script = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>)</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;        {</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;            <span class="keywordflow">if</span> (i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf942ecb11955a03d4b522c3981b71689">TARGET_UNIT_ENEMY</a> ||</div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;                i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa293afadabc29273eadc698cf4b8d81a">TARGET_UNIT_FRIEND</a> ||</div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;                i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae1dbf35279c8e9d2da10764df673261e">TARGET_UNIT_RAID</a> ||</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;                i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa1c9e6d0a0c1c1f97e8425600d2d59074">TARGET_UNIT</a> ||</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;                i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3888b9db5eaa2d6c9c5001a61fed215a">TARGET_UNIT_PARTY</a> ||</div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;                i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9ae0d0fca4f7ea335145567b080452d2">TARGET_LOCATION_CASTER_TARGET_POSITION</a>)</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;            {</div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;                need = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;                <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a>;</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;            }</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;            <span class="keywordflow">if</span> (i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a> ||</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;                i == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf70a4efa83b11389d844309475184e3e">TARGET_UNIT_SCRIPT_NEAR_CASTER</a>)</div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;            {</div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;                script = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;            }</div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;        }</div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;        <span class="keywordflow">if</span> (need)</div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">setUnitTarget</a>(target);</div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (script)</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d">CheckCast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160; </div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* _target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160; </div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;        <span class="comment">// for target dead/target not valid</span></div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;        <span class="keywordflow">if</span> (_target &amp;&amp; <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a>)</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;        {</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;            <span class="keywordflow">if</span> (_target-&gt;<a class="code" href="classUnit.html#a82ab342b3d9aef32e6fe61405eff82f3">IsDead</a>() &amp;&amp; !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801ae3fa8042725e82ce05d035ced9338aa3">SPELL_ATTR_EX2_ALLOW_DEAD_TARGET</a>))</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160; </div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#aa48055df917f805e2ef4b8e56f78cc93">IsPositiveSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, _target))</div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;            {</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(_target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;            }</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;            {</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;                <span class="keywordtype">bool</span> duelvsplayertar = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j : <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>)</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;                {</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;                    <span class="comment">// TARGET_UNIT is positive AND negative</span></div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;                    duelvsplayertar |= (j == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa1c9e6d0a0c1c1f97e8425600d2d59074">TARGET_UNIT</a>);</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;                }</div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a08cbed215e32eaeb4d9716da830e72b8">CanAttack</a>(target) &amp;&amp; !duelvsplayertar)</div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;                {</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;                }</div>
<div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;            }</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;        }</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;        <span class="comment">// cooldown</span></div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a0725cae3f5e238dd7dbb15885cebc07c">IsSpellReady</a>(*<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba8b8a8978f57575bd089e2da378bf03ad">SPELL_FAILED_NOT_READY</a>;</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;    }</div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160; </div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d">CheckCast</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;}</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160; </div>
<div class="line"><a name="l07168"></a><span class="lineno"><a class="line" href="classSpell.html#af471902fa858fc71b299d69d88272be5"> 7168</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#af471902fa858fc71b299d69d88272be5">Spell::CheckCasterAuras</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#af8ae043215e1e85e6e67b934ae91d896">m_ignoreCasterAuraState</a>)</div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160; </div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>())</div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160; </div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a0369a5743cc4df083542161d8975656b">SPELL_ATTR_EX6_NOT_AN_ATTACK</a>))</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160; </div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;    <span class="comment">// these attributes only show the spell as usable on the client when it has related aura applied</span></div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;     <span class="comment">// still they need to be checked against certain mechanics</span></div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160; </div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;     <span class="comment">// SPELL_ATTR5_USABLE_WHILE_STUNNED by default only MECHANIC_STUN (ie no sleep, knockout, freeze, etc.)</span></div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;    <span class="keywordtype">bool</span> usableWhileStunned = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734abba70d43d90380cbf0a5a4fd8af7c928">SPELL_ATTR_EX5_ALLOW_WHILE_STUNNED</a>);</div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160; </div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;    <span class="comment">// Pain Suppression (have SPELL_ATTR_EX5_USABLE_WHILE_STUNNED that must be used only with glyph)</span></div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 33206 &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(63248))</div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;        usableWhileStunned = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160; </div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;    <span class="comment">// SPELL_ATTR5_USABLE_WHILE_FEARED by default only fear (ie no horror)</span></div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;    <span class="keywordtype">bool</span> usableWhileFeared = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a0cb6ca24fc7bac55a3348b82eecee373">SPELL_ATTR_EX5_ALLOW_WHILE_FLEEING</a>);</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160; </div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;    <span class="comment">// SPELL_ATTR5_USABLE_WHILE_CONFUSED by default only disorient (ie no polymorph)</span></div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;    <span class="keywordtype">bool</span> usableWhileConfused = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a27b95a6394f56574a6a97b3e5ed885f2">SPELL_ATTR_EX5_ALLOW_WHILE_CONFUSED</a>);</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160; </div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;    <span class="comment">// Check whether the cast should be prevented by any state you might have.</span></div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160; </div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;    <span class="comment">// Get unit state</span></div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="keyword">const</span> unitflag = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#aebc9e7589e372ab99544e474c07609f0">GetUInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>);</div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160; </div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;    <span class="comment">// this check should only be done when player does cast directly</span></div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;    <span class="comment">// (ie not when it&#39;s called from a script) Breaks for example PlayerAI when charmed</span></div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2999180c9cb3caf82303f88dd2f3e6e3">m_clientCast</a>)</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* charmer = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ab7aa55eb03cc7e7d93894ccaf4e6f250">GetCharmer</a>())</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#aa6aca574b2e1959895ddfb2ec61050fb">CheckSpellCancelsCharm</a>(param1))</div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;                result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a>;</div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160; </div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;    <span class="comment">// spell has attribute usable while having a cc state, check if caster has allowed mechanic auras, another mechanic types must prevent cast spell</span></div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;    <span class="keyword">auto</span> mechanicCheck = [&amp;](<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799">AuraType</a> type) -&gt; <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a></div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;    {</div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;        <span class="keywordtype">bool</span> foundNotMechanic = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;        <a class="code" href="classUnit.html#a2b5b1c6d16de917e5356d9f1708178b4">Unit::AuraList</a> <span class="keyword">const</span>&amp; auras = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">GetAurasByType</a>(type);</div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classAura.html">Aura</a> <span class="keyword">const</span>* aura : auras)</div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;        {</div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <span class="keyword">const</span> mechanicMask = aura-&gt;GetSpellProto()-&gt;GetAllEffectsMechanicMask();</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;            <span class="keywordflow">if</span> (mechanicMask &amp;&amp; !(mechanicMask &amp; <a class="code" href="SpellMgr_8h.html#a3d8ecd789903bb522e3563819035af97">GetAllowedMechanicMask</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>)))</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;            {</div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;                foundNotMechanic = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160; </div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;                <span class="comment">// fill up aura mechanic info to send client proper error message</span></div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;                param1 = aura-&gt;GetSpellProto()-&gt;EffectMechanic[aura-&gt;GetEffIndex()];</div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;                <span class="keywordflow">if</span> (!param1)</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;                    param1 = aura-&gt;GetSpellProto()-&gt;Mechanic;</div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160; </div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;            }</div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;        }</div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160; </div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;        <span class="keywordflow">if</span> (foundNotMechanic)</div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;        {</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;            <span class="keywordflow">switch</span> (type)</div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;            {</div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799afdf00dd634aaa25017ad329f58bd6cfd">SPELL_AURA_MOD_STUN</a>:</div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0936bc5119bbdacad4096fdd55a0c3ee">SPELL_FAILED_STUNNED</a>;</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a44cf043145f5a78c5a4e36ecff8a034d">SPELL_AURA_MOD_FEAR</a>:</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae6d69f69f6cdd70d7a287c9b1a40ce25">SPELL_FAILED_FLEEING</a>;</div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adaa58e2c604243da285d64f4a95b42f7">SPELL_AURA_MOD_CONFUSE</a>:</div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac74ff5725df2905f4d85db915b8be032">SPELL_FAILED_CONFUSED</a>;</div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;                    <a class="code" href="Errors_8h.html#a7b94d20194b84dde056465e12496d3f4">MANGOS_ASSERT</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba270280418a53c9d018219f9cddda4e3c">SPELL_FAILED_NOT_KNOWN</a>;</div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;            }</div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;        }</div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160; </div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;    };</div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160; </div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;    <span class="keywordflow">if</span> (unitflag &amp; <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a20d03528858479b31941a42820257eeb">UNIT_FLAG_STUNNED</a> &amp;&amp; !usableWhileStunned &amp;&amp; !<a class="code" href="classSpell.html#a18b664a798ce529bb5742222ef87da01">CheckSpellCancelsStun</a>(param1))</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;        result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0936bc5119bbdacad4096fdd55a0c3ee">SPELL_FAILED_STUNNED</a>;</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (unitflag &amp; <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac5e049a6b427ad34206151958117403e">UNIT_FLAG_SILENCED</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac2d17132ffcbb75f8748f9c04930526d">PreventionType</a> == <a class="code" href="SharedDefines_8h.html#a3194644c6ed7acd85ec8eb1b98821b8ea03702a6fae99a6fc1b0ebf339a86865e">SPELL_PREVENTION_TYPE_SILENCE</a> &amp;&amp; !<a class="code" href="classSpell.html#ad2c181118cb5bf43cdbdf18729358bc3">CheckSpellCancelsSilence</a>(param1))</div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;        result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad0d4fef991322bbae678d56d2785226d">SPELL_FAILED_SILENCED</a>;</div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (unitflag &amp; <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a6fe41521d08dba6583ba7bb9d45cef82">UNIT_FLAG_PACIFIED</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac2d17132ffcbb75f8748f9c04930526d">PreventionType</a> == <a class="code" href="SharedDefines_8h.html#a3194644c6ed7acd85ec8eb1b98821b8ea36d609ad404c7522db727505ad528c51">SPELL_PREVENTION_TYPE_PACIFY</a> &amp;&amp; !<a class="code" href="classSpell.html#ad94f7eb8b77b07d58a37e9cb4dd5605c">CheckSpellCancelsPacify</a>(param1))</div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;        result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae828ac076cd78171682ba1ac82eb57f2">SPELL_FAILED_PACIFIED</a>;</div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (unitflag &amp; <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a8ad2e62c7207250ee894d9a30d6bf130">UNIT_FLAG_FLEEING</a> &amp;&amp; !usableWhileFeared &amp;&amp; !<a class="code" href="classSpell.html#a0bf8e3d48d88a395dfb6ecec3684284f">CheckSpellCancelsFear</a>(param1))</div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;        result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae6d69f69f6cdd70d7a287c9b1a40ce25">SPELL_FAILED_FLEEING</a>;</div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (unitflag &amp; <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a889affbf3beefd9704c68058b2bc79e3">UNIT_FLAG_CONFUSED</a> &amp;&amp; !usableWhileConfused &amp;&amp; !<a class="code" href="classSpell.html#a4fd1b8c716c40489fbb4e4b57290d410">CheckSpellCancelsConfuse</a>(param1))</div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;        result = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac74ff5725df2905f4d85db915b8be032">SPELL_FAILED_CONFUSED</a>;</div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160; </div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;    <span class="comment">// Attr must make flag drop spell totally immune from all effects</span></div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;    <span class="keywordflow">if</span> (result != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;        <span class="keywordflow">return</span> param1 ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6ff414333f83deadfa05e6b4406af895">SPELL_FAILED_PREVENTED_BY_MECHANIC</a> : result;</div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160; </div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;}</div>
<div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160; </div>
<div class="line"><a name="l07266"></a><span class="lineno"><a class="line" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32"> 7266</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">Spell::CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799">AuraType</a> auraType, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* unitCaster = (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>() ? nullptr : <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;    <span class="keywordflow">if</span> (!unitCaster)</div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160; </div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;    <span class="comment">// Checking auras is needed now, because you are prevented by some state but the spell grants immunity.</span></div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;    <a class="code" href="classUnit.html#a2b5b1c6d16de917e5356d9f1708178b4">Unit::AuraList</a> <span class="keyword">const</span>&amp; auraEffects = unitCaster-&gt;<a class="code" href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">GetAurasByType</a>(auraType);</div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;    <span class="keywordflow">if</span> (auraEffects.empty())</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160; </div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classAura.html">Aura</a> <span class="keyword">const</span>* aura : auraEffects)</div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;    {</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;        <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* auraInfo = aura-&gt;GetSpellProto();</div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a7728c56eea783417340528757e74eeae">SpellCancelsAuraEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, auraInfo, aura-&gt;GetEffIndex()))</div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160; </div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;        param1 = auraInfo-&gt;<a class="code" href="structSpellEntry.html#a5c19327a3007d70a2404dba4deab3745">EffectMechanic</a>[aura-&gt;GetEffIndex()];</div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;        <span class="keywordflow">if</span> (!param1)</div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;            param1 = auraInfo-&gt;<a class="code" href="structSpellEntry.html#a00a5387370626b3d3226aad2d6cbd1e7">Mechanic</a>;</div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160; </div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;    }</div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160; </div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;}</div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160; </div>
<div class="line"><a name="l07293"></a><span class="lineno"><a class="line" href="classSpell.html#aa6aca574b2e1959895ddfb2ec61050fb"> 7293</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#aa6aca574b2e1959895ddfb2ec61050fb">Spell::CheckSpellCancelsCharm</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9">SPELL_AURA_MOD_CHARM</a>, param1) &amp;&amp;</div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;        <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1">SPELL_AURA_AOE_CHARM</a>, param1) &amp;&amp;</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;        <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea">SPELL_AURA_MOD_POSSESS</a>, param1);</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;}</div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160; </div>
<div class="line"><a name="l07300"></a><span class="lineno"><a class="line" href="classSpell.html#a18b664a798ce529bb5742222ef87da01"> 7300</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a18b664a798ce529bb5742222ef87da01">Spell::CheckSpellCancelsStun</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799afdf00dd634aaa25017ad329f58bd6cfd">SPELL_AURA_MOD_STUN</a>, param1) &amp;&amp;</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;        <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab7aebcdfc938aad8e15f24f026994dbb">SPELL_AURA_STRANGULATE</a>, param1);</div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;}</div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160; </div>
<div class="line"><a name="l07306"></a><span class="lineno"><a class="line" href="classSpell.html#ad2c181118cb5bf43cdbdf18729358bc3"> 7306</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#ad2c181118cb5bf43cdbdf18729358bc3">Spell::CheckSpellCancelsSilence</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6c684b941fc93d5488ff49a976973596">SPELL_AURA_MOD_SILENCE</a>, param1) &amp;&amp;</div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;        <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aab7e99142d3a87d93f8586e2a9cd81c8">SPELL_AURA_MOD_PACIFY_SILENCE</a>, param1);</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;}</div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160; </div>
<div class="line"><a name="l07312"></a><span class="lineno"><a class="line" href="classSpell.html#ad94f7eb8b77b07d58a37e9cb4dd5605c"> 7312</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#ad94f7eb8b77b07d58a37e9cb4dd5605c">Spell::CheckSpellCancelsPacify</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6c38d7d76b8741d45023a0ccc3c0f9b3">SPELL_AURA_MOD_PACIFY</a>, param1) &amp;&amp;</div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;        <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aab7e99142d3a87d93f8586e2a9cd81c8">SPELL_AURA_MOD_PACIFY_SILENCE</a>, param1);</div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;}</div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160; </div>
<div class="line"><a name="l07318"></a><span class="lineno"><a class="line" href="classSpell.html#a0bf8e3d48d88a395dfb6ecec3684284f"> 7318</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a0bf8e3d48d88a395dfb6ecec3684284f">Spell::CheckSpellCancelsFear</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a44cf043145f5a78c5a4e36ecff8a034d">SPELL_AURA_MOD_FEAR</a>, param1);</div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;}</div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160; </div>
<div class="line"><a name="l07323"></a><span class="lineno"><a class="line" href="classSpell.html#a4fd1b8c716c40489fbb4e4b57290d410"> 7323</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a4fd1b8c716c40489fbb4e4b57290d410">Spell::CheckSpellCancelsConfuse</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; param1)<span class="keyword"> const</span></div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">CheckSpellCancelsAuraEffect</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adaa58e2c604243da285d64f4a95b42f7">SPELL_AURA_MOD_CONFUSE</a>, param1);</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;}</div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160; </div>
<div class="line"><a name="l07328"></a><span class="lineno"><a class="line" href="classSpell.html#aff5477a54c2dfe98575d5ea12984b86f"> 7328</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#aff5477a54c2dfe98575d5ea12984b86f">Spell::CanAutoCast</a>(<a class="code" href="classUnit.html">Unit</a>* target)</div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;{</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++j)</div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;    {</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[j] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d">SPELL_EFFECT_APPLY_AURA</a>)</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;        {</div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a800c4530cf509731e4c51d1c14e21c99">StackAmount</a> &lt;= 1)</div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;            {</div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j)))</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;            }</div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;            {</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classAura.html">Aura</a>* aura = target-&gt;<a class="code" href="classUnit.html#a87b4688e7aef0ea4562efb17f01971de">GetAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j)))</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;                    <span class="keywordflow">if</span> (aura-&gt;GetStackAmount() &gt;= <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a800c4530cf509731e4c51d1c14e21c99">StackAmount</a>)</div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;            }</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;        }</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#ace3da75b505e34c32ab1294c4a4d5a2f">IsAreaAuraEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[j]))</div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;        {</div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j)))</div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;        }</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;    }</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160; </div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;    <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> result = <a class="code" href="classSpell.html#ab1dea568ff32c16850a58cf34aa5b5ea">CheckPetCast</a>(target);</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160; </div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;    <span class="keywordflow">if</span> (result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a> || result == <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0201f3ee2e3101af63e54aafbf14c226">SPELL_FAILED_UNIT_NOT_INFRONT</a>)</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;                                           <span class="comment">// target invalid</span></div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;}</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160; </div>
<div class="line"><a name="l07360"></a><span class="lineno"><a class="line" href="classSpell.html#aa9f3502112045494cd74493b114dd92e"> 7360</a></span>&#160;std::pair&lt;float, float&gt; <a class="code" href="classSpell.html#aa9f3502112045494cd74493b114dd92e">Spell::GetMinMaxRange</a>(<span class="keywordtype">bool</span> strict)</div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;{</div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;    <span class="keywordtype">float</span> minRange = 0.0f, maxRange = 0.0f, rangeMod = 0.0f;</div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160; </div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;    <span class="keywordflow">if</span> (strict &amp;&amp; <a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;        <span class="keywordflow">return</span> { 0.0f, 100.0f };</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160; </div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* caster = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>); <span class="comment">// preparation for GO casting</span></div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160; </div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;    <a class="code" href="structSpellRangeEntry.html">SpellRangeEntry</a> <span class="keyword">const</span>* spellRange = <a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>);</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;    <span class="keywordflow">if</span> (spellRange)</div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;    {</div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;        <span class="keywordflow">if</span> (spellRange-&gt;<a class="code" href="structSpellRangeEntry.html#a12b3cb0e28ed0f47ff5ccea09fc8b860">Flags</a> &amp; <a class="code" href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956af4dafe2c07c14ff50816f52540465e45">SPELL_RANGE_FLAG_MELEE</a>)</div>
<div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;        {</div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;            <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;                rangeMod = caster-&gt;<a class="code" href="classWorldObject.html#ab40a9c9bc4746738f352a493f889ffa6">GetCombinedCombatReach</a>(target ? target : caster, <span class="keyword">true</span>, 0.f);</div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;        }</div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;        {</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;            <span class="keywordtype">float</span> meleeRange = 0.f;</div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;            <span class="keywordflow">if</span> (spellRange-&gt;<a class="code" href="structSpellRangeEntry.html#a12b3cb0e28ed0f47ff5ccea09fc8b860">Flags</a> &amp; <a class="code" href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956a9c4178348ebd97182ee9ef7b952fa691">SPELL_RANGE_FLAG_RANGED</a>)</div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;            {</div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;                <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;                    meleeRange = caster-&gt;<a class="code" href="classWorldObject.html#ab40a9c9bc4746738f352a493f889ffa6">GetCombinedCombatReach</a>(target ? target : caster, <span class="keyword">true</span>, 0.f);</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;            }</div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160; </div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;            <span class="keywordtype">bool</span> friendly = target ? <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">CanAssistSpell</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) : <span class="keyword">false</span>;</div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;            minRange = <a class="code" href="SpellMgr_8h.html#aff490dc835c75af68cdf1ed77d85d798">GetSpellMinRange</a>(spellRange, friendly) + meleeRange;</div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;            maxRange = <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(spellRange, friendly);</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160; </div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;            <span class="keywordflow">if</span> (target || <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a62e4f91dc75aad55879fc4ea1346abaa">getCorpseTarget</a>())</div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;            {</div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;                rangeMod = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae93cbe6fc0feed133ffa419cf6771c19">GetCombatReach</a>() + (target ? target-&gt;<a class="code" href="classUnit.html#a5f8e38db03da1828c7f5447548b393e3">GetCombatReach</a>() : <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae93cbe6fc0feed133ffa419cf6771c19">GetCombatReach</a>());</div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160; </div>
<div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;                <span class="keywordflow">if</span> (minRange &gt; 0.0f &amp;&amp; !(spellRange-&gt;<a class="code" href="structSpellRangeEntry.html#a12b3cb0e28ed0f47ff5ccea09fc8b860">Flags</a> &amp; <a class="code" href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956a9c4178348ebd97182ee9ef7b952fa691">SPELL_RANGE_FLAG_RANGED</a>))</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;                    minRange += rangeMod;</div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;            }</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;        }</div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160; </div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;        <span class="keywordflow">if</span> (target &amp;&amp; caster &amp;&amp; caster-&gt;<a class="code" href="classUnit.html#acfffaa0b819e26d3586ccb46c13156ac">IsMovingForward</a>() &amp;&amp; target-&gt;<a class="code" href="classUnit.html#acfffaa0b819e26d3586ccb46c13156ac">IsMovingForward</a>() &amp;&amp; !caster-&gt;<a class="code" href="classUnit.html#af5f118a391194216cdd0ab4dcd2f48c3">IsWalking</a>() &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#af5f118a391194216cdd0ab4dcd2f48c3">IsWalking</a>() &amp;&amp;</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;            ((spellRange-&gt;<a class="code" href="structSpellRangeEntry.html#a12b3cb0e28ed0f47ff5ccea09fc8b860">Flags</a> &amp; <a class="code" href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956af4dafe2c07c14ff50816f52540465e45">SPELL_RANGE_FLAG_MELEE</a>) || target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>))</div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;            rangeMod += <a class="code" href="ObjectDefines_8h.html#a0d1dd456efeb406c2d571e557c1916bf">MELEE_LEEWAY</a>;</div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;    }</div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160; </div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;    <span class="keywordflow">if</span> (caster)</div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;    {</div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a81376bc7d7fcc95dcfdd244eca6e5746">SPELL_ATTR_USES_RANGED_SLOT</a>) &amp;&amp; caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* ranged = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(caster)-&gt;<a class="code" href="classPlayer.html#a9ddba282e25d1585271207900b33e25f">GetWeaponForAttack</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a>))</div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;                maxRange *= ranged-&gt;GetProto()-&gt;RangedModRange * 0.01f;</div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160; </div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = caster-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>())</div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;            modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a02be30b0aa7e94e836effcf6882ddea8">SPELLMOD_RANGE</a>, maxRange);</div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;    }</div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160; </div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;    maxRange += rangeMod;</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160; </div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;    <span class="keywordflow">return</span> { minRange, maxRange };</div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;}</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160; </div>
<div class="line"><a name="l07420"></a><span class="lineno"><a class="line" href="classSpell.html#af29009de4460469d4a4157fa1eda8173"> 7420</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#af29009de4460469d4a4157fa1eda8173">Spell::CheckRange</a>(<span class="keywordtype">bool</span> strict)</div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;{</div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;    <span class="comment">// Don&#39;t check for instant cast spells</span></div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;    <span class="keywordflow">if</span> (!strict &amp;&amp; <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a> == 0)</div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160; </div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160; </div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;    <span class="keywordtype">float</span> minRange, maxRange;</div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;    std::tie(minRange, maxRange) = <a class="code" href="classSpell.html#aa9f3502112045494cd74493b114dd92e">GetMinMaxRange</a>(strict);</div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160; </div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;    <span class="comment">// non strict spell tolerance</span></div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellRangeEntry.html">SpellRangeEntry</a> <span class="keyword">const</span>* spellRange = <a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>))</div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;        <span class="keywordflow">if</span> ((spellRange-&gt;Flags &amp; <a class="code" href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956af4dafe2c07c14ff50816f52540465e45">SPELL_RANGE_FLAG_MELEE</a>) == 0 &amp;&amp; !strict)</div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;            maxRange += std::min(3.f, maxRange * 0.1f); <span class="comment">// 10% but no more than MAX_SPELL_RANGE_TOLERANCE</span></div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160; </div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;    <span class="keywordflow">if</span> (!target &amp;&amp; <a class="code" href="classSpell.html#a2999180c9cb3caf82303f88dd2f3e6e3">m_clientCast</a> &amp;&amp; <a class="code" href="SpellMgr_8h.html#ac080470c59071a67207dd338d64f6954">HasSpellTarget</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a>))</div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;        target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>() ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>() : <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ab8ceebad76b0e65fa1f6c9031070a75c">GetCharm</a>();</div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160; </div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;    <span class="keywordflow">if</span> (target &amp;&amp; target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)</div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;    {</div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;        <span class="comment">// distance from target in checks</span></div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;        <span class="keywordtype">float</span> dist = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(target, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>); <span class="comment">// minRange/maxRange already contain everything</span></div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;        <span class="keywordflow">if</span> (dist &gt; maxRange * maxRange)</div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;           <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;        <span class="keywordflow">if</span> (minRange &amp;&amp; dist &lt; minRange * minRange)</div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba190b67f5dadc0d719211257c5f91c2dd">SPELL_FAILED_TOO_CLOSE</a>;</div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp;</div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;            (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#abc406eb0bdad331a22c743708f5bf39c">FacingCasterFlags</a> &amp; <a class="code" href="SpellDefines_8h.html#ac8791ee2f758e00e9621a849273a8549ac8e8981ed6a7cb479ac7a0911f51ff6c">SPELL_FACING_FLAG_INFRONT</a>) &amp;&amp; !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#ae0338558ec4649199ff37b6ae422e0b2">HasInArc</a>(target))</div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0201f3ee2e3101af63e54aafbf14c226">SPELL_FAILED_UNIT_NOT_INFRONT</a>;</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;    }</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160; </div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classGameObject.html">GameObject</a>* goTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">getGOTarget</a>())</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;        <span class="keywordflow">if</span> (!goTarget-&gt;IsAtInteractDistance(<span class="keyword">dynamic_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>), maxRange)) <span class="comment">// only player casts these</span></div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160; </div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> == <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;    {</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;        <span class="keywordtype">float</span> dist = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>);</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;        <span class="keywordflow">if</span> (dist &gt; maxRange * maxRange)</div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;        <span class="keywordflow">if</span> (minRange &amp;&amp; dist &lt; minRange * minRange)</div>
<div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba190b67f5dadc0d719211257c5f91c2dd">SPELL_FAILED_TOO_CLOSE</a>;</div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a856f63fc12dc903b8122624a5bbfec3b">IsIgnoreLosSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a26e87ddbab4b2f802e189ecb564e4400">IsWithinLOS</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">m_destPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a> + 1.f))</div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d">SPELL_FAILED_LINE_OF_SIGHT</a>;</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;    }</div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160; </div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> == <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a>)</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;    {</div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;        <span class="keywordtype">float</span> dist = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>);</div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;        <span class="keywordflow">if</span> (dist &gt; maxRange* maxRange)</div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a>;</div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;        <span class="keywordflow">if</span> (minRange &amp;&amp; dist &lt; minRange * minRange)</div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba190b67f5dadc0d719211257c5f91c2dd">SPELL_FAILED_TOO_CLOSE</a>;</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a856f63fc12dc903b8122624a5bbfec3b">IsIgnoreLosSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a26e87ddbab4b2f802e189ecb564e4400">IsWithinLOS</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">x</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a54a6182b5f7539295b32255808897d3f">y</a>, <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">m_srcPos</a>.<a class="code" href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">z</a> + 1.f))</div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d">SPELL_FAILED_LINE_OF_SIGHT</a>;</div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;    }</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160; </div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;    <a class="code" href="classSpell.html#a1eccb88ab5fe5367817bcbbdbb368b81">m_maxRange</a> = maxRange; <span class="comment">// need to save max range for some calculations</span></div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160; </div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;}</div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160; </div>
<div class="line"><a name="l07485"></a><span class="lineno"><a class="line" href="classSpell.html#ac3945af8d47c78ea50cbbaf97205fc6e"> 7485</a></span>&#160;<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> <a class="code" href="classSpell.html#ac3945af8d47c78ea50cbbaf97205fc6e">Spell::CalculateSpellEffectDamage</a>(<a class="code" href="classUnit.html">Unit</a>* unitTarget, <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> damage)</div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;{</div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;    <span class="comment">// damage bonus (per damage class)</span></div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a879bfebf33dade7738722746a31bc78b">DmgClass</a>)</div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;    {</div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;        <span class="comment">// Melee and Ranged Spells</span></div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a26638bd2ee5365a4b278420b7dc66956">SPELL_DAMAGE_CLASS_RANGED</a>:</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4ad6e0146bc0d96e2ff12e902b53a29fe3">SPELL_DAMAGE_CLASS_MELEE</a>:</div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;        {</div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;            <span class="comment">// Calculate damage bonus</span></div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>())</div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;                <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a> = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a4380e734c7b5bff2ef337acc09973574">MeleeDamageBonusDone</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a>, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SharedDefines_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54">SPELL_DIRECT_DAMAGE</a>);</div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;            <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a> = <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classUnit.html#a9aa5110031a70a1a839fd6a18368ff5b">MeleeDamageBonusTaken</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>() ? <span class="keyword">nullptr</span> : <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a>, <a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="SharedDefines_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54">SPELL_DIRECT_DAMAGE</a>);</div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;        }</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;        <span class="comment">// Magical Attacks</span></div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a5aee25f13be5fe04f98537e1da06a615">SPELL_DAMAGE_CLASS_NONE</a>:</div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a44c25232e532dcd5a47b225f2e531093">SPELL_DAMAGE_CLASS_MAGIC</a>:</div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;        {</div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;            <span class="comment">// Calculate damage bonus</span></div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>())</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;                <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a> = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#aca7b70433ca6cf1a62190882b7077d2c">SpellDamageBonusDone</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a>, <a class="code" href="SharedDefines_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54">SPELL_DIRECT_DAMAGE</a>);</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;            <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a> = <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>-&gt;<a class="code" href="classUnit.html#a3e205a20504de0ff1b2fcab7a8b0784e">SpellDamageBonusTaken</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>() ? <span class="keyword">nullptr</span> : <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a>, <a class="code" href="SharedDefines_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54">SPELL_DIRECT_DAMAGE</a>);</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;        }</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;    }</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">damage</a>;</div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;}</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160; </div>
<div class="line"><a name="l07514"></a><span class="lineno"><a class="line" href="classSpell.html#a95c30c2702c0b125c21ab71bdf9ba743"> 7514</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classSpell.html#a95c30c2702c0b125c21ab71bdf9ba743">Spell::CalculatePowerCost</a>(<a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellInfo, <a class="code" href="classUnit.html">Unit</a>* caster, <a class="code" href="classSpell.html">Spell</a>* spell, <a class="code" href="classItem.html">Item</a>* castItem, <span class="keywordtype">bool</span> finalUse)</div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;{</div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;    <span class="comment">// item cast not used power</span></div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;    <span class="keywordflow">if</span> (castItem)</div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160; </div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;    <span class="comment">// Spell drain all exist power on cast (Only paladin lay of Hands)</span></div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a9055b406a86e1f19015561a20e239bfc">SPELL_ATTR_EX_USE_ALL_MANA</a>))</div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;    {</div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;        <span class="comment">// If power type - health drain all</span></div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;        <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a>)</div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;            <span class="keywordflow">return</span> caster-&gt;<a class="code" href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>();</div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;        <span class="comment">// Else drain all power</span></div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;        <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> &lt; <a class="code" href="SharedDefines_8h.html#a78fcc691229c7bc57dff4fcb8d744f1b">MAX_POWERS</a>)</div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;            <span class="keywordflow">return</span> caster-&gt;<a class="code" href="classUnit.html#ad7e475d80b9af430cc076d7c01f967e9">GetPower</a>(<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>));</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell::CalculateManaCost: Unknown power type &#39;%d&#39; in spell %d&quot;</span>, spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>, spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;    }</div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160; </div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;    <span class="comment">// Base powerCost</span></div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> powerCost = spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa1f607116227f95f1c499af5232aef93">manaCost</a> + spellInfo-&gt;<a class="code" href="structSpellEntry.html#a9a00332818bed2bf6a28bad16d8b4acc">manaCostPerlevel</a> * (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(caster-&gt;<a class="code" href="classUnit.html#a96443998b2a4b8ffd2af149939440837">GetSpellRank</a>(spellInfo)) / 5  - spellInfo-&gt;<a class="code" href="structSpellEntry.html#a131e28e607f7dfea2b2aa1928050ecef">baseLevel</a>);</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;    <span class="comment">// PCT cost from total amount</span></div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#accbc0425316d6848dbdd9f6bed9ec306">ManaCostPercentage</a>)</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;    {</div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;        <span class="keywordflow">switch</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>)</div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;        {</div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;            <span class="comment">// health as power used</span></div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a>:</div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;                powerCost += spellInfo-&gt;<a class="code" href="structSpellEntry.html#accbc0425316d6848dbdd9f6bed9ec306">ManaCostPercentage</a> * caster-&gt;<a class="code" href="classUnit.html#a9678aa29c620e955f9a971c3c889c860">GetCreateHealth</a>() / 100;</div>
<div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>:</div>
<div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;                powerCost += spellInfo-&gt;<a class="code" href="structSpellEntry.html#accbc0425316d6848dbdd9f6bed9ec306">ManaCostPercentage</a> * caster-&gt;<a class="code" href="classUnit.html#ae0ca62842bea9e94497c0200b37891d8">GetCreateMana</a>() / 100;</div>
<div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a1b514bf3a42e9a5dc4271bd25b7dce7e">POWER_RAGE</a>:</div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27adf1e2c1dbfbecd82a3bdcef559ac8cc3">POWER_FOCUS</a>:</div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a535f3e3322566811e43bef82808b5288">POWER_ENERGY</a>:</div>
<div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a50639b61f76392c0af9c99462b1cba35">POWER_HAPPINESS</a>:</div>
<div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;                powerCost += spellInfo-&gt;<a class="code" href="structSpellEntry.html#accbc0425316d6848dbdd9f6bed9ec306">ManaCostPercentage</a> * caster-&gt;<a class="code" href="classUnit.html#a93f83fd909310de2c76382d00d7dbbf1">GetMaxPower</a>(<a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>(spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>)) / 100;</div>
<div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ad2662f90ffd864b9483e8265c2cc08df">POWER_RUNE</a>:</div>
<div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a4c504424e60c95f01e0ec1468a52d221">POWER_RUNIC_POWER</a>:</div>
<div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;                <a class="code" href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a>(<span class="stringliteral">&quot;Spell::CalculateManaCost: Not implemented yet!&quot;</span>);</div>
<div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;                <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell::CalculateManaCost: Unknown power type &#39;%d&#39; in spell %d&quot;</span>, spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>, spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;        }</div>
<div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;    }</div>
<div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;    <a class="code" href="SharedDefines_8h.html#a25263e3e283b54e5280d5af1fd16da4c">SpellSchools</a> school = <a class="code" href="SharedDefines_8h.html#a6606234724aae83ff057f648f96c2ada">GetFirstSchoolInMask</a>(spell ? spell-&gt;<a class="code" href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">m_spellSchoolMask</a> : <a class="code" href="SpellMgr_8h.html#a22e0f1c7f488563ce1e10a2ae2d4906d">GetSpellSchoolMask</a>(spellInfo));</div>
<div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;    <span class="comment">// Flat mod from caster auras by spell school</span></div>
<div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;    powerCost += caster-&gt;<a class="code" href="classObject.html#acbbf66178b2c9ec6d5d44d80b43abfb6">GetInt32Value</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a1f16c4385c6f555e384b123886377fa1">UNIT_FIELD_POWER_COST_MODIFIER</a> + school);</div>
<div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;    <span class="comment">// Shiv - costs 20 + weaponSpeed*10 energy (apply only to non-triggered spell with energy cost)</span></div>
<div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035a6d5c664016f0bd4bd56a6a7659cb9c81">SPELL_ATTR_EX4_WEAPON_SPEED_COST_SCALING</a>))</div>
<div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;        powerCost += caster-&gt;<a class="code" href="classUnit.html#aa4192d3622a4c41d4c5a46a60209e62e">GetAttackTime</a>(<a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a>) / 100;</div>
<div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;    <span class="comment">// Apply cost mod by spell</span></div>
<div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;    <span class="keywordflow">if</span> (spell)</div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = caster-&gt;<a class="code" href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">GetSpellModOwner</a>())</div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;            modOwner-&gt;ApplySpellMod(spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351af20b74239c863da128fdb51f2d37bdd7">SPELLMOD_COST</a>, powerCost, finalUse);</div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160; </div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a02b7267ebc23af3804cb7d2c0fec1580">SPELL_ATTR_SCALES_WITH_CREATURE_LEVEL</a>))</div>
<div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;    {</div>
<div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;        <a class="code" href="structGtNPCManaCostScalerEntry.html">GtNPCManaCostScalerEntry</a> <span class="keyword">const</span>* spellScaler = <a class="code" href="DBCStores_8cpp.html#a6cd9fabae2b38cb4d202f25c57e4dad9">sGtNPCManaCostScalerStore</a>.LookupEntry(spellInfo-&gt;<a class="code" href="structSpellEntry.html#aa401405fe3221db2723b2b8e6fe48c9b">spellLevel</a> - 1);</div>
<div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;        <a class="code" href="structGtNPCManaCostScalerEntry.html">GtNPCManaCostScalerEntry</a> <span class="keyword">const</span>* casterScaler = <a class="code" href="DBCStores_8cpp.html#a6cd9fabae2b38cb4d202f25c57e4dad9">sGtNPCManaCostScalerStore</a>.LookupEntry(caster-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>() - 1);</div>
<div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;        <span class="keywordflow">if</span> (spellScaler &amp;&amp; casterScaler)</div>
<div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;            powerCost *= casterScaler-&gt;<a class="code" href="structGtNPCManaCostScalerEntry.html#a4d2880eb4c15dca8148ee5aa21920e6d">ratio</a> / spellScaler-&gt;<a class="code" href="structGtNPCManaCostScalerEntry.html#a4d2880eb4c15dca8148ee5aa21920e6d">ratio</a>;</div>
<div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;    }</div>
<div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160; </div>
<div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;    <span class="comment">// PCT mod from user auras by school</span></div>
<div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;    powerCost = <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(powerCost * (1.0f + caster-&gt;<a class="code" href="classObject.html#ae70d868c6ec2c0d3849a48c6e75da5aa">GetFloatValue</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881ae2928aeed1af182ed918045f3823ac38">UNIT_FIELD_POWER_COST_MULTIPLIER</a> + school)));</div>
<div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;    <span class="keywordflow">if</span> (powerCost &lt; 0)</div>
<div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;        powerCost = 0;</div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;    <span class="keywordflow">return</span> powerCost;</div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;}</div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160; </div>
<div class="line"><a name="l07588"></a><span class="lineno"><a class="line" href="classSpell.html#a3b98230b66cde204babd4bf0f3a73789"> 7588</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#a3b98230b66cde204babd4bf0f3a73789">Spell::CheckPower</a>(<span class="keywordtype">bool</span> strict)</div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;{</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;    <span class="comment">// item or GO cast does not use power</span></div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> || !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160; </div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;    <span class="comment">// Do precise power regen on spell cast</span></div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a> &gt; 0 &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;    {</div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;        <a class="code" href="classPlayer.html">Player</a>* playerCaster = (<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>;</div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> diff = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ae4a38d0c4dd65a2c51822fc8f605a1cc">GetRegenTimer</a>();</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;        <span class="keywordflow">if</span> (diff &gt;= <a class="code" href="group__game.html#gab15b0fa4721a5e2edcc527603cab9006">REGEN_TIME_PRECISE</a>)</div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;            playerCaster-&gt;<a class="code" href="classPlayer.html#a05e3496384aaffb6cd16f560bd36d29c">RegenerateAll</a>(diff);</div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;    }</div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160; </div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;    <a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a> = <a class="code" href="classSpell.html#a95c30c2702c0b125c21ab71bdf9ba743">CalculatePowerCost</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <span class="keyword">this</span>, <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>, !strict);</div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160; </div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;    <span class="comment">// health as power used - need check health amount</span></div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a>)</div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;    {</div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>() &lt;= <a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a>)</div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a>;</div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;    }</div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160; </div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;    <span class="comment">// Check valid power type</span></div>
<div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> &gt;= <a class="code" href="SharedDefines_8h.html#a78fcc691229c7bc57dff4fcb8d744f1b">MAX_POWERS</a>)</div>
<div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;    {</div>
<div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;Spell::CheckMana: Unknown power type &#39;%d&#39;&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>);</div>
<div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba413f89a20f52b5ee916ca64f50fc4467">SPELL_FAILED_UNKNOWN</a>;</div>
<div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;    }</div>
<div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160; </div>
<div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;    <span class="comment">// check rune cost only if a spell has PowerType == POWER_RUNE</span></div>
<div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a> == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ad2662f90ffd864b9483e8265c2cc08df">POWER_RUNE</a>)</div>
<div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;    {</div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> failReason = <a class="code" href="classSpell.html#ab3ffd4cc75d8108d2602ae767ea3d5df">CheckOrTakeRunePower</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;        <span class="keywordflow">if</span> (failReason != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;            <span class="keywordflow">return</span> failReason;</div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;    }</div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160; </div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;    <span class="comment">// Check power amount</span></div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;    <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a> powerType = <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">powerType</a>);</div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ad7e475d80b9af430cc076d7c01f967e9">GetPower</a>(powerType) &lt; <a class="code" href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">m_powerCost</a>)</div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba24fad721a4cf3b105b67b9d0613be0c3">SPELL_FAILED_NO_POWER</a>;</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160; </div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;}</div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160; </div>
<div class="line"><a name="l07636"></a><span class="lineno"><a class="line" href="classSpell.html#af84a8ccfbfa113458cd96927a0bd65d6"> 7636</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#af84a8ccfbfa113458cd96927a0bd65d6">Spell::IgnoreItemRequirements</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#afbeb295ad7652c0abf129066e76a4a10">m_channelOnly</a> || <a class="code" href="classSpell.html#aa2b31e212fc2a2b6608c464b428976d1">m_ignoreCosts</a>)</div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160; </div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> &amp;&amp; (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#af7a886f8c92b50336befba9567265017">Flags</a> &amp; <a class="code" href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa24970521c3ce1c90018bcafb985b0f46">ITEM_FLAG_NO_REAGENT_COST</a>))</div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160; </div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;    <span class="comment">// Workaround for double shard problem</span></div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> || this-&gt;<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 46546)</div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;    {</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* targetItem = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;            <span class="keywordflow">if</span> (targetItem-&gt;GetOwnerGuid() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160; </div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;        <span class="keywordflow">return</span> !(<a class="code" href="classSpell.html#ab3d3ccf4db3daa4de3bdfd7fe3371eae">m_triggeredBySpellInfo</a> &amp;&amp; !<a class="code" href="classSpell.html#ab3d3ccf4db3daa4de3bdfd7fe3371eae">m_triggeredBySpellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1c912ec366db72086130df35f219f46b">Reagent</a>[0]);</div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;    }</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160; </div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;}</div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160; </div>
<div class="line"><a name="l07661"></a><span class="lineno"><a class="line" href="classSpell.html#a516f3d4404f0ca2010d21d8c64d478ee"> 7661</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#a516f3d4404f0ca2010d21d8c64d478ee">Spell::CheckItems</a>()</div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;{</div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160; </div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;    <a class="code" href="classPlayer.html">Player</a>* p_caster = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;    <a class="code" href="classPlayer.html">Player</a>* playerTarget = p_caster;</div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;        <span class="keywordflow">if</span> (target-&gt;IsPlayer())</div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;            playerTarget = <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target);</div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160; </div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;    <span class="keywordtype">bool</span> isScrollItem = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;    <span class="keywordtype">bool</span> isVellumTarget = <span class="keyword">false</span>;</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160; </div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;    <span class="comment">// cast item checks</span></div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>)</div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;    {</div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a9f88246dc5897db068da95ed1f473eec">IsInTrade</a>())</div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a>;</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160; </div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> itemid = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>();</div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;        <span class="keywordflow">if</span> (!p_caster-&gt;<a class="code" href="classPlayer.html#ab563068f1495ca11652bef21caf63da3">HasItemCount</a>(itemid, 1))</div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a>;</div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160; </div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;        <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* proto = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>();</div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;        <span class="keywordflow">if</span> (!proto)</div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a>;</div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160; </div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;        <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#af7a886f8c92b50336befba9567265017">Flags</a> &amp; <a class="code" href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa24970521c3ce1c90018bcafb985b0f46">ITEM_FLAG_NO_REAGENT_COST</a>)</div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;            isScrollItem = <span class="keyword">true</span>;</div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160; </div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; 5; ++i)</div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;            <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>[i].<a class="code" href="struct__Spell.html#a16909465a3a20dbab6e3ca2e3c807f17">SpellCharges</a>)</div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a345485448a4b18c8ef2e8805f16ce458">GetSpellCharges</a>(i) == 0)</div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba54cc630c056dcd9d3f6c2736bb4f7ef5">SPELL_FAILED_NO_CHARGES_REMAIN</a>;</div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160; </div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;        <span class="comment">// consumable cast item checks</span></div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;        <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#a1818791c8035a7cd3cf441c79d34fb66">Class</a> == <a class="code" href="ItemPrototype_8h.html#ab76605e05d3b13f61472b9a89cd22a68af2ec0a93be80cad30c0131dcd5b7761c">ITEM_CLASS_CONSUMABLE</a>)</div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;        {</div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;            <span class="comment">// such items should only fail if there is no suitable effect at all - see Rejuvenation Potions for example</span></div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;            <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> failReason = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;            {</div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;                <span class="comment">// skip check, pet not required like checks, and for TARGET_UNIT_CASTER_PET m_targets.getUnitTarget() is not the real target but the caster</span></div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a>)</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160; </div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[i] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a> ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;                <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160; </div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4882157067be8542f9192927816acda1">SPELL_EFFECT_HEAL</a>)</div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;                {</div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>() == target-&gt;<a class="code" href="classUnit.html#a5173c1774b09b42c409bf31280c37d36">GetMaxHealth</a>())</div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;                    {</div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;                        failReason = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6f1577d756a021a3789b7b85da15e4e0">SPELL_FAILED_ALREADY_AT_FULL_HEALTH</a>;</div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;                    }</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;                    failReason = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;                }</div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160; </div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;                <span class="comment">// Mana Potion, Rage Potion, Thistle Tea(Rogue), ...</span></div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab0727b6312cbc0d83b93ab5d5578fe8b">SPELL_EFFECT_ENERGIZE</a>)</div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;                {</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i] &lt; 0 || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i] &gt;= <a class="code" href="SharedDefines_8h.html#a78fcc691229c7bc57dff4fcb8d744f1b">MAX_POWERS</a>)</div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;                    {</div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;                        failReason = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4c3f7a0632ca530f1240ef3bec4a8dac">SPELL_FAILED_ALREADY_AT_FULL_POWER</a>;</div>
<div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;                    }</div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160; </div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;                    <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a> power = <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i]);</div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#ad7e475d80b9af430cc076d7c01f967e9">GetPower</a>(power) == target-&gt;<a class="code" href="classUnit.html#a93f83fd909310de2c76382d00d7dbbf1">GetMaxPower</a>(power))</div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;                    {</div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;                        failReason = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4c3f7a0632ca530f1240ef3bec4a8dac">SPELL_FAILED_ALREADY_AT_FULL_POWER</a>;</div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;                    }</div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;                    {</div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;                        failReason = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;                    }</div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;                }</div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;            }</div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;            <span class="keywordflow">if</span> (failReason != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>)</div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;                <span class="keywordflow">return</span> failReason;</div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;        }</div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;    }</div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160; </div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;    <span class="comment">// check target item (for triggered case not report error)</span></div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#aebd9cd7110f9711cd2bd94e154920cd6">getItemTargetGuid</a>())</div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;    {</div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;                   ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160; </div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>  &amp;&amp; !(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;                   ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba56178933380524354520fc81ffa3b350">SPELL_FAILED_ITEM_GONE</a>;</div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160; </div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;        isVellumTarget = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>()-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#a2b8cde54716446647b4cfef0c3cf61fe">IsVellum</a>();</div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>()-&gt;<a class="code" href="classItem.html#ab83f9f8737df779b6ae7aae91cbc1f2c">IsFitToSpellRequirements</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>  &amp;&amp; !(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;                   ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba189024402cf4723fd717ba84cde101fa">SPELL_FAILED_EQUIPPED_ITEM_CLASS</a>;</div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160; </div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50ac46d6aff18eaddcab3e946b63c819c14">SPELL_ATTR_HELD_ITEM_ONLY</a>) &amp;&amp; (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>()-&gt;<a class="code" href="classItem.html#a04019a011a5f4df849f39b413df68295">GetSlot</a>() &lt; <a class="code" href="Player_8h.html#a93b8041f948d575ef2d23746324a37afa559e9d51b0cff8ac6448c07e005a13bd">EQUIPMENT_SLOT_MAINHAND</a> || <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>()-&gt;<a class="code" href="classItem.html#a04019a011a5f4df849f39b413df68295">GetSlot</a>() &gt; <a class="code" href="Player_8h.html#a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a">EQUIPMENT_SLOT_RANGED</a>))</div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; !(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;                   ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf05e1b2262997839340ddceb8bc9dc39">SPELL_FAILED_MAINHAND_EMPTY</a>;</div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160; </div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;        <span class="comment">// Do not enchant vellum with scroll</span></div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;        <span class="keywordflow">if</span> (isVellumTarget &amp;&amp; isScrollItem)</div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>  &amp;&amp; !(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>)</div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;                   ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;    }</div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;    <span class="comment">// if not item target then required item must be equipped (for triggered case not report error)</span></div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;    {</div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> error = <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba189024402cf4723fd717ba84cde101fa">SPELL_FAILED_EQUIPPED_ITEM_CLASS</a>;</div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; !<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;HasItemFitToSpellReqirements(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, <span class="keyword">nullptr</span>, &amp;error))</div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> ? <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a> : <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a>(error);</div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;    }</div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160; </div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;    <span class="comment">// check reagents (ignore triggered spells with reagents processed by original spell) and special reagent ignore case.</span></div>
<div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#af84a8ccfbfa113458cd96927a0bd65d6">IgnoreItemRequirements</a>())</div>
<div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;    {</div>
<div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;        <span class="keywordflow">if</span> (!p_caster-&gt;<a class="code" href="classPlayer.html#ae6a51221f478bb16c116402295880786">CanNoReagentCast</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;        {</div>
<div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCStructure_8h.html#a7dfd9b5e0adb5c5e3ebf3173f80fbcce">MAX_SPELL_REAGENTS</a>; ++i)</div>
<div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;            {</div>
<div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1c912ec366db72086130df35f219f46b">Reagent</a>[i] &lt;= 0)</div>
<div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160; </div>
<div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> itemid    = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1c912ec366db72086130df35f219f46b">Reagent</a>[i];</div>
<div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> itemcount = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a0fdf9afa2dbe95e2e8b2aeb31dc7dfa1">ReagentCount</a>[i];</div>
<div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160; </div>
<div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;                <span class="comment">// if CastItem is also spell reagent</span></div>
<div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> &amp;&amp; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() == itemid)</div>
<div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;                {</div>
<div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;                    <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* proto = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>();</div>
<div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;                    <span class="keywordflow">if</span> (!proto)</div>
<div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa628da71e8ecb35003c937c46662d243">SPELL_FAILED_REAGENTS</a>;</div>
<div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s = 0; s &lt; <a class="code" href="ItemPrototype_8h.html#a9e238c2727e820f5207cccdb26e2ce95">MAX_ITEM_PROTO_SPELLS</a>; ++s)</div>
<div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;                    {</div>
<div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;                        <span class="comment">// CastItem will be used up and does not count as reagent</span></div>
<div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;                        <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> charges = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classItem.html#a345485448a4b18c8ef2e8805f16ce458">GetSpellCharges</a>(s);</div>
<div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;                        <span class="keywordflow">if</span> (proto-&gt;<a class="code" href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">Spells</a>[s].<a class="code" href="struct__Spell.html#a16909465a3a20dbab6e3ca2e3c807f17">SpellCharges</a> &lt; 0 &amp;&amp; abs(charges) &lt; 2)</div>
<div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;                        {</div>
<div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;                            <span class="comment">// NOTE: spells that proc and require a reagent shouldn&#39;t increment the counter; Example: 52418</span></div>
<div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;                            <span class="keywordflow">if</span> (!itemcount)</div>
<div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;                                ++itemcount;</div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;                        }</div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;                    }</div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;                }</div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160; </div>
<div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;                <span class="keywordflow">if</span> (!p_caster-&gt;<a class="code" href="classPlayer.html#ab563068f1495ca11652bef21caf63da3">HasItemCount</a>(itemid, itemcount))</div>
<div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;                {</div>
<div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;                    <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a> = itemid;</div>
<div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa628da71e8ecb35003c937c46662d243">SPELL_FAILED_REAGENTS</a>;</div>
<div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;                }</div>
<div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;            }</div>
<div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;        }</div>
<div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160; </div>
<div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;        <span class="comment">// check totem-item requirements (items presence in inventory)</span></div>
<div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> totems = <a class="code" href="DBCStructure_8h.html#aecf32f24cad55cf1076d863d70247894">MAX_SPELL_TOTEMS</a>;</div>
<div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> i : <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a3d7ab889f71d22afbfb78329c4bb0f16">Totem</a>)</div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;        {</div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;            <span class="keywordflow">if</span> (i != 0)</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;            {</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;                <span class="keywordflow">if</span> (p_caster-&gt;<a class="code" href="classPlayer.html#ab563068f1495ca11652bef21caf63da3">HasItemCount</a>(i, 1))</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;                {</div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;                    totems -= 1;</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;                }</div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;            }</div>
<div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;                totems -= 1;</div>
<div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;        }</div>
<div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160; </div>
<div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;        <span class="keywordflow">if</span> (totems != 0)</div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba85507d5434460a32675c0e5601110d3f">SPELL_FAILED_TOTEMS</a>;</div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160; </div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;        <span class="comment">// Check items for TotemCategory  (items presence in inventory)</span></div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="SharedDefines_8h.html#ab2b0211558cbc166b3bccd39444b95f0">TotemCategory</a> = <a class="code" href="DBCStructure_8h.html#a0c6f569404777c9ea81a3a0c17bef481">MAX_SPELL_TOTEM_CATEGORIES</a>;</div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#afd59039a969e14a54f39a372a6541d0b">TotemCategory</a>)</div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;        {</div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;            <span class="keywordflow">if</span> (i != 0)</div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;            {</div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;                <span class="keywordflow">if</span> (p_caster-&gt;<a class="code" href="classPlayer.html#a626160ad35021711783bd86f733cb284">HasItemTotemCategory</a>(i))</div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;                {</div>
<div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;                    <a class="code" href="SharedDefines_8h.html#ab2b0211558cbc166b3bccd39444b95f0">TotemCategory</a> -= 1;</div>
<div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;                }</div>
<div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;            }</div>
<div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;                <a class="code" href="SharedDefines_8h.html#ab2b0211558cbc166b3bccd39444b95f0">TotemCategory</a> -= 1;</div>
<div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;        }</div>
<div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160; </div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="SharedDefines_8h.html#ab2b0211558cbc166b3bccd39444b95f0">TotemCategory</a> != 0)</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf5c8961a3681a64ace4b65bd9927d31a">SPELL_FAILED_TOTEM_CATEGORY</a>;</div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;    }</div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160; </div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;    <span class="comment">// special checks for spell effects</span></div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;    {</div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i])</div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;        {</div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af5abf258b008fbff818ad32ac7a95fbb">SPELL_EFFECT_CREATE_ITEM</a>:</div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;            {</div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;                <span class="comment">// check requirement at spell end</span></div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa763d6493fb2b6b556c84aee4e0f1bad3">SPELL_STATE_TARGETING</a>)</div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160; </div>
<div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i])</div>
<div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;                {</div>
<div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;                    <span class="comment">// Conjure Mana Gem (skip same or low level ranks for later recharge)</span></div>
<div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;                    <span class="keywordflow">if</span> (i == <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db">EFFECT_INDEX_1</a>] == <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a027bcdf3b42e90e7374802fe61fd776d">SPELL_EFFECT_DUMMY</a>)</div>
<div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;                    {</div>
<div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* itemProto = <a class="code" href="classObjectMgr.html#a85a1155c667c781dff3258c751fcde60">ObjectMgr::GetItemPrototype</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i]))</div>
<div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;                        {</div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* item = p_caster-&gt;<a class="code" href="classPlayer.html#abd27766d244dff1de0e26608a5bf3160">GetItemByLimitedCategory</a>(itemProto-&gt;ItemLimitCategory))</div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;                            {</div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;                                <span class="keywordflow">if</span> (item-&gt;GetProto()-&gt;ItemLevel &lt;= itemProto-&gt;ItemLevel)</div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;                                {</div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;                                    <span class="keywordflow">if</span> (item-&gt;HasMaxCharges())</div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;                                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1a54b16fbf940ffc9f6451e815579b8d">SPELL_FAILED_ITEM_AT_MAX_CHARGES</a>;</div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160; </div>
<div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;                                    <span class="comment">// will recharge in next effect</span></div>
<div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;                                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;                                }</div>
<div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;                            }</div>
<div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;                        }</div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;                    }</div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160; </div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;                    <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* itemProto = <a class="code" href="classObjectMgr.html#a85a1155c667c781dff3258c751fcde60">ObjectMgr::GetItemPrototype</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i]);</div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;                    <span class="keywordflow">if</span> (!itemProto)</div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a>; <span class="comment">// custom error in case item template is missing</span></div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;                    <a class="code" href="Player_8h.html#a06f492a0a20f5264c8395684220fec84">ItemPosCountVec</a> dest;</div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;                    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> count = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;                    count = count &gt; itemProto-&gt;<a class="code" href="structItemPrototype.html#ad84fbcdf7890c7bad885a8ae5a02f19e">Stackable</a> ? itemProto-&gt;<a class="code" href="structItemPrototype.html#ad84fbcdf7890c7bad885a8ae5a02f19e">Stackable</a> : count;</div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;                    <a class="code" href="Item_8h.html#a73617af2b3e5e935646638fa13678391">InventoryResult</a> msg = playerTarget-&gt;<a class="code" href="classPlayer.html#af059a10625d50ca7674771ea1c1c4c4c">CanStoreNewItem</a>(<a class="code" href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5a843659af0a40139bfa505d7e7982477b">NULL_BAG</a>, <a class="code" href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5aeb5cbd7990d2f5e679ec4ecc65e83130">NULL_SLOT</a>, dest, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i], count);</div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;                    <span class="keywordflow">if</span> (msg != <a class="code" href="Item_8h.html#a73617af2b3e5e935646638fa13678391a939b6661cd19d6c18274906abb28021c">EQUIP_ERR_OK</a>)</div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;                    {</div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;                        p_caster-&gt;<a class="code" href="classPlayer.html#ab44cedcf193c8807967a7126bb38de3b">SendEquipError</a>(msg, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i]);</div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;                    }</div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;                }</div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;            }</div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97acc3029fb0c202edd84a65d07ef68014e">SPELL_EFFECT_RESTORE_ITEM_CHARGES</a>:</div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;            {</div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* item = p_caster-&gt;<a class="code" href="classPlayer.html#a2a17a4e404276def5918ada66ed0f1f4">GetItemByEntry</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i]))</div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;                    <span class="keywordflow">if</span> (item-&gt;HasMaxCharges())</div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1a54b16fbf940ffc9f6451e815579b8d">SPELL_FAILED_ITEM_AT_MAX_CHARGES</a>;</div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160; </div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;            }</div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a3467958b5173482af8149b7c32c9ed4d">SPELL_EFFECT_ENCHANT_ITEM</a>:</div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aeb1d7a27ab01055bd66d8b012dbea7be">SPELL_EFFECT_ENCHANT_ITEM_PRISMATIC</a>:</div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;            {</div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;                <a class="code" href="classItem.html">Item</a>* targetItem = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>();</div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;                <span class="keywordflow">if</span> (!targetItem)</div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a>;</div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160; </div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;                <span class="keywordflow">if</span> (targetItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#a8eca0641dc694b14de2db0e23a341328">ItemLevel</a> &lt; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a131e28e607f7dfea2b2aa1928050ecef">baseLevel</a>)</div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf">SPELL_FAILED_LOWLEVEL</a>;</div>
<div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;                <span class="comment">// Check if we can store a new scroll, enchanting vellum has implicit SPELL_EFFECT_CREATE_ITEM</span></div>
<div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;                <span class="keywordflow">if</span> (isVellumTarget &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i])</div>
<div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;                {</div>
<div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;                    <a class="code" href="Player_8h.html#a06f492a0a20f5264c8395684220fec84">ItemPosCountVec</a> dest;</div>
<div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;                    <a class="code" href="Item_8h.html#a73617af2b3e5e935646638fa13678391">InventoryResult</a> msg = p_caster-&gt;<a class="code" href="classPlayer.html#af059a10625d50ca7674771ea1c1c4c4c">CanStoreNewItem</a>(<a class="code" href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5a843659af0a40139bfa505d7e7982477b">NULL_BAG</a>, <a class="code" href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5aeb5cbd7990d2f5e679ec4ecc65e83130">NULL_SLOT</a>, dest, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">EffectItemType</a>[i], 1);</div>
<div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;                    <span class="keywordflow">if</span> (msg != <a class="code" href="Item_8h.html#a73617af2b3e5e935646638fa13678391a939b6661cd19d6c18274906abb28021c">EQUIP_ERR_OK</a>)</div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;                    {</div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;                        p_caster-&gt;<a class="code" href="classPlayer.html#ab44cedcf193c8807967a7126bb38de3b">SendEquipError</a>(msg, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;                    }</div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;                }</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;                <span class="comment">// Not allow enchant in trade slot for some enchant type</span></div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;                <span class="keywordflow">if</span> (targetItem-&gt;<a class="code" href="classItem.html#a832970d43976538c4092cf5d09706546">GetOwner</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;                {</div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a9e5fc74325466193bc989105be999795">SPELL_ATTR_EX2_ENCHANT_OWN_ITEM_ONLY</a>))</div>
<div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4d4bd06fea08b64dd0e963b9ba714942">SPELL_FAILED_NOT_TRADEABLE</a>;</div>
<div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160; </div>
<div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> enchant_id = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i];</div>
<div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;                    <a class="code" href="structSpellItemEnchantmentEntry.html">SpellItemEnchantmentEntry</a> <span class="keyword">const</span>* pEnchant = <a class="code" href="DBCStores_8cpp.html#a4b7782641d455ad5070f1aba070beae9">sSpellItemEnchantmentStore</a>.LookupEntry(enchant_id);</div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;                    <span class="keywordflow">if</span> (!pEnchant)</div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>;</div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;                    <span class="keywordflow">if</span> (pEnchant-&gt;<a class="code" href="structSpellItemEnchantmentEntry.html#ac764d2273e6024588328b68b078c98c5">flags</a> &amp; <a class="code" href="Item_8h.html#a733cdbba8ff15fedfe83704f3cc04838a8f5f4bb2b0cab06350f662261236f3e6">ENCHANTMENT_SOULBOUND</a>)</div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4d4bd06fea08b64dd0e963b9ba714942">SPELL_FAILED_NOT_TRADEABLE</a>;</div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;                    <span class="comment">// cannot replace vellum with scroll in trade slot</span></div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;                    <span class="keywordflow">if</span> (isVellumTarget)</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac060d1a222e61fb41adb93c9cf15e587">SPELL_FAILED_ITEM_ENCHANT_TRADE_WINDOW</a>;</div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;                }</div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;            }</div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aef19cb2a68fa76f831bb9ddcff67fa65">SPELL_EFFECT_ENCHANT_ITEM_TEMPORARY</a>:</div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;            {</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;                <a class="code" href="classItem.html">Item</a>* item = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>();</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;                <span class="keywordflow">if</span> (!item)</div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a>;</div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;                <span class="comment">// Not allow enchant in trade slot for some enchant type</span></div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;                <span class="keywordflow">if</span> (item-&gt;<a class="code" href="classItem.html#a832970d43976538c4092cf5d09706546">GetOwner</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;                {</div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a9e5fc74325466193bc989105be999795">SPELL_ATTR_EX2_ENCHANT_OWN_ITEM_ONLY</a>))</div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4d4bd06fea08b64dd0e963b9ba714942">SPELL_FAILED_NOT_TRADEABLE</a>;</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160; </div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> enchant_id = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[i];</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;                    <a class="code" href="structSpellItemEnchantmentEntry.html">SpellItemEnchantmentEntry</a> <span class="keyword">const</span>* pEnchant = <a class="code" href="DBCStores_8cpp.html#a4b7782641d455ad5070f1aba070beae9">sSpellItemEnchantmentStore</a>.LookupEntry(enchant_id);</div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;                    <span class="keywordflow">if</span> (!pEnchant)</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a>;</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;                    <span class="keywordflow">if</span> (pEnchant-&gt;<a class="code" href="structSpellItemEnchantmentEntry.html#ac764d2273e6024588328b68b078c98c5">flags</a> &amp; <a class="code" href="Item_8h.html#a733cdbba8ff15fedfe83704f3cc04838a8f5f4bb2b0cab06350f662261236f3e6">ENCHANTMENT_SOULBOUND</a>)</div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4d4bd06fea08b64dd0e963b9ba714942">SPELL_FAILED_NOT_TRADEABLE</a>;</div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;                }</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;            }</div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a2c6434d09a221f75cf5496947aa2eb89">SPELL_EFFECT_ENCHANT_HELD_ITEM</a>:</div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;                <span class="comment">// check item existence in effect code (not output errors at offhand hold item effect to main hand for example</span></div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a10e5f9dd8abe4f069a1f244ac042ac73">SPELL_EFFECT_DISENCHANT</a>:</div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;            {</div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabaec038b3106e2f9345b84a4396711da">SPELL_FAILED_CANT_BE_DISENCHANTED</a>;</div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160; </div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;                <span class="comment">// prevent disenchanting in trade slot</span></div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>()-&gt;<a class="code" href="classItem.html#a0e05db2244d937cb00e786abc2484229">GetOwnerGuid</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabaec038b3106e2f9345b84a4396711da">SPELL_FAILED_CANT_BE_DISENCHANTED</a>;</div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160; </div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;                <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* itemProto = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>()-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>();</div>
<div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;                <span class="keywordflow">if</span> (!itemProto)</div>
<div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabaec038b3106e2f9345b84a4396711da">SPELL_FAILED_CANT_BE_DISENCHANTED</a>;</div>
<div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160; </div>
<div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;                <span class="comment">// must have disenchant loot (other static req. checked at item prototype loading)</span></div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;                <span class="keywordflow">if</span> (!itemProto-&gt;<a class="code" href="structItemPrototype.html#a7a22f8ff5b6866d5d6da4ed241029877">DisenchantID</a>)</div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabaec038b3106e2f9345b84a4396711da">SPELL_FAILED_CANT_BE_DISENCHANTED</a>;</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160; </div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;                <span class="comment">// 2.0.x addon: Check player enchanting level against the item disenchanting requirements</span></div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> item_disenchantskilllevel = itemProto-&gt;<a class="code" href="structItemPrototype.html#af8c932938fa05286e451a814bf226037">RequiredDisenchantSkill</a>;</div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;                <span class="keywordflow">if</span> (item_disenchantskilllevel &gt; <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(p_caster-&gt;<a class="code" href="classPlayer.html#acda80b2f5f4e3a9b2e14609a45c0d22b">GetSkillValue</a>(<a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234aeb1f5d58fca5c46b87ad0944191ed916">SKILL_ENCHANTING</a>)))</div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505">SPELL_FAILED_LOW_CASTLEVEL</a>;</div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;            }</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a13356fe4dbcf454b9b7078fba9037965">SPELL_EFFECT_PROSPECTING</a>:</div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;            {</div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae4731a85085ddbbf17c538cb5d910f71">SPELL_FAILED_CANT_BE_PROSPECTED</a>;</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;                <a class="code" href="classItem.html">Item</a>* <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a> = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>();</div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;                <span class="comment">// ensure item is a prospectable ore</span></div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;                <span class="keywordflow">if</span> (!(<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#af7a886f8c92b50336befba9567265017">Flags</a> &amp; <a class="code" href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa40ef0669ee302f8c0fed53c60d89b65a">ITEM_FLAG_IS_PROSPECTABLE</a>))</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae4731a85085ddbbf17c538cb5d910f71">SPELL_FAILED_CANT_BE_PROSPECTED</a>;</div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;                <span class="comment">// prevent prospecting in trade slot</span></div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#a0e05db2244d937cb00e786abc2484229">GetOwnerGuid</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae4731a85085ddbbf17c538cb5d910f71">SPELL_FAILED_CANT_BE_PROSPECTED</a>;</div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;                <span class="comment">// already looting it</span></div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classObject.html#ad86e87ac77905e1436571475e6c426a1">m_loot</a> &amp;&amp; <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#a4b75fbb438b16f2594f5de570047ae05">HasTemporaryLoot</a>())</div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba847437f05d4dfe914c63dffe4badc3a1">SPELL_FAILED_NOT_WHILE_LOOTING</a>;</div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;                <span class="comment">// Check for enough skill in jewelcrafting</span></div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> item_prospectingskilllevel = <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#ad7684c702be4fdb4ce87d4a83092d215">RequiredSkillRank</a>;</div>
<div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;                <span class="keywordflow">if</span> (item_prospectingskilllevel &gt; p_caster-&gt;<a class="code" href="classPlayer.html#acda80b2f5f4e3a9b2e14609a45c0d22b">GetSkillValue</a>(<a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234aebd6721b790c2f7357ff4eb51db1f127">SKILL_JEWELCRAFTING</a>))</div>
<div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505">SPELL_FAILED_LOW_CASTLEVEL</a>;</div>
<div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;                <span class="comment">// make sure the player has the required ores in inventory</span></div>
<div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> requiredCount = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#acfce1d883f464dc73696f17c62d5ba5c">GetCount</a>()) &lt; requiredCount)</div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;                {</div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;                    <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a> = <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>();</div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;                    <a class="code" href="classSpell.html#a654c6400b8537dd520231fe998080855">m_param2</a> = requiredCount - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#acfce1d883f464dc73696f17c62d5ba5c">GetCount</a>());</div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad844177691a3eb714772f0bf8bf85bb6">SPELL_FAILED_NEED_MORE_ITEMS</a>;</div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;                }</div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160; </div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="LootMgr_8cpp.html#a5e98772296a6d93715a4ed74eb2b5bdf">LootTemplates_Prospecting</a>.<a class="code" href="classLootStore.html#abd45358d22bbb44f54743792a7fd0039">HaveLootFor</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a872c670896e98cb2ca74948e0639ba15">getItemTargetEntry</a>()))</div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae4731a85085ddbbf17c538cb5d910f71">SPELL_FAILED_CANT_BE_PROSPECTED</a>;</div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160; </div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;            }</div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a64cdaec1ed4305de209cd2aeab92aff1">SPELL_EFFECT_MILLING</a>:</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;            {</div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0dc7c11206c85c14a7c4243153d86875">SPELL_FAILED_CANT_BE_MILLED</a>;</div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;                <a class="code" href="classItem.html">Item</a>* <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a> = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>();</div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;                <span class="comment">// ensure item is a millable herb</span></div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;                <span class="keywordflow">if</span> (!(<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#af7a886f8c92b50336befba9567265017">Flags</a> &amp; <a class="code" href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa0c78000507aa82285acdf032bc9ee84f">ITEM_FLAG_IS_MILLABLE</a>))</div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0dc7c11206c85c14a7c4243153d86875">SPELL_FAILED_CANT_BE_MILLED</a>;</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;                <span class="comment">// prevent milling in trade slot</span></div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#a0e05db2244d937cb00e786abc2484229">GetOwnerGuid</a>() != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>())</div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0dc7c11206c85c14a7c4243153d86875">SPELL_FAILED_CANT_BE_MILLED</a>;</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;                <span class="comment">// Check for enough skill in inscription</span></div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;                <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> item_millingskilllevel = <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#ad7684c702be4fdb4ce87d4a83092d215">RequiredSkillRank</a>;</div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;                <span class="keywordflow">if</span> (item_millingskilllevel &gt; p_caster-&gt;<a class="code" href="classPlayer.html#acda80b2f5f4e3a9b2e14609a45c0d22b">GetSkillValue</a>(<a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a09ffe4e99e7854f73a28ed106ebb90e2">SKILL_INSCRIPTION</a>))</div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505">SPELL_FAILED_LOW_CASTLEVEL</a>;</div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;                <span class="comment">// make sure the player has the required herbs in inventory</span></div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> requiredCount = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#acfce1d883f464dc73696f17c62d5ba5c">GetCount</a>()) &lt; requiredCount)</div>
<div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;                {</div>
<div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;                    <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a> = <a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>();</div>
<div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;                    <a class="code" href="classSpell.html#a654c6400b8537dd520231fe998080855">m_param2</a> = requiredCount - <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">itemTarget</a>-&gt;<a class="code" href="classItem.html#acfce1d883f464dc73696f17c62d5ba5c">GetCount</a>());</div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad844177691a3eb714772f0bf8bf85bb6">SPELL_FAILED_NEED_MORE_ITEMS</a>;</div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;                }</div>
<div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160; </div>
<div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="LootMgr_8cpp.html#a433757800c8ee4e9b654d504a4ee828a">LootTemplates_Milling</a>.<a class="code" href="classLootStore.html#abd45358d22bbb44f54743792a7fd0039">HaveLootFor</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a872c670896e98cb2ca74948e0639ba15">getItemTargetEntry</a>()))</div>
<div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0dc7c11206c85c14a7c4243153d86875">SPELL_FAILED_CANT_BE_MILLED</a>;</div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160; </div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;            }</div>
<div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a44d3da0109cb50c42bad53e2790715e4">SPELL_EFFECT_WEAPON_DAMAGE</a>:</div>
<div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa2beb2e0d1440f64ea1661312ed02628">SPELL_EFFECT_WEAPON_DAMAGE_NOSCHOOL</a>:</div>
<div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;            {</div>
<div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>) <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1aac9d46e45a1eacb68c46b1c3e16014">SPELL_FAILED_TARGET_NOT_PLAYER</a>;</div>
<div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a> != <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a>)</div>
<div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;                <a class="code" href="classItem.html">Item</a>* pItem = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetWeaponForAttack(<a class="code" href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">m_attackType</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;                <span class="keywordflow">if</span> (!pItem)</div>
<div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6e18028072d461188e44ba8b28b7865a">SPELL_FAILED_EQUIPPED_ITEM</a>;</div>
<div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160; </div>
<div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;                <span class="keywordflow">switch</span> (pItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#ad09dd92ab1fcf2a86060fb36120459b3">SubClass</a>)</div>
<div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;                {</div>
<div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556add7a582e0a83334e929d740fbf31f820">ITEM_SUBCLASS_WEAPON_THROWN</a>:</div>
<div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;                    {</div>
<div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;                        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> ammo = pItem-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>();</div>
<div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;                        <span class="keywordflow">if</span> (!((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;HasItemCount(ammo, 1))</div>
<div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;                    }</div>
<div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a109fce85f20ce2e44432377b64a7e02c">ITEM_SUBCLASS_WEAPON_GUN</a>:</div>
<div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556aa314812b34af0583ded09e09f915c9b7">ITEM_SUBCLASS_WEAPON_BOW</a>:</div>
<div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a0e2041adefa9c4b36bf9fcc5cc9f6a4f">ITEM_SUBCLASS_WEAPON_CROSSBOW</a>:</div>
<div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;                    {</div>
<div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;                        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> ammo = ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetUInt32Value(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a98b3337ada4a0939a660090381c648b6">PLAYER_AMMO_ID</a>);</div>
<div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;                        <span class="keywordflow">if</span> (!ammo)</div>
<div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;                        {</div>
<div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;                            <span class="comment">// Requires No Ammo</span></div>
<div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#acce934b8f6ca08be9d7f7f7e773046d9">GetDummyAura</a>(46699))</div>
<div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;                                <span class="keywordflow">break</span>;                      <span class="comment">// skip other checks</span></div>
<div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160; </div>
<div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;                        }</div>
<div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160; </div>
<div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;                        <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* ammoProto = <a class="code" href="classObjectMgr.html#a85a1155c667c781dff3258c751fcde60">ObjectMgr::GetItemPrototype</a>(ammo);</div>
<div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;                        <span class="keywordflow">if</span> (!ammoProto)</div>
<div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160; </div>
<div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;                        <span class="keywordflow">if</span> (ammoProto-&gt;<a class="code" href="structItemPrototype.html#a1818791c8035a7cd3cf441c79d34fb66">Class</a> != <a class="code" href="ItemPrototype_8h.html#ab76605e05d3b13f61472b9a89cd22a68a93f7b2606e798c614212ace05d2bd52b">ITEM_CLASS_PROJECTILE</a>)</div>
<div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160; </div>
<div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;                        <span class="comment">// check ammo ws. weapon compatibility</span></div>
<div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;                        <span class="keywordflow">switch</span> (pItem-&gt;<a class="code" href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">GetProto</a>()-&gt;<a class="code" href="structItemPrototype.html#ad09dd92ab1fcf2a86060fb36120459b3">SubClass</a>)</div>
<div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;                        {</div>
<div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556aa314812b34af0583ded09e09f915c9b7">ITEM_SUBCLASS_WEAPON_BOW</a>:</div>
<div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a0e2041adefa9c4b36bf9fcc5cc9f6a4f">ITEM_SUBCLASS_WEAPON_CROSSBOW</a>:</div>
<div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;                                <span class="keywordflow">if</span> (ammoProto-&gt;<a class="code" href="structItemPrototype.html#ad09dd92ab1fcf2a86060fb36120459b3">SubClass</a> != <a class="code" href="ItemPrototype_8h.html#a59f191404caead502059bad31a2ce374a12f6717b2ba149fcefe2c6ea3df0da7c">ITEM_SUBCLASS_ARROW</a>)</div>
<div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;                            <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a109fce85f20ce2e44432377b64a7e02c">ITEM_SUBCLASS_WEAPON_GUN</a>:</div>
<div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;                                <span class="keywordflow">if</span> (ammoProto-&gt;<a class="code" href="structItemPrototype.html#ad09dd92ab1fcf2a86060fb36120459b3">SubClass</a> != <a class="code" href="ItemPrototype_8h.html#a59f191404caead502059bad31a2ce374a5b651314950d95e33ec1081b90eef5ac">ITEM_SUBCLASS_BULLET</a>)</div>
<div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;                                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;                            <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;                        }</div>
<div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160; </div>
<div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;                        <span class="keywordflow">if</span> (!((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;HasItemCount(ammo, 1))</div>
<div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;                            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a>;</div>
<div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;                    }</div>
<div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;                    <span class="keywordflow">case</span> <a class="code" href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556acfba60aacffd401146e4b0eefcb3dc48">ITEM_SUBCLASS_WEAPON_WAND</a>:</div>
<div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;                    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;                }</div>
<div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;            }</div>
<div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;            <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;        }</div>
<div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;    }</div>
<div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160; </div>
<div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;}</div>
<div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160; </div>
<div class="line"><a name="l08134"></a><span class="lineno"><a class="line" href="classSpell.html#aa19f9a8629e5ff119c87c8308c8d08d6"> 8134</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#aa19f9a8629e5ff119c87c8308c8d08d6">Spell::Delayed</a>()</div>
<div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;{</div>
<div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160; </div>
<div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a587554773427224df51cbce7a50b9d2c">m_spellState</a> == <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a>)</div>
<div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;        <span class="keywordflow">return</span>;                                             <span class="comment">// spell is active and can&#39;t be time-backed</span></div>
<div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160; </div>
<div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abe31237cfa9f26394765589cd7c3a58c">isDelayableNoMore</a>())                                <span class="comment">// Spells may only be delayed twice</span></div>
<div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160; </div>
<div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a15d161cf7035492df160807e1fa1fcb1">SPELL_ATTR_EX6_NO_PUSHBACK</a>))</div>
<div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160; </div>
<div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;    <span class="comment">// spells not loosing casting time ( slam, dynamites, bombs.. )</span></div>
<div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;    <span class="keywordflow">if</span> (!(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a5dc75f632a583e7d59c9fd780d939246">InterruptFlags</a> &amp; <a class="code" href="SpellDefines_8h.html#abadf2f982fd866917c372d16ab99c109a6003b0d5211156ba175b18e6719326ed">SPELL_INTERRUPT_FLAG_DAMAGE_PUSHBACK</a>))</div>
<div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160; </div>
<div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;    <span class="comment">// check pushback reduce</span></div>
<div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> delaytime = 500;                                  <span class="comment">// spellcasting delay is normally 500ms</span></div>
<div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> delayReduce = 100;                                <span class="comment">// must be initialized to 100 for percent modifiers</span></div>
<div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;    <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a2aa9aafa27b11a2395aef543c83eced2">SPELLMOD_NOT_LOSE_CASTING_TIME</a>, delayReduce);</div>
<div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;    delayReduce += <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ad8ea13960b62a966b516a1929585ea7b">GetTotalAuraModifier</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab7eb197a8bd93b47521695875517c14e">SPELL_AURA_REDUCE_PUSHBACK</a>) - 100;</div>
<div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;    <span class="keywordflow">if</span> (delayReduce &gt;= 100)</div>
<div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160; </div>
<div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;    delaytime = delaytime * (100 - delayReduce) / 100;</div>
<div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160; </div>
<div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>) + delaytime &gt; <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a>)</div>
<div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;    {</div>
<div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;        delaytime = <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a> - <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>;</div>
<div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;        <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> = <a class="code" href="classSpell.html#a61b0b397250bb79024c8657e28323879">m_casttime</a>;</div>
<div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;    }</div>
<div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;        <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> += delaytime;</div>
<div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160; </div>
<div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;    <a class="code" href="Log_8h.html#a078dcc01e2d47219e739c5b92ba737e2">DETAIL_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Spell %u partially interrupted for (%d) ms at damage&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, delaytime);</div>
<div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160; </div>
<div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;    <a class="code" href="classWorldPacket.html">WorldPacket</a> data(<a class="code" href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca73deada371f16dfdd7a33852eeedf6d7">SMSG_SPELL_DELAYED</a>, 8 + 4);</div>
<div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;    data &lt;&lt; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">GetPackGUID</a>();</div>
<div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;    data &lt;&lt; <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(delaytime);</div>
<div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160; </div>
<div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;    <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">SendMessageToSet</a>(data, <span class="keyword">true</span>);</div>
<div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;}</div>
<div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160; </div>
<div class="line"><a name="l08179"></a><span class="lineno"><a class="line" href="classSpell.html#ae9198fc52a22dbc82ad69b1c32d884e7"> 8179</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae9198fc52a22dbc82ad69b1c32d884e7">Spell::DelayedChannel</a>()</div>
<div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;{</div>
<div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() || <a class="code" href="classSpell.html#a6fea183fab3cd5f8946923c3d8909f5a">getState</a>() != <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>)</div>
<div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160; </div>
<div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#abe31237cfa9f26394765589cd7c3a58c">isDelayableNoMore</a>())                                <span class="comment">// Spells may only be delayed twice</span></div>
<div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160; </div>
<div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;    <span class="comment">// check pushback reduce</span></div>
<div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> delaytime = <a class="code" href="SpellMgr_8cpp.html#ac8cbcaf933a719c961ea28ae0be73c10">GetSpellDuration</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) * 25 / 100;<span class="comment">// channeling delay is normally 25% of its time per hit</span></div>
<div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;    <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> delayReduce = 100;                                <span class="comment">// must be initialized to 100 for percent modifiers</span></div>
<div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;    <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a2aa9aafa27b11a2395aef543c83eced2">SPELLMOD_NOT_LOSE_CASTING_TIME</a>, delayReduce);</div>
<div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;    delayReduce += <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ad8ea13960b62a966b516a1929585ea7b">GetTotalAuraModifier</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab7eb197a8bd93b47521695875517c14e">SPELL_AURA_REDUCE_PUSHBACK</a>) - 100;</div>
<div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;    <span class="keywordflow">if</span> (delayReduce &gt;= 100)</div>
<div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160; </div>
<div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;    delaytime = delaytime * (100 - delayReduce) / 100;</div>
<div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160; </div>
<div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>(<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>) &lt; delaytime)</div>
<div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;    {</div>
<div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;        delaytime = <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>;</div>
<div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;        <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> = 0;</div>
<div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;    }</div>
<div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;        <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a> -= delaytime;</div>
<div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160; </div>
<div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;    <a class="code" href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a>(<a class="code" href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a>, <span class="stringliteral">&quot;Spell %u partially interrupted for %i ms, new duration: %u ms&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, delaytime, <a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>);</div>
<div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160; </div>
<div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;    <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;    {</div>
<div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;        <span class="keywordflow">if</span> ((*ihit).missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)</div>
<div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;        {</div>
<div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == ihit-&gt;targetGUID ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, ihit-&gt;targetGUID))</div>
<div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;                unit-&gt;DelaySpellAuraHolder(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, delaytime, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>());</div>
<div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;        }</div>
<div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;    }</div>
<div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160; </div>
<div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++j)</div>
<div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;    {</div>
<div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;        <span class="comment">// partially interrupt persistent area auras</span></div>
<div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classDynamicObject.html">DynamicObject</a>* dynObj = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#afb9b0972d880f4325cacf77b56af970f">GetDynObject</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(j)))</div>
<div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;            dynObj-&gt;Delay(delaytime);</div>
<div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;    }</div>
<div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160; </div>
<div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;    <a class="code" href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">SendChannelUpdate</a>(<a class="code" href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">m_timer</a>);</div>
<div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;}</div>
<div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160; </div>
<div class="line"><a name="l08226"></a><span class="lineno"><a class="line" href="classSpell.html#af4432b3a613d924a4bdc8f68e9c99dac"> 8226</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#af4432b3a613d924a4bdc8f68e9c99dac">Spell::UpdateOriginalCasterPointer</a>()</div>
<div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;{</div>
<div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a> == <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>())</div>
<div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;        <a class="code" href="classSpell.html#a15299304003f041f28de7a0fd992c735">m_originalCaster</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>);</div>
<div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>.<a class="code" href="classObjectGuid.html#a97277f64de28fdef0e9f821fcd8a20a9">IsGameObject</a>())</div>
<div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;    {</div>
<div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;        <a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() ? <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;        <a class="code" href="classSpell.html#a15299304003f041f28de7a0fd992c735">m_originalCaster</a> = go ? go-&gt;<a class="code" href="classGameObject.html#a08fe8b2e3a798c80f5ca914be099b75d">GetOwner</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;    }</div>
<div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;    {</div>
<div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>);</div>
<div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;        <a class="code" href="classSpell.html#a15299304003f041f28de7a0fd992c735">m_originalCaster</a> = unit &amp;&amp; unit-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() ? unit : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;    }</div>
<div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;}</div>
<div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160; </div>
<div class="line"><a name="l08242"></a><span class="lineno"><a class="line" href="classSpell.html#a00dbf3e8c4ec3aa165e7bddb7cfeecd8"> 8242</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a00dbf3e8c4ec3aa165e7bddb7cfeecd8">Spell::UpdatePointers</a>()</div>
<div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;{</div>
<div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;    <a class="code" href="classSpell.html#af4432b3a613d924a4bdc8f68e9c99dac">UpdateOriginalCasterPointer</a>();</div>
<div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160; </div>
<div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;    <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#acba7dabf3692dcf95a31ad1ed6a5089b">Update</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>);</div>
<div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;}</div>
<div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160; </div>
<div class="line"><a name="l08249"></a><span class="lineno"><a class="line" href="classSpell.html#a80a8c95f25b8275f1d2b50a8155dd52e"> 8249</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a80a8c95f25b8275f1d2b50a8155dd52e">Spell::CheckTargetCreatureType</a>(<a class="code" href="classUnit.html">Unit</a>* target, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellInfo)</div>
<div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;{</div>
<div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellCreatureTargetMask = spellInfo-&gt;<a class="code" href="structSpellEntry.html#a3649fd97627e9ff314d43ae63e6d05cb">TargetCreatureType</a>;</div>
<div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160; </div>
<div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;    <span class="comment">// Dismiss Pet, Taming Lesson and Control Robot skipped</span></div>
<div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;    <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 2641 || spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 23356 || spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 30009)</div>
<div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;        spellCreatureTargetMask =  0;</div>
<div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160; </div>
<div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;    <span class="keywordflow">if</span> (spellCreatureTargetMask)</div>
<div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;    {</div>
<div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> TargetCreatureType = target-&gt;<a class="code" href="classUnit.html#adaae3faffd48abb28c78f8dc1b6de40e">GetCreatureTypeMask</a>();</div>
<div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160; </div>
<div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;        <span class="keywordflow">return</span> !TargetCreatureType || (spellCreatureTargetMask &amp; TargetCreatureType);</div>
<div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;    }</div>
<div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;}</div>
<div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160; </div>
<div class="line"><a name="l08266"></a><span class="lineno"><a class="line" href="classSpell.html#a9ce48dbc3b6abee433f9bf1dc97b29a6"> 8266</a></span>&#160;<a class="code" href="group__game.html#gab791040bd6d685b1fd2cfd12c96d0a1f">CurrentSpellTypes</a> <a class="code" href="classSpell.html#a9ce48dbc3b6abee433f9bf1dc97b29a6">Spell::GetCurrentContainer</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fabf840fee2a2e133105c6a92a7b43a272">CURRENT_MELEE_SPELL</a>);</div>
<div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3378c5e643dbbde893606505c42817b5">IsAutoRepeat</a>())</div>
<div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1faf4d9017fa01b68842e61b948323e93c1">CURRENT_AUTOREPEAT_SPELL</a>);</div>
<div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fa960a792eef11d7eca70b058265e3cca6">CURRENT_CHANNELED_SPELL</a>);</div>
<div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fa9cbac6c5133585dece51a40e9c1908b0">CURRENT_GENERIC_SPELL</a>);</div>
<div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;}</div>
<div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160; </div>
<div class="line"><a name="l08277"></a><span class="lineno"><a class="line" href="classSpell.html#a90f0bd6624e63ad55052e7974f7c7cdf"> 8277</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a90f0bd6624e63ad55052e7974f7c7cdf">Spell::CheckTarget</a>(<a class="code" href="classUnit.html">Unit</a>* target, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> eff, <span class="keywordtype">bool</span> targetB, <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eb">CheckException</a> exception)<span class="keyword"> const</span></div>
<div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;    <span class="comment">// Check targets for creature type mask and remove not appropriate (skip explicit self target case, maybe need other explicit targets)</span></div>
<div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;    <span class="keywordflow">if</span> (exception != <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba4fafb5864cb471a67bb473eb292c73ba">EXCEPTION_MAGNET</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[eff] != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a>)</div>
<div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;    {</div>
<div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a80a8c95f25b8275f1d2b50a8155dd52e">CheckTargetCreatureType</a>(target, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;    }</div>
<div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160; </div>
<div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;    <a class="code" href="classWorldObject.html">WorldObject</a>* affectiveCaster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>();</div>
<div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetType;</div>
<div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;    <a class="code" href="structSpellTargetInfo.html">SpellTargetInfo</a> info;</div>
<div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;    <span class="keywordflow">if</span> (!targetB)</div>
<div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;        targetType = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[eff], info = <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[eff]];</div>
<div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;        targetType = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[eff], info = <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[eff]];</div>
<div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;    <span class="keywordtype">bool</span> scriptTarget = (info.<a class="code" href="structSpellTargetInfo.html#a68c229e7f0563a90091445d626addca4">type</a> == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a> &amp;&amp; info.<a class="code" href="structSpellTargetInfo.html#a5b9dd67836d431b8c7a569b64da5dbd8">filter</a> == <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a76152bae5512ab0aeaf68f34c550d33a">TARGET_SCRIPT</a>);</div>
<div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160; </div>
<div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;    <span class="keywordflow">if</span> (target != affectiveCaster)</div>
<div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;    {</div>
<div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;        <span class="comment">// Check targets for not_selectable unit flag and remove</span></div>
<div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;        <span class="comment">// A player can cast spells on his pet (or other controlled unit) though in any state</span></div>
<div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;        <span class="keywordflow">if</span> ((!affectiveCaster || target-&gt;<a class="code" href="classUnit.html#a0d3beff329102d154c2f4a7e7221cea1">GetMasterGuid</a>() != affectiveCaster-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>()) &amp;&amp; !scriptTarget)</div>
<div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;        {</div>
<div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;            <span class="comment">// unselectable targets skipped in all cases except targets with TARGET_SCRIPT</span></div>
<div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;            <span class="comment">// vehicle passengers are excepted from this rule</span></div>
<div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a86aa78d62024c54252d387e9e230878c">m_ignoreUnselectableTarget</a> &amp;&amp; target != <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() &amp;&amp; target-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552aa65da9d539e832160f7097da6bd6c2c2">UNIT_FLAG_UNINTERACTIBLE</a>) &amp;&amp;</div>
<div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;                (!target-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>() || (target-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>() &amp;&amp; !((<a class="code" href="classUnit.html">Unit</a>*)target-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a314642719fc92ee528c2abb228b3a105">GetTransport</a>())-&gt;IsVehicle())))</div>
<div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;        }</div>
<div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160; </div>
<div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;        <span class="comment">// Check player targets and remove if in GM mode or GM invisibility (for not self casting case)</span></div>
<div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;        {</div>
<div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target)-&gt;<a class="code" href="classUnit.html#af7c17e4866662733d1f9e488d1eb9277">GetVisibility</a>() == <a class="code" href="group__game.html#gga438f0aec316c954744ade1a737ec0a1da994d45dfc72710c872a9d657a380be69">VISIBILITY_OFF</a>)</div>
<div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160; </div>
<div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;            <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target)-&gt;<a class="code" href="classPlayer.html#a9f23cae8a3da0345a05c2a2bfedc2fe2">IsGameMaster</a>() &amp;&amp; !<a class="code" href="SpellMgr_8h.html#ab3038f54f63721701513c9ebc5c3de2e">IsPositiveEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, eff, affectiveCaster, target))</div>
<div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;        }</div>
<div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160; </div>
<div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;        <span class="keywordflow">if</span> (affectiveCaster &amp;&amp; affectiveCaster-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;        {</div>
<div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;            <span class="comment">// Do not allow these spells to target creatures not tapped by us (Banish, Polymorph, many quest spells)</span></div>
<div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801af854beb3bfcbb2fa59f784fa54c9e5b0">SPELL_ATTR_EX2_CANNOT_CAST_ON_TAPPED</a>))</div>
<div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classCreature.html">Creature</a> <span class="keyword">const</span>* targetCreature = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(target))</div>
<div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;                    <span class="keywordflow">if</span> ((!targetCreature-&gt;GetLootRecipientGuid().IsEmpty()) &amp;&amp; !targetCreature-&gt;IsTappedBy(<span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(affectiveCaster)))</div>
<div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;        }</div>
<div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;    }</div>
<div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160; </div>
<div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;    <span class="keywordflow">if</span> (!scriptTarget)</div>
<div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;    {</div>
<div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;        <span class="comment">// Check targets for LOS visibility (except spells without range limitations )</span></div>
<div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[eff])</div>
<div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;        {</div>
<div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4ef88119cf7545ebf2a3402027bf112a">SPELL_EFFECT_SUMMON_PLAYER</a>:                    <span class="comment">// from anywhere</span></div>
<div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;                <span class="comment">// fall through</span></div>
<div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abb61d351517b94c04b1b9da9369691ae">SPELL_EFFECT_RESURRECT_NEW</a>:</div>
<div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;                <span class="comment">// player far away, maybe his corpse near?</span></div>
<div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;                <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> &amp;&amp; !target-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;                {</div>
<div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;                    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a98eee6778ea2cc05bd0073affde7f37d">getCorpseTargetGuid</a>())</div>
<div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160; </div>
<div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;                    <a class="code" href="classCorpse.html">Corpse</a>* corpse = <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a42612925011d01e872fad7e915a8ba2a">GetCorpse</a>(<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a98eee6778ea2cc05bd0073affde7f37d">getCorpseTargetGuid</a>());</div>
<div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;                    <span class="keywordflow">if</span> (!corpse)</div>
<div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160; </div>
<div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;                    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() != corpse-&gt;<a class="code" href="classCorpse.html#a62cde64257532bb8db3d052c9a2c9965">GetOwnerGuid</a>())</div>
<div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160; </div>
<div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;                    <span class="keywordflow">if</span> (!corpse-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;                }</div>
<div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160; </div>
<div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;                <span class="comment">// all ok by some way or another, skip normal check</span></div>
<div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;            <span class="keywordflow">default</span>:                                            <span class="comment">// normal case</span></div>
<div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;                <span class="keywordtype">bool</span> forceLos = <span class="keyword">false</span>;</div>
<div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;                <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> &amp;&amp; target != <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;                    forceLos = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a3bb986cc8f8aae9d9fd0f0191c49d960">SPELL_ATTR_EX5_ALWAYS_AOE_LINE_OF_SIGHT</a>);</div>
<div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;                <span class="keywordflow">if</span> (exception != <a class="code" href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba4fafb5864cb471a67bb473eb292c73ba">EXCEPTION_MAGNET</a> &amp;&amp; (forceLos || !<a class="code" href="SpellMgr_8h.html#ae21aa77332ab7e86c1fef7ec58d3c866">IsIgnoreLosSpellEffect</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>, eff)))</div>
<div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;                {</div>
<div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;                    <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;                    <span class="keywordflow">switch</span> (info.<a class="code" href="structSpellTargetInfo.html#a1ce8a11382a3a4e6d3239b45c5c27205">los</a>)</div>
<div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;                    {</div>
<div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a79f2ae9bf0ff964b05145bb73becb699a3b1f9b14b486ccf9353b5c96744f749f">TARGET_LOS_DEST</a>:</div>
<div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;                            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">getDestination</a>(x, y, z);</div>
<div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;                            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classWorldObject.html#a26e87ddbab4b2f802e189ecb564e4400">IsWithinLOS</a>(x, y, z + target-&gt;<a class="code" href="classUnit.html#a30903f223f0668c6beae4a350d49a43a">GetCollisionHeight</a>(), <span class="keyword">true</span>))</div>
<div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a79f2ae9bf0ff964b05145bb73becb699ad7853c5e91e5832b4218a5618f4d919c">TARGET_LOS_SRC</a>:</div>
<div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;                            <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a31496bc8861793d11f83b216c94a81e8">getSource</a>(x, y, z);</div>
<div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;                            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classWorldObject.html#a26e87ddbab4b2f802e189ecb564e4400">IsWithinLOS</a>(x, y, z + target-&gt;<a class="code" href="classUnit.html#a30903f223f0668c6beae4a350d49a43a">GetCollisionHeight</a>(), <span class="keyword">true</span>))</div>
<div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;                                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a79f2ae9bf0ff964b05145bb73becb699acc07bf679f1941dbdcc1cddf2dfd2137">TARGET_LOS_CASTER</a>:</div>
<div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;                            <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> &amp;&amp; info.<a class="code" href="structSpellTargetInfo.html#afff6bd3bc8a1439d5f21e1d019627d54">enumerator</a> != <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a8e5483b8a18d10590d68cbeba15ce870">TARGET_ENUMERATOR_CHAIN</a>) <span class="comment">// chain is checked on FilterTargetMap</span></div>
<div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;                            {</div>
<div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[eff] == <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa6d07f243eca1c5b5700d3f458aac14ac">TARGET_LOCATION_CHANNEL_TARGET_DEST</a>)</div>
<div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;                                {</div>
<div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="classDynamicObject.html">DynamicObject</a>* dynObj = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#afb9b0972d880f4325cacf77b56af970f">GetDynObject</a>(<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> ? <a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> : <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;                                        <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(dynObj, <span class="keyword">true</span>))</div>
<div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;                                            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;                                }</div>
<div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>())</div>
<div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;                                {</div>
<div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;                                    <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(caster, <span class="keyword">true</span>))</div>
<div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;                                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;                                }</div>
<div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;                            }</div>
<div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;                            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;                    }</div>
<div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;                }</div>
<div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;        }</div>
<div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160; </div>
<div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea8bb36703be604178fb8710c4187d91bb">SPELL_ATTR_EX3_ONLY_ON_GHOSTS</a>) &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#ab0dc1a4e64a8e211c4a791c2570e4737">HasVisFlags</a>(<a class="code" href="group__game.html#ggafb81d85f97b7b585d799a9c5e0e80e05acf622ff29910872498fde6f2e51a4919">UNIT_VIS_FLAG_GHOST</a>))</div>
<div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160; </div>
<div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="SpellMgr_8h.html#a4b52705bf9b40c5afc1698bf9a165663">IsAllowingDeadTarget</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;        {</div>
<div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;                <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a> || !<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50aa96ea1ca361d7bcfd729ef6548e1c141">SPELL_ATTR_ALLOW_CAST_WHILE_DEAD</a>))</div>
<div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160; </div>
<div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;            <span class="keywordflow">if</span> (target != <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)</div>
<div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;                <span class="keywordflow">if</span> (info.<a class="code" href="structSpellTargetInfo.html#a5b9dd67836d431b8c7a569b64da5dbd8">filter</a> == <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502ad09d82da366aedd07fc12f30cdc8163a">TARGET_HELPFUL</a>)</div>
<div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;        }</div>
<div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;    }</div>
<div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160; </div>
<div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;    <span class="keywordflow">if</span> (targetType != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a> &amp;&amp; targetType != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a>)</div>
<div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;    {</div>
<div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a241a5d4ba7a1aa5228ecb67793f31400">SPELL_ATTR_EX6_CAN_TARGET_UNTARGETABLE</a>) &amp;&amp; target-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a5aa9f8e6a27782a3f628e9b44c9e6528">UNIT_FLAG_UNTARGETABLE</a>))</div>
<div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;        </div>
<div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a11629ba94e35782022fabd1f567551df">SPELL_ATTR_EX_ONLY_PEACEFUL_TARGETS</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#af5e75d013dfa8a8b888d7714992e3f2a">IsInCombat</a>())</div>
<div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;    }    </div>
<div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160; </div>
<div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34eac268ac21729dac14538c60dacbd85f49">SPELL_ATTR_EX3_NOT_ON_AOE_IMMUNE</a>) || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a50fa980199dae1942bc37774989ea212">SPELL_ATTR_EX5_TREAT_AS_AREA_EFFECT</a>)) <span class="comment">// rest done in aoe code</span></div>
<div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;        <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a5eb92537f6b7ef74746508c7c5790933">IsAOEImmune</a>())</div>
<div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160; </div>
<div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;    <span class="comment">// If spell have ingore CC attr &amp; unit is CC</span></div>
<div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0aa553bd77c64bd5136e0b578b93199622">SPELL_ATTR_EX6_DO_NOT_CHAIN_TO_CROWD_CONTROLLED_TARGETS</a>) &amp;&amp; target != <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>() &amp;&amp; target-&gt;<a class="code" href="classUnit.html#aec7a5e4c0b6c77a57a2fb20b2c96ceb6">IsCrowdControlled</a>())</div>
<div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160; </div>
<div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a5db6cd44014f24b32b2ec27d54c66d2b">SPELL_ATTR_EX5_NOT_ON_TRIVIAL</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#ae1e6fbada450b9dc47424b2a20718ea5">IsTrivialForTarget</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160; </div>
<div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;    <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea065cd304dcdf77d6d2fdef81f2a72b87">SPELL_ATTR_EX3_ONLY_ON_PLAYER</a>)</div>
<div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;        &amp;&amp; targetType != <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a>)</div>
<div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160; </div>
<div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734af314637b5b06e3f25a2bb8e87abc68d3">SPELL_ATTR_EX5_NOT_ON_PLAYER</a>) &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160; </div>
<div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a65ee564b8f7e72b199e6d6ae55ad8488">SPELL_ATTR_EX5_NOT_ON_PLAYER_CONTROLLED_NPC</a>) &amp;&amp; target-&gt;<a class="code" href="classUnit.html#a62196e93f86fd56823e665abd41864db">IsPlayerControlled</a>() &amp;&amp; target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160; </div>
<div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#abe316061c52c1e6fdcc778232efac1ac">MaxTargetLevel</a> &amp;&amp; target-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>() &gt; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#abe316061c52c1e6fdcc778232efac1ac">MaxTargetLevel</a>)</div>
<div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160; </div>
<div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">OnCheckTarget</a>(target, eff);</div>
<div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;}</div>
<div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160; </div>
<div class="line"><a name="l08447"></a><span class="lineno"><a class="line" href="classSpell.html#a3ed06c7cdee02042bd42e23a21733bdd"> 8447</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a3ed06c7cdee02042bd42e23a21733bdd">Spell::IsNeedSendToClient</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#afbeb295ad7652c0abf129066e76a4a10">m_channelOnly</a>)</div>
<div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160; </div>
<div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9aa5990186f6d643ccf2899290b1afd89f">SPELL_ATTR_EX7_ALWAYS_CAST_LOG</a>))</div>
<div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160; </div>
<div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a39b26f93bb0f756875d72cb4338333c9">SpellVisual</a>[0] || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a39b26f93bb0f756875d72cb4338333c9">SpellVisual</a>[1] || <a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>) ||</div>
<div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;           <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1cc6fd3348e4f9c66a3b786b38937577">speed</a> &gt; 0.0f || (!<a class="code" href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">m_triggeredByAuraSpell</a> &amp;&amp; !<a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a>);</div>
<div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;}</div>
<div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160; </div>
<div class="line"><a name="l08459"></a><span class="lineno"><a class="line" href="classSpell.html#ab6bdcd5cfae7ac3b6f848f04bc193573"> 8459</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#ab6bdcd5cfae7ac3b6f848f04bc193573">Spell::IsTriggeredSpellWithRedundantCastTime</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">m_IsTriggeredSpell</a> &amp;&amp; (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aa1f607116227f95f1c499af5232aef93">manaCost</a> || <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#accbc0425316d6848dbdd9f6bed9ec306">ManaCostPercentage</a>);</div>
<div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;}</div>
<div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160; </div>
<div class="line"><a name="l08464"></a><span class="lineno"><a class="line" href="classSpell.html#a8de82de2d1fc29d0874f2ad183f8f2a7"> 8464</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a8de82de2d1fc29d0874f2ad183f8f2a7">Spell::HaveTargetsForEffect</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effect)<span class="keyword"> const</span></div>
<div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; itr : <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>)</div>
<div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;        <span class="keywordflow">if</span> (itr.effectHitMask &amp; (1 &lt;&lt; effect))</div>
<div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160; </div>
<div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; itr : <a class="code" href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">m_UniqueGOTargetInfo</a>)</div>
<div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;        <span class="keywordflow">if</span> (itr.effectMask &amp; (1 &lt;&lt; effect))</div>
<div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160; </div>
<div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr : <a class="code" href="classSpell.html#a4ba53019f02abcaff8db6e21aaf4a78e">m_UniqueItemInfo</a>)</div>
<div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;        <span class="keywordflow">if</span> (itr.effectMask &amp; (1 &lt;&lt; effect))</div>
<div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160; </div>
<div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;}</div>
<div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160; </div>
<div class="line"><a name="l08481"></a><span class="lineno"><a class="line" href="classSpellEvent.html#abca64eb7d39df9788cef9df7e8634368"> 8481</a></span>&#160;<a class="code" href="classSpellEvent.html#abca64eb7d39df9788cef9df7e8634368">SpellEvent::SpellEvent</a>(<a class="code" href="classSpell.html">Spell</a>* spell) : <a class="code" href="classBasicEvent.html">BasicEvent</a>()</div>
<div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;{</div>
<div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;    <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a> = spell;</div>
<div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;}</div>
<div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160; </div>
<div class="line"><a name="l08486"></a><span class="lineno"><a class="line" href="classSpellEvent.html#a01f8ea354ef70d0a2ee7b88b8dd9f68e"> 8486</a></span>&#160;<a class="code" href="classSpellEvent.html#a01f8ea354ef70d0a2ee7b88b8dd9f68e">SpellEvent::~SpellEvent</a>()</div>
<div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;{</div>
<div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6fea183fab3cd5f8946923c3d8909f5a">getState</a>() != <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>)</div>
<div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;        <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160; </div>
<div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6032f8f164df1d6fc2607e4ca5c35ce5">IsDeletable</a>() || <a class="code" href="classWorld.html#ae1716f62b00fe8ba87a92850bf4d054c">World::IsStopped</a>())</div>
<div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;    {</div>
<div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;        <span class="keyword">delete</span> <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>;</div>
<div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;    }</div>
<div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;    {</div>
<div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;        <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;~SpellEvent: %s %u tried to delete non-deletable spell %u. Was not deleted, causes memory leak.&quot;</span>,</div>
<div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;                      (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a3bcd646cc44a9b80aa804f984c289cf3">GetCaster</a>()-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> ? <span class="stringliteral">&quot;Player&quot;</span> : <span class="stringliteral">&quot;Creature&quot;</span>), <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a3bcd646cc44a9b80aa804f984c289cf3">GetCaster</a>()-&gt;<a class="code" href="classObject.html#a4777844356842a389621c1bad1433109">GetGUIDLow</a>(), <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;    }</div>
<div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;}</div>
<div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160; </div>
<div class="line"><a name="l08502"></a><span class="lineno"><a class="line" href="classSpellEvent.html#aca4a3938f7b68ffb40cb4d9becb21537"> 8502</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpellEvent.html#aca4a3938f7b68ffb40cb4d9becb21537">SpellEvent::Execute</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> e_time, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> p_time)</div>
<div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;{</div>
<div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;    <span class="comment">// update spell if it is not finished</span></div>
<div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6fea183fab3cd5f8946923c3d8909f5a">getState</a>() != <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>)</div>
<div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;        <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#acc435ce7ca5fc0510122e720a6aea580">update</a>(p_time);</div>
<div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160; </div>
<div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;    <span class="comment">// check spell state to process</span></div>
<div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6fea183fab3cd5f8946923c3d8909f5a">getState</a>())</div>
<div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;    {</div>
<div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>:</div>
<div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;        {</div>
<div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;            <span class="comment">// spell was finished, check deletable state</span></div>
<div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6032f8f164df1d6fc2607e4ca5c35ce5">IsDeletable</a>())</div>
<div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;            {</div>
<div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;                <span class="comment">// check, if we do have unfinished triggered spells</span></div>
<div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;                                <span class="comment">// spell is deletable, finish event</span></div>
<div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;            }</div>
<div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;            <span class="comment">// event will be re-added automatically at the end of routine)</span></div>
<div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160; </div>
<div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a>:</div>
<div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;        {</div>
<div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;            <span class="comment">// this spell is in channeled state, process it on the next update</span></div>
<div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;            <span class="comment">// event will be re-added automatically at the end of routine)</span></div>
<div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160; </div>
<div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a>:</div>
<div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;        {</div>
<div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;            <span class="comment">// first, check, if we have just started</span></div>
<div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#acd106ca9dbe908ea1329c05d1fdbffc4">GetDelayStart</a>() != 0)</div>
<div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;            {</div>
<div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;                <span class="comment">// no, we aren&#39;t, do the typical update</span></div>
<div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;                <span class="comment">// check, if we have channeled spell on our hands</span></div>
<div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;                {</div>
<div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;                    <span class="comment">// evented channeled spell is processed separately, casted once after delay, and not destroyed till finish</span></div>
<div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;                    <span class="comment">// check, if we have casting anything else except this channeled spell and autorepeat</span></div>
<div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a3bcd646cc44a9b80aa804f984c289cf3">GetCaster</a>()-&gt;<a class="code" href="classUnit.html#af0cab5ed9e6a02a565198db1d3db13a8">IsNonMeleeSpellCasted</a>(<span class="keyword">false</span>, <span class="keyword">true</span>, <span class="keyword">true</span>))</div>
<div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;                    {</div>
<div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;                        <span class="comment">// another non-melee non-delayed spell is casted now, abort</span></div>
<div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;                        <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;                    }</div>
<div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;                    {</div>
<div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;                        <span class="comment">// do the action (pass spell to channeling state)</span></div>
<div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;                        <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a323570cf86a1b20a8e64a9db971cab8c">handle_immediate</a>();</div>
<div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;                    }</div>
<div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;                    <span class="comment">// event will be re-added automatically at the end of routine)</span></div>
<div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;                }</div>
<div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;                {</div>
<div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;                    <span class="comment">// run the spell handler and think about what we can do next</span></div>
<div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;                    <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> t_offset = e_time - <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#acd106ca9dbe908ea1329c05d1fdbffc4">GetDelayStart</a>();</div>
<div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;                    <a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> n_offset = <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a98e6d38fef38925272ed77fae54903b2">handle_delayed</a>(t_offset);</div>
<div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;                    <span class="keywordflow">if</span> (n_offset)</div>
<div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;                    {</div>
<div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;                        <span class="comment">// re-add us to the queue</span></div>
<div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;                        <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#abe5d2483c52b087c98e7f7b1c49606ad">GetTrueCaster</a>()-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">AddEvent</a>(<span class="keyword">this</span>, <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#acd106ca9dbe908ea1329c05d1fdbffc4">GetDelayStart</a>() + n_offset, <span class="keyword">false</span>);</div>
<div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;                       <span class="comment">// event not complete</span></div>
<div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;                    }</div>
<div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;                    <span class="comment">// event complete</span></div>
<div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;                    <span class="comment">// finish update event will be re-added automatically at the end of routine)</span></div>
<div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;                }</div>
<div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;            }</div>
<div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;            {</div>
<div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;                <span class="comment">// delaying had just started, record the moment</span></div>
<div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;                <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a9572cd3b12252c7c177b0f6151a1c57b">SetDelayStart</a>(e_time);</div>
<div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;                <span class="comment">// re-plan the event for the delay moment</span></div>
<div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;                <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#abe5d2483c52b087c98e7f7b1c49606ad">GetTrueCaster</a>()-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">AddEvent</a>(<span class="keyword">this</span>, e_time + <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#ad39149ba8f34185ed6c52c5782881250">GetDelayMoment</a>(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;                               <span class="comment">// event not complete</span></div>
<div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;            }</div>
<div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160; </div>
<div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;        {</div>
<div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;            <span class="comment">// all other states</span></div>
<div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;            <span class="comment">// event will be re-added automatically at the end of routine)</span></div>
<div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;        } <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;    }</div>
<div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160; </div>
<div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;    <span class="comment">// spell processing not complete, plan event on the next update interval</span></div>
<div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;    <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#abe5d2483c52b087c98e7f7b1c49606ad">GetTrueCaster</a>()-&gt;<a class="code" href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">m_events</a>.<a class="code" href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">AddEvent</a>(<span class="keyword">this</span>, e_time + 1, <span class="keyword">false</span>);</div>
<div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;                                           <span class="comment">// event not complete</span></div>
<div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;}</div>
<div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160; </div>
<div class="line"><a name="l08588"></a><span class="lineno"><a class="line" href="classSpellEvent.html#a80c41e5e456ff336bb10e97bf7d2d1e5"> 8588</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpellEvent.html#a80c41e5e456ff336bb10e97bf7d2d1e5">SpellEvent::Abort</a>(<a class="code" href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a> <span class="comment">/*e_time*/</span>)</div>
<div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;{</div>
<div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;    <span class="comment">// oops, the spell we try to do is aborted</span></div>
<div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6fea183fab3cd5f8946923c3d8909f5a">getState</a>() != <a class="code" href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a>)</div>
<div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;        <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">cancel</a>();</div>
<div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;}</div>
<div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160; </div>
<div class="line"><a name="l08595"></a><span class="lineno"><a class="line" href="classSpellEvent.html#a13088218be78a1d47ee1ab82adc2a4b2"> 8595</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpellEvent.html#a13088218be78a1d47ee1ab82adc2a4b2">SpellEvent::IsDeletable</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">m_Spell</a>-&gt;<a class="code" href="classSpell.html#a6032f8f164df1d6fc2607e4ca5c35ce5">IsDeletable</a>();</div>
<div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;}</div>
<div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160; </div>
<div class="line"><a name="l08600"></a><span class="lineno"><a class="line" href="classSpell.html#aea24ad8716a09b612bf4856b99c9c978"> 8600</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#aea24ad8716a09b612bf4856b99c9c978">Spell::CanOpenLock</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> lockId, <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234">SkillType</a>&amp; skillId, <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>&amp; reqSkillValue, <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a>&amp; skillValue)</div>
<div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;{</div>
<div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;    <span class="keywordflow">if</span> (!lockId)                                            <span class="comment">// possible case for GO and maybe for items.</span></div>
<div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160; </div>
<div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;    <span class="comment">// Get LockInfo</span></div>
<div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;    <a class="code" href="structLockEntry.html">LockEntry</a> <span class="keyword">const</span>* lockInfo = <a class="code" href="DBCStores_8cpp.html#a517422c4e090503dc6776f5fe0deae7c">sLockStore</a>.LookupEntry(lockId);</div>
<div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160; </div>
<div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;    <span class="keywordflow">if</span> (!lockInfo)</div>
<div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160; </div>
<div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;    <span class="keywordtype">bool</span> reqKey = <span class="keyword">false</span>;                                    <span class="comment">// some locks not have reqs</span></div>
<div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160; </div>
<div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; 8; ++j)</div>
<div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;    {</div>
<div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;        <span class="keywordflow">switch</span> (lockInfo-&gt;<a class="code" href="structLockEntry.html#a39b0b548efd795c162926bddcdd301b5">Type</a>[j])</div>
<div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;        {</div>
<div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;            <span class="comment">// check key item (many fit cases can be)</span></div>
<div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7bd0d3f34feccd7870d260f3b1d4aad4a04bac8c77c91ae5973d441d8cab5dcc7">LOCK_KEY_ITEM</a>:</div>
<div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;                <span class="keywordflow">if</span> (lockInfo-&gt;<a class="code" href="structLockEntry.html#aa58e046529aae0d1d6201c08ec8107e2">Index</a>[j] &amp;&amp; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> &amp;&amp; <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() == lockInfo-&gt;<a class="code" href="structLockEntry.html#aa58e046529aae0d1d6201c08ec8107e2">Index</a>[j])</div>
<div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;                reqKey = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;            <span class="comment">// check key skill (only single first fit case can be)</span></div>
<div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SharedDefines_8h.html#a7bd0d3f34feccd7870d260f3b1d4aad4ac6bd1369cde2ea38f6b9e4a218657f0d">LOCK_KEY_SKILL</a>:</div>
<div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;            {</div>
<div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;                reqKey = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160; </div>
<div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;                <span class="comment">// wrong locktype, skip</span></div>
<div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[effIndex]) != lockInfo-&gt;<a class="code" href="structLockEntry.html#aa58e046529aae0d1d6201c08ec8107e2">Index</a>[j])</div>
<div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160; </div>
<div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;                <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234">SkillType</a> tempSkillId = <a class="code" href="SharedDefines_8h.html#ae2da0a82ea63b2ca1010424c11aeb2c8">SkillByLockType</a>(<a class="code" href="SharedDefines_8h.html#a5893ac36dd21da7bcd19a505205ea180">LockType</a>(lockInfo-&gt;<a class="code" href="structLockEntry.html#aa58e046529aae0d1d6201c08ec8107e2">Index</a>[j]));</div>
<div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;                skillId = tempSkillId;</div>
<div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160; </div>
<div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;                <span class="keywordtype">bool</span> oldCalc = <span class="keyword">true</span>;</div>
<div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;                <span class="keywordflow">if</span> (tempSkillId == <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a984419a280ad5111b03d5d5ecdcd9a0f">SKILL_NONE</a>) <span class="comment">// these must not be carried over to the reference variable - unless more research comes up</span></div>
<div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;                {</div>
<div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;                    <a class="code" href="SpellMgr_8h.html#ac821b7d2d8a9effd8fafef038528e877">SkillLineAbilityMapBounds</a> bounds = <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSkillLineAbilityMapBoundsBySpellId(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;                    <span class="keywordflow">if</span> (bounds.first != bounds.second)</div>
<div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;                    {</div>
<div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;                        <a class="code" href="structSkillLineAbilityEntry.html">SkillLineAbilityEntry</a> <span class="keyword">const</span>* skillInfo = bounds.first-&gt;second;</div>
<div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;                        tempSkillId = <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234">SkillType</a>(skillInfo-&gt;<a class="code" href="structSkillLineAbilityEntry.html#adff1e5a7840ae7a2337e10e67a189c60">skillId</a>);</div>
<div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;                        oldCalc = <span class="keyword">false</span>;</div>
<div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;                    }</div>
<div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;                }</div>
<div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160; </div>
<div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;                <span class="keywordflow">if</span> (tempSkillId != <a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a984419a280ad5111b03d5d5ecdcd9a0f">SKILL_NONE</a>)</div>
<div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;                {</div>
<div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellSkillBonus = 0;</div>
<div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;                    <span class="keywordflow">if</span> (oldCalc) <span class="comment">// still correct but not usable for spell skill ids</span></div>
<div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;                    {</div>
<div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;                        <span class="comment">// skill bonus provided by casting spell (mostly item spells)</span></div>
<div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;                        <span class="comment">// add the damage modifier from the spell casted (cheat lock / skeleton key etc.) (use m_currentBasePoints, CalculateDamage returns wrong value)</span></div>
<div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;                        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellSkillBonus = <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>(<a class="code" href="classSpell.html#ac6c221b279935d9dfdf840f569f62954">m_currentBasePoints</a>[effIndex]);</div>
<div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;                        reqSkillValue = lockInfo-&gt;<a class="code" href="structLockEntry.html#aed5e58cf605d3c28cd0d26015722be03">Skill</a>[j];</div>
<div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160; </div>
<div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;                        <span class="comment">// castitem check: rogue using skeleton keys. the skill values should not be added in this case.</span></div>
<div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;                        skillValue = <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> || !<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() ?</div>
<div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;                            0 : <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;GetSkillValue(tempSkillId);</div>
<div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160; </div>
<div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;                        skillValue += spellSkillBonus;</div>
<div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;                    }</div>
<div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lockInfo-&gt;<a class="code" href="structLockEntry.html#aa58e046529aae0d1d6201c08ec8107e2">Index</a>[j] == <a class="code" href="SharedDefines_8h.html#a5893ac36dd21da7bcd19a505205ea180a20663fe7fe377ced1724452b0108af51">LOCKTYPE_DISARM_TRAP</a>)</div>
<div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;                    {</div>
<div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;                        reqSkillValue = INT32_MAX;</div>
<div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="classGameObject.html">GameObject</a>* go = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">getGOTarget</a>())</div>
<div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;                            reqSkillValue = go-&gt;<a class="code" href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">GetLevel</a>() * 5;</div>
<div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;                        skillValue = <a class="code" href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">CalculateSpellEffectValue</a>(effIndex, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;                    }</div>
<div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160; </div>
<div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;                    <span class="keywordflow">if</span> (skillValue &lt; reqSkillValue)</div>
<div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505">SPELL_FAILED_LOW_CASTLEVEL</a>;</div>
<div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;                }</div>
<div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160; </div>
<div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;            }</div>
<div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;        }</div>
<div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;    }</div>
<div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160; </div>
<div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;    <span class="keywordflow">if</span> (reqKey)</div>
<div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160; </div>
<div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;}</div>
<div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160; </div>
<div class="line"><a name="l08697"></a><span class="lineno"><a class="line" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8"> 8697</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">Spell::FillAreaTargets</a>(<a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; targetUnitMap, <span class="keywordtype">float</span> radius, <span class="keywordtype">float</span> cone, <a class="code" href="Spell_8h.html#a26481736169727a2aefce2cac71c5bee">SpellNotifyPushType</a> pushType, <a class="code" href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069">SpellTargets</a> spellTargets, <a class="code" href="classWorldObject.html">WorldObject</a>* originalCaster <span class="comment">/*=nullptr*/</span>)</div>
<div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;{</div>
<div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;    <a class="code" href="structMaNGOS_1_1SpellNotifierCreatureAndPlayer.html">MaNGOS::SpellNotifierCreatureAndPlayer</a> notifier(*<span class="keyword">this</span>, targetUnitMap, radius, cone, pushType, spellTargets, originalCaster);</div>
<div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;    <a class="code" href="structCell.html#a07c1300d6a1d8ee38819103043b89b8f">Cell::VisitAllObjects</a>(notifier.<a class="code" href="structMaNGOS_1_1SpellNotifierCreatureAndPlayer.html#a8c674f90c3d5c58499705ea1843873dc">GetCenterX</a>(), notifier.<a class="code" href="structMaNGOS_1_1SpellNotifierCreatureAndPlayer.html#ad0294a1224109c2aa306575e5105aece">GetCenterY</a>(), <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>(), notifier, radius);</div>
<div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;}</div>
<div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160; </div>
<div class="line"><a name="l08703"></a><span class="lineno"><a class="line" href="classSpell.html#a321d6f8758262f8e47955c53a6f55329"> 8703</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a321d6f8758262f8e47955c53a6f55329">Spell::FillRaidOrPartyTargets</a>(<a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; targetUnitMap, <a class="code" href="classUnit.html">Unit</a>* member, <a class="code" href="classUnit.html">Unit</a>* center, <span class="keywordtype">float</span> radius, <span class="keywordtype">bool</span> raid, <span class="keywordtype">bool</span> withPets, <span class="keywordtype">bool</span> withcaster)<span class="keyword"> const</span></div>
<div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;    <a class="code" href="classPlayer.html">Player</a>* pMember = member-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>();</div>
<div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;    <a class="code" href="classGroup.html">Group</a>* pGroup = pMember ? pMember-&gt;<a class="code" href="classPlayer.html#a3acf7eadb0ec1ae686858ea11ee87302">GetGroup</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160; </div>
<div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;    <span class="keywordflow">if</span> (pGroup)</div>
<div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;    {</div>
<div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;        <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> subgroup = pMember-&gt;<a class="code" href="classPlayer.html#ad2debe6316c3b6ebab131713336f3284">GetSubGroup</a>();</div>
<div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160; </div>
<div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classGroupReference.html">GroupReference</a>* itr = pGroup-&gt;<a class="code" href="classGroup.html#a39cc0707e5c157b6ff4851e133b0a9dc">GetFirstMember</a>(); itr != <span class="keyword">nullptr</span>; itr = itr-&gt;<a class="code" href="classGroupReference.html#a05b946c0952db094a696093283308cb1">next</a>())</div>
<div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;        {</div>
<div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;            <a class="code" href="classPlayer.html">Player</a>* <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a> = itr-&gt;getSource();</div>
<div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160; </div>
<div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;            <span class="comment">// CanAssist check duel and controlled by enemy</span></div>
<div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a> &amp;&amp; (raid || subgroup == <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;GetSubGroup())</div>
<div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;                    &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">CanAssistSpell</a>(<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;            {</div>
<div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;                <span class="keywordflow">if</span> ((<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a> == center || center-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>, radius)) &amp;&amp;</div>
<div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;                        (withcaster || <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a> != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;                    targetUnitMap.push_back(<a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>);</div>
<div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160; </div>
<div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;                <span class="keywordflow">if</span> (withPets)</div>
<div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = <a class="code" href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a>-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;                        <span class="keywordflow">if</span> ((pet == center || center-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(pet, radius)) &amp;&amp;</div>
<div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;                                (withcaster || pet != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;                            targetUnitMap.push_back(pet);</div>
<div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;            }</div>
<div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;        }</div>
<div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;    }</div>
<div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;    {</div>
<div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;        <a class="code" href="classUnit.html">Unit</a>* ownerOrSelf = pMember ? pMember : member-&gt;<a class="code" href="classUnit.html#a2bfc129a8ad6c9fa8ca94a0ed3c877fc">GetBeneficiary</a>();</div>
<div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;        <span class="keywordflow">if</span> ((ownerOrSelf == center || center-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(ownerOrSelf, radius)) &amp;&amp;</div>
<div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;                (withcaster || ownerOrSelf != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;            targetUnitMap.push_back(ownerOrSelf);</div>
<div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160; </div>
<div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;        <span class="keywordflow">if</span> (withPets)</div>
<div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classPet.html">Pet</a>* pet = ownerOrSelf-&gt;<a class="code" href="classUnit.html#a45bee1c004336ebfbadbde232797f559">GetPet</a>())</div>
<div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;                <span class="keywordflow">if</span> ((pet == center || center-&gt;<a class="code" href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">IsWithinDistInMap</a>(pet, radius)) &amp;&amp;</div>
<div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;                        (withcaster || pet != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>))</div>
<div class="line"><a name="l08743"></a><span class="lineno"> 8743</span>&#160;                    targetUnitMap.push_back(pet);</div>
<div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;    }</div>
<div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;}</div>
<div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160; </div>
<div class="line"><a name="l08747"></a><span class="lineno"><a class="line" href="classSpell.html#a8b9ac3ab5007aba016972ab1e2e0d12c"> 8747</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a8b9ac3ab5007aba016972ab1e2e0d12c">Spell::FillRaidOrPartyManaPriorityTargets</a>(<a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; targetUnitMap, <a class="code" href="classUnit.html">Unit</a>* member, <a class="code" href="classUnit.html">Unit</a>* center, <span class="keywordtype">float</span> radius, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count, <span class="keywordtype">bool</span> raid, <span class="keywordtype">bool</span> withPets, <span class="keywordtype">bool</span> withCaster)</div>
<div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;{</div>
<div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;    <a class="code" href="classSpell.html#a321d6f8758262f8e47955c53a6f55329">FillRaidOrPartyTargets</a>(targetUnitMap, member, center, radius, raid, withPets, withCaster);</div>
<div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;}</div>
<div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160; </div>
<div class="line"><a name="l08752"></a><span class="lineno"><a class="line" href="classSpell.html#a4cc21b731b4fa349649e5cf4f895b266"> 8752</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a4cc21b731b4fa349649e5cf4f895b266">Spell::FillRaidOrPartyHealthPriorityTargets</a>(<a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; targetUnitMap, <a class="code" href="classUnit.html">Unit</a>* member, <a class="code" href="classUnit.html">Unit</a>* center, <span class="keywordtype">float</span> radius, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> count, <span class="keywordtype">bool</span> raid, <span class="keywordtype">bool</span> withPets, <span class="keywordtype">bool</span> withCaster)</div>
<div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;{</div>
<div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;    <a class="code" href="classSpell.html#a321d6f8758262f8e47955c53a6f55329">FillRaidOrPartyTargets</a>(targetUnitMap, member, center, radius, raid, withPets, withCaster);</div>
<div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;}</div>
<div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160; </div>
<div class="line"><a name="l08757"></a><span class="lineno"><a class="line" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e"> 8757</a></span>&#160;<a class="code" href="classWorldObject.html">WorldObject</a>* <a class="code" href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">Spell::GetAffectiveCasterObject</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>)</div>
<div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160; </div>
<div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>.<a class="code" href="classObjectGuid.html#a97277f64de28fdef0e9f821fcd8a20a9">IsGameObject</a>() &amp;&amp; <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>())</div>
<div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() ? <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>.<a class="code" href="classObjectGuid.html#a919e658ac950dcb1ce6195a72f824705">IsDynamicObject</a>())</div>
<div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() ? <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a3fb76b11cc6e62eb9745a585eb497a5f">GetDynamicObject</a>(<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a15299304003f041f28de7a0fd992c735">m_originalCaster</a>;</div>
<div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;}</div>
<div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160; </div>
<div class="line"><a name="l08769"></a><span class="lineno"><a class="line" href="classSpell.html#af8de4da19951058b9debc1521bb5b954"> 8769</a></span>&#160;<a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classSpell.html#af8de4da19951058b9debc1521bb5b954">Spell::GetAffectiveCasterOrOwner</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>() ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <span class="keyword">static_cast&lt;</span><a class="code" href="classGameObject.html">GameObject</a>*<span class="keyword">&gt;</span>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>)-&gt;GetOwner();</div>
<div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;}</div>
<div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160; </div>
<div class="line"><a name="l08774"></a><span class="lineno"><a class="line" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0"> 8774</a></span>&#160;<a class="code" href="classWorldObject.html">WorldObject</a>* <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">Spell::GetCastingObject</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>())</div>
<div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>.<a class="code" href="classObjectGuid.html#a97277f64de28fdef0e9f821fcd8a20a9">IsGameObject</a>())</div>
<div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() ? <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">GetGameObject</a>(<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>.<a class="code" href="classObjectGuid.html#a919e658ac950dcb1ce6195a72f824705">IsDynamicObject</a>())</div>
<div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">IsInWorld</a>() ? <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#a3fb76b11cc6e62eb9745a585eb497a5f">GetDynamicObject</a>(<a class="code" href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">m_originalCasterGUID</a>) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160; </div>
<div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>;</div>
<div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;}</div>
<div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160; </div>
<div class="line"><a name="l08786"></a><span class="lineno"><a class="line" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94"> 8786</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">Spell::GetSpellSpeed</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classObject.html#a85475682d62e51bfaf2133b51d41a619">IsGameObject</a>()) <span class="comment">// 4 spells in all of wotlk and doesnt seem like GO casting supports travelling delay from sniffs</span></div>
<div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;        <span class="keywordflow">return</span> 0.f;</div>
<div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;        <span class="keywordflow">return</span> 0.f;</div>
<div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160; </div>
<div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ae7ef00105b47529bb50b1c669aabb283">m_overrideSpeed</a>)</div>
<div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="classSpell.html#ab3aee301de963366979fe898f74576f4">m_overridenSpeed</a>;</div>
<div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;    </div>
<div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a1cc6fd3348e4f9c66a3b786b38937577">speed</a>;</div>
<div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;}</div>
<div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160; </div>
<div class="line"><a name="l08799"></a><span class="lineno"><a class="line" href="classSpell.html#a5003eeaba08c841f12b72a3010420eec"> 8799</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a5003eeaba08c841f12b72a3010420eec">Spell::IsDelayedSpell</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">GetSpellSpeed</a>() &gt; 0.0f &amp;&amp; !<a class="code" href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>);</div>
<div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;}</div>
<div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160; </div>
<div class="line"><a name="l08804"></a><span class="lineno"><a class="line" href="classSpell.html#ac34348062658c54529e2d7f0e108e739"> 8804</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ac34348062658c54529e2d7f0e108e739">Spell::ResetEffectDamageAndHeal</a>()</div>
<div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;{</div>
<div class="line"><a name="l08806"></a><span class="lineno"> 8806</span>&#160;    <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> = 0;</div>
<div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;    <a class="code" href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">m_healing</a> = 0;</div>
<div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;}</div>
<div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160; </div>
<div class="line"><a name="l08810"></a><span class="lineno"><a class="line" href="classSpell.html#a747ae7c3474dbad2d6a676c8e0d31cf3"> 8810</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a747ae7c3474dbad2d6a676c8e0d31cf3">Spell::CanExecuteTriggersOnHit</a>(<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effMask, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* triggeredByAura, <span class="keywordtype">bool</span> auraTarget)<span class="keyword"> const</span></div>
<div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;    <span class="keywordtype">bool</span> onlyOnTarget = (triggeredByAura &amp;&amp; triggeredByAura-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035a9d9c4d96556a2f5ba8ad93e87101fbb8">SPELL_ATTR_EX4_CLASS_TRIGGER_ONLY_ON_TARGET</a>));</div>
<div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;    <span class="comment">// If triggeredByAura has SPELL_ATTR4_PROC_ONLY_ON_CASTER then it can only proc on a cast spell with TARGET_UNIT_CASTER</span></div>
<div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;        <span class="keywordflow">if</span> ((effMask &amp; (1 &lt;&lt; i)) &amp;&amp; (!onlyOnTarget || (onlyOnTarget &amp;&amp; auraTarget)))</div>
<div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160; </div>
<div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;}</div>
<div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160; </div>
<div class="line"><a name="l08821"></a><span class="lineno"><a class="line" href="classSpell.html#abe41422e439fe882c04760475e3c3072"> 8821</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#abe41422e439fe882c04760475e3c3072">Spell::ProcSpellAuraTriggers</a>()</div>
<div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;{</div>
<div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160; </div>
<div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;    <a class="code" href="classUnit.html#a2b5b1c6d16de917e5356d9f1708178b4">Unit::AuraList</a> <span class="keyword">const</span>&amp; targetTriggers = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">GetAurasByType</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6f4ce86c39fc491ab2a65efda7566c9f">SPELL_AURA_ADD_TARGET_TRIGGER</a>);</div>
<div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> targetTrigger : targetTriggers)</div>
<div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;    {</div>
<div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;        <span class="keywordflow">if</span> (!targetTrigger-&gt;isAffectedOnSpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>))</div>
<div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;        <span class="keywordflow">for</span> (TargetList::const_iterator ihit = <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.begin(); ihit != <a class="code" href="classSpell.html#a5467441e13fb75e103e32f4975528c41">m_UniqueTargetInfo</a>.end(); ++ihit)</div>
<div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160;        {</div>
<div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;            <span class="keywordflow">if</span> (ihit-&gt;missCondition == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a>)</div>
<div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160;            {</div>
<div class="line"><a name="l08835"></a><span class="lineno"> 8835</span>&#160;                <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == ihit-&gt;targetGUID ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, ihit-&gt;targetGUID);</div>
<div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;                <span class="keywordflow">if</span> (!target || !target-&gt;<a class="code" href="classUnit.html#a5ea3f54af571493f7889220724667189">IsAlive</a>())</div>
<div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;                <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* auraSpellInfo = targetTrigger-&gt;GetSpellProto();</div>
<div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a747ae7c3474dbad2d6a676c8e0d31cf3">CanExecuteTriggersOnHit</a>(ihit-&gt;effectHitMask, auraSpellInfo, targetTrigger-&gt;GetTarget()-&gt;GetObjectGuid() == ihit-&gt;targetGUID))</div>
<div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;                <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> auraSpellIdx = targetTrigger-&gt;GetEffIndex();</div>
<div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;                <span class="keyword">const</span> <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> procid = auraSpellInfo-&gt;<a class="code" href="structSpellEntry.html#a1d14e6dd0b955eb76e4bb65171368518">EffectTriggerSpell</a>[auraSpellIdx];</div>
<div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> auraBasePoints = targetTrigger-&gt;GetBasePoints();</div>
<div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;                <span class="comment">// Calculate chance at that moment (can be depend for example from combo points)</span></div>
<div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;                <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> chance = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ac6a93531977fc4f4bd5c245381883181">CalculateSpellEffectValue</a>(target, auraSpellInfo, auraSpellIdx, &amp;auraBasePoints);</div>
<div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="Util_8h.html#a50320d4edff86db31b25138ae72161ad">roll_chance_i</a>(chance))</div>
<div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;                {</div>
<div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;                    <a class="code" href="classSpell.html">Spell</a>* spell = <span class="keyword">new</span> <a class="code" href="classSpell.html#aebdf5cc0847865b97bf8f4b06a5921f6">Spell</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(procid), <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;                    <a class="code" href="classSpellCastTargets.html">SpellCastTargets</a> targets;</div>
<div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;                    targets.<a class="code" href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">setUnitTarget</a>(target);</div>
<div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;                    spell-&gt;<a class="code" href="classSpell.html#a9561e3f1de1cc6181818781b26fc1335">SetOverridenSpeed</a>(<a class="code" href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">GetSpellSpeed</a>());</div>
<div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;                    spell-&gt;<a class="code" href="classSpell.html#a2391bf1bfb54f70998c4374d59eb308c">SpellStart</a>(&amp;targets, targetTrigger);</div>
<div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;                }</div>
<div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;            }</div>
<div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;        }</div>
<div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;    }</div>
<div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;}</div>
<div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160; </div>
<div class="line"><a name="l08859"></a><span class="lineno"><a class="line" href="classSpell.html#a30ad9ebc3e466447c7a4a5c3343476df"> 8859</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a30ad9ebc3e466447c7a4a5c3343476df">Spell::SelectMountByAreaAndSkill</a>(<a class="code" href="classUnit.html">Unit</a>* target, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* parentSpell, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId75, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId150, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId225, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellId300, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellIdSpecial)</div>
<div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;{</div>
<div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;    <span class="keywordflow">if</span> (!target || !target-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>())</div>
<div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160; </div>
<div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;    <span class="comment">// Prevent stacking of mounts</span></div>
<div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;    target-&gt;<a class="code" href="classUnit.html#a71eb7e701f65d94e214db3eccf3b5b5e">RemoveSpellsCausingAura</a>(<a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a8cec8a45f78b8555b8f13b8b00995acf">SPELL_AURA_MOUNTED</a>);</div>
<div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;    <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a> skillval = ((<a class="code" href="classPlayer.html">Player</a>*)target)-&gt;GetSkillValue(<a class="code" href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a91ab54f2f2d5f62473324790d2678324">SKILL_RIDING</a>);</div>
<div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;    <span class="keywordflow">if</span> (!skillval)</div>
<div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160; </div>
<div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;    <span class="keywordflow">if</span> (skillval &gt;= 225 &amp;&amp; (spellId300 &gt; 0 || spellId225 &gt; 0))</div>
<div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;    {</div>
<div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> spellid = skillval &gt;= 300 ? spellId300 : spellId225;</div>
<div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;        <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* pSpell = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(spellid);</div>
<div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;        <span class="keywordflow">if</span> (!pSpell)</div>
<div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;        {</div>
<div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;SelectMountByAreaAndSkill: unknown spell id %i by caster: %s&quot;</span>, spellid, target-&gt;<a class="code" href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">GetGuidStr</a>().c_str());</div>
<div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;        }</div>
<div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160; </div>
<div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;        <span class="comment">// zone check</span></div>
<div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;        <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> zone, area;</div>
<div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;        target-&gt;<a class="code" href="classWorldObject.html#ae1a8efe701e885f0ed1eaeb93bbece8e">GetZoneAndAreaId</a>(zone, area);</div>
<div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160; </div>
<div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;        <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> locRes = <a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetSpellAllowedInLocationError(pSpell, target-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>(), zone, area, target-&gt;<a class="code" href="classUnit.html#aa480553e15719930865a6fab27c24302">GetBeneficiaryPlayer</a>());</div>
<div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;        <span class="keywordflow">if</span> (locRes != <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a> || !((<a class="code" href="classPlayer.html">Player</a>*)target)-&gt;CanStartFlyInArea(target-&gt;<a class="code" href="classWorldObject.html#a485ded18163bda1b789be2283781780e">GetMapId</a>(), zone, area, pSpell-&gt;<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a9bc68a96c5126296e4cdc116685168e1">SPELL_ATTR_EX7_IGNORES_COLD_WEATHER_FLYING_REQUIREMENT</a>)))</div>
<div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;            target-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, spellId150, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), parentSpell);</div>
<div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spellIdSpecial &gt; 0)</div>
<div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;        {</div>
<div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;            <span class="keywordflow">for</span> (PlayerSpellMap::const_iterator iter = ((<a class="code" href="classPlayer.html">Player</a>*)target)-&gt;GetSpellMap().begin(); iter != ((<a class="code" href="classPlayer.html">Player</a>*)target)-&gt;GetSpellMap().end(); ++iter)</div>
<div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;            {</div>
<div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;                <span class="keywordflow">if</span> (iter-&gt;second.state != <a class="code" href="Player_8h.html#aeba4f8d5fc0fa3fd00538df69077ba55a1a8411f74fdb6a5715ed8cfca6b96a50">PLAYERSPELL_REMOVED</a>)</div>
<div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;                {</div>
<div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;                    <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>* spellInfo = <a class="code" href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellEntry.html">SpellEntry</a>&gt;(iter-&gt;first);</div>
<div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;                    {</div>
<div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;                        <span class="keywordflow">if</span> (spellInfo-&gt;<a class="code" href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">EffectApplyAuraName</a>[i] == <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aba4cc8813262b13c7f9f10d41f2ca6a9">SPELL_AURA_MOD_FLIGHT_SPEED_MOUNTED</a>)</div>
<div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;                        {</div>
<div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;                            <a class="code" href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a> mountSpeed = spellInfo-&gt;<a class="code" href="structSpellEntry.html#a6f908af779d48f0107cc905c5e97d457">CalculateSimpleValue</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a>(i));</div>
<div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160; </div>
<div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;                            <span class="comment">// speed higher than 280 replace it</span></div>
<div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;                            <span class="keywordflow">if</span> (mountSpeed &gt; 280)</div>
<div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;                            {</div>
<div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;                                target-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, spellIdSpecial, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20">TRIGGERED_NONE</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), parentSpell);</div>
<div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;                                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;                            }</div>
<div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;                        }</div>
<div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;                    }</div>
<div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;                }</div>
<div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;            }</div>
<div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;            target-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, pSpell, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20">TRIGGERED_NONE</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), parentSpell);</div>
<div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;        }</div>
<div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;            target-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, pSpell, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20">TRIGGERED_NONE</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), parentSpell);</div>
<div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;    }</div>
<div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (skillval &gt;= 150 &amp;&amp; spellId150 &gt; 0)</div>
<div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;        target-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, spellId150, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20">TRIGGERED_NONE</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), parentSpell);</div>
<div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (spellId75 &gt; 0)</div>
<div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;        target-&gt;<a class="code" href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">CastSpell</a>(target, spellId75, <a class="code" href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20">TRIGGERED_NONE</a>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, <a class="code" href="classObjectGuid.html">ObjectGuid</a>(), parentSpell);</div>
<div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;}</div>
<div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160; </div>
<div class="line"><a name="l08921"></a><span class="lineno"><a class="line" href="classSpell.html#aa85563fe5bc694dfe0ac0a9ce6053ce6"> 8921</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#aa85563fe5bc694dfe0ac0a9ce6053ce6">Spell::IsInterruptible</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a5dc75f632a583e7d59c9fd780d939246">InterruptFlags</a> &amp; <a class="code" href="SpellDefines_8h.html#abadf2f982fd866917c372d16ab99c109a652afef72a005336c4715d69b39a9821">SPELL_INTERRUPT_FLAG_COMBAT</a>) &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ac2d17132ffcbb75f8748f9c04930526d">PreventionType</a> == <a class="code" href="SharedDefines_8h.html#a3194644c6ed7acd85ec8eb1b98821b8ea03702a6fae99a6fc1b0ebf339a86865e">SPELL_PREVENTION_TYPE_SILENCE</a> &amp;&amp; <a class="code" href="classSpell.html#af9fe4eb228aed83f869a8416dd2cb65f">CanBeInterrupted</a>();</div>
<div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;}</div>
<div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160; </div>
<div class="line"><a name="l08926"></a><span class="lineno"><a class="line" href="classSpell.html#a3fa9f05760646da14b7d71ad748d0447"> 8926</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a3fa9f05760646da14b7d71ad748d0447">Spell::RegisterAuraProc</a>(<a class="code" href="classAura.html">Aura</a>* aura)</div>
<div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;{</div>
<div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;    <a class="code" href="classSpell.html#a7da231eced52ed2408fd513a0668d5bc">m_procOnceHolder</a>.insert(aura);</div>
<div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;}</div>
<div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160; </div>
<div class="line"><a name="l08931"></a><span class="lineno"><a class="line" href="classSpell.html#aa26b218c5d3d4b1e5ff494b2806641f2"> 8931</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#aa26b218c5d3d4b1e5ff494b2806641f2">Spell::IsAuraProcced</a>(<a class="code" href="classAura.html">Aura</a>* aura)</div>
<div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;{</div>
<div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classSpell.html#a7da231eced52ed2408fd513a0668d5bc">m_procOnceHolder</a>.find(aura) != <a class="code" href="classSpell.html#a7da231eced52ed2408fd513a0668d5bc">m_procOnceHolder</a>.end();</div>
<div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;}</div>
<div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160; </div>
<div class="line"><a name="l08936"></a><span class="lineno"><a class="line" href="classSpell.html#ad93507f6abc44a9a3334f3e9a5cc8825"> 8936</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ad93507f6abc44a9a3334f3e9a5cc8825">Spell::ClearCastItem</a>()</div>
<div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;{</div>
<div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> == <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;        <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a5ddeb0e96775789e553286c9cc879c27">setItemTarget</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160; </div>
<div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160;    <a class="code" href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">m_CastItem</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;}</div>
<div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160; </div>
<div class="line"><a name="l08944"></a><span class="lineno"><a class="line" href="classSpell.html#ad98b19601a903f26b44cd7e30e347d27"> 8944</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ad98b19601a903f26b44cd7e30e347d27">Spell::GetSpellRangeAndRadius</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex, <span class="keywordtype">float</span>&amp; radius, <span class="keywordtype">bool</span> targetB, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a>&amp; EffectChainTarget)</div>
<div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;{</div>
<div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[effIndex])</div>
<div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;        radius = <a class="code" href="SpellMgr_8h.html#ab4b1d536a5b410eaf601a13235196d3a">GetSpellRadius</a>(<a class="code" href="DBCStores_8cpp.html#a495e62fceccd344a25ba720c9e1966d9">sSpellRadiusStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[effIndex]));</div>
<div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;        radius = <a class="code" href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a>(<a class="code" href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a>.LookupEntry(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">rangeIndex</a>));</div>
<div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160; </div>
<div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> targetMode;</div>
<div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;    <span class="keywordflow">if</span> (!targetB)</div>
<div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;        targetMode = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">EffectImplicitTargetA</a>[effIndex];</div>
<div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;        targetMode = <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">EffectImplicitTargetB</a>[effIndex];</div>
<div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;    <a class="code" href="structSpellTargetInfo.html">SpellTargetInfo</a>&amp; data = <a class="code" href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a>[targetMode];</div>
<div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;    <span class="keywordflow">if</span> (radius == 50000.f) <span class="comment">// safety against bad data</span></div>
<div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;    {</div>
<div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;        <span class="keywordflow">if</span> (data.<a class="code" href="structSpellTargetInfo.html#a5b9dd67836d431b8c7a569b64da5dbd8">filter</a> != <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a76152bae5512ab0aeaf68f34c550d33a">TARGET_SCRIPT</a>)</div>
<div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;        {</div>
<div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;            <span class="keywordflow">switch</span> (data.<a class="code" href="structSpellTargetInfo.html#a68c229e7f0563a90091445d626addca4">type</a>)</div>
<div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;            {</div>
<div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8fb995e48c74119f7f7f849a08a66a17">TARGET_TYPE_LOCATION_DEST</a>:</div>
<div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa26d8044284eb711be1d91940d12f2c4a">TARGET_TYPE_LOCATION_TRAJ</a>:</div>
<div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;                    <span class="keywordflow">if</span> (data.<a class="code" href="structSpellTargetInfo.html#a5b9dd67836d431b8c7a569b64da5dbd8">filter</a> == <a class="code" href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a76152bae5512ab0aeaf68f34c550d33a">TARGET_SCRIPT</a>) <span class="comment">// TODO: Fix this whole shebang</span></div>
<div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;                        radius = 100.f;</div>
<div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;                    <span class="keywordflow">else</span></div>
<div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;                        radius = 3.0f;</div>
<div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a>:</div>
<div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaff677b466a96dba01f1d816dfef5c33e">TARGET_TYPE_GAMEOBJECT</a>:</div>
<div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;                    <span class="keywordflow">if</span> (data.<a class="code" href="structSpellTargetInfo.html#afff6bd3bc8a1439d5f21e1d019627d54">enumerator</a> == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a8e5483b8a18d10590d68cbeba15ce870">TARGET_ENUMERATOR_CHAIN</a> || data.<a class="code" href="structSpellTargetInfo.html#afff6bd3bc8a1439d5f21e1d019627d54">enumerator</a> == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a6c7f6ab7a64e6d33d3a06ddb6b84e6a4">TARGET_ENUMERATOR_AOE</a> || data.<a class="code" href="structSpellTargetInfo.html#afff6bd3bc8a1439d5f21e1d019627d54">enumerator</a> == <a class="code" href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a578da5f5ffca03e698701e59307875fd">TARGET_ENUMERATOR_CONE</a>)</div>
<div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;                        radius = 200.f;</div>
<div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;                <span class="keywordflow">default</span>: <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;            }</div>
<div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;        }</div>
<div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;    }</div>
<div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (radius == 0.f &amp;&amp; data.<a class="code" href="structSpellTargetInfo.html#a68c229e7f0563a90091445d626addca4">type</a> == <a class="code" href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8fb995e48c74119f7f7f849a08a66a17">TARGET_TYPE_LOCATION_DEST</a>)</div>
<div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;    {</div>
<div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;        <span class="keywordflow">switch</span> (targetMode) <span class="comment">// TODO: move this to SQL</span></div>
<div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;        {</div>
<div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8143b77ebd5c7094f838b3706e28e7a5">TARGET_LOCATION_CASTER_FRONT_RIGHT</a>:</div>
<div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac87a16d4727bd15a2a30716d2a33efc1">TARGET_LOCATION_CASTER_BACK_RIGHT</a>:</div>
<div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3e384548d63f5185979b9b85fac98260">TARGET_LOCATION_CASTER_BACK_LEFT</a>:</div>
<div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3927316559e8203c94784bc6312b8f1e">TARGET_LOCATION_CASTER_FRONT_LEFT</a>:</div>
<div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae926e00811e9e5e3dd31c0145306d783">TARGET_LOCATION_CASTER_FRONT</a>:</div>
<div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faafa68d7e3edd5e9a880f11c638d90ac2">TARGET_LOCATION_CASTER_BACK</a>:</div>
<div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae46169d7118e2f9a826dbde4ff6e656f">TARGET_LOCATION_CASTER_LEFT</a>:</div>
<div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9489af0c1d71883a98d467b641a15701">TARGET_LOCATION_CASTER_RIGHT</a>:</div>
<div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;                <span class="keywordflow">if</span> (radius == 0.f &amp;&amp; <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">EffectRadiusIndex</a>[effIndex] != 36) <span class="comment">// All shaman totems have 0 radius - need to override with proper value</span></div>
<div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;                    radius = 2.f;</div>
<div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;        }</div>
<div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;    }</div>
<div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160; </div>
<div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* realCaster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>())</div>
<div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;    {</div>
<div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPlayer.html">Player</a>* modOwner = realCaster-&gt;<a class="code" href="classPlayer.html#add3944b50311b59aded74efda7fea752">GetSpellModOwner</a>())</div>
<div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;        {</div>
<div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;            modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351aee2e5c475de0fac5532e93699abcd681">SPELLMOD_RADIUS</a>, radius);</div>
<div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;            <span class="keywordflow">if</span> (!targetB)</div>
<div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;                modOwner-&gt;ApplySpellMod(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>, <a class="code" href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351ac8da41f19ec3dc98d57d14b6ae22ab7f">SPELLMOD_JUMP_TARGETS</a>, EffectChainTarget);</div>
<div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;        }</div>
<div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;    }</div>
<div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160; </div>
<div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;    <span class="comment">// AOE leeway - 2f when caster is moving</span></div>
<div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;    <span class="keywordflow">if</span> (radius != 50000.f &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac6b72d2692bc7b4f8cbfccea9d40e520">IsMoving</a>() &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af5f118a391194216cdd0ab4dcd2f48c3">IsWalking</a>())</div>
<div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;        radius += <a class="code" href="ObjectDefines_8h.html#af436926bcfdf652a551bcf7ca39604c0">AOE_LEEWAY</a>;</div>
<div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160; </div>
<div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a>)</div>
<div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;    {</div>
<div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a>:</div>
<div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 20424)                   <span class="comment">// Seal of Command (2 more target for single targeted spell)</span></div>
<div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;            {</div>
<div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;                <span class="comment">// overwrite EffectChainTarget for non single target spell</span></div>
<div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html">Spell</a>* currSpell = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a6a942f7bfc8e8ea98ab52a0172970a35">GetCurrentSpell</a>(<a class="code" href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fa9cbac6c5133585dece51a40e9c1908b0">CURRENT_GENERIC_SPELL</a>))</div>
<div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;                    <span class="keywordflow">if</span> (currSpell-&gt;m_spellInfo-&gt;MaxAffectedTargets &gt; 0 ||</div>
<div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;                            currSpell-&gt;m_spellInfo-&gt;EffectChainTarget[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>] &gt; 0 ||</div>
<div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;                            currSpell-&gt;m_spellInfo-&gt;EffectChainTarget[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db">EFFECT_INDEX_1</a>] &gt; 0 ||</div>
<div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;                            currSpell-&gt;m_spellInfo-&gt;EffectChainTarget[<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a1c69b2509a4774a2c523cacb45edc840">EFFECT_INDEX_2</a>] &gt; 0)</div>
<div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;                        EffectChainTarget = 0;              <span class="comment">// no chain targets</span></div>
<div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;            }</div>
<div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;    }</div>
<div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160; </div>
<div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;    <span class="comment">// custom radius cases</span></div>
<div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellFamilyName</a>)</div>
<div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;    {</div>
<div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0ebbb6206eb92cdc484b416eb6f41743">SPELLFAMILY_GENERIC</a>:</div>
<div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;        {</div>
<div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;            {</div>
<div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;                <span class="keywordflow">case</span> 28241:                                 <span class="comment">// Poison (Naxxramas, Grobbulus Cloud)</span></div>
<div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;                <span class="keywordflow">case</span> 54363:                                 <span class="comment">// Poison (Naxxramas, Grobbulus Cloud) (H)</span></div>
<div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;                {</div>
<div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> auraId = (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a> == 28241 ? 28158 : 54362);</div>
<div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpellAuraHolder.html">SpellAuraHolder</a>* auraHolder = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac7ae0a42b6a31508ab24e2d1cf0bb983">GetSpellAuraHolder</a>(auraId))</div>
<div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;                        radius = 0.5f * (60000 - auraHolder-&gt;GetAuraDuration()) * 0.001f;</div>
<div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;                }</div>
<div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;                <span class="keywordflow">case</span> 36374:                                 <span class="comment">// Summon Smoke Beacon</span></div>
<div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;                {</div>
<div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;                    <span class="keywordflow">if</span> (effIndex == <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a>)</div>
<div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;                        radius = <a class="code" href="ObjectDefines_8h.html#ad4d2791434b33b0698c9af2e1ffd81a5">INTERACTION_DISTANCE</a>;</div>
<div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;                }</div>
<div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;                <span class="keywordflow">case</span> 30915:                                 <span class="comment">// Poison - Broggok</span></div>
<div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;                <span class="keywordflow">case</span> 38463:</div>
<div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;                {</div>
<div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpellAuraHolder.html">SpellAuraHolder</a>* auraHolder = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac7ae0a42b6a31508ab24e2d1cf0bb983">GetSpellAuraHolder</a>(<a class="code" href="classSpell.html#a45908b2e73c10613e29719e547d527b6">GetTriggeredByAuraSpellInfo</a>()-&gt;Id))</div>
<div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;                        radius = (60000 - auraHolder-&gt;GetAuraDuration()) * 0.0002f;</div>
<div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;                }</div>
<div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;                <span class="keywordflow">case</span> 54643:                                 <span class="comment">// Teleport (Strand of the Ancients)</span></div>
<div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;                <span class="keywordflow">case</span> 66550:                                 <span class="comment">// Teleport (Isle of Conquest)</span></div>
<div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;                <span class="keywordflow">case</span> 66630:                                 <span class="comment">// Alliance Gunship Portal (Isle of Conquest)</span></div>
<div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;                <span class="keywordflow">case</span> 66637:                                 <span class="comment">// Horde Gunship Portal (Isle of Conquest)</span></div>
<div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;                <span class="keywordflow">case</span> 66899:                                 <span class="comment">// Gunship Portal Click (Isle of Conquest)</span></div>
<div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;                    radius = <a class="code" href="ObjectDefines_8h.html#aa75f883ff0201abc3089c69d3685e6c2">DEFAULT_VISIBILITY_BGARENAS</a>;</div>
<div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;                <span class="keywordflow">case</span> 66881:                                 <span class="comment">// Slime Pool (ToCrusader, Acidmaw &amp; Dreadscale)</span></div>
<div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;                <span class="keywordflow">case</span> 67638:                                 <span class="comment">// Slime Pool (ToCrusader, Acidmaw &amp; Dreadscale) (Mode 1)</span></div>
<div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;                <span class="keywordflow">case</span> 67639:                                 <span class="comment">// Slime Pool (ToCrusader, Acidmaw &amp; Dreadscale) (Mode 2)</span></div>
<div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;                <span class="keywordflow">case</span> 67640:                                 <span class="comment">// Slime Pool (ToCrusader, Acidmaw &amp; Dreadscale) (Mode 3)</span></div>
<div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classSpellAuraHolder.html">SpellAuraHolder</a>* auraHolder = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#ac7ae0a42b6a31508ab24e2d1cf0bb983">GetSpellAuraHolder</a>(66882))</div>
<div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;                        radius = 0.5f * (60000 - auraHolder-&gt;GetAuraDuration()) * 0.001f;</div>
<div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;                <span class="keywordflow">case</span> 56438:                                 <span class="comment">// Arcane Overload</span></div>
<div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* realCaster = <a class="code" href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">GetAffectiveCaster</a>())</div>
<div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;                        radius = radius * realCaster-&gt;GetObjectScale();</div>
<div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;                <span class="keywordflow">case</span> 42442:                                 <span class="comment">// Vengeance Landing Cannonfire</span></div>
<div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;                    radius = <a class="code" href="ObjectDefines_8h.html#a31a0b2a8fa9e11ad72229baf2b8759b8">MAX_VISIBILITY_DISTANCE</a>;</div>
<div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;                <span class="keywordflow">case</span> 50790:                                 <span class="comment">// Summon Iron Dwarf (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;                <span class="keywordflow">case</span> 50791:                                 <span class="comment">// Summon Iron Dwarf (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;                <span class="keywordflow">case</span> 50793:                                 <span class="comment">// Summon Iron Trogg (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;                <span class="keywordflow">case</span> 50794:                                 <span class="comment">// Summon Iron Trogg (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;                <span class="keywordflow">case</span> 50802:                                 <span class="comment">// Summon Malformed Ooze (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;                <span class="keywordflow">case</span> 50803:                                 <span class="comment">// Summon Malformed Ooze (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;                <span class="keywordflow">case</span> 50825:                                 <span class="comment">// Summon Earthen  Dwarf (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;                <span class="keywordflow">case</span> 50826:                                 <span class="comment">// Summon Earthen  Dwarf (Halls of Stone, Sjonnir) - only target A</span></div>
<div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;                <span class="keywordflow">case</span> 56429:                                 <span class="comment">// Summon Arcane Bomb (Eye of Eternity, Malygos) - only target A</span></div>
<div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;                    <span class="keywordflow">if</span> (targetB)</div>
<div class="line"><a name="l09086"></a><span class="lineno"> 9086</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160;                <span class="keywordflow">case</span> 69057:                                 <span class="comment">// Bone Spike Graveyard (Icecrown Citadel, Lord Marrowgar encounter, 10N)</span></div>
<div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;                <span class="keywordflow">case</span> 70826:                                 <span class="comment">// Bone Spike Graveyard (Icecrown Citadel, Lord Marrowgar encounter, 25N)</span></div>
<div class="line"><a name="l09089"></a><span class="lineno"> 9089</span>&#160;                <span class="keywordflow">case</span> 72088:                                 <span class="comment">// Bone Spike Graveyard (Icecrown Citadel, Lord Marrowgar encounter, 10H)</span></div>
<div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;                <span class="keywordflow">case</span> 72089:                                 <span class="comment">// Bone Spike Graveyard (Icecrown Citadel, Lord Marrowgar encounter, 25H)</span></div>
<div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160;                <span class="keywordflow">case</span> 73142:                                 <span class="comment">// Bone Spike Graveyard (during Bone Storm) (Icecrown Citadel, Lord Marrowgar encounter, 10N)</span></div>
<div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;                <span class="keywordflow">case</span> 73143:                                 <span class="comment">// Bone Spike Graveyard (during Bone Storm) (Icecrown Citadel, Lord Marrowgar encounter, 25N)</span></div>
<div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;                <span class="keywordflow">case</span> 73144:                                 <span class="comment">// Bone Spike Graveyard (during Bone Storm) (Icecrown Citadel, Lord Marrowgar encounter, 10H)</span></div>
<div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;                <span class="keywordflow">case</span> 73145:                                 <span class="comment">// Bone Spike Graveyard (during Bone Storm) (Icecrown Citadel, Lord Marrowgar encounter, 25H)</span></div>
<div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;                <span class="keywordflow">case</span> 72350:                                 <span class="comment">// Fury of Frostmourne</span></div>
<div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;                <span class="keywordflow">case</span> 72351:                                 <span class="comment">// Fury of Frostmourne</span></div>
<div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;                <span class="keywordflow">case</span> 72706:                                 <span class="comment">// Achievement Check</span></div>
<div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;                <span class="keywordflow">case</span> 72830:                                 <span class="comment">// Achievement Check</span></div>
<div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;                    radius = <a class="code" href="ObjectDefines_8h.html#ae3422c6c7104690fcfcf1158c4c8abef">DEFAULT_VISIBILITY_INSTANCE</a>;</div>
<div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;                <span class="keywordflow">case</span> 43486:                                 <span class="comment">// Summon Amani&#39;shi Warriors</span></div>
<div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160;                <span class="keywordflow">case</span> 43487:                                 <span class="comment">// Summon Amani Eagle</span></div>
<div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;                <span class="keywordflow">case</span> 43962:                                 <span class="comment">// Summon Amani&#39;shi Hatcher</span></div>
<div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;                <span class="keywordflow">case</span> 45340:</div>
<div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;                {</div>
<div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;                    <span class="keywordflow">if</span> (!targetB)</div>
<div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;                        radius = 250.f;</div>
<div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;                }</div>
<div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;                <span class="keywordflow">case</span> 59464:                                 <span class="comment">// Hurl Boulder</span></div>
<div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;                    radius = 100.f;</div>
<div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160;                <span class="keywordflow">case</span> 49554:                                 <span class="comment">// Summon Injured Soldier</span></div>
<div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160;                    radius = 100.f;</div>
<div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;            }</div>
<div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;        }</div>
<div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a>:</div>
<div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;        {</div>
<div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;            {</div>
<div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;                <span class="keywordflow">case</span> 49376:                                 <span class="comment">// Feral Charge - Cat</span></div>
<div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;                    <span class="comment">// No default radius for this spell, so we need to use the contact distance</span></div>
<div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;                    radius = <a class="code" href="ObjectDefines_8h.html#a771706b817fb3c23d5f2945264ea6d07">CONTACT_DISTANCE</a>;</div>
<div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;            }</div>
<div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;        }</div>
<div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;    }</div>
<div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160; </div>
<div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;    <a class="code" href="classSpell.html#a4f8c2ec4d79161f96c94196e2628e15b">OnRadiusCalculate</a>(effIndex, targetB, radius);</div>
<div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;}</div>
<div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160; </div>
<div class="line"><a name="l09138"></a><span class="lineno"><a class="line" href="classSpell.html#a704340f3b83f142c160ec6bd60773386"> 9138</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="classSpell.html#a704340f3b83f142c160ec6bd60773386">Spell::GetCone</a>()</div>
<div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;{</div>
<div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellCone.html">SpellCone</a> <span class="keyword">const</span>* coneData = <a class="code" href="SQLStorages_8cpp.html#aa0e50246fb55cfde84721af130ade66a">sSpellCones</a>.<a class="code" href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">LookupEntry</a>&lt;<a class="code" href="structSpellCone.html">SpellCone</a>&gt;(<a class="code" href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a>.GetFirstSpellInChain(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)))</div>
<div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;        <span class="keywordflow">return</span> G3D::toRadians(coneData-&gt;coneAngle);</div>
<div class="line"><a name="l09142"></a><span class="lineno"> 9142</span>&#160; </div>
<div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a> / 3.f; <span class="comment">// 60 degrees is default</span></div>
<div class="line"><a name="l09144"></a><span class="lineno"> 9144</span>&#160;}</div>
<div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160; </div>
<div class="line"><a name="l09146"></a><span class="lineno"><a class="line" href="classSpell.html#a1f5dac6a66009db412f1a37b7e7b6c7e"> 9146</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a1f5dac6a66009db412f1a37b7e7b6c7e">Spell::ProcReflectProcs</a>(<a class="code" href="structSpell_1_1TargetInfo.html">TargetInfo</a>&amp; targetInfo)</div>
<div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;{</div>
<div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)</div>
<div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160; </div>
<div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;    <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">GetObjectGuid</a>() == targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a> ? <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> : <a class="code" href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a>(*<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>, targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">targetGUID</a>);</div>
<div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;    <span class="keywordflow">if</span> (!target)</div>
<div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160; </div>
<div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;    <span class="comment">// Victim reflects, apply reflect procs</span></div>
<div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;    <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, target, <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>, <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6dee6718a32d2b2ada5d7c55bdc45546">PROC_FLAG_TAKE_HARMFUL_SPELL</a>, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceac0f0575131b658e1143778206283552a">PROC_EX_REFLECT</a>, 1, <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>));</div>
<div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;    <span class="keywordflow">if</span> (targetInfo.<a class="code" href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">reflectResult</a> == <a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a>)</div>
<div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;        <span class="comment">// Apply reflect procs on self</span></div>
<div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;        <a class="code" href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a>(<a class="code" href="structProcSystemArguments.html">ProcSystemArguments</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>, <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a>, <a class="code" href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6dee6718a32d2b2ada5d7c55bdc45546">PROC_FLAG_TAKE_HARMFUL_SPELL</a>, <a class="code" href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceac0f0575131b658e1143778206283552a">PROC_EX_REFLECT</a>, 1, <a class="code" href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>));</div>
<div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;}</div>
<div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160; </div>
<div class="line"><a name="l09162"></a><span class="lineno"><a class="line" href="classSpell.html#a6f5ff9846deb35f126543a513a1eb0d7"> 9162</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a6f5ff9846deb35f126543a513a1eb0d7">Spell::FilterTargetMap</a>(<a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a>&amp; filterUnitList, <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985">SpellTargetFilterScheme</a> scheme, <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> chainTargetCount)</div>
<div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;{</div>
<div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;    <span class="keywordflow">switch</span> (scheme)</div>
<div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;    {</div>
<div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a9f57d792380f0419583e3f26fe869361">SCHEME_RANDOM</a>:</div>
<div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;        {</div>
<div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a> &amp;&amp; filterUnitList.size() &gt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;            {</div>
<div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;                <span class="comment">// remove random units from the map</span></div>
<div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;                <span class="keywordflow">while</span> (filterUnitList.size() &gt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;                {</div>
<div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> poz = <a class="code" href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a>(0, filterUnitList.size() - 1);</div>
<div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;                    <span class="keyword">auto</span> itr = filterUnitList.begin();</div>
<div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;                    std::advance(itr, poz);</div>
<div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;                    itr = filterUnitList.erase(itr);</div>
<div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;                }</div>
<div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;            }</div>
<div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;        }</div>
<div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a19012b13b855a490e0b76cc2bfecead7">SCHEME_CLOSEST</a>:</div>
<div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;        {</div>
<div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a> &amp;&amp; filterUnitList.size() &gt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;            {</div>
<div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;                filterUnitList.sort(<a class="code" href="structTargetDistanceOrderNear.html">TargetDistanceOrderNear</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>));</div>
<div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;                filterUnitList.resize(<a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>);</div>
<div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;            }</div>
<div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;        }</div>
<div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a9a11c7682370a4122d01d089099df83e">SCHEME_FURTHEST</a>:</div>
<div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;        {</div>
<div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a> &amp;&amp; filterUnitList.size() &gt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;            {</div>
<div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;                filterUnitList.sort(<a class="code" href="structTargetDistanceOrderFarAway.html">TargetDistanceOrderFarAway</a>(<a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>));</div>
<div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;                filterUnitList.resize(<a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>);</div>
<div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;            }</div>
<div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;        }</div>
<div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a3eea6d8d009c826e1d14f3aa2ccc78ee">SCHEME_HIGHEST_HP</a>:</div>
<div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;        {</div>
<div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;            <span class="comment">// Returns the target with the highest HP in melee range</span></div>
<div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* hatedTarget = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> maxHP = 0;</div>
<div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; unit : filterUnitList)</div>
<div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;            {</div>
<div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abc3ccbe4e8693ed5df548cbde2d94851">CanReachWithMeleeAttack</a>(unit))</div>
<div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;                {</div>
<div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;                    <span class="keywordflow">if</span> (unit-&gt;GetHealth() &gt; maxHP)</div>
<div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;                    {</div>
<div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;                        maxHP = unit-&gt;<a class="code" href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">GetHealth</a>();</div>
<div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;                        hatedTarget = unit;</div>
<div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;                    }</div>
<div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;                }</div>
<div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;            }</div>
<div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;            <span class="keywordflow">if</span> (!hatedTarget)</div>
<div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160; </div>
<div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;            filterUnitList.clear();</div>
<div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;            filterUnitList.push_back(hatedTarget);</div>
<div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;        }</div>
<div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985afc576d5edda33c47cd495826c7c112af">SCHEME_RANDOM_CHAIN</a>:</div>
<div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;        {</div>
<div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;            <span class="keywordflow">if</span> (filterUnitList.empty() || filterUnitList.front() != <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>)</div>
<div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;            <span class="keywordflow">if</span> (chainTargetCount &gt; 1 &amp;&amp; filterUnitList.size() &gt; chainTargetCount)</div>
<div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;            {</div>
<div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;                <span class="comment">// remove random units from the map</span></div>
<div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;                <span class="keywordflow">while</span> (filterUnitList.size() &gt; chainTargetCount)</div>
<div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;                {</div>
<div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;                    <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> poz = <a class="code" href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a>(1, filterUnitList.size() - 1);</div>
<div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;                    <span class="keyword">auto</span> itr = filterUnitList.begin();</div>
<div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;                    std::advance(itr, poz);</div>
<div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;                    itr = filterUnitList.erase(itr);</div>
<div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;                }</div>
<div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;            }</div>
<div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;        }</div>
<div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985ae410d4c74ef7f7fc0e271b99acc718f1">SCHEME_CLOSEST_CHAIN</a>:</div>
<div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;        {</div>
<div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;            <span class="keywordflow">if</span> (filterUnitList.empty() || filterUnitList.front() != <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>)</div>
<div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;            <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> newList;</div>
<div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;            newList.push_back(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;            filterUnitList.pop_front();</div>
<div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;            filterUnitList.sort(<a class="code" href="structTargetDistanceOrderNear.html">TargetDistanceOrderNear</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>));</div>
<div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* prev = <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>;</div>
<div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;            UnitList::iterator next = filterUnitList.begin();</div>
<div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;            chainTargetCount -= 1; <span class="comment">// unit target is one</span></div>
<div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160; </div>
<div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;            <span class="keywordflow">while</span> (chainTargetCount &amp;&amp; next != filterUnitList.end())</div>
<div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;            {</div>
<div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;                <span class="keywordflow">if</span> (prev-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(*next, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>) &gt; <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a> * <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a>)</div>
<div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160; </div>
<div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;                <span class="keywordflow">if</span> (!prev-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(*next, <span class="keyword">true</span>))</div>
<div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;                {</div>
<div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;                    ++next;</div>
<div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;                }</div>
<div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;                prev = *next;</div>
<div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;                newList.push_back(prev);</div>
<div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;                filterUnitList.erase(next);</div>
<div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;                filterUnitList.sort(<a class="code" href="structTargetDistanceOrderNear.html">TargetDistanceOrderNear</a>(prev));</div>
<div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;                next = filterUnitList.begin();</div>
<div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160; </div>
<div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;                --chainTargetCount;</div>
<div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;            }</div>
<div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;            std::swap(filterUnitList, newList);</div>
<div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;        }</div>
<div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a587b1efe366e181d34e1f2d8c9bd16aa">SCHEME_LOWEST_HP_CHAIN</a>:</div>
<div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;        {</div>
<div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a> = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;            <span class="keywordflow">if</span> (filterUnitList.empty() || filterUnitList.front() != <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>)</div>
<div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;            <a class="code" href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a> newList;</div>
<div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;            newList.push_back(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;            <span class="keywordtype">bool</span> isInGroup = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#afc35f58684e81ba4956b79fc1434eb7b">IsInGroup</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>);</div>
<div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160;            filterUnitList.pop_front();</div>
<div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;            filterUnitList.sort(<a class="code" href="structLowestHPNearestOrder.html">LowestHPNearestOrder</a>(<a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>));</div>
<div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* prev = <a class="code" href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">unitTarget</a>;</div>
<div class="line"><a name="l09285"></a><span class="lineno"> 9285</span>&#160;            UnitList::iterator next = filterUnitList.begin();</div>
<div class="line"><a name="l09286"></a><span class="lineno"> 9286</span>&#160;            chainTargetCount -= 1; <span class="comment">// unit target is one</span></div>
<div class="line"><a name="l09287"></a><span class="lineno"> 9287</span>&#160; </div>
<div class="line"><a name="l09288"></a><span class="lineno"> 9288</span>&#160;            <span class="keywordflow">while</span> (chainTargetCount &amp;&amp; next != filterUnitList.end())</div>
<div class="line"><a name="l09289"></a><span class="lineno"> 9289</span>&#160;            {</div>
<div class="line"><a name="l09290"></a><span class="lineno"> 9290</span>&#160;                <span class="comment">// since we do not iterate through closest but through HP, we must check all units</span></div>
<div class="line"><a name="l09291"></a><span class="lineno"> 9291</span>&#160;                <span class="keywordflow">if</span> (prev-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(*next, <span class="keyword">true</span>, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>) &gt; <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a> * <a class="code" href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">m_jumpRadius</a>)</div>
<div class="line"><a name="l09292"></a><span class="lineno"> 9292</span>&#160;                {</div>
<div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;                    ++next;</div>
<div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;                }</div>
<div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160; </div>
<div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;                <span class="keywordflow">if</span> (!prev-&gt;<a class="code" href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">IsWithinLOSInMap</a>(*next, <span class="keyword">true</span>))</div>
<div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;                {</div>
<div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;                    ++next;</div>
<div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;                }</div>
<div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160; </div>
<div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;                <span class="keywordflow">if</span> (isInGroup &amp;&amp; !<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#afc35f58684e81ba4956b79fc1434eb7b">IsInGroup</a>(*next))</div>
<div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;                {</div>
<div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;                    ++next;</div>
<div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;                }</div>
<div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160; </div>
<div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;                prev = *next;</div>
<div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;                newList.push_back(prev);</div>
<div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;                filterUnitList.erase(next);</div>
<div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;                filterUnitList.sort(<a class="code" href="structLowestHPNearestOrder.html">LowestHPNearestOrder</a>(prev));</div>
<div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;                next = filterUnitList.begin();</div>
<div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160; </div>
<div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;                --chainTargetCount;</div>
<div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;            }</div>
<div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;            std::swap(filterUnitList, newList);</div>
<div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;        }</div>
<div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985ab3174c83a195b132a24d708c649fc3d6">SCHEME_PRIORITIZE_HEALTH</a>:</div>
<div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;        {</div>
<div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;            <a class="code" href="Spell_8cpp.html#a383f3a05d4be51b435ee3729ecef2945">PrioritizeHealthUnitQueue</a> healthQueue;</div>
<div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classUnit.html">Unit</a>* unit : filterUnitList)</div>
<div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;                <span class="keywordflow">if</span> (!unit-&gt;IsDead())</div>
<div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;                    healthQueue.push(<a class="code" href="classPrioritizeHealthUnitWraper.html">PrioritizeHealthUnitWraper</a>(unit));</div>
<div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160; </div>
<div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;            filterUnitList.clear();</div>
<div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;            <span class="keywordflow">while</span> (!healthQueue.empty() &amp;&amp; filterUnitList.size() &lt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;            {</div>
<div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;                filterUnitList.push_back(healthQueue.top().getUnit());</div>
<div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;                healthQueue.pop();</div>
<div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;            }</div>
<div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;        }</div>
<div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a52f8be0444a1f44f2ad742317ee4c10f">SCHEME_PRIORITIZE_MANA</a>:</div>
<div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;        {</div>
<div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;            <a class="code" href="Spell_8cpp.html#a75fe3a63b7f03e4148a49154481cd53d">PrioritizeManaUnitQueue</a> manaUsers;</div>
<div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="classUnit.html">Unit</a>* unit : filterUnitList)</div>
<div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;                <span class="keywordflow">if</span> (unit-&gt;GetPowerType() == <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a> &amp;&amp; !unit-&gt;IsDead())</div>
<div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;                    manaUsers.push(<a class="code" href="classPrioritizeManaUnitWraper.html">PrioritizeManaUnitWraper</a>(unit));</div>
<div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160; </div>
<div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;            filterUnitList.clear();</div>
<div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;            <span class="keywordflow">while</span> (!manaUsers.empty() &amp;&amp; filterUnitList.size() &lt; <a class="code" href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">m_affectedTargetCount</a>)</div>
<div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;            {</div>
<div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;                filterUnitList.push_back(manaUsers.top().getUnit());</div>
<div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;                manaUsers.pop();</div>
<div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;            }</div>
<div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;        }</div>
<div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;    }</div>
<div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160;}</div>
<div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160; </div>
<div class="line"><a name="l09353"></a><span class="lineno"><a class="line" href="classSpell.html#a65a4dec4a0f7978e9d70e204c81336aa"> 9353</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a65a4dec4a0f7978e9d70e204c81336aa">Spell::FillFromTargetFlags</a>(<a class="code" href="structSpell_1_1TempTargetingData.html">TempTargetingData</a>&amp; targetingData, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIdx)</div>
<div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;{</div>
<div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6ff2692c36a92d32bc4fc2d1eec84cec">TARGET_FLAG_UNIT_ALLY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa3325fba850592588fce959a992007a87">TARGET_FLAG_UNIT_ENEMY</a>))</div>
<div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;    {</div>
<div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;            targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[effIdx].<a class="code" href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">tmpUnitList</a>[<span class="keyword">false</span>].push_back(unit);</div>
<div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;    }</div>
<div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b">TARGET_FLAG_CORPSE_ENEMY</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11">TARGET_FLAG_CORPSE_ALLY</a>))</div>
<div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;    {</div>
<div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classUnit.html">Unit</a>* unit = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;            targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[effIdx].<a class="code" href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">tmpUnitList</a>[<span class="keyword">false</span>].push_back(unit);</div>
<div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a98eee6778ea2cc05bd0073affde7f37d">getCorpseTargetGuid</a>())</div>
<div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;        {</div>
<div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classCorpse.html">Corpse</a>* corpse = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a62e4f91dc75aad55879fc4ea1346abaa">getCorpseTarget</a>())</div>
<div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;                targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[effIdx].<a class="code" href="structSpell_1_1TempTargetData.html#ad710b44d1df09b198f609d9557212b99">tempCorpseList</a>.push_back(corpse);</div>
<div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;        }</div>
<div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;    }</div>
<div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a> &amp; (<a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49">TARGET_FLAG_ITEM</a> | <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a>))</div>
<div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;    {</div>
<div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classItem.html">Item</a>* item = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">getItemTarget</a>())</div>
<div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160;            targetingData.<a class="code" href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">data</a>[effIdx].<a class="code" href="structSpell_1_1TempTargetData.html#a97f400e188a5ec71230e0240da3452ef">tempItemList</a>.push_back(item);</div>
<div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;    }</div>
<div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">Targets</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>)</div>
<div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;    {</div>
<div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">m_targetMask</a> &amp; <a class="code" href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a>) == 0)</div>
<div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;        {</div>
<div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;            <a class="code" href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a>.outError(<span class="stringliteral">&quot;No destination for spell with flag TARGET_FLAG_DEST_LOCATION, spell ID: %u&quot;</span>, <a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>); <span class="comment">// should never occur</span></div>
<div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classWorldObject.html">WorldObject</a>* caster = <a class="code" href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">GetCastingObject</a>())</div>
<div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;                <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">setDestination</a>(caster-&gt;GetPositionX(), caster-&gt;GetPositionY(), caster-&gt;GetPositionZ());</div>
<div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;        }</div>
<div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;    }</div>
<div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;}</div>
<div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160; </div>
<div class="line"><a name="l09386"></a><span class="lineno"><a class="line" href="classSpell.html#a77286525a5c1dd28a09c9fc5f903f554"> 9386</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a77286525a5c1dd28a09c9fc5f903f554">Spell::IsEffectWithImplementedMultiplier</a>(<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> effectId)<span class="keyword"> const</span></div>
<div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;    <span class="comment">// TODO: extend this for all effects that do damage and healing</span></div>
<div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;    <span class="keywordflow">switch</span> (effectId)</div>
<div class="line"><a name="l09390"></a><span class="lineno"> 9390</span>&#160;    {</div>
<div class="line"><a name="l09391"></a><span class="lineno"> 9391</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abd12cbfc6a8daf7ca788d06a77256e01">SPELL_EFFECT_SCHOOL_DAMAGE</a>:</div>
<div class="line"><a name="l09392"></a><span class="lineno"> 9392</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4882157067be8542f9192927816acda1">SPELL_EFFECT_HEAL</a>:</div>
<div class="line"><a name="l09393"></a><span class="lineno"> 9393</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a0a43a6be2a57b573021530d45a1e367e">SPELL_EFFECT_POWER_BURN</a>:</div>
<div class="line"><a name="l09394"></a><span class="lineno"> 9394</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a8e8f8712c494e5f9bffca881c9398304">SPELL_EFFECT_HEAL_MECHANICAL</a>:</div>
<div class="line"><a name="l09395"></a><span class="lineno"> 9395</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ae0cab2a09ad0acd69cdc260048bf31b5">SPELL_EFFECT_HEAL_PCT</a>:</div>
<div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;        <span class="comment">// weapon based</span></div>
<div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa2beb2e0d1440f64ea1661312ed02628">SPELL_EFFECT_WEAPON_DAMAGE_NOSCHOOL</a>:</div>
<div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a905e6b16c4a6a4f7e538f0b6b97190d5">SPELL_EFFECT_WEAPON_PERCENT_DAMAGE</a>:</div>
<div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a44d3da0109cb50c42bad53e2790715e4">SPELL_EFFECT_WEAPON_DAMAGE</a>:</div>
<div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4a3d78eee24d6e6d28fbaa67213be92d">SPELL_EFFECT_NORMALIZED_WEAPON_DMG</a>:</div>
<div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;    }</div>
<div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;}</div>
<div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160; </div>
<div class="line"><a name="l09407"></a><span class="lineno"><a class="line" href="classSpell.html#a155729c79b2273c8aa062c13e8dd4e08"> 9407</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a155729c79b2273c8aa062c13e8dd4e08">Spell::StopCast</a>(<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> castResult)</div>
<div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;{</div>
<div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;    <a class="code" href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">SendCastResult</a>(castResult);</div>
<div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;    <a class="code" href="classSpell.html#a0170aeace8c572eb70d4436c8b93fe4c">SendInterrupted</a>(castResult);</div>
<div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160;    <a class="code" href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">finish</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l09412"></a><span class="lineno"> 9412</span>&#160;    <a class="code" href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">m_trueCaster</a>-&gt;<a class="code" href="classWorldObject.html#a30575160f50527439663406d3fa3991e">DecreaseCastCounter</a>();</div>
<div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;    <a class="code" href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">SetExecutedCurrently</a>(<span class="keyword">false</span>);</div>
<div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;}</div>
<div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160; </div>
<div class="line"><a name="l09416"></a><span class="lineno"><a class="line" href="classSpell.html#a9561e3f1de1cc6181818781b26fc1335"> 9416</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a9561e3f1de1cc6181818781b26fc1335">Spell::SetOverridenSpeed</a>(<span class="keywordtype">float</span> newSpeed)</div>
<div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;{</div>
<div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160;    <a class="code" href="classSpell.html#ae7ef00105b47529bb50b1c669aabb283">m_overrideSpeed</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;    <a class="code" href="classSpell.html#ab3aee301de963366979fe898f74576f4">m_overridenSpeed</a> = newSpeed;</div>
<div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;}</div>
<div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160; </div>
<div class="line"><a name="l09422"></a><span class="lineno"><a class="line" href="classSpell.html#ae031e444535b6a6ad619b430fb4fdc7f"> 9422</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae031e444535b6a6ad619b430fb4fdc7f">Spell::OnInit</a>()</div>
<div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;{</div>
<div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;        script-&gt;OnInit(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;}</div>
<div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160; </div>
<div class="line"><a name="l09428"></a><span class="lineno"><a class="line" href="classSpell.html#a3ae62069047a5c7606f932e95d144562"> 9428</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a3ae62069047a5c7606f932e95d144562">Spell::OnSuccessfulStart</a>()</div>
<div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;{</div>
<div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;        script-&gt;OnSuccessfulStart(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;}</div>
<div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160; </div>
<div class="line"><a name="l09434"></a><span class="lineno"><a class="line" href="classSpell.html#af93fc378bb91e3d416c59835b3760d3d"> 9434</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#af93fc378bb91e3d416c59835b3760d3d">Spell::OnSuccessfulFinish</a>()</div>
<div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;{</div>
<div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;    {</div>
<div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;        <span class="keywordflow">case</span> 32053: <span class="comment">// Soul Charge - drop either stack or charge</span></div>
<div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;        <span class="keywordflow">case</span> 32054:</div>
<div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;        <span class="keywordflow">case</span> 32057:</div>
<div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;        {</div>
<div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> parentSpell;</div>
<div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;            <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;            {</div>
<div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;                <span class="keywordflow">case</span> 32053: parentSpell = 32052; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;                <span class="keywordflow">case</span> 32054: parentSpell = 32045; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;                <span class="keywordflow">case</span> 32057: parentSpell = 32051; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;            }</div>
<div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a81ad6a307a801355b33808d2f1e1ceee">RemoveAuraStack</a>(parentSpell);</div>
<div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;        }</div>
<div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;        <span class="keywordflow">case</span> 40870: <span class="comment">// Fatal Attraction - Mother Shahraz</span></div>
<div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;        {</div>
<div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#aea2657881d1a997c81f1cffefd1b2abd">m_scriptValue</a> == 0) <span class="comment">// noone was hit</span></div>
<div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;                <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a1a38bdc4f3c0a9b9cfa22f51365e37a4">RemoveAurasDueToSpell</a>(41001);</div>
<div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;        }</div>
<div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;                script-&gt;OnSuccessfulFinish(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;    }</div>
<div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;}</div>
<div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160; </div>
<div class="line"><a name="l09465"></a><span class="lineno"><a class="line" href="classSpell.html#ab1e0f40468f5a385b5d6bf22afb55459"> 9465</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#ab1e0f40468f5a385b5d6bf22afb55459">Spell::OnCheckCast</a>(<span class="keywordtype">bool</span> strict)</div>
<div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;{</div>
<div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;    {</div>
<div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;        <span class="keywordflow">case</span> 47871: <span class="comment">// Health Stone</span></div>
<div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;        <span class="keywordflow">case</span> 47878:</div>
<div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;        <span class="keywordflow">case</span> 27230:</div>
<div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;        <span class="keywordflow">case</span> 11730:</div>
<div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;        <span class="keywordflow">case</span> 11729:</div>
<div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;        <span class="keywordflow">case</span> 6202:</div>
<div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;        <span class="keywordflow">case</span> 6201:</div>
<div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160;        <span class="keywordflow">case</span> 5699:</div>
<div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;        {</div>
<div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;            <span class="comment">// check if we already have a healthstone</span></div>
<div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;            <a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> itemType = <a class="code" href="classSpell.html#aed032ab41978b3a3e9e61fc630186a93">GetUsableHealthStoneItemType</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>);</div>
<div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;            <span class="keywordflow">if</span> (itemType &amp;&amp; <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">IsPlayer</a>() &amp;&amp; ((<a class="code" href="classPlayer.html">Player</a>*)<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>)-&gt;GetItemCount(itemType) &gt; 0)</div>
<div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;            {</div>
<div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;                <a class="code" href="structItemPrototype.html">ItemPrototype</a> <span class="keyword">const</span>* proto = <a class="code" href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a>.GetItemPrototype(itemType);</div>
<div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;                <span class="keywordflow">if</span> (proto &amp;&amp; proto-&gt;<a class="code" href="structItemPrototype.html#a8fe5d2c25f9cf0dc186c1ce8533410db">ItemLimitCategory</a>)</div>
<div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;                    <a class="code" href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">m_param1</a> = proto-&gt;<a class="code" href="structItemPrototype.html#a8fe5d2c25f9cf0dc186c1ce8533410db">ItemLimitCategory</a>;</div>
<div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac434f4f7f84bea20939be3067eb33c5f">SPELL_FAILED_TOO_MANY_OF_ITEM</a>;</div>
<div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;            }</div>
<div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160;        }</div>
<div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;        <span class="keywordflow">case</span> 7914: <span class="comment">// Capture Spirit</span></div>
<div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160;        {</div>
<div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classObjectGuid.html">ObjectGuid</a> target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>()) <span class="comment">// can be cast only on these targets</span></div>
<div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;                <span class="keywordflow">if</span> (target.GetEntry() != 4663 &amp;&amp; target.GetEntry() != 4664 &amp;&amp; target.GetEntry() != 4665 &amp;&amp; target.GetEntry() != 4666 &amp;&amp; target.GetEntry() != 4667</div>
<div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;                    &amp;&amp; target.GetEntry() != 4668 &amp;&amp; target.GetEntry() != 4705 &amp;&amp; target.GetEntry() != 13019)</div>
<div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;        }</div>
<div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;        <span class="keywordflow">case</span> 12699: <span class="comment">// Summon Screecher Spirit</span></div>
<div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;        {</div>
<div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;            <span class="keywordflow">if</span> (!target || !target-&gt;<a class="code" href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">IsCreature</a>() || <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(target)-&gt;<a class="code" href="classCreature.html#a1b5958a0bdca7d2c4079acbb1c2ce873">HasBeenHitBySpell</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>))</div>
<div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;            <span class="keywordflow">if</span> (!strict)</div>
<div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;            {</div>
<div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;                <span class="keyword">static_cast&lt;</span><a class="code" href="classCreature.html">Creature</a>*<span class="keyword">&gt;</span>(target)-&gt;RegisterHitBySpell(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>);</div>
<div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;            }</div>
<div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160;        }</div>
<div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;        <span class="keywordflow">case</span> 30077: <span class="comment">// Carinda&#39;s Retribution</span></div>
<div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classObjectGuid.html">ObjectGuid</a> target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>())</div>
<div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;                <span class="keywordflow">if</span> (target.GetEntry() != 17226)</div>
<div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160;        <span class="keywordflow">case</span> 31958: <span class="comment">// Fire Bomb Halaa - Must be Taxi Flying</span></div>
<div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a598220bd7032e604abfdb838b9d60f66">IsTaxiFlying</a>())</div>
<div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae48a6bed6e0e1b5748062142c97d1669">SPELL_FAILED_ONLY_MOUNTED</a>;</div>
<div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;        <span class="keywordflow">case</span> 35244: <span class="comment">// Choking Vines - should not go through on target with Choking Wound</span></div>
<div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;        {</div>
<div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;            <span class="keywordflow">if</span> (!target || target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(35247))</div>
<div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;        }</div>
<div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;        <span class="keywordflow">case</span> 36867: <span class="comment">// Creature - Summon Event Ethereal</span></div>
<div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#aa2cb60c143addea3312e37ad92ebdbbb">SpawnedCountForEntry</a>(21445) &gt;= 1 || <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">GetMap</a>()-&gt;<a class="code" href="classMap.html#aa2cb60c143addea3312e37ad92ebdbbb">SpawnedCountForEntry</a>(22285) &gt;= 1)</div>
<div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a>;</div>
<div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;        <span class="keywordflow">case</span> 37390: <span class="comment">// Oscillating Frequency Scanner</span></div>
<div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(37407))</div>
<div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2afb5e4b72a353abe6677d7d9ee8eeec">SPELL_FAILED_NOT_HERE</a>;</div>
<div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;        <span class="keywordflow">case</span> 38170: <span class="comment">// Spin Nether-weather Vane</span></div>
<div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(37968))</div>
<div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac5b4c7f6ad3c18c893d7183117bcbbda">SPELL_FAILED_FIZZLE</a>;</div>
<div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;        <span class="keywordflow">case</span> 40157: <span class="comment">// Spirit Lance - Teron Gorefiend - can only be used on spirits</span></div>
<div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classObjectGuid.html">ObjectGuid</a> target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>())</div>
<div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;                <span class="keywordflow">if</span> (target.GetEntry() != 23111)</div>
<div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;        <span class="keywordflow">case</span> 40742: <span class="comment">// Booterang -  Must have aura Defiant And Enraged or Lazy and Good for Nothing</span></div>
<div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;        {</div>
<div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;            <a class="code" href="classUnit.html">Unit</a>* target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>();</div>
<div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;            <span class="keywordflow">if</span> (!target || (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(40732) &amp;&amp; !target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(40735)))</div>
<div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;        }</div>
<div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;        <span class="keywordflow">case</span> 40856: <span class="comment">// Wrangling rope - should only be usable on aether rays</span></div>
<div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classObjectGuid.html">ObjectGuid</a> target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>())</div>
<div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;                <span class="keywordflow">if</span> (target.GetEntry() != 22181)</div>
<div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;        <span class="keywordflow">case</span> 43732: <span class="comment">// Remove Amani Curse - should only be usable on Forest Frog</span></div>
<div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classObjectGuid.html">ObjectGuid</a> target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>())</div>
<div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;                <span class="keywordflow">if</span> (target.GetEntry() != 24396)</div>
<div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160;        <span class="keywordflow">case</span> 42489:</div>
<div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classObjectGuid.html">ObjectGuid</a> target = <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">getUnitTargetGuid</a>())</div>
<div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;                <span class="keywordflow">if</span> (target.GetEntry() != 4393 &amp;&amp; target.GetEntry() != 4394)</div>
<div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a>;</div>
<div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;                <span class="keywordflow">return</span> script-&gt;OnCheckCast(<span class="keyword">this</span>, strict);</div>
<div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;    }</div>
<div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160; </div>
<div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;}</div>
<div class="line"><a name="l09572"></a><span class="lineno"> 9572</span>&#160; </div>
<div class="line"><a name="l09573"></a><span class="lineno"><a class="line" href="classSpell.html#a6c3094450c157ad61c00375270392d5c"> 9573</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a6c3094450c157ad61c00375270392d5c">Spell::OnEffectExecute</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex)</div>
<div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160;{</div>
<div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;        script-&gt;OnEffectExecute(<span class="keyword">this</span>, effIndex);</div>
<div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;}</div>
<div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160; </div>
<div class="line"><a name="l09579"></a><span class="lineno"><a class="line" href="classSpell.html#a4f8c2ec4d79161f96c94196e2628e15b"> 9579</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a4f8c2ec4d79161f96c94196e2628e15b">Spell::OnRadiusCalculate</a>(<a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> effIndex, <span class="keywordtype">bool</span> targetB, <span class="keywordtype">float</span>&amp; radius)</div>
<div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;{</div>
<div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;        script-&gt;OnRadiusCalculate(<span class="keyword">this</span>, effIndex, targetB, radius);</div>
<div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;}</div>
<div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160; </div>
<div class="line"><a name="l09585"></a><span class="lineno"><a class="line" href="classSpell.html#ae81fe2336f8471249bbb9b2ed273702d"> 9585</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae81fe2336f8471249bbb9b2ed273702d">Spell::OnDestTarget</a>() <span class="comment">// TODO</span></div>
<div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;{</div>
<div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;        script-&gt;OnDestTarget(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;}</div>
<div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160; </div>
<div class="line"><a name="l09591"></a><span class="lineno"><a class="line" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34"> 9591</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">Spell::OnCheckTarget</a>(<a class="code" href="classGameObject.html">GameObject</a>* target, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> eff)<span class="keyword"> const</span></div>
<div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160;    {</div>
<div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;        <span class="keywordflow">case</span> 38054: <span class="comment">// Random rocket missile</span></div>
<div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classGameObject.html#aca53c235c050cbf14158a9071647b9c5">GetLootState</a>() == <a class="code" href="GameObject_8h.html#a08733f20cea1f77cc9f1a549f8ce9f07a3e50ac5f6829b981fdff39a85a48959e">GO_ACTIVATED</a>) <span class="comment">// can only hit unused ones</span></div>
<div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;                <span class="keywordflow">return</span> script-&gt;OnCheckTarget(<span class="keyword">this</span>, target, eff);</div>
<div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;    }</div>
<div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;}</div>
<div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160; </div>
<div class="line"><a name="l09607"></a><span class="lineno"><a class="line" href="classSpell.html#a436d795f19f47d8ab3fb571d17fc284f"> 9607</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">Spell::OnCheckTarget</a>(<a class="code" href="classUnit.html">Unit</a>* target, <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a> eff)<span class="keyword"> const</span></div>
<div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)</div>
<div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;    {</div>
<div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;        <span class="keywordflow">case</span> 5246:                                          <span class="comment">// Intimidating Shout</span></div>
<div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;            <span class="keywordflow">if</span> (eff != <a class="code" href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a> &amp;&amp; target == <a class="code" href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">m_targets</a>.<a class="code" href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">getUnitTarget</a>())</div>
<div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;        <span class="keywordflow">case</span> 9082:                                          <span class="comment">// Create Containment Coffer</span></div>
<div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(9032))</div>
<div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;        <span class="keywordflow">case</span> 14297: <span class="comment">// Shadow Storm (exclude targets below 25 yards and above 40 yards. Max value is handled by spell effect radius)</span></div>
<div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;        <span class="keywordflow">case</span> 26546:</div>
<div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;        <span class="keywordflow">case</span> 26555:</div>
<div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;        {</div>
<div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;            <span class="keywordtype">float</span> x, y, z;</div>
<div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160;            <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">GetPosition</a>(x, y, z);</div>
<div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(x, y, z, <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771a54404857d1ada8dc6fb419b57c69014c">DIST_CALC_COMBAT_REACH</a>) &lt; 25.f)</div>
<div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;        }</div>
<div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;        <span class="keywordflow">case</span> 16807:                                         <span class="comment">// Mass Teleport</span></div>
<div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">HasFlag</a>(<a class="code" href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a>, <a class="code" href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a>)) <span class="comment">// spell targets only creatures</span></div>
<div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;            <span class="comment">// Exceptions for Nefarian class calls</span></div>
<div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;            <span class="comment">// as it is not possible to filter out targets based on their class from data in spells template (like spell family masks for example)</span></div>
<div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;        <span class="keywordflow">case</span> 23397:                                         <span class="comment">// Berserk</span></div>
<div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa679de5e410197d42cea53f371aba7f59">CLASS_WARRIOR</a>)</div>
<div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;        <span class="keywordflow">case</span> 23398:                                         <span class="comment">// Involuntary Transformation</span></div>
<div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa312316ea844ad336fad9eb5a00348636">CLASS_DRUID</a>)</div>
<div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;        <span class="keywordflow">case</span> 23401:                                         <span class="comment">// Corrupted Healing</span></div>
<div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa59ec961e807113e366431dfb1b0d5fcc">CLASS_PRIEST</a>)</div>
<div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;        <span class="keywordflow">case</span> 23410:                                         <span class="comment">// Wild Magic</span></div>
<div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa753aca2f522c3d903449c3f79244a63f">CLASS_MAGE</a>)</div>
<div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;        <span class="keywordflow">case</span> 23414:                                         <span class="comment">// Paralyze</span></div>
<div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfac6e894dcb39c03655545f42f6c39d454">CLASS_ROGUE</a>)</div>
<div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09654"></a><span class="lineno"> 9654</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;        <span class="keywordflow">case</span> 23418:                                         <span class="comment">// Siphon Blessing</span></div>
<div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfaaaf23b801cec5bfa54bd93650af67128">CLASS_PALADIN</a>)</div>
<div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160;        <span class="keywordflow">case</span> 23425:                                         <span class="comment">// Corrupted Totems</span></div>
<div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa3e5a6df9e9af2516746e51a4a03062a1">CLASS_SHAMAN</a>)</div>
<div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;        <span class="keywordflow">case</span> 23427:                                         <span class="comment">// Summon Infernals</span></div>
<div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa72922255ea5f13ce70f2c5cec3e33369">CLASS_WARLOCK</a>)</div>
<div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;        <span class="keywordflow">case</span> 23436:                                         <span class="comment">// Corrupted Weapon</span></div>
<div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a58a507ebe628930b8a506144b364d84b">getClass</a>() != <a class="code" href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa1c7c740a229946b31a477913e2e38fd8">CLASS_HUNTER</a>)</div>
<div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;        <span class="keywordflow">case</span> 25676:                                         <span class="comment">// Drain Mana</span></div>
<div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;        <span class="keywordflow">case</span> 25754:</div>
<div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160;        <span class="keywordflow">case</span> 26457:</div>
<div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;        <span class="keywordflow">case</span> 26559:</div>
<div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a4ae648f71881fd67bcdd861ec4ef2363">GetPowerType</a>() != <a class="code" href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a>)</div>
<div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160;        <span class="keywordflow">case</span> 28062:                                         <span class="comment">// Positive Charge</span></div>
<div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(29660))                    <span class="comment">// Only deal damage if target has Negative Charge</span></div>
<div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;        <span class="keywordflow">case</span> 28085:                                         <span class="comment">// Negative Charge</span></div>
<div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(29659))                    <span class="comment">// Only deal damage if target has Positive Charge</span></div>
<div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160;        <span class="keywordflow">case</span> 29511:</div>
<div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> &amp;&amp; target == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">GetVictim</a>())</div>
<div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;        <span class="keywordflow">case</span> 30835:                                         <span class="comment">// Infernal Relay - Malchezaar - must only hit unused infernals</span></div>
<div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160;        {</div>
<div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;            <a class="code" href="classCreature.html">Creature</a>* creature = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;            <a class="code" href="classMaNGOS_1_1NearestCreatureEntryWithLiveStateInObjectRangeCheck.html">MaNGOS::NearestCreatureEntryWithLiveStateInObjectRangeCheck</a> creature_check(*target, 17646, <span class="keyword">true</span>, <span class="keyword">false</span>, 2.0f, <span class="keyword">true</span>);</div>
<div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;            <a class="code" href="structMaNGOS_1_1CreatureLastSearcher.html">MaNGOS::CreatureLastSearcher&lt;MaNGOS::NearestCreatureEntryWithLiveStateInObjectRangeCheck&gt;</a> searcher(creature, creature_check);</div>
<div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;            <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(target, searcher, 2.0f);</div>
<div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;            <span class="keywordflow">if</span> (creature)</div>
<div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;                <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>() == creature-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>() &amp;&amp; target-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>() == creature-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>())</div>
<div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;        }</div>
<div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;        <span class="keywordflow">case</span> 32124:                                         <span class="comment">// Cant hit players</span></div>
<div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;        <span class="keywordflow">case</span> 33512:                                         <span class="comment">// Kazzak&#39;s Assault - likely should not hit players</span></div>
<div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() == <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;        <span class="keywordflow">case</span> 36819:                                         <span class="comment">// Always should hit main tank, no clue why rigged as AOE</span></div>
<div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">GetVictim</a>() &amp;&amp; target != <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">GetVictim</a>())</div>
<div class="line"><a name="l09708"></a><span class="lineno"> 9708</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09709"></a><span class="lineno"> 9709</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09710"></a><span class="lineno"> 9710</span>&#160;        <span class="keywordflow">case</span> 37144:                                         <span class="comment">// Move - Chess event</span></div>
<div class="line"><a name="l09711"></a><span class="lineno"> 9711</span>&#160;        <span class="keywordflow">case</span> 37146:</div>
<div class="line"><a name="l09712"></a><span class="lineno"> 9712</span>&#160;        <span class="keywordflow">case</span> 37148:</div>
<div class="line"><a name="l09713"></a><span class="lineno"> 9713</span>&#160;        <span class="keywordflow">case</span> 37151:</div>
<div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160;        <span class="keywordflow">case</span> 37152:</div>
<div class="line"><a name="l09715"></a><span class="lineno"> 9715</span>&#160;        <span class="keywordflow">case</span> 37153:</div>
<div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(39400))</div>
<div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;        <span class="keywordflow">case</span> 37433:                                         <span class="comment">// Spout (The Lurker Below), only players affected if its not in water</span></div>
<div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#a9556ed3ef1d6b11bc0a50966a4d38e70">IsInWater</a>() &amp;&amp; (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a> || <span class="keyword">static_cast&lt;</span><a class="code" href="classPlayer.html">Player</a>*<span class="keyword">&gt;</span>(target)-&gt;<a class="code" href="classPlayer.html#a6fa4db05df1d6e6cd7b680b045e383ab">IsInHighLiquid</a>()))</div>
<div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;        <span class="keywordflow">case</span> 37868:                                         <span class="comment">// Arcano-Scorp Control</span></div>
<div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;        <span class="keywordflow">case</span> 37893:</div>
<div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;        <span class="keywordflow">case</span> 37895:</div>
<div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(<a class="code" href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">m_spellInfo</a>-&gt;<a class="code" href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">Id</a>)) <span class="comment">// scorp already possessed cannot be repossessed by a diff player TODO: Check on retail</span></div>
<div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;        <span class="keywordflow">case</span> 37918:                                         <span class="comment">// Arcano-pince</span></div>
<div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;        <span class="keywordflow">case</span> 37919:                                         <span class="comment">// Arcano-dismantle</span></div>
<div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;        {</div>
<div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(37917) || <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a> == target) <span class="comment">// Can&#39;t target targets with Arcano-Cloak or self (no attribute)</span></div>
<div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;        }</div>
<div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;        <span class="keywordflow">case</span> 38782:                                         <span class="comment">// Druid Signal</span></div>
<div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(38776) || target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(39158)) <span class="comment">// Don&#39;t target druids that have already been summoned by another player</span></div>
<div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;        <span class="keywordflow">case</span> 39090:                                         <span class="comment">// Positive Charge</span></div>
<div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(39091))                    <span class="comment">// Only deal damage if target has Negative Charge</span></div>
<div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;        <span class="keywordflow">case</span> 39093:                                         <span class="comment">// Negative Charge</span></div>
<div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(39088))                    <span class="comment">// Only deal damage if target has Positive Charge</span></div>
<div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160;        <span class="keywordflow">case</span> 39095:                                         <span class="comment">// Amplify Damage - weird logic confirmed on retail</span></div>
<div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a1b7f920f1194c4aab9d600bce2e9f9c2">getThreatManager</a>().<a class="code" href="classThreatManager.html#a646910563d1b3943c276f5efe1561bfd">getThreatList</a>().size() &gt;= 2 &amp;&amp; target == <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">GetVictim</a>())</div>
<div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;        <span class="keywordflow">case</span> 39365:                                         <span class="comment">// Thundering Storm - only hits 25-100yd range targets</span></div>
<div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;        {</div>
<div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;            <span class="keywordtype">float</span> dist = sqrt(target-&gt;<a class="code" href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">GetDistance</a>(<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">GetPositionX</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">GetPositionY</a>(), <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">GetPositionZ</a>(), <a class="code" href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a>));</div>
<div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;            <span class="keywordflow">if</span> (dist &lt; 25.f || dist &gt; 100.f)</div>
<div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;        }</div>
<div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;        <span class="keywordflow">case</span> 39921:                                         <span class="comment">// Vimgol Pentagram Beam</span></div>
<div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160;        {</div>
<div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> || target-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() != 23040 || <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a> || <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() != 23040)</div>
<div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160; </div>
<div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;            <a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> pBunnyId = <a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a4b46371e7ac4e6ae944a5e1d2d9c7293">GetScriptData</a>();</div>
<div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160; </div>
<div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;            std::list&lt;Creature*&gt; creatureList;</div>
<div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;            <a class="code" href="classMaNGOS_1_1AllCreaturesOfEntryInRangeCheck.html">MaNGOS::AllCreaturesOfEntryInRangeCheck</a> check(target, 23040, 60.f);</div>
<div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160;            <a class="code" href="structMaNGOS_1_1CreatureListSearcher.html">MaNGOS::CreatureListSearcher&lt;MaNGOS::AllCreaturesOfEntryInRangeCheck&gt;</a> searcher(creatureList, check);</div>
<div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;            <a class="code" href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a>(target, searcher, 60.f);</div>
<div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160; </div>
<div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; creature : creatureList)</div>
<div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160;            {</div>
<div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;                <span class="comment">// Check that both have AI() before accessing</span></div>
<div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;                <span class="keywordflow">if</span> (creature-&gt;AI() &amp;&amp; target-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>() &amp;&amp;</div>
<div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160;                    creature-&gt;AI()-&gt;<a class="code" href="classUnitAI.html#a4b46371e7ac4e6ae944a5e1d2d9c7293">GetScriptData</a>() == target-&gt;<a class="code" href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">AI</a>()-&gt;<a class="code" href="classUnitAI.html#a4b46371e7ac4e6ae944a5e1d2d9c7293">GetScriptData</a>())</div>
<div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;                    pBunnyId = creature-&gt;AI()-&gt;GetScriptData();</div>
<div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;            }</div>
<div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160; </div>
<div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160;            <a class="code" href="EntitiesMgr_8h.html#a16d185077e89f6e3983a664727a5f968">PlayerList</a> playerList;</div>
<div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;            <a class="code" href="classMaNGOS_1_1AnyPlayerInObjectRangeCheck.html">MaNGOS::AnyPlayerInObjectRangeCheck</a> checkPlayer(target, 4.f);</div>
<div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;            <a class="code" href="structMaNGOS_1_1PlayerListSearcher.html">MaNGOS::PlayerListSearcher&lt;MaNGOS::AnyPlayerInObjectRangeCheck&gt;</a> playerSearcher(playerList, checkPlayer);</div>
<div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;            <a class="code" href="structCell.html#aaa71b83434fc3d01f05dfbde2030124e">Cell::VisitWorldObjects</a>(target, playerSearcher, 4.f);</div>
<div class="line"><a name="l09783"></a><span class="lineno"> 9783</span>&#160;            <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; player : playerList)</div>
<div class="line"><a name="l09784"></a><span class="lineno"> 9784</span>&#160;            {</div>
<div class="line"><a name="l09785"></a><span class="lineno"> 9785</span>&#160;                <span class="keywordflow">switch</span> (pBunnyId)</div>
<div class="line"><a name="l09786"></a><span class="lineno"> 9786</span>&#160;                {</div>
<div class="line"><a name="l09787"></a><span class="lineno"> 9787</span>&#160;                    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l09788"></a><span class="lineno"> 9788</span>&#160;                    {</div>
<div class="line"><a name="l09789"></a><span class="lineno"> 9789</span>&#160;                        <span class="keywordflow">if</span> (player-&gt;HasAura(39834)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09790"></a><span class="lineno"> 9790</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09791"></a><span class="lineno"> 9791</span>&#160;                    }</div>
<div class="line"><a name="l09792"></a><span class="lineno"> 9792</span>&#160;                    <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;                    {</div>
<div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;                        <span class="keywordflow">if</span> (player-&gt;HasAura(39851)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160;                    }</div>
<div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;                    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;                    {</div>
<div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;                        <span class="keywordflow">if</span> (player-&gt;HasAura(39852)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;                    }</div>
<div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;                    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160;                    {</div>
<div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;                        <span class="keywordflow">if</span> (player-&gt;HasAura(39853)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;                    }</div>
<div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160;                    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;                    {</div>
<div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;                        <span class="keywordflow">if</span> (player-&gt;HasAura(39854)) <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;                    }</div>
<div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160;                }</div>
<div class="line"><a name="l09813"></a><span class="lineno"> 9813</span>&#160;            }</div>
<div class="line"><a name="l09814"></a><span class="lineno"> 9814</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09815"></a><span class="lineno"> 9815</span>&#160;        }</div>
<div class="line"><a name="l09816"></a><span class="lineno"> 9816</span>&#160;        <span class="keywordflow">case</span> 30769:                             <span class="comment">// Pick Red Riding Hood</span></div>
<div class="line"><a name="l09817"></a><span class="lineno"> 9817</span>&#160;        <span class="keywordflow">case</span> 30843:                             <span class="comment">// Enfeeble</span></div>
<div class="line"><a name="l09818"></a><span class="lineno"> 9818</span>&#160;        <span class="keywordflow">case</span> 36797:                             <span class="comment">// Mind Control (Kael&#39;thas)</span></div>
<div class="line"><a name="l09819"></a><span class="lineno"> 9819</span>&#160;        <span class="keywordflow">case</span> 40243:                             <span class="comment">// Crushing Shadows - Teron Gorefiend</span></div>
<div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160;        <span class="keywordflow">case</span> 41376:                             <span class="comment">// Spite</span></div>
<div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;        <span class="keywordflow">case</span> 43550:                             <span class="comment">// Mind Control - Malacrass</span></div>
<div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;        <span class="keywordflow">case</span> 62166:                             <span class="comment">// Stone Grip</span></div>
<div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160;        <span class="keywordflow">case</span> 63981:                             <span class="comment">// Stone Grip (h)</span></div>
<div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;        <span class="keywordflow">case</span> 69674:                             <span class="comment">// Mutated Infection (10n)</span></div>
<div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;        <span class="keywordflow">case</span> 71224:                             <span class="comment">// Mutated Infection (25n)</span></div>
<div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;        <span class="keywordflow">case</span> 73022:                             <span class="comment">// Mutated Infection (10h)</span></div>
<div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160;        <span class="keywordflow">case</span> 73023:                             <span class="comment">// Mutated Infection (25h)</span></div>
<div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">GetVictim</a>() == target)</div>
<div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;        <span class="keywordflow">case</span> 40175:                             <span class="comment">// Spirit Chains - Teron Gorefiend</span></div>
<div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;        <span class="keywordflow">case</span> 40314:                             <span class="comment">// Spirit Volley - Teron Gorefiend</span></div>
<div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() != 23111) <span class="comment">// can only hit Shadowy Constructs</span></div>
<div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09835"></a><span class="lineno"> 9835</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;        <span class="keywordflow">case</span> 44659:                             <span class="comment">// Destroy All Spirits - Teron Gorefiend</span></div>
<div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">GetEntry</a>() != 23109) <span class="comment">// can only hit Vengeful Spirits</span></div>
<div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09840"></a><span class="lineno"> 9840</span>&#160;        <span class="keywordflow">case</span> 40618:                             <span class="comment">// Insignificance</span></div>
<div class="line"><a name="l09841"></a><span class="lineno"> 9841</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(40603)) <span class="comment">// Taunt Gurtogg</span></div>
<div class="line"><a name="l09842"></a><span class="lineno"> 9842</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09843"></a><span class="lineno"> 9843</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09844"></a><span class="lineno"> 9844</span>&#160;        <span class="keywordflow">case</span> 40693:                             <span class="comment">// Illidan - Cage Trap</span></div>
<div class="line"><a name="l09845"></a><span class="lineno"> 9845</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(40409)) <span class="comment">// Maiev is down - trap should fail</span></div>
<div class="line"><a name="l09846"></a><span class="lineno"> 9846</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09847"></a><span class="lineno"> 9847</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;        <span class="keywordflow">case</span> 40722:                             <span class="comment">// Will of the Arakkoa God - Terokk</span></div>
<div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(40726)) <span class="comment">// Chosen One</span></div>
<div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160;        <span class="keywordflow">case</span> 40834:                             <span class="comment">// Agonizing Flames</span></div>
<div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classUnit.html#abc3ccbe4e8693ed5df548cbde2d94851">CanReachWithMeleeAttack</a>(target))</div>
<div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160;        <span class="keywordflow">case</span> 40869:                             <span class="comment">// Fatal Attraction - Mother Shahraz - ignore tanks - those which have Saber Lash</span></div>
<div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(43690)) <span class="comment">// Saber Lash</span></div>
<div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;        <span class="keywordflow">case</span> 40870:                             <span class="comment">// Fatal Attraction - tick - Mother Shahraz</span></div>
<div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;            <span class="keywordflow">if</span> (!target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(41001)) <span class="comment">// Fatal Attraction Aura</span></div>
<div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;        <span class="keywordflow">case</span> 43657:                             <span class="comment">// Electrical Storm - Akil&#39;zon</span></div>
<div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(44007)) <span class="comment">// Electrical Storm - Safe within eye</span></div>
<div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;        <span class="keywordflow">case</span> 39992:                             <span class="comment">// Needle Spine Targeting - Najentus</span></div>
<div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;            <span class="keywordflow">if</span> (target-&gt;<a class="code" href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">HasAura</a>(39837)) <span class="comment">// Impaling Spine - skip</span></div>
<div class="line"><a name="l09870"></a><span class="lineno"> 9870</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;        <span class="keywordflow">case</span> 68921:                                         <span class="comment">// Soulstorm (FoS), only targets farer than 10 away</span></div>
<div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;        <span class="keywordflow">case</span> 69049:                                         <span class="comment">// Soulstorm            - = -</span></div>
<div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">m_caster</a>-&gt;<a class="code" href="classWorldObject.html#ad31c70778088c09b056d7c12ecb61e2a">IsWithinDist</a>(target, 10.0f, <span class="keyword">false</span>))</div>
<div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;                <span class="keywordflow">return</span> script-&gt;OnCheckTarget(<span class="keyword">this</span>, target, eff);</div>
<div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;    }</div>
<div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160; </div>
<div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;}</div>
<div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160; </div>
<div class="line"><a name="l09886"></a><span class="lineno"><a class="line" href="classSpell.html#a3baff69e3d6bff9c02248e290cfb2e30"> 9886</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a3baff69e3d6bff9c02248e290cfb2e30">Spell::OnCast</a>()</div>
<div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160;{</div>
<div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;        <span class="keywordflow">return</span> script-&gt;OnCast(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160;}</div>
<div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160; </div>
<div class="line"><a name="l09892"></a><span class="lineno"><a class="line" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2"> 9892</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">Spell::OnHit</a>(<a class="code" href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65a">SpellMissInfo</a> missInfo)</div>
<div class="line"><a name="l09893"></a><span class="lineno"> 9893</span>&#160;{</div>
<div class="line"><a name="l09894"></a><span class="lineno"> 9894</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09895"></a><span class="lineno"> 9895</span>&#160;        <span class="keywordflow">return</span> script-&gt;OnHit(<span class="keyword">this</span>, missInfo);</div>
<div class="line"><a name="l09896"></a><span class="lineno"> 9896</span>&#160;}</div>
<div class="line"><a name="l09897"></a><span class="lineno"> 9897</span>&#160; </div>
<div class="line"><a name="l09898"></a><span class="lineno"><a class="line" href="classSpell.html#a0b4cba9e81d9533c5acc442797c7df85"> 9898</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a0b4cba9e81d9533c5acc442797c7df85">Spell::OnAfterHit</a>()</div>
<div class="line"><a name="l09899"></a><span class="lineno"> 9899</span>&#160;{</div>
<div class="line"><a name="l09900"></a><span class="lineno"> 9900</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09901"></a><span class="lineno"> 9901</span>&#160;        <span class="keywordflow">return</span> script-&gt;OnAfterHit(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09902"></a><span class="lineno"> 9902</span>&#160;}</div>
<div class="line"><a name="l09903"></a><span class="lineno"> 9903</span>&#160; </div>
<div class="line"><a name="l09904"></a><span class="lineno"><a class="line" href="classSpell.html#ae4cc49a92d3376183bbe01b2d021dfb1"> 9904</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae4cc49a92d3376183bbe01b2d021dfb1">Spell::OnSummon</a>(<a class="code" href="classGameObject.html">GameObject</a>* summon)</div>
<div class="line"><a name="l09905"></a><span class="lineno"> 9905</span>&#160;{</div>
<div class="line"><a name="l09906"></a><span class="lineno"> 9906</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09907"></a><span class="lineno"> 9907</span>&#160;        <span class="keywordflow">return</span> script-&gt;OnSummon(<span class="keyword">this</span>, summon);</div>
<div class="line"><a name="l09908"></a><span class="lineno"> 9908</span>&#160;}</div>
<div class="line"><a name="l09909"></a><span class="lineno"> 9909</span>&#160; </div>
<div class="line"><a name="l09910"></a><span class="lineno"><a class="line" href="classSpell.html#a5209a8092eab3948b25c4a5279e76a5c"> 9910</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#ae4cc49a92d3376183bbe01b2d021dfb1">Spell::OnSummon</a>(<a class="code" href="classCreature.html">Creature</a>* summon)</div>
<div class="line"><a name="l09911"></a><span class="lineno"> 9911</span>&#160;{</div>
<div class="line"><a name="l09912"></a><span class="lineno"> 9912</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;        <span class="keywordflow">return</span> script-&gt;OnSummon(<span class="keyword">this</span>, summon);</div>
<div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;}</div>
<div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160; </div>
<div class="line"><a name="l09916"></a><span class="lineno"><a class="line" href="classSpell.html#a8894a2448ad80db750cad4d2a3912641"> 9916</a></span>&#160;<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> <a class="code" href="classSpell.html#a8894a2448ad80db750cad4d2a3912641">Spell::GetPhaseMaskOverride</a>()</div>
<div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160;{</div>
<div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structSpellScript.html">SpellScript</a>* script = <a class="code" href="classSpell.html#a8e022f35193d932a94db798657f2328a">GetSpellScript</a>())</div>
<div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;        <span class="keywordflow">return</span> script-&gt;GetPhaseMaskOverride(<span class="keyword">this</span>);</div>
<div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160; </div>
<div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;}</div>
<div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160; </div>
<div class="line"><a name="l09924"></a><span class="lineno"><a class="line" href="classSpell.html#a0f13cd88cfc58640ca705d6b1a72d2e0"> 9924</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classSpell.html#a0f13cd88cfc58640ca705d6b1a72d2e0">Spell::SetTotalTargetValueModifier</a>(<span class="keywordtype">float</span> modifier)</div>
<div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160;{</div>
<div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160;    <a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a> = float(<a class="code" href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">m_damage</a>) * modifier;</div>
<div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;}</div>
<div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160; </div>
<div class="line"><a name="l09929"></a><span class="lineno"><a class="line" href="classSpellModRAII.html#a20687bd4166920cdb7989253e9ff000b"> 9929</a></span>&#160;<a class="code" href="classSpellModRAII.html#a20687bd4166920cdb7989253e9ff000b">SpellModRAII::SpellModRAII</a>(<a class="code" href="classSpell.html">Spell</a>* spell, <a class="code" href="classPlayer.html">Player</a>* modOwner, <span class="keywordtype">bool</span> success, <span class="keywordtype">bool</span> onlySave) : m_spell(spell), m_modOwner(modOwner), m_success(success), m_onlySave(onlySave)</div>
<div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160;{</div>
<div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a> &amp;&amp; !modOwner-&gt;<a class="code" href="classPlayer.html#a543ac618fb8aaec4fc23bdfb92b29733">GetSpellModSpell</a>()) <span class="comment">// only if first spell in depth</span></div>
<div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;        <a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a>-&gt;<a class="code" href="classPlayer.html#ab65ebe29bf60f3b6144070a461976f9a">SetSpellModSpell</a>(spell);</div>
<div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160;}</div>
<div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160; </div>
<div class="line"><a name="l09935"></a><span class="lineno"><a class="line" href="classSpellModRAII.html#a348fe871eb808be6f115674b363cafd0"> 9935</a></span>&#160;<a class="code" href="classSpellModRAII.html#a348fe871eb808be6f115674b363cafd0">SpellModRAII::~SpellModRAII</a>()</div>
<div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;{</div>
<div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a> &amp;&amp; <a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a>-&gt;<a class="code" href="classPlayer.html#a543ac618fb8aaec4fc23bdfb92b29733">GetSpellModSpell</a>() == <a class="code" href="classSpellModRAII.html#a23f3fd7bed5c18dde8d1ee3182389e01">m_spell</a>) <span class="comment">// only if this spell is toplevel</span></div>
<div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;    {</div>
<div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="classSpellModRAII.html#a8b770a4d2aa3a8c23d5c324c5e1f5f87">m_onlySave</a>)</div>
<div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160;        {</div>
<div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classSpellModRAII.html#af7936f9aab357d4d25d2436178fa06ca">m_success</a>)</div>
<div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160;                <a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a>-&gt;<a class="code" href="classPlayer.html#a0bb44a15011105880e352426c8756c97">RemoveSpellMods</a>(<a class="code" href="classSpellModRAII.html#a23f3fd7bed5c18dde8d1ee3182389e01">m_spell</a>-&gt;<a class="code" href="classSpell.html#a3265dd73fd4d1e72de3ca47f4a2e8b3f">m_usedAuraCharges</a>);</div>
<div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;                <a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a>-&gt;<a class="code" href="classPlayer.html#a215e25644bd2d843ab3782f5a8beca9f">ResetSpellModsDueToCanceledSpell</a>(<a class="code" href="classSpellModRAII.html#a23f3fd7bed5c18dde8d1ee3182389e01">m_spell</a>-&gt;<a class="code" href="classSpell.html#a3265dd73fd4d1e72de3ca47f4a2e8b3f">m_usedAuraCharges</a>);</div>
<div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;        }</div>
<div class="line"><a name="l09946"></a><span class="lineno"> 9946</span>&#160;        <a class="code" href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">m_modOwner</a>-&gt;<a class="code" href="classPlayer.html#ab65ebe29bf60f3b6144070a461976f9a">SetSpellModSpell</a>(<span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;    }</div>
<div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;}</div>
<div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160; </div>
<div class="line"><a name="l09950"></a><span class="lineno"><a class="line" href="classSpell.html#a4aeb2f8c87142d7dc0a88f89b41eedad"> 9950</a></span>&#160;<a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a> <a class="code" href="classSpell.html#a4aeb2f8c87142d7dc0a88f89b41eedad">Spell::CheckVehicle</a>(<a class="code" href="classUnit.html">Unit</a> <span class="keyword">const</span>* caster, <a class="code" href="structSpellEntry.html">SpellEntry</a> <span class="keyword">const</span>&amp; spellInfo)</div>
<div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;{</div>
<div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160;    <span class="comment">// All creatures should be able to cast as passengers freely, restriction and attribute are only for players</span></div>
<div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="classObject.html#a7e985367f6a9997544bbc18253f3563d">GetTypeId</a>() != <a class="code" href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a>)</div>
<div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160; </div>
<div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;    <a class="code" href="classVehicleInfo.html">VehicleInfo</a>* vehicle = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;    <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>())</div>
<div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160;        <span class="keywordflow">if</span> (caster-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a314642719fc92ee528c2abb228b3a105">GetTransport</a>()-&gt;<a class="code" href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">IsUnit</a>())</div>
<div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;            vehicle = <span class="keyword">static_cast&lt;</span><a class="code" href="classUnit.html">Unit</a>*<span class="keyword">&gt;</span>(caster-&gt;<a class="code" href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">GetTransportInfo</a>()-&gt;<a class="code" href="classTransportInfo.html#a314642719fc92ee528c2abb228b3a105">GetTransport</a>())-&gt;GetVehicleInfo();</div>
<div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;    <span class="keywordflow">if</span> (vehicle)</div>
<div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160;    {</div>
<div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;        <a class="code" href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a> checkMask = 0;</div>
<div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a> effIdx = 0; effIdx &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++effIdx)</div>
<div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160;        {</div>
<div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;            <span class="keywordflow">if</span> (spellInfo.<a class="code" href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">EffectApplyAuraName</a>[effIdx] == <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1c3516bb8442ba5d970c928ffc976689">SPELL_AURA_MOD_SHAPESHIFT</a>)</div>
<div class="line"><a name="l09966"></a><span class="lineno"> 9966</span>&#160;            {</div>
<div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160;                <a class="code" href="structSpellShapeshiftFormEntry.html">SpellShapeshiftFormEntry</a> <span class="keyword">const</span>* shapeShiftEntry = <a class="code" href="DBCStores_8cpp.html#a523b3c32b0410c0f5306a289932bc32e">sSpellShapeshiftFormStore</a>.LookupEntry(spellInfo.<a class="code" href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">EffectMiscValue</a>[effIdx]);</div>
<div class="line"><a name="l09968"></a><span class="lineno"> 9968</span>&#160;                <span class="keywordflow">if</span> (shapeShiftEntry &amp;&amp; (shapeShiftEntry-&gt;<a class="code" href="structSpellShapeshiftFormEntry.html#a026745f2ce754d754858d69ee219b518">flags1</a> &amp; 1) == 0)  <span class="comment">// unk flag</span></div>
<div class="line"><a name="l09969"></a><span class="lineno"> 9969</span>&#160;                    checkMask |= <a class="code" href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5aa773d2ff6e26744f026eddd73b911603">SEAT_FLAG_UNCONTROLLED</a>;</div>
<div class="line"><a name="l09970"></a><span class="lineno"> 9970</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09971"></a><span class="lineno"> 9971</span>&#160;            }</div>
<div class="line"><a name="l09972"></a><span class="lineno"> 9972</span>&#160;        }</div>
<div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160; </div>
<div class="line"><a name="l09974"></a><span class="lineno"> 9974</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="SpellMgr_8h.html#a2763a918baa144ce10d9dcbf1d6f9c70">IsSpellHaveAura</a>(&amp;spellInfo, <a class="code" href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a8cec8a45f78b8555b8f13b8b00995acf">SPELL_AURA_MOUNTED</a>))</div>
<div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;            checkMask |= <a class="code" href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5ab430d78bf3f8efc657a17999e3956c82">SEAT_FLAG_CAN_CAST_MOUNT_SPELL</a>;</div>
<div class="line"><a name="l09976"></a><span class="lineno"> 9976</span>&#160; </div>
<div class="line"><a name="l09977"></a><span class="lineno"> 9977</span>&#160;        <span class="keywordflow">if</span> (!checkMask)</div>
<div class="line"><a name="l09978"></a><span class="lineno"> 9978</span>&#160;            checkMask = <a class="code" href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5a9c8f30856fa3dad2a6c7837ffabab729">SEAT_FLAG_CAN_ATTACK</a>;</div>
<div class="line"><a name="l09979"></a><span class="lineno"> 9979</span>&#160; </div>
<div class="line"><a name="l09980"></a><span class="lineno"> 9980</span>&#160;        <a class="code" href="structVehicleSeatEntry.html">VehicleSeatEntry</a> <span class="keyword">const</span>* vehicleSeat = vehicle-&gt;<a class="code" href="group__TransportSystem.html#gac3560ad689c70f8672b3f2e9bb675e54">GetSeatForPassenger</a>(caster);</div>
<div class="line"><a name="l09981"></a><span class="lineno"> 9981</span>&#160;        <span class="keywordflow">if</span> (!spellInfo.<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0af18ed96ca251fb247f188fbf1690b08e">SPELL_ATTR_EX6_ALLOW_WHILE_RIDING_VEHICLE</a>) &amp;&amp; !spellInfo.<a class="code" href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">HasAttribute</a>(<a class="code" href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8eb753addae32fb84984d8c1c613108f">SPELL_ATTR_ALLOW_WHILE_MOUNTED</a>)</div>
<div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;            &amp;&amp; (vehicleSeat-&gt;<a class="code" href="structVehicleSeatEntry.html#afe02aa891cad80dff89156d138bad691">m_flags</a> &amp; checkMask) != checkMask)</div>
<div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9c6a5ea90b0797694ebec8b386fd920b">SPELL_FAILED_CANT_DO_THAT_RIGHT_NOW</a>;</div>
<div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160; </div>
<div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;        <span class="comment">// Can only summon uncontrolled minions/guardians when on controlled vehicle</span></div>
<div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160;        <span class="keywordflow">if</span> (vehicleSeat-&gt;<a class="code" href="structVehicleSeatEntry.html#afe02aa891cad80dff89156d138bad691">m_flags</a> &amp; (<a class="code" href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5a0df1e3692de005c5a5e2269c6845de93">SEAT_FLAG_CAN_CONTROL</a> | <a class="code" href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5ae1e772dd21637ff84bea16f195dbfc19">SEAT_FLAG_UNK25</a>))</div>
<div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;        {</div>
<div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;            <span class="keywordflow">for</span> (<a class="code" href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a> i = 0; i &lt; <a class="code" href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a>; ++i)</div>
<div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;            {</div>
<div class="line"><a name="l09990"></a><span class="lineno"> 9990</span>&#160;                <span class="keywordflow">if</span> (spellInfo.<a class="code" href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">Effect</a>[i] != <a class="code" href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa7be476935ce81144c2b383b7af7bf47">SPELL_EFFECT_SUMMON</a>)</div>
<div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;                    <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160; </div>
<div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;                <a class="code" href="structSummonPropertiesEntry.html">SummonPropertiesEntry</a> <span class="keyword">const</span>* props = <a class="code" href="DBCStores_8cpp.html#ab1c80e434031e07ffd42dc18640e5b26">sSummonPropertiesStore</a>.LookupEntry(spellInfo.<a class="code" href="structSpellEntry.html#ab0c175d928e13ac47a1a0125e16d048c">EffectMiscValueB</a>[i]);</div>
<div class="line"><a name="l09994"></a><span class="lineno"> 9994</span>&#160;                <span class="keywordflow">if</span> (props &amp;&amp; props-&gt;<a class="code" href="structSummonPropertiesEntry.html#ac93e8d8e555456ec9b7a9d38f15b55e0">Group</a> != <a class="code" href="DBCEnums_8h.html#a24fca3b9586dfe1d08bbea5f78626640ad602a3044fd291c37236430404e65897">SUMMON_PROP_GROUP_WILD</a>)</div>
<div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;                    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9c6a5ea90b0797694ebec8b386fd920b">SPELL_FAILED_CANT_DO_THAT_RIGHT_NOW</a>;</div>
<div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160;            }</div>
<div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;        }</div>
<div class="line"><a name="l09998"></a><span class="lineno"> 9998</span>&#160;    }</div>
<div class="line"><a name="l09999"></a><span class="lineno"> 9999</span>&#160; </div>
<div class="line"><a name="l10000"></a><span class="lineno">10000</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a>;</div>
<div class="line"><a name="l10001"></a><span class="lineno">10001</span>&#160;}</div>
<div class="line"><a name="l10002"></a><span class="lineno">10002</span>&#160; </div>
<div class="ttc" id="aBag_8h_html_aadcc1e3338f8cbbe511ad060db42dfb5a843659af0a40139bfa505d7e7982477b"><div class="ttname"><a href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5a843659af0a40139bfa505d7e7982477b">NULL_BAG</a></div><div class="ttdeci">@ NULL_BAG</div><div class="ttdef"><b>Definition:</b> <a href="Bag_8h_source.html#l00027">Bag.h:27</a></div></div>
<div class="ttc" id="aBag_8h_html_aadcc1e3338f8cbbe511ad060db42dfb5aeb5cbd7990d2f5e679ec4ecc65e83130"><div class="ttname"><a href="Bag_8h.html#aadcc1e3338f8cbbe511ad060db42dfb5aeb5cbd7990d2f5e679ec4ecc65e83130">NULL_SLOT</a></div><div class="ttdeci">@ NULL_SLOT</div><div class="ttdef"><b>Definition:</b> <a href="Bag_8h_source.html#l00029">Bag.h:28</a></div></div>
<div class="ttc" id="aBattleGround_8h_html"><div class="ttname"><a href="BattleGround_8h.html">BattleGround.h</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eae7efc0dc1952d03b010583a83242fab8">STATUS_WAIT_LEAVE</a></div><div class="ttdeci">@ STATUS_WAIT_LEAVE</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00187">BattleGround.h:186</a></div></div>
<div class="ttc" id="aBattleGround_8h_html_ac50f9874790ffafe1eb61f64e2b83d0eafaf0b6349b8a93b543f64c744e321d5a"><div class="ttname"><a href="BattleGround_8h.html#ac50f9874790ffafe1eb61f64e2b83d0eafaf0b6349b8a93b543f64c744e321d5a">STATUS_IN_PROGRESS</a></div><div class="ttdeci">@ STATUS_IN_PROGRESS</div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00185">BattleGround.h:185</a></div></div>
<div class="ttc" id="aCellImpl_8h_html"><div class="ttname"><a href="CellImpl_8h.html">CellImpl.h</a></div></div>
<div class="ttc" id="aChat_8h_html"><div class="ttname"><a href="Chat_8h.html">Chat.h</a></div></div>
<div class="ttc" id="aCommon_8h_html_a25c83491d5877e166e36a591e84c1b76"><div class="ttname"><a href="Common_8h.html#a25c83491d5877e166e36a591e84c1b76">SIZEFMTD</a></div><div class="ttdeci">#define SIZEFMTD</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00090">Common.h:90</a></div></div>
<div class="ttc" id="aCommon_8h_html_ab9c3c609e1d02430671de0a109410ac8"><div class="ttname"><a href="Common_8h.html#ab9c3c609e1d02430671de0a109410ac8">M_PI_F</a></div><div class="ttdeci">#define M_PI_F</div><div class="ttdef"><b>Definition:</b> <a href="Common_8h_source.html#l00166">Common.h:166</a></div></div>
<div class="ttc" id="aCreatureEventAI_8h_html_a31488d29805a596498c0234ae392d35d"><div class="ttname"><a href="CreatureEventAI_8h.html#a31488d29805a596498c0234ae392d35d">Target</a></div><div class="ttdeci">Target</div><div class="ttdef"><b>Definition:</b> <a href="CreatureEventAI_8h_source.html#l00155">CreatureEventAI.h:156</a></div></div>
<div class="ttc" id="aCreature_8h_html_a8f7d803e051a8bcb43a44f16b01f9c09"><div class="ttname"><a href="Creature_8h.html#a8f7d803e051a8bcb43a44f16b01f9c09">MAX_VIRTUAL_ITEM_SLOT</a></div><div class="ttdeci">#define MAX_VIRTUAL_ITEM_SLOT</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00494">Creature.h:494</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a0040fdd9a7192268e855e468c71b68a1"><div class="ttname"><a href="DBCEnums_8h.html#a0040fdd9a7192268e855e468c71b68a1">SpellEffectIndexMask</a></div><div class="ttdeci">SpellEffectIndexMask</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00494">DBCEnums.h:495</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a0040fdd9a7192268e855e468c71b68a1a1b9f5fd9fb33c4b9012f42d680914c30"><div class="ttname"><a href="DBCEnums_8h.html#a0040fdd9a7192268e855e468c71b68a1a1b9f5fd9fb33c4b9012f42d680914c30">EFFECT_MASK_ALL</a></div><div class="ttdeci">@ EFFECT_MASK_ALL</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00500">DBCEnums.h:499</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a038867f3f1d822b38a6cad2411c8006a"><div class="ttname"><a href="DBCEnums_8h.html#a038867f3f1d822b38a6cad2411c8006a">MAX_EFFECT_INDEX</a></div><div class="ttdeci">#define MAX_EFFECT_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00492">DBCEnums.h:492</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a1722a65e910763eaffb541de9d7001f5a0df1e3692de005c5a5e2269c6845de93"><div class="ttname"><a href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5a0df1e3692de005c5a5e2269c6845de93">SEAT_FLAG_CAN_CONTROL</a></div><div class="ttdeci">@ SEAT_FLAG_CAN_CONTROL</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00573">DBCEnums.h:573</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a1722a65e910763eaffb541de9d7001f5a9c8f30856fa3dad2a6c7837ffabab729"><div class="ttname"><a href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5a9c8f30856fa3dad2a6c7837ffabab729">SEAT_FLAG_CAN_ATTACK</a></div><div class="ttdeci">@ SEAT_FLAG_CAN_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00576">DBCEnums.h:576</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a1722a65e910763eaffb541de9d7001f5aa773d2ff6e26744f026eddd73b911603"><div class="ttname"><a href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5aa773d2ff6e26744f026eddd73b911603">SEAT_FLAG_UNCONTROLLED</a></div><div class="ttdeci">@ SEAT_FLAG_UNCONTROLLED</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00575">DBCEnums.h:575</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a1722a65e910763eaffb541de9d7001f5ab430d78bf3f8efc657a17999e3956c82"><div class="ttname"><a href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5ab430d78bf3f8efc657a17999e3956c82">SEAT_FLAG_CAN_CAST_MOUNT_SPELL</a></div><div class="ttdeci">@ SEAT_FLAG_CAN_CAST_MOUNT_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00574">DBCEnums.h:574</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a1722a65e910763eaffb541de9d7001f5ae1e772dd21637ff84bea16f195dbfc19"><div class="ttname"><a href="DBCEnums_8h.html#a1722a65e910763eaffb541de9d7001f5ae1e772dd21637ff84bea16f195dbfc19">SEAT_FLAG_UNK25</a></div><div class="ttdeci">@ SEAT_FLAG_UNK25</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00592">DBCEnums.h:592</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a24fca3b9586dfe1d08bbea5f78626640a4d0533929599bc8711fd2152978a2426"><div class="ttname"><a href="DBCEnums_8h.html#a24fca3b9586dfe1d08bbea5f78626640a4d0533929599bc8711fd2152978a2426">SUMMON_PROP_GROUP_PETS</a></div><div class="ttdeci">@ SUMMON_PROP_GROUP_PETS</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00424">DBCEnums.h:424</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a24fca3b9586dfe1d08bbea5f78626640ad602a3044fd291c37236430404e65897"><div class="ttname"><a href="DBCEnums_8h.html#a24fca3b9586dfe1d08bbea5f78626640ad602a3044fd291c37236430404e65897">SUMMON_PROP_GROUP_WILD</a></div><div class="ttdeci">@ SUMMON_PROP_GROUP_WILD</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00422">DBCEnums.h:422</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a43efb0a2e61815a66134dfa5ccea0a83"><div class="ttname"><a href="DBCEnums_8h.html#a43efb0a2e61815a66134dfa5ccea0a83">Difficulty</a></div><div class="ttdeci">Difficulty</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00270">DBCEnums.h:271</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a6be7938b7bea685e9f021da7acb6d9b6"><div class="ttname"><a href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6">SpellEffectIndex</a></div><div class="ttdeci">SpellEffectIndex</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00485">DBCEnums.h:486</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a6be7938b7bea685e9f021da7acb6d9b6a1c69b2509a4774a2c523cacb45edc840"><div class="ttname"><a href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a1c69b2509a4774a2c523cacb45edc840">EFFECT_INDEX_2</a></div><div class="ttdeci">@ EFFECT_INDEX_2</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00490">DBCEnums.h:489</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db"><div class="ttname"><a href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a2515e06020940e666b94acc8835521db">EFFECT_INDEX_1</a></div><div class="ttdeci">@ EFFECT_INDEX_1</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00488">DBCEnums.h:488</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1"><div class="ttname"><a href="DBCEnums_8h.html#a6be7938b7bea685e9f021da7acb6d9b6a6eb7ddf7003f3af330b407084e1d88b1">EFFECT_INDEX_0</a></div><div class="ttdeci">@ EFFECT_INDEX_0</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00487">DBCEnums.h:487</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a796cde2fc6e2eaed4c657203ed43cd19a048099caa4f6285d05f1f824b1793259"><div class="ttname"><a href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a048099caa4f6285d05f1f824b1793259">ACHIEVEMENT_CRITERIA_TYPE_BE_SPELL_TARGET2</a></div><div class="ttdeci">@ ACHIEVEMENT_CRITERIA_TYPE_BE_SPELL_TARGET2</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00186">DBCEnums.h:186</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a796cde2fc6e2eaed4c657203ed43cd19a09cd8a896a5a8785223068bbbaa65135"><div class="ttname"><a href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a09cd8a896a5a8785223068bbbaa65135">ACHIEVEMENT_CRITERIA_TYPE_USE_ITEM</a></div><div class="ttdeci">@ ACHIEVEMENT_CRITERIA_TYPE_USE_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00159">DBCEnums.h:159</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a796cde2fc6e2eaed4c657203ed43cd19a16b93c36aa3687bd59c859016b6202c1"><div class="ttname"><a href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a16b93c36aa3687bd59c859016b6202c1">ACHIEVEMENT_CRITERIA_TYPE_BE_SPELL_TARGET</a></div><div class="ttdeci">@ ACHIEVEMENT_CRITERIA_TYPE_BE_SPELL_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00146">DBCEnums.h:146</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a796cde2fc6e2eaed4c657203ed43cd19a2644bcc963aae857b4e9a20ce22ac048"><div class="ttname"><a href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a2644bcc963aae857b4e9a20ce22ac048">ACHIEVEMENT_CRITERIA_TYPE_CAST_SPELL</a></div><div class="ttdeci">@ ACHIEVEMENT_CRITERIA_TYPE_CAST_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00147">DBCEnums.h:147</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_a796cde2fc6e2eaed4c657203ed43cd19a90f087842f0682fb18ff1b9af67810b0"><div class="ttname"><a href="DBCEnums_8h.html#a796cde2fc6e2eaed4c657203ed43cd19a90f087842f0682fb18ff1b9af67810b0">ACHIEVEMENT_CRITERIA_TYPE_CAST_SPELL2</a></div><div class="ttdeci">@ ACHIEVEMENT_CRITERIA_TYPE_CAST_SPELL2</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00222">DBCEnums.h:222</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca04f59ec569a753b4e47a0a230782f207"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca04f59ec569a753b4e47a0a230782f207">SPELLFAMILY_PRIEST</a></div><div class="ttdeci">@ SPELLFAMILY_PRIEST</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00510">DBCEnums.h:510</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca0a134bc75d430da10f6c1df4977c29cf"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0a134bc75d430da10f6c1df4977c29cf">SPELLFAMILY_WARLOCK</a></div><div class="ttdeci">@ SPELLFAMILY_WARLOCK</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00509">DBCEnums.h:509</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca0e4b88db8be01ea5d62cc08d07b28aae"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0e4b88db8be01ea5d62cc08d07b28aae">SPELLFAMILY_MAGE</a></div><div class="ttdeci">@ SPELLFAMILY_MAGE</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00507">DBCEnums.h:507</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca0ebbb6206eb92cdc484b416eb6f41743"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca0ebbb6206eb92cdc484b416eb6f41743">SPELLFAMILY_GENERIC</a></div><div class="ttdeci">@ SPELLFAMILY_GENERIC</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00504">DBCEnums.h:504</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca52acbcf14a96b5ed01b8a43052a26a11"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca52acbcf14a96b5ed01b8a43052a26a11">SPELLFAMILY_WARRIOR</a></div><div class="ttdeci">@ SPELLFAMILY_WARRIOR</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00508">DBCEnums.h:508</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca573f9ad8924e7632156291378448e742"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca573f9ad8924e7632156291378448e742">SPELLFAMILY_PALADIN</a></div><div class="ttdeci">@ SPELLFAMILY_PALADIN</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00514">DBCEnums.h:514</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca66df9b34a3b922a8242d3dfb74494026"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca66df9b34a3b922a8242d3dfb74494026">SPELLFAMILY_HUNTER</a></div><div class="ttdeci">@ SPELLFAMILY_HUNTER</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00513">DBCEnums.h:513</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca9160b2e3a87a908af25c9a594295c0c1"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9160b2e3a87a908af25c9a594295c0c1">SPELLFAMILY_ROGUE</a></div><div class="ttdeci">@ SPELLFAMILY_ROGUE</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00512">DBCEnums.h:512</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1ca9c8a9c6e102c760263471a93e58e80ea"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1ca9c8a9c6e102c760263471a93e58e80ea">SPELLFAMILY_SHAMAN</a></div><div class="ttdeci">@ SPELLFAMILY_SHAMAN</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00515">DBCEnums.h:515</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1cac3788ce010075b8bd4e6083638d8cd40"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cac3788ce010075b8bd4e6083638d8cd40">SPELLFAMILY_DRUID</a></div><div class="ttdeci">@ SPELLFAMILY_DRUID</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00511">DBCEnums.h:511</a></div></div>
<div class="ttc" id="aDBCEnums_8h_html_ad49a8709b09d0f77d54e799b71495e1cadc34b27f2cd523716d80c51d4e1d6f02"><div class="ttname"><a href="DBCEnums_8h.html#ad49a8709b09d0f77d54e799b71495e1cadc34b27f2cd523716d80c51d4e1d6f02">SPELLFAMILY_DEATHKNIGHT</a></div><div class="ttdeci">@ SPELLFAMILY_DEATHKNIGHT</div><div class="ttdef"><b>Definition:</b> <a href="DBCEnums_8h_source.html#l00519">DBCEnums.h:519</a></div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a0f73cf810ab3701b159edd9d9eb1dc07"><div class="ttname"><a href="DBCStores_8cpp.html#a0f73cf810ab3701b159edd9d9eb1dc07">sSpellRangeStore</a></div><div class="ttdeci">DBCStorage&lt; SpellRangeEntry &gt; sSpellRangeStore(SpellRangefmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a495e62fceccd344a25ba720c9e1966d9"><div class="ttname"><a href="DBCStores_8cpp.html#a495e62fceccd344a25ba720c9e1966d9">sSpellRadiusStore</a></div><div class="ttdeci">DBCStorage&lt; SpellRadiusEntry &gt; sSpellRadiusStore(SpellRadiusfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a4b7782641d455ad5070f1aba070beae9"><div class="ttname"><a href="DBCStores_8cpp.html#a4b7782641d455ad5070f1aba070beae9">sSpellItemEnchantmentStore</a></div><div class="ttdeci">DBCStorage&lt; SpellItemEnchantmentEntry &gt; sSpellItemEnchantmentStore(SpellItemEnchantmentfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a517422c4e090503dc6776f5fe0deae7c"><div class="ttname"><a href="DBCStores_8cpp.html#a517422c4e090503dc6776f5fe0deae7c">sLockStore</a></div><div class="ttdeci">DBCStorage&lt; LockEntry &gt; sLockStore(LockEntryfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a523b3c32b0410c0f5306a289932bc32e"><div class="ttname"><a href="DBCStores_8cpp.html#a523b3c32b0410c0f5306a289932bc32e">sSpellShapeshiftFormStore</a></div><div class="ttdeci">DBCStorage&lt; SpellShapeshiftFormEntry &gt; sSpellShapeshiftFormStore(SpellShapeshiftFormfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a637df65a6f7f0354010d82cace781499"><div class="ttname"><a href="DBCStores_8cpp.html#a637df65a6f7f0354010d82cace781499">sItemStore</a></div><div class="ttdeci">DBCStorage&lt; ItemEntry &gt; sItemStore(Itemfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a6cd9fabae2b38cb4d202f25c57e4dad9"><div class="ttname"><a href="DBCStores_8cpp.html#a6cd9fabae2b38cb4d202f25c57e4dad9">sGtNPCManaCostScalerStore</a></div><div class="ttdeci">DBCStorage&lt; GtNPCManaCostScalerEntry &gt; sGtNPCManaCostScalerStore(GtNPCManaCostScalerfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a85005b81c129bd976cb43f44a9c0fa42"><div class="ttname"><a href="DBCStores_8cpp.html#a85005b81c129bd976cb43f44a9c0fa42">sSpellCategoryStore</a></div><div class="ttdeci">DBCStorage&lt; SpellCategoryEntry &gt; sSpellCategoryStore(SpellCategoryfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_a9a542d9b7a00cab69edf5db46e90f718"><div class="ttname"><a href="DBCStores_8cpp.html#a9a542d9b7a00cab69edf5db46e90f718">sSpellRuneCostStore</a></div><div class="ttdeci">DBCStorage&lt; SpellRuneCostEntry &gt; sSpellRuneCostStore(SpellRuneCostfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_ab1c80e434031e07ffd42dc18640e5b26"><div class="ttname"><a href="DBCStores_8cpp.html#ab1c80e434031e07ffd42dc18640e5b26">sSummonPropertiesStore</a></div><div class="ttdeci">DBCStorage&lt; SummonPropertiesEntry &gt; sSummonPropertiesStore(SummonPropertiesfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_ac28198d1c28605951e9debe1298b8304"><div class="ttname"><a href="DBCStores_8cpp.html#ac28198d1c28605951e9debe1298b8304">sMapStore</a></div><div class="ttdeci">DBCStorage&lt; MapEntry &gt; sMapStore(MapEntryfmt)</div></div>
<div class="ttc" id="aDBCStores_8cpp_html_af61cd8fbbd2bde6fd6763ce7301e728e"><div class="ttname"><a href="DBCStores_8cpp.html#af61cd8fbbd2bde6fd6763ce7301e728e">sGlyphPropertiesStore</a></div><div class="ttdeci">DBCStorage&lt; GlyphPropertiesEntry &gt; sGlyphPropertiesStore(GlyphPropertiesfmt)</div></div>
<div class="ttc" id="aDBCStructure_8h_html_a0c6f569404777c9ea81a3a0c17bef481"><div class="ttname"><a href="DBCStructure_8h.html#a0c6f569404777c9ea81a3a0c17bef481">MAX_SPELL_TOTEM_CATEGORIES</a></div><div class="ttdeci">#define MAX_SPELL_TOTEM_CATEGORIES</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01814">DBCStructure.h:1814</a></div></div>
<div class="ttc" id="aDBCStructure_8h_html_a7dfd9b5e0adb5c5e3ebf3173f80fbcce"><div class="ttname"><a href="DBCStructure_8h.html#a7dfd9b5e0adb5c5e3ebf3173f80fbcce">MAX_SPELL_REAGENTS</a></div><div class="ttdeci">#define MAX_SPELL_REAGENTS</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01812">DBCStructure.h:1812</a></div></div>
<div class="ttc" id="aDBCStructure_8h_html_aecf32f24cad55cf1076d863d70247894"><div class="ttname"><a href="DBCStructure_8h.html#aecf32f24cad55cf1076d863d70247894">MAX_SPELL_TOTEMS</a></div><div class="ttdeci">#define MAX_SPELL_TOTEMS</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01813">DBCStructure.h:1813</a></div></div>
<div class="ttc" id="aDatabaseEnv_8h_html"><div class="ttname"><a href="DatabaseEnv_8h.html">DatabaseEnv.h</a></div></div>
<div class="ttc" id="aDefine_8h_html_a0bf9964a3ce962c07ad3d8b5432bbbcd"><div class="ttname"><a href="Define_8h.html#a0bf9964a3ce962c07ad3d8b5432bbbcd">int32</a></div><div class="ttdeci">std::int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00112">Define.h:112</a></div></div>
<div class="ttc" id="aDefine_8h_html_a15a8d014fadf85c99a2268d8cbd00767"><div class="ttname"><a href="Define_8h.html#a15a8d014fadf85c99a2268d8cbd00767">uint8</a></div><div class="ttdeci">std::uint8_t uint8</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00118">Define.h:118</a></div></div>
<div class="ttc" id="aDefine_8h_html_a22f78cc9780bf32aff91ae17c3101c8d"><div class="ttname"><a href="Define_8h.html#a22f78cc9780bf32aff91ae17c3101c8d">uint32</a></div><div class="ttdeci">std::uint32_t uint32</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00116">Define.h:116</a></div></div>
<div class="ttc" id="aDefine_8h_html_ac4dd6ce78ce3b840c53bd4b3c63ed09b"><div class="ttname"><a href="Define_8h.html#ac4dd6ce78ce3b840c53bd4b3c63ed09b">uint64</a></div><div class="ttdeci">std::uint64_t uint64</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00115">Define.h:115</a></div></div>
<div class="ttc" id="aDefine_8h_html_ad9c79638db63f1dfe2b085743b5cbf7b"><div class="ttname"><a href="Define_8h.html#ad9c79638db63f1dfe2b085743b5cbf7b">uint16</a></div><div class="ttdeci">std::uint16_t uint16</div><div class="ttdef"><b>Definition:</b> <a href="Define_8h_source.html#l00117">Define.h:117</a></div></div>
<div class="ttc" id="aDynamicObject_8h_html"><div class="ttname"><a href="DynamicObject_8h.html">DynamicObject.h</a></div></div>
<div class="ttc" id="aEntitiesMgr_8h_html_a16d185077e89f6e3983a664727a5f968"><div class="ttname"><a href="EntitiesMgr_8h.html#a16d185077e89f6e3983a664727a5f968">PlayerList</a></div><div class="ttdeci">std::list&lt; Player * &gt; PlayerList</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesMgr_8h_source.html#l00049">EntitiesMgr.h:49</a></div></div>
<div class="ttc" id="aEntitiesMgr_8h_html_a2004a3d83184c385811859562ee39089"><div class="ttname"><a href="EntitiesMgr_8h.html#a2004a3d83184c385811859562ee39089">CreatureList</a></div><div class="ttdeci">std::list&lt; Creature * &gt; CreatureList</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesMgr_8h_source.html#l00046">EntitiesMgr.h:46</a></div></div>
<div class="ttc" id="aEntitiesMgr_8h_html_a9a6023581a510c75fe601cd9d7412f15"><div class="ttname"><a href="EntitiesMgr_8h.html#a9a6023581a510c75fe601cd9d7412f15">GameObjectList</a></div><div class="ttdeci">std::list&lt; GameObject * &gt; GameObjectList</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesMgr_8h_source.html#l00047">EntitiesMgr.h:47</a></div></div>
<div class="ttc" id="aEntitiesMgr_8h_html_abbe331960980fa852a0be15ccebef947"><div class="ttname"><a href="EntitiesMgr_8h.html#abbe331960980fa852a0be15ccebef947">UnitList</a></div><div class="ttdeci">std::list&lt; Unit * &gt; UnitList</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesMgr_8h_source.html#l00045">EntitiesMgr.h:45</a></div></div>
<div class="ttc" id="aEntitiesMgr_8h_html_ac4bbfdc3832b40357f0f08c0e0366bd7"><div class="ttname"><a href="EntitiesMgr_8h.html#ac4bbfdc3832b40357f0f08c0e0366bd7">CorpseList</a></div><div class="ttdeci">std::list&lt; Corpse * &gt; CorpseList</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesMgr_8h_source.html#l00048">EntitiesMgr.h:48</a></div></div>
<div class="ttc" id="aErrors_8h_html_a7b94d20194b84dde056465e12496d3f4"><div class="ttname"><a href="Errors_8h.html#a7b94d20194b84dde056465e12496d3f4">MANGOS_ASSERT</a></div><div class="ttdeci">#define MANGOS_ASSERT</div><div class="ttdef"><b>Definition:</b> <a href="Errors_8h_source.html#l00046">Errors.h:46</a></div></div>
<div class="ttc" id="aGameObject_8h_html_a08733f20cea1f77cc9f1a549f8ce9f07a3e50ac5f6829b981fdff39a85a48959e"><div class="ttname"><a href="GameObject_8h.html#a08733f20cea1f77cc9f1a549f8ce9f07a3e50ac5f6829b981fdff39a85a48959e">GO_ACTIVATED</a></div><div class="ttdeci">@ GO_ACTIVATED</div><div class="ttdef"><b>Definition:</b> <a href="GameObject_8h_source.html#l00699">GameObject.h:699</a></div></div>
<div class="ttc" id="aGridNotifiersImpl_8h_html"><div class="ttname"><a href="GridNotifiersImpl_8h.html">GridNotifiersImpl.h</a></div></div>
<div class="ttc" id="aGridNotifiers_8h_html"><div class="ttname"><a href="GridNotifiers_8h.html">GridNotifiers.h</a></div></div>
<div class="ttc" id="aGroup_8h_html"><div class="ttname"><a href="Group_8h.html">Group.h</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a10e11b09bccd6b87211d851310d1e556a0e2041adefa9c4b36bf9fcc5cc9f6a4f"><div class="ttname"><a href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a0e2041adefa9c4b36bf9fcc5cc9f6a4f">ITEM_SUBCLASS_WEAPON_CROSSBOW</a></div><div class="ttdeci">@ ITEM_SUBCLASS_WEAPON_CROSSBOW</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00340">ItemPrototype.h:340</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a10e11b09bccd6b87211d851310d1e556a109fce85f20ce2e44432377b64a7e02c"><div class="ttname"><a href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556a109fce85f20ce2e44432377b64a7e02c">ITEM_SUBCLASS_WEAPON_GUN</a></div><div class="ttdeci">@ ITEM_SUBCLASS_WEAPON_GUN</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00325">ItemPrototype.h:325</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a10e11b09bccd6b87211d851310d1e556aa314812b34af0583ded09e09f915c9b7"><div class="ttname"><a href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556aa314812b34af0583ded09e09f915c9b7">ITEM_SUBCLASS_WEAPON_BOW</a></div><div class="ttdeci">@ ITEM_SUBCLASS_WEAPON_BOW</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00324">ItemPrototype.h:324</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a10e11b09bccd6b87211d851310d1e556acfba60aacffd401146e4b0eefcb3dc48"><div class="ttname"><a href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556acfba60aacffd401146e4b0eefcb3dc48">ITEM_SUBCLASS_WEAPON_WAND</a></div><div class="ttdeci">@ ITEM_SUBCLASS_WEAPON_WAND</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00341">ItemPrototype.h:341</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a10e11b09bccd6b87211d851310d1e556add7a582e0a83334e929d740fbf31f820"><div class="ttname"><a href="ItemPrototype_8h.html#a10e11b09bccd6b87211d851310d1e556add7a582e0a83334e929d740fbf31f820">ITEM_SUBCLASS_WEAPON_THROWN</a></div><div class="ttdeci">@ ITEM_SUBCLASS_WEAPON_THROWN</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00338">ItemPrototype.h:338</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a2793ea198e8b328078cf49008fa1d5b1a8baed7484de6618b6a471f07ae065e20"><div class="ttname"><a href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1a8baed7484de6618b6a471f07ae065e20">INVTYPE_THROWN</a></div><div class="ttdeci">@ INVTYPE_THROWN</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00259">ItemPrototype.h:259</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a2793ea198e8b328078cf49008fa1d5b1acde5d85868749e487a7662f649df11ad"><div class="ttname"><a href="ItemPrototype_8h.html#a2793ea198e8b328078cf49008fa1d5b1acde5d85868749e487a7662f649df11ad">INVTYPE_AMMO</a></div><div class="ttdeci">@ INVTYPE_AMMO</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00258">ItemPrototype.h:258</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a59f191404caead502059bad31a2ce374a12f6717b2ba149fcefe2c6ea3df0da7c"><div class="ttname"><a href="ItemPrototype_8h.html#a59f191404caead502059bad31a2ce374a12f6717b2ba149fcefe2c6ea3df0da7c">ITEM_SUBCLASS_ARROW</a></div><div class="ttdeci">@ ITEM_SUBCLASS_ARROW</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00390">ItemPrototype.h:390</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a59f191404caead502059bad31a2ce374a5b651314950d95e33ec1081b90eef5ac"><div class="ttname"><a href="ItemPrototype_8h.html#a59f191404caead502059bad31a2ce374a5b651314950d95e33ec1081b90eef5ac">ITEM_SUBCLASS_BULLET</a></div><div class="ttdeci">@ ITEM_SUBCLASS_BULLET</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00391">ItemPrototype.h:391</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_a9e238c2727e820f5207cccdb26e2ce95"><div class="ttname"><a href="ItemPrototype_8h.html#a9e238c2727e820f5207cccdb26e2ce95">MAX_ITEM_PROTO_SPELLS</a></div><div class="ttdeci">#define MAX_ITEM_PROTO_SPELLS</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00586">ItemPrototype.h:586</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_ab76605e05d3b13f61472b9a89cd22a68a93f7b2606e798c614212ace05d2bd52b"><div class="ttname"><a href="ItemPrototype_8h.html#ab76605e05d3b13f61472b9a89cd22a68a93f7b2606e798c614212ace05d2bd52b">ITEM_CLASS_PROJECTILE</a></div><div class="ttdeci">@ ITEM_CLASS_PROJECTILE</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00275">ItemPrototype.h:275</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_ab76605e05d3b13f61472b9a89cd22a68aeaefdfc527a31c7c733104c01368ac2a"><div class="ttname"><a href="ItemPrototype_8h.html#ab76605e05d3b13f61472b9a89cd22a68aeaefdfc527a31c7c733104c01368ac2a">ITEM_CLASS_WEAPON</a></div><div class="ttdeci">@ ITEM_CLASS_WEAPON</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00271">ItemPrototype.h:271</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_ab76605e05d3b13f61472b9a89cd22a68af2ec0a93be80cad30c0131dcd5b7761c"><div class="ttname"><a href="ItemPrototype_8h.html#ab76605e05d3b13f61472b9a89cd22a68af2ec0a93be80cad30c0131dcd5b7761c">ITEM_CLASS_CONSUMABLE</a></div><div class="ttdeci">@ ITEM_CLASS_CONSUMABLE</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00269">ItemPrototype.h:269</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_aeed88091796e82d46e0e5cf43c53b46fa0c78000507aa82285acdf032bc9ee84f"><div class="ttname"><a href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa0c78000507aa82285acdf032bc9ee84f">ITEM_FLAG_IS_MILLABLE</a></div><div class="ttdeci">@ ITEM_FLAG_IS_MILLABLE</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00130">ItemPrototype.h:130</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_aeed88091796e82d46e0e5cf43c53b46fa24970521c3ce1c90018bcafb985b0f46"><div class="ttname"><a href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa24970521c3ce1c90018bcafb985b0f46">ITEM_FLAG_NO_REAGENT_COST</a></div><div class="ttdeci">@ ITEM_FLAG_NO_REAGENT_COST</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00129">ItemPrototype.h:129</a></div></div>
<div class="ttc" id="aItemPrototype_8h_html_aeed88091796e82d46e0e5cf43c53b46fa40ef0669ee302f8c0fed53c60d89b65a"><div class="ttname"><a href="ItemPrototype_8h.html#aeed88091796e82d46e0e5cf43c53b46fa40ef0669ee302f8c0fed53c60d89b65a">ITEM_FLAG_IS_PROSPECTABLE</a></div><div class="ttdeci">@ ITEM_FLAG_IS_PROSPECTABLE</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00119">ItemPrototype.h:119</a></div></div>
<div class="ttc" id="aItem_8h_html_a0f5184076c22295de05457493ab1e476a57d2e5e22d11497cfb9a1cf92c00521c"><div class="ttname"><a href="Item_8h.html#a0f5184076c22295de05457493ab1e476a57d2e5e22d11497cfb9a1cf92c00521c">ITEM_DYNFLAG_UNLOCKED</a></div><div class="ttdeci">@ ITEM_DYNFLAG_UNLOCKED</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00219">Item.h:219</a></div></div>
<div class="ttc" id="aItem_8h_html_a733cdbba8ff15fedfe83704f3cc04838a8f5f4bb2b0cab06350f662261236f3e6"><div class="ttname"><a href="Item_8h.html#a733cdbba8ff15fedfe83704f3cc04838a8f5f4bb2b0cab06350f662261236f3e6">ENCHANTMENT_SOULBOUND</a></div><div class="ttdeci">@ ENCHANTMENT_SOULBOUND</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00190">Item.h:190</a></div></div>
<div class="ttc" id="aItem_8h_html_a73617af2b3e5e935646638fa13678391"><div class="ttname"><a href="Item_8h.html#a73617af2b3e5e935646638fa13678391">InventoryResult</a></div><div class="ttdeci">InventoryResult</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00038">Item.h:39</a></div></div>
<div class="ttc" id="aItem_8h_html_a73617af2b3e5e935646638fa13678391a939b6661cd19d6c18274906abb28021c"><div class="ttname"><a href="Item_8h.html#a73617af2b3e5e935646638fa13678391a939b6661cd19d6c18274906abb28021c">EQUIP_ERR_OK</a></div><div class="ttdeci">@ EQUIP_ERR_OK</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00040">Item.h:40</a></div></div>
<div class="ttc" id="aItem_8h_html_a744ce838494e4dc6eb5f123b9a38bd04a20da1bef68b2abe402a3c2b96e8287af"><div class="ttname"><a href="Item_8h.html#a744ce838494e4dc6eb5f123b9a38bd04a20da1bef68b2abe402a3c2b96e8287af">ITEM_CHANGED</a></div><div class="ttdeci">@ ITEM_CHANGED</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00199">Item.h:199</a></div></div>
<div class="ttc" id="aLog_8h_html"><div class="ttname"><a href="Log_8h.html">Log.h</a></div></div>
<div class="ttc" id="aLog_8h_html_a078dcc01e2d47219e739c5b92ba737e2"><div class="ttname"><a href="Log_8h.html#a078dcc01e2d47219e739c5b92ba737e2">DETAIL_FILTER_LOG</a></div><div class="ttdeci">#define DETAIL_FILTER_LOG(F,...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00256">Log.h:256</a></div></div>
<div class="ttc" id="aLog_8h_html_a21a2c7330a04ac78200a986f66609369"><div class="ttname"><a href="Log_8h.html#a21a2c7330a04ac78200a986f66609369">DEBUG_LOG</a></div><div class="ttdeci">#define DEBUG_LOG(...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00262">Log.h:262</a></div></div>
<div class="ttc" id="aLog_8h_html_ab5487500f5b4b12072043104b916d582"><div class="ttname"><a href="Log_8h.html#ab5487500f5b4b12072043104b916d582">sLog</a></div><div class="ttdeci">#define sLog</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00236">Log.h:236</a></div></div>
<div class="ttc" id="aLog_8h_html_adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798"><div class="ttname"><a href="Log_8h.html#adcb185c96f6828ee86e95abebbc8b46fa103d1be0c2b876d9f9fb5e7388ac8798">LOG_FILTER_SPELL_CAST</a></div><div class="ttdeci">@ LOG_FILTER_SPELL_CAST</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00053">Log.h:53</a></div></div>
<div class="ttc" id="aLog_8h_html_afa7e5c92fdb6f3734f8b4a23aa5c95dc"><div class="ttname"><a href="Log_8h.html#afa7e5c92fdb6f3734f8b4a23aa5c95dc">DEBUG_FILTER_LOG</a></div><div class="ttdeci">#define DEBUG_FILTER_LOG(F,...)</div><div class="ttdef"><b>Definition:</b> <a href="Log_8h_source.html#l00268">Log.h:268</a></div></div>
<div class="ttc" id="aLootMgr_8cpp_html_a433757800c8ee4e9b654d504a4ee828a"><div class="ttname"><a href="LootMgr_8cpp.html#a433757800c8ee4e9b654d504a4ee828a">LootTemplates_Milling</a></div><div class="ttdeci">LootStore LootTemplates_Milling(&quot;milling_loot_template&quot;, &quot;item entry (herb)&quot;, true)</div></div>
<div class="ttc" id="aLootMgr_8cpp_html_a5e98772296a6d93715a4ed74eb2b5bdf"><div class="ttname"><a href="LootMgr_8cpp.html#a5e98772296a6d93715a4ed74eb2b5bdf">LootTemplates_Prospecting</a></div><div class="ttdeci">LootStore LootTemplates_Prospecting(&quot;prospecting_loot_template&quot;, &quot;item entry (ore)&quot;, true)</div></div>
<div class="ttc" id="aLootMgr_8h_html"><div class="ttname"><a href="LootMgr_8h.html">LootMgr.h</a></div></div>
<div class="ttc" id="aObjectAccessor_8h_html"><div class="ttname"><a href="ObjectAccessor_8h.html">ObjectAccessor.h</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_a0d1dd456efeb406c2d571e557c1916bf"><div class="ttname"><a href="ObjectDefines_8h.html#a0d1dd456efeb406c2d571e557c1916bf">MELEE_LEEWAY</a></div><div class="ttdeci">static constexpr float const MELEE_LEEWAY</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00027">ObjectDefines.h:27</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_a31a0b2a8fa9e11ad72229baf2b8759b8"><div class="ttname"><a href="ObjectDefines_8h.html#a31a0b2a8fa9e11ad72229baf2b8759b8">MAX_VISIBILITY_DISTANCE</a></div><div class="ttdeci">static constexpr float const MAX_VISIBILITY_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00032">ObjectDefines.h:32</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_a3b8ab5f5010c80810475c2054abc0cde"><div class="ttname"><a href="ObjectDefines_8h.html#a3b8ab5f5010c80810475c2054abc0cde">DEFAULT_VISIBILITY_DISTANCE</a></div><div class="ttdeci">static constexpr float const DEFAULT_VISIBILITY_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00038">ObjectDefines.h:38</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_a771706b817fb3c23d5f2945264ea6d07"><div class="ttname"><a href="ObjectDefines_8h.html#a771706b817fb3c23d5f2945264ea6d07">CONTACT_DISTANCE</a></div><div class="ttdeci">static constexpr float const CONTACT_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00024">ObjectDefines.h:24</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_aa75f883ff0201abc3089c69d3685e6c2"><div class="ttname"><a href="ObjectDefines_8h.html#aa75f883ff0201abc3089c69d3685e6c2">DEFAULT_VISIBILITY_BGARENAS</a></div><div class="ttdeci">static constexpr float const DEFAULT_VISIBILITY_BGARENAS</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00040">ObjectDefines.h:40</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_ad4d2791434b33b0698c9af2e1ffd81a5"><div class="ttname"><a href="ObjectDefines_8h.html#ad4d2791434b33b0698c9af2e1ffd81a5">INTERACTION_DISTANCE</a></div><div class="ttdeci">static constexpr float const INTERACTION_DISTANCE</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00025">ObjectDefines.h:25</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_ae3422c6c7104690fcfcf1158c4c8abef"><div class="ttname"><a href="ObjectDefines_8h.html#ae3422c6c7104690fcfcf1158c4c8abef">DEFAULT_VISIBILITY_INSTANCE</a></div><div class="ttdeci">static constexpr float const DEFAULT_VISIBILITY_INSTANCE</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00039">ObjectDefines.h:39</a></div></div>
<div class="ttc" id="aObjectDefines_8h_html_af436926bcfdf652a551bcf7ca39604c0"><div class="ttname"><a href="ObjectDefines_8h.html#af436926bcfdf652a551bcf7ca39604c0">AOE_LEEWAY</a></div><div class="ttdeci">static constexpr float const AOE_LEEWAY</div><div class="ttdef"><b>Definition:</b> <a href="ObjectDefines_8h_source.html#l00028">ObjectDefines.h:28</a></div></div>
<div class="ttc" id="aObjectGuid_8h_html"><div class="ttname"><a href="ObjectGuid_8h.html">ObjectGuid.h</a></div></div>
<div class="ttc" id="aObjectGuid_8h_html_a183c40b2ba67065929d70b3987da4cc2a91b74ac7ebfe7909332a6eec5054c60d"><div class="ttname"><a href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a91b74ac7ebfe7909332a6eec5054c60d">TYPEID_GAMEOBJECT</a></div><div class="ttdeci">@ TYPEID_GAMEOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00033">ObjectGuid.h:33</a></div></div>
<div class="ttc" id="aObjectGuid_8h_html_a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9"><div class="ttname"><a href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2a93dfa528ffc48db4993fb7ac62696db9">TYPEID_UNIT</a></div><div class="ttdeci">@ TYPEID_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00031">ObjectGuid.h:31</a></div></div>
<div class="ttc" id="aObjectGuid_8h_html_a183c40b2ba67065929d70b3987da4cc2ab20e64ae3f5f5a5ecffa53fee57d7d2f"><div class="ttname"><a href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2ab20e64ae3f5f5a5ecffa53fee57d7d2f">TYPEID_CORPSE</a></div><div class="ttdeci">@ TYPEID_CORPSE</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00036">ObjectGuid.h:35</a></div></div>
<div class="ttc" id="aObjectGuid_8h_html_a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c"><div class="ttname"><a href="ObjectGuid_8h.html#a183c40b2ba67065929d70b3987da4cc2aca37d750899c40a5743285ccda2bba9c">TYPEID_PLAYER</a></div><div class="ttdeci">@ TYPEID_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00032">ObjectGuid.h:32</a></div></div>
<div class="ttc" id="aObjectMgr_8h_html"><div class="ttname"><a href="ObjectMgr_8h.html">ObjectMgr.h</a></div></div>
<div class="ttc" id="aObjectMgr_8h_html_a736e30da2b5261060ac6cdbb5de3b787"><div class="ttname"><a href="ObjectMgr_8h.html#a736e30da2b5261060ac6cdbb5de3b787">sObjectMgr</a></div><div class="ttdeci">#define sObjectMgr</div><div class="ttdef"><b>Definition:</b> <a href="ObjectMgr_8h_source.html#l01464">ObjectMgr.h:1464</a></div></div>
<div class="ttc" id="aObject_8h_html_a083358a25d084fb928e170c453128f9da139108986e314c8c0a315acb06760742"><div class="ttname"><a href="Object_8h.html#a083358a25d084fb928e170c453128f9da139108986e314c8c0a315acb06760742">MOVEFLAG_FALLINGFAR</a></div><div class="ttdeci">@ MOVEFLAG_FALLINGFAR</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00762">Object.h:762</a></div></div>
<div class="ttc" id="aObject_8h_html_a083358a25d084fb928e170c453128f9dadad97ca67c796fc2a563dd47dd03c5be"><div class="ttname"><a href="Object_8h.html#a083358a25d084fb928e170c453128f9dadad97ca67c796fc2a563dd47dd03c5be">MOVEFLAG_ONTRANSPORT</a></div><div class="ttdeci">@ MOVEFLAG_ONTRANSPORT</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00758">Object.h:758</a></div></div>
<div class="ttc" id="aObject_8h_html_a083358a25d084fb928e170c453128f9daf7b99f828aa60b4dea8dd12382e5b8e6"><div class="ttname"><a href="Object_8h.html#a083358a25d084fb928e170c453128f9daf7b99f828aa60b4dea8dd12382e5b8e6">MOVEFLAG_FALLING</a></div><div class="ttdeci">@ MOVEFLAG_FALLING</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00761">Object.h:761</a></div></div>
<div class="ttc" id="aObject_8h_html_a7ad5ea2fa1d260a4c1ffd0cf9a678771a54404857d1ada8dc6fb419b57c69014c"><div class="ttname"><a href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771a54404857d1ada8dc6fb419b57c69014c">DIST_CALC_COMBAT_REACH</a></div><div class="ttdeci">@ DIST_CALC_COMBAT_REACH</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00079">Object.h:79</a></div></div>
<div class="ttc" id="aObject_8h_html_a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a"><div class="ttname"><a href="Object_8h.html#a7ad5ea2fa1d260a4c1ffd0cf9a678771adb3032bf14065ea838fb4185988a387a">DIST_CALC_NONE</a></div><div class="ttdeci">@ DIST_CALC_NONE</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00077">Object.h:77</a></div></div>
<div class="ttc" id="aOpcodes_8h_html"><div class="ttname"><a href="Opcodes_8h.html">Opcodes.h</a></div></div>
<div class="ttc" id="aPathFinder_8h_html"><div class="ttname"><a href="PathFinder_8h.html">PathFinder.h</a></div></div>
<div class="ttc" id="aPathFinder_8h_html_ae093c9a96eda0463cdd2501ba83f10c3a5ab66bcba6eb689d881b4ebc85188984"><div class="ttname"><a href="PathFinder_8h.html#ae093c9a96eda0463cdd2501ba83f10c3a5ab66bcba6eb689d881b4ebc85188984">PATHFIND_NOPATH</a></div><div class="ttdeci">@ PATHFIND_NOPATH</div><div class="ttdef"><b>Definition:</b> <a href="PathFinder_8h_source.html#l00062">PathFinder.h:62</a></div></div>
<div class="ttc" id="aPathFinder_8h_html_ae093c9a96eda0463cdd2501ba83f10c3a8a25c1fe0f8142291e2183102e647cc2"><div class="ttname"><a href="PathFinder_8h.html#ae093c9a96eda0463cdd2501ba83f10c3a8a25c1fe0f8142291e2183102e647cc2">PATHFIND_SHORT</a></div><div class="ttdeci">@ PATHFIND_SHORT</div><div class="ttdef"><b>Definition:</b> <a href="PathFinder_8h_source.html#l00064">PathFinder.h:64</a></div></div>
<div class="ttc" id="aPet_8h_html"><div class="ttname"><a href="Pet_8h.html">Pet.h</a></div></div>
<div class="ttc" id="aPet_8h_html_a006372e9693754ac0d923d8764ec55fdae55abbb64855962852c91fb8638ad6cd"><div class="ttname"><a href="Pet_8h.html#a006372e9693754ac0d923d8764ec55fdae55abbb64855962852c91fb8638ad6cd">PET_SAVE_NOT_IN_SLOT</a></div><div class="ttdeci">@ PET_SAVE_NOT_IN_SLOT</div><div class="ttdef"><b>Definition:</b> <a href="Pet_8h_source.html#l00046">Pet.h:46</a></div></div>
<div class="ttc" id="aPet_8h_html_aae4a343750f70898b0f6490e7db6a471ae855adcbda374b2c654ae4e9a9bf2ce1"><div class="ttname"><a href="Pet_8h.html#aae4a343750f70898b0f6490e7db6a471ae855adcbda374b2c654ae4e9a9bf2ce1">MINI_PET</a></div><div class="ttdeci">@ MINI_PET</div><div class="ttdef"><b>Definition:</b> <a href="Pet_8h_source.html#l00032">Pet.h:32</a></div></div>
<div class="ttc" id="aPlayer_8h_html"><div class="ttname"><a href="Player_8h.html">Player.h</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a06f492a0a20f5264c8395684220fec84"><div class="ttname"><a href="Player_8h.html#a06f492a0a20f5264c8395684220fec84">ItemPosCountVec</a></div><div class="ttdeci">std::vector&lt; ItemPosCount &gt; ItemPosCountVec</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00727">Player.h:727</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a2377260993cd4a14aaab6f5771385e11"><div class="ttname"><a href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11">RuneType</a></div><div class="ttdeci">RuneType</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00353">Player.h:354</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c"><div class="ttname"><a href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a4e52953e1ef02ede72070ea1231f882c">RUNE_DEATH</a></div><div class="ttdeci">@ RUNE_DEATH</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00358">Player.h:358</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a2377260993cd4a14aaab6f5771385e11a6690183338755f52259fe9eb8332db35"><div class="ttname"><a href="Player_8h.html#a2377260993cd4a14aaab6f5771385e11a6690183338755f52259fe9eb8332db35">NUM_RUNE_TYPES</a></div><div class="ttdeci">@ NUM_RUNE_TYPES</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00360">Player.h:359</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a2a50815668e7443f20a14ff3fa353db4"><div class="ttname"><a href="Player_8h.html#a2a50815668e7443f20a14ff3fa353db4">MAX_RUNES</a></div><div class="ttdeci">#define MAX_RUNES</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00350">Player.h:350</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a41120073d2b85118df1dfb7c61cce5b2"><div class="ttname"><a href="Player_8h.html#a41120073d2b85118df1dfb7c61cce5b2">RUNE_COOLDOWN</a></div><div class="ttdeci">#define RUNE_COOLDOWN</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00351">Player.h:351</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a486dd000e9a9532459d9dd9010570621a0d4e89dc06c8c0976de45352f9800b9b"><div class="ttname"><a href="Player_8h.html#a486dd000e9a9532459d9dd9010570621a0d4e89dc06c8c0976de45352f9800b9b">PLAYER_ALLOW_ONLY_ABILITY</a></div><div class="ttdeci">@ PLAYER_ALLOW_ONLY_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00442">Player.h:442</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a93b8041f948d575ef2d23746324a37afa559e9d51b0cff8ac6448c07e005a13bd"><div class="ttname"><a href="Player_8h.html#a93b8041f948d575ef2d23746324a37afa559e9d51b0cff8ac6448c07e005a13bd">EQUIPMENT_SLOT_MAINHAND</a></div><div class="ttdeci">@ EQUIPMENT_SLOT_MAINHAND</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00642">Player.h:642</a></div></div>
<div class="ttc" id="aPlayer_8h_html_a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a"><div class="ttname"><a href="Player_8h.html#a93b8041f948d575ef2d23746324a37afafc73f33a54a6e48f474648a2ad5bd72a">EQUIPMENT_SLOT_RANGED</a></div><div class="ttdeci">@ EQUIPMENT_SLOT_RANGED</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00644">Player.h:644</a></div></div>
<div class="ttc" id="aPlayer_8h_html_ad8fd978c4198825d89a1f02643d20c62"><div class="ttname"><a href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62">TradeSlots</a></div><div class="ttdeci">TradeSlots</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00729">Player.h:730</a></div></div>
<div class="ttc" id="aPlayer_8h_html_ad8fd978c4198825d89a1f02643d20c62a1e8d56a5a22d784c5d388fd8bd206488"><div class="ttname"><a href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62a1e8d56a5a22d784c5d388fd8bd206488">TRADE_SLOT_COUNT</a></div><div class="ttdeci">@ TRADE_SLOT_COUNT</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00731">Player.h:731</a></div></div>
<div class="ttc" id="aPlayer_8h_html_ad8fd978c4198825d89a1f02643d20c62abdab7c30065c4b145dd2e6ce0e27c45f"><div class="ttname"><a href="Player_8h.html#ad8fd978c4198825d89a1f02643d20c62abdab7c30065c4b145dd2e6ce0e27c45f">TRADE_SLOT_NONTRADED</a></div><div class="ttdeci">@ TRADE_SLOT_NONTRADED</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00734">Player.h:733</a></div></div>
<div class="ttc" id="aPlayer_8h_html_aeba4f8d5fc0fa3fd00538df69077ba55a1a8411f74fdb6a5715ed8cfca6b96a50"><div class="ttname"><a href="Player_8h.html#aeba4f8d5fc0fa3fd00538df69077ba55a1a8411f74fdb6a5715ed8cfca6b96a50">PLAYERSPELL_REMOVED</a></div><div class="ttdeci">@ PLAYERSPELL_REMOVED</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00109">Player.h:108</a></div></div>
<div class="ttc" id="aSQLStorages_8cpp_html_a6e07b93ae2737d35f4214041a6f735f4"><div class="ttname"><a href="SQLStorages_8cpp.html#a6e07b93ae2737d35f4214041a6f735f4">sSpellTemplate</a></div><div class="ttdeci">SQLStorage sSpellTemplate(SpellEntryfmt, &quot;id&quot;, &quot;spell_template&quot;)</div></div>
<div class="ttc" id="aSQLStorages_8cpp_html_a80fcb422402f1dd5f21967ad405f5014"><div class="ttname"><a href="SQLStorages_8cpp.html#a80fcb422402f1dd5f21967ad405f5014">sSpellScriptTargetStorage</a></div><div class="ttdeci">SQLMultiStorage sSpellScriptTargetStorage(SpellScriptTargetFmt, &quot;entry&quot;, &quot;spell_script_target&quot;)</div></div>
<div class="ttc" id="aSQLStorages_8cpp_html_aa0e50246fb55cfde84721af130ade66a"><div class="ttname"><a href="SQLStorages_8cpp.html#aa0e50246fb55cfde84721af130ade66a">sSpellCones</a></div><div class="ttdeci">SQLStorage sSpellCones(SpellConefmt, &quot;id&quot;, &quot;spell_cone&quot;)</div></div>
<div class="ttc" id="aSQLStorages_8h_html"><div class="ttname"><a href="SQLStorages_8h.html">SQLStorages.h</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html"><div class="ttname"><a href="SharedDefines_8h.html">SharedDefines.h</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0233096c29a8a39f15373e06434985f9afd1b3271e7a9e6205d5f1dab1d34610f"><div class="ttname"><a href="SharedDefines_8h.html#a0233096c29a8a39f15373e06434985f9afd1b3271e7a9e6205d5f1dab1d34610f">GAMEOBJECT_TYPE_DESTRUCTIBLE_BUILDING</a></div><div class="ttdeci">@ GAMEOBJECT_TYPE_DESTRUCTIBLE_BUILDING</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00592">SharedDefines.h:592</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0b496ae912a68ca7a6f8fd555cf62437aca618c5b7ae69c151ea4da7955578b02"><div class="ttname"><a href="SharedDefines_8h.html#a0b496ae912a68ca7a6f8fd555cf62437aca618c5b7ae69c151ea4da7955578b02">ENCOUNTER_CREDIT_CAST_SPELL</a></div><div class="ttdeci">@ ENCOUNTER_CREDIT_CAST_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02191">SharedDefines.h:2191</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a0f323c1b17777bed7ec77789ee6642c2a3f4a9671aaf4bc04157666f4f08be8f8"><div class="ttname"><a href="SharedDefines_8h.html#a0f323c1b17777bed7ec77789ee6642c2a3f4a9671aaf4bc04157666f4f08be8f8">AREA_LOCKSTATUS_OK</a></div><div class="ttdeci">@ AREA_LOCKSTATUS_OK</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02220">SharedDefines.h:2220</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a1d74b2169d9a060490d81975a3064f50"><div class="ttname"><a href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50">DiminishingGroup</a></div><div class="ttdeci">DiminishingGroup</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01834">SharedDefines.h:1835</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c"><div class="ttname"><a href="SharedDefines_8h.html#a1d74b2169d9a060490d81975a3064f50a463a6938a384ecb8e81ea00f8a66a85c">DIMINISHING_NONE</a></div><div class="ttdeci">@ DIMINISHING_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01837">SharedDefines.h:1837</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a25263e3e283b54e5280d5af1fd16da4c"><div class="ttname"><a href="SharedDefines_8h.html#a25263e3e283b54e5280d5af1fd16da4c">SpellSchools</a></div><div class="ttdeci">SpellSchools</div><div class="ttdoc">The different spell schools that are available, used in both damage calculation and spell casting to ...</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00173">SharedDefines.h:174</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67"><div class="ttname"><a href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa052681ec165e5b5e3edcf2089607ae67">OFF_ATTACK</a></div><div class="ttdeci">@ OFF_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00480">SharedDefines.h:480</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae"><div class="ttname"><a href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aa5145c1138a6f21d47061e9015e07a3ae">BASE_ATTACK</a></div><div class="ttdeci">@ BASE_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00479">SharedDefines.h:479</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670"><div class="ttname"><a href="SharedDefines_8h.html#a2a35652af7129b6f139b0f7a2af1876aaa2557af152c5f2b27bbf59915cbd1670">RANGED_ATTACK</a></div><div class="ttdeci">@ RANGED_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00482">SharedDefines.h:481</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a3002b6959a1e2bc149144b9ae9a9728c"><div class="ttname"><a href="SharedDefines_8h.html#a3002b6959a1e2bc149144b9ae9a9728c">CLASSMASK_WAND_USERS</a></div><div class="ttdeci">#define CLASSMASK_WAND_USERS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00110">SharedDefines.h:110</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a3194644c6ed7acd85ec8eb1b98821b8ea03702a6fae99a6fc1b0ebf339a86865e"><div class="ttname"><a href="SharedDefines_8h.html#a3194644c6ed7acd85ec8eb1b98821b8ea03702a6fae99a6fc1b0ebf339a86865e">SPELL_PREVENTION_TYPE_SILENCE</a></div><div class="ttdeci">@ SPELL_PREVENTION_TYPE_SILENCE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00524">SharedDefines.h:524</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a3194644c6ed7acd85ec8eb1b98821b8ea36d609ad404c7522db727505ad528c51"><div class="ttname"><a href="SharedDefines_8h.html#a3194644c6ed7acd85ec8eb1b98821b8ea36d609ad404c7522db727505ad528c51">SPELL_PREVENTION_TYPE_PACIFY</a></div><div class="ttdeci">@ SPELL_PREVENTION_TYPE_PACIFY</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00526">SharedDefines.h:525</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a4ba1ab72fa9ab5b52fcda8906105c08fa12667dd3f55738c93e1ddb1351779b42"><div class="ttname"><a href="SharedDefines_8h.html#a4ba1ab72fa9ab5b52fcda8906105c08fa12667dd3f55738c93e1ddb1351779b42">SPELL_SCHOOL_MASK_NORMAL</a></div><div class="ttdeci">@ SPELL_SCHOOL_MASK_NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00192">SharedDefines.h:192</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a5893ac36dd21da7bcd19a505205ea180"><div class="ttname"><a href="SharedDefines_8h.html#a5893ac36dd21da7bcd19a505205ea180">LockType</a></div><div class="ttdeci">LockType</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01215">SharedDefines.h:1216</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a5893ac36dd21da7bcd19a505205ea180a20663fe7fe377ced1724452b0108af51"><div class="ttname"><a href="SharedDefines_8h.html#a5893ac36dd21da7bcd19a505205ea180a20663fe7fe377ced1724452b0108af51">LOCKTYPE_DISARM_TRAP</a></div><div class="ttdeci">@ LOCKTYPE_DISARM_TRAP</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01221">SharedDefines.h:1221</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a5bc40f1116d89138cda8ebd1a04694dfa90dea51445e88ead6218aa0a5a5e4344"><div class="ttname"><a href="SharedDefines_8h.html#a5bc40f1116d89138cda8ebd1a04694dfa90dea51445e88ead6218aa0a5a5e4344">CREATURE_TYPE_UNDEAD</a></div><div class="ttdeci">@ CREATURE_TYPE_UNDEAD</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01259">SharedDefines.h:1259</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a6606234724aae83ff057f648f96c2ada"><div class="ttname"><a href="SharedDefines_8h.html#a6606234724aae83ff057f648f96c2ada">GetFirstSchoolInMask</a></div><div class="ttdeci">SpellSchools GetFirstSchoolInMask(SpellSchoolMask mask)</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00236">SharedDefines.h:236</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7443b708d5bd7312fc0a420679ae10a4a26638bd2ee5365a4b278420b7dc66956"><div class="ttname"><a href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a26638bd2ee5365a4b278420b7dc66956">SPELL_DAMAGE_CLASS_RANGED</a></div><div class="ttdeci">@ SPELL_DAMAGE_CLASS_RANGED</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00519">SharedDefines.h:518</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7443b708d5bd7312fc0a420679ae10a4a44c25232e532dcd5a47b225f2e531093"><div class="ttname"><a href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a44c25232e532dcd5a47b225f2e531093">SPELL_DAMAGE_CLASS_MAGIC</a></div><div class="ttdeci">@ SPELL_DAMAGE_CLASS_MAGIC</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00516">SharedDefines.h:516</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7443b708d5bd7312fc0a420679ae10a4a5aee25f13be5fe04f98537e1da06a615"><div class="ttname"><a href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4a5aee25f13be5fe04f98537e1da06a615">SPELL_DAMAGE_CLASS_NONE</a></div><div class="ttdeci">@ SPELL_DAMAGE_CLASS_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00515">SharedDefines.h:515</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7443b708d5bd7312fc0a420679ae10a4ad6e0146bc0d96e2ff12e902b53a29fe3"><div class="ttname"><a href="SharedDefines_8h.html#a7443b708d5bd7312fc0a420679ae10a4ad6e0146bc0d96e2ff12e902b53a29fe3">SPELL_DAMAGE_CLASS_MELEE</a></div><div class="ttdeci">@ SPELL_DAMAGE_CLASS_MELEE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00517">SharedDefines.h:517</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a78fcc691229c7bc57dff4fcb8d744f1b"><div class="ttname"><a href="SharedDefines_8h.html#a78fcc691229c7bc57dff4fcb8d744f1b">MAX_POWERS</a></div><div class="ttdeci">#define MAX_POWERS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00163">SharedDefines.h:163</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fa0756188c4255061315a9172a12eace4a"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa0756188c4255061315a9172a12eace4a">PETTAME_CREATUREALREADYOWNED</a></div><div class="ttdeci">@ PETTAME_CREATUREALREADYOWNED</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02134">SharedDefines.h:2134</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fa2221baaca0a792d55236f5a502517956"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa2221baaca0a792d55236f5a502517956">PETTAME_DEAD</a></div><div class="ttdeci">@ PETTAME_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02141">SharedDefines.h:2141</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fa2677a8f323ffd8e91068f897d112c826"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa2677a8f323ffd8e91068f897d112c826">PETTAME_UNITSCANTTAME</a></div><div class="ttdeci">@ PETTAME_UNITSCANTTAME</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02137">SharedDefines.h:2137</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fa356ff068f2e441e3a1899031a405bce4"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa356ff068f2e441e3a1899031a405bce4">PETTAME_NOTTAMEABLE</a></div><div class="ttdeci">@ PETTAME_NOTTAMEABLE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02135">SharedDefines.h:2135</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fa730c5ae2ccd2cd5abf9de16c78a89175"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa730c5ae2ccd2cd5abf9de16c78a89175">PETTAME_CANTCONTROLEXOTIC</a></div><div class="ttdeci">@ PETTAME_CANTCONTROLEXOTIC</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02143">SharedDefines.h:2143</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fa8eb9f589293d6756399e98596c8583eb"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fa8eb9f589293d6756399e98596c8583eb">PETTAME_UNKNOWNERROR</a></div><div class="ttdeci">@ PETTAME_UNKNOWNERROR</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02145">SharedDefines.h:2144</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154faa6e6ed17785e5c16d1944dd8770688b6"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154faa6e6ed17785e5c16d1944dd8770688b6">PETTAME_TOOHIGHLEVEL</a></div><div class="ttdeci">@ PETTAME_TOOHIGHLEVEL</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02140">SharedDefines.h:2140</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fab38e2c8f7365784032dad0dac40ac7de"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fab38e2c8f7365784032dad0dac40ac7de">PETTAME_NOTDEAD</a></div><div class="ttdeci">@ PETTAME_NOTDEAD</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02142">SharedDefines.h:2142</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7b8070e848865ee8e772755cf209154fad714798a413a2ddcdcbb9ce9ec83357b"><div class="ttname"><a href="SharedDefines_8h.html#a7b8070e848865ee8e772755cf209154fad714798a413a2ddcdcbb9ce9ec83357b">PETTAME_ANOTHERSUMMONACTIVE</a></div><div class="ttdeci">@ PETTAME_ANOTHERSUMMONACTIVE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02136">SharedDefines.h:2136</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7bd0d3f34feccd7870d260f3b1d4aad4a04bac8c77c91ae5973d441d8cab5dcc7"><div class="ttname"><a href="SharedDefines_8h.html#a7bd0d3f34feccd7870d260f3b1d4aad4a04bac8c77c91ae5973d441d8cab5dcc7">LOCK_KEY_ITEM</a></div><div class="ttdeci">@ LOCK_KEY_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01210">SharedDefines.h:1210</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a7bd0d3f34feccd7870d260f3b1d4aad4ac6bd1369cde2ea38f6b9e4a218657f0d"><div class="ttname"><a href="SharedDefines_8h.html#a7bd0d3f34feccd7870d260f3b1d4aad4ac6bd1369cde2ea38f6b9e4a218657f0d">LOCK_KEY_SKILL</a></div><div class="ttdeci">@ LOCK_KEY_SKILL</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01211">SharedDefines.h:1211</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa1c7c740a229946b31a477913e2e38fd8"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa1c7c740a229946b31a477913e2e38fd8">CLASS_HUNTER</a></div><div class="ttdeci">@ CLASS_HUNTER</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00082">SharedDefines.h:82</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa312316ea844ad336fad9eb5a00348636"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa312316ea844ad336fad9eb5a00348636">CLASS_DRUID</a></div><div class="ttdeci">@ CLASS_DRUID</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00090">SharedDefines.h:90</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa3e5a6df9e9af2516746e51a4a03062a1"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa3e5a6df9e9af2516746e51a4a03062a1">CLASS_SHAMAN</a></div><div class="ttdeci">@ CLASS_SHAMAN</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00086">SharedDefines.h:86</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa59ec961e807113e366431dfb1b0d5fcc"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa59ec961e807113e366431dfb1b0d5fcc">CLASS_PRIEST</a></div><div class="ttdeci">@ CLASS_PRIEST</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00084">SharedDefines.h:84</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa679de5e410197d42cea53f371aba7f59"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa679de5e410197d42cea53f371aba7f59">CLASS_WARRIOR</a></div><div class="ttdeci">@ CLASS_WARRIOR</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00080">SharedDefines.h:80</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa72922255ea5f13ce70f2c5cec3e33369"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa72922255ea5f13ce70f2c5cec3e33369">CLASS_WARLOCK</a></div><div class="ttdeci">@ CLASS_WARLOCK</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00088">SharedDefines.h:88</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa753aca2f522c3d903449c3f79244a63f"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa753aca2f522c3d903449c3f79244a63f">CLASS_MAGE</a></div><div class="ttdeci">@ CLASS_MAGE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00087">SharedDefines.h:87</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfa7f7b30426fd386c181799196c1739058">CLASS_DEATH_KNIGHT</a></div><div class="ttdeci">@ CLASS_DEATH_KNIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00085">SharedDefines.h:85</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfaaaf23b801cec5bfa54bd93650af67128"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfaaaf23b801cec5bfa54bd93650af67128">CLASS_PALADIN</a></div><div class="ttdeci">@ CLASS_PALADIN</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00081">SharedDefines.h:81</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a86e4e3df7a5142175aa5df522d3346cfac6e894dcb39c03655545f42f6c39d454"><div class="ttname"><a href="SharedDefines_8h.html#a86e4e3df7a5142175aa5df522d3346cfac6e894dcb39c03655545f42f6c39d454">CLASS_ROGUE</a></div><div class="ttdeci">@ CLASS_ROGUE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00083">SharedDefines.h:83</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27">Powers</a></div><div class="ttdeci">Powers</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00151">SharedDefines.h:152</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27a1b514bf3a42e9a5dc4271bd25b7dce7e"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a1b514bf3a42e9a5dc4271bd25b7dce7e">POWER_RAGE</a></div><div class="ttdeci">@ POWER_RAGE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00154">SharedDefines.h:154</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a46379b081e66f0ab034f94a9f5dbad22">POWER_HEALTH</a></div><div class="ttdeci">@ POWER_HEALTH</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00161">SharedDefines.h:160</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27a4c504424e60c95f01e0ec1468a52d221"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a4c504424e60c95f01e0ec1468a52d221">POWER_RUNIC_POWER</a></div><div class="ttdeci">@ POWER_RUNIC_POWER</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00159">SharedDefines.h:159</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27a50639b61f76392c0af9c99462b1cba35"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a50639b61f76392c0af9c99462b1cba35">POWER_HAPPINESS</a></div><div class="ttdeci">@ POWER_HAPPINESS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00157">SharedDefines.h:157</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27a535f3e3322566811e43bef82808b5288"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27a535f3e3322566811e43bef82808b5288">POWER_ENERGY</a></div><div class="ttdeci">@ POWER_ENERGY</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00156">SharedDefines.h:156</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ab3e4f73d6494c917b99431bae75a4d5f">POWER_MANA</a></div><div class="ttdeci">@ POWER_MANA</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00153">SharedDefines.h:153</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27ad2662f90ffd864b9483e8265c2cc08df"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27ad2662f90ffd864b9483e8265c2cc08df">POWER_RUNE</a></div><div class="ttdeci">@ POWER_RUNE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00158">SharedDefines.h:158</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8aa413c82fd7553d24fcd515335f1f27adf1e2c1dbfbecd82a3bdcef559ac8cc3"><div class="ttname"><a href="SharedDefines_8h.html#a8aa413c82fd7553d24fcd515335f1f27adf1e2c1dbfbecd82a3bdcef559ac8cc3">POWER_FOCUS</a></div><div class="ttdeci">@ POWER_FOCUS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00155">SharedDefines.h:155</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_a8e779c285da3368f4301e8ff21653960ac22ac2f620eb2d8c0eb3d3161a04113d"><div class="ttname"><a href="SharedDefines_8h.html#a8e779c285da3368f4301e8ff21653960ac22ac2f620eb2d8c0eb3d3161a04113d">TOTEM_SLOT_FIRE</a></div><div class="ttdeci">@ TOTEM_SLOT_FIRE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02150">SharedDefines.h:2150</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ab1b67dd15f243c850f589f66747e547caa28b6421a1efdc3a6377c480e1f80809"><div class="ttname"><a href="SharedDefines_8h.html#ab1b67dd15f243c850f589f66747e547caa28b6421a1efdc3a6377c480e1f80809">FORM_CAT</a></div><div class="ttdeci">@ FORM_CAT</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01872">SharedDefines.h:1872</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ab2b0211558cbc166b3bccd39444b95f0"><div class="ttname"><a href="SharedDefines_8h.html#ab2b0211558cbc166b3bccd39444b95f0">TotemCategory</a></div><div class="ttdeci">TotemCategory</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01644">SharedDefines.h:1645</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ab804ff2a65c41112bfa1774811d79b26a3d355edb9318b2055f84fdb987832c41"><div class="ttname"><a href="SharedDefines_8h.html#ab804ff2a65c41112bfa1774811d79b26a3d355edb9318b2055f84fdb987832c41">SPELL_HIT_TYPE_CRIT</a></div><div class="ttdeci">@ SPELL_HIT_TYPE_CRIT</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00506">SharedDefines.h:506</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_abb1a2beaa12ca034ba4388d83708a89dabfea4f1275e85265f1637b0f1123389d"><div class="ttname"><a href="SharedDefines_8h.html#abb1a2beaa12ca034ba4388d83708a89dabfea4f1275e85265f1637b0f1123389d">GO_FLAG_IN_USE</a></div><div class="ttdeci">@ GO_FLAG_IN_USE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00601">SharedDefines.h:601</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65a"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65a">SpellMissInfo</a></div><div class="ttdeci">SpellMissInfo</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00487">SharedDefines.h:488</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa1c71c106427627a9403f8a338e929d27"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa1c71c106427627a9403f8a338e929d27">SPELL_MISS_PARRY</a></div><div class="ttdeci">@ SPELL_MISS_PARRY</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00493">SharedDefines.h:493</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa2d810d137e753f560f2a4fe71841899f">SPELL_MISS_IMMUNE</a></div><div class="ttdeci">@ SPELL_MISS_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00496">SharedDefines.h:496</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa3d25ac2e6bf2195d7f10f70d1c07c809"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa3d25ac2e6bf2195d7f10f70d1c07c809">SPELL_MISS_DODGE</a></div><div class="ttdeci">@ SPELL_MISS_DODGE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00492">SharedDefines.h:492</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa4f14819249f6154bab64ccae4c0bf0c5"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa4f14819249f6154bab64ccae4c0bf0c5">SPELL_MISS_IMMUNE2</a></div><div class="ttdeci">@ SPELL_MISS_IMMUNE2</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00497">SharedDefines.h:497</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa893d017f010f243616e70394c7fec096">SPELL_MISS_NONE</a></div><div class="ttdeci">@ SPELL_MISS_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00489">SharedDefines.h:489</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa8ccbb0208849d542de83f9b638e877ea"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa8ccbb0208849d542de83f9b638e877ea">SPELL_MISS_RESIST</a></div><div class="ttdeci">@ SPELL_MISS_RESIST</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00491">SharedDefines.h:491</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aa92c5d2d6d9802d16764163ddfc01c364"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aa92c5d2d6d9802d16764163ddfc01c364">SPELL_MISS_MISS</a></div><div class="ttdeci">@ SPELL_MISS_MISS</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00490">SharedDefines.h:490</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aab385a91257c762e8ab30ee5ec4a619c7"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aab385a91257c762e8ab30ee5ec4a619c7">SPELL_MISS_EVADE</a></div><div class="ttdeci">@ SPELL_MISS_EVADE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00495">SharedDefines.h:495</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aae656c2c9239cd191f25c0c3c626744d4">SPELL_MISS_REFLECT</a></div><div class="ttdeci">@ SPELL_MISS_REFLECT</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00501">SharedDefines.h:500</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac42174a036914cd9ca25c52e98bef65aafcddc76d7d93f87266de9113d8402150"><div class="ttname"><a href="SharedDefines_8h.html#ac42174a036914cd9ca25c52e98bef65aafcddc76d7d93f87266de9113d8402150">SPELL_MISS_DEFLECT</a></div><div class="ttdeci">@ SPELL_MISS_DEFLECT</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00498">SharedDefines.h:498</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac44d0318ef3e26ca5366bb81f4c77956a9c4178348ebd97182ee9ef7b952fa691"><div class="ttname"><a href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956a9c4178348ebd97182ee9ef7b952fa691">SPELL_RANGE_FLAG_RANGED</a></div><div class="ttdeci">@ SPELL_RANGE_FLAG_RANGED</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00540">SharedDefines.h:540</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ac44d0318ef3e26ca5366bb81f4c77956af4dafe2c07c14ff50816f52540465e45"><div class="ttname"><a href="SharedDefines_8h.html#ac44d0318ef3e26ca5366bb81f4c77956af4dafe2c07c14ff50816f52540465e45">SPELL_RANGE_FLAG_MELEE</a></div><div class="ttdeci">@ SPELL_RANGE_FLAG_MELEE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00539">SharedDefines.h:539</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad2aeb5ae42fe35df2fb10f017c9eed66a91b90a0714fac244c510d1bcde9456a9"><div class="ttname"><a href="SharedDefines_8h.html#ad2aeb5ae42fe35df2fb10f017c9eed66a91b90a0714fac244c510d1bcde9456a9">MECHANIC_BANDAGE</a></div><div class="ttdeci">@ MECHANIC_BANDAGE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00385">SharedDefines.h:385</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ad2aeb5ae42fe35df2fb10f017c9eed66ae896bc0b0a0eb3df2b85c317074e3383"><div class="ttname"><a href="SharedDefines_8h.html#ad2aeb5ae42fe35df2fb10f017c9eed66ae896bc0b0a0eb3df2b85c317074e3383">MECHANIC_SHIELD</a></div><div class="ttdeci">@ MECHANIC_SHIELD</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00388">SharedDefines.h:388</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_ae2da0a82ea63b2ca1010424c11aeb2c8"><div class="ttname"><a href="SharedDefines_8h.html#ae2da0a82ea63b2ca1010424c11aeb2c8">SkillByLockType</a></div><div class="ttdeci">SkillType SkillByLockType(LockType locktype)</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01618">SharedDefines.h:1618</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234">SkillType</a></div><div class="ttdeci">SkillType</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01460">SharedDefines.h:1461</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234a09ffe4e99e7854f73a28ed106ebb90e2"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a09ffe4e99e7854f73a28ed106ebb90e2">SKILL_INSCRIPTION</a></div><div class="ttdeci">@ SKILL_INSCRIPTION</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01600">SharedDefines.h:1600</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234a77d73a39948d0b12d05f2a8431738b95"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a77d73a39948d0b12d05f2a8431738b95">SKILL_MINING</a></div><div class="ttdeci">@ SKILL_MINING</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01517">SharedDefines.h:1517</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234a91ab54f2f2d5f62473324790d2678324"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a91ab54f2f2d5f62473324790d2678324">SKILL_RIDING</a></div><div class="ttdeci">@ SKILL_RIDING</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01589">SharedDefines.h:1589</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234a984419a280ad5111b03d5d5ecdcd9a0f"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234a984419a280ad5111b03d5d5ecdcd9a0f">SKILL_NONE</a></div><div class="ttdeci">@ SKILL_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01462">SharedDefines.h:1462</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234aeb1f5d58fca5c46b87ad0944191ed916"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234aeb1f5d58fca5c46b87ad0944191ed916">SKILL_ENCHANTING</a></div><div class="ttdeci">@ SKILL_ENCHANTING</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01552">SharedDefines.h:1552</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234aebd6721b790c2f7357ff4eb51db1f127"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234aebd6721b790c2f7357ff4eb51db1f127">SKILL_JEWELCRAFTING</a></div><div class="ttdeci">@ SKILL_JEWELCRAFTING</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01583">SharedDefines.h:1583</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af4541d30ebbff76b1f9f689519789234af833460db5b970aa092fb57e38593ba9"><div class="ttname"><a href="SharedDefines_8h.html#af4541d30ebbff76b1f9f689519789234af833460db5b970aa092fb57e38593ba9">SKILL_HERBALISM</a></div><div class="ttdeci">@ SKILL_HERBALISM</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l01513">SharedDefines.h:1513</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_af5bcca146183dc0013aeea53f940d121af45ce69153311c323432adb88af93c81"><div class="ttname"><a href="SharedDefines_8h.html#af5bcca146183dc0013aeea53f940d121af45ce69153311c323432adb88af93c81">CREATURE_LOOT_STATUS_LOOTED</a></div><div class="ttdeci">@ CREATURE_LOOT_STATUS_LOOTED</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l02293">SharedDefines.h:2293</a></div></div>
<div class="ttc" id="aSharedDefines_8h_html_aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54"><div class="ttname"><a href="SharedDefines_8h.html#aff59f402d05917ab1de0c5f6bf148ea4a9308d3cdd6446af40814a12302809f54">SPELL_DIRECT_DAMAGE</a></div><div class="ttdeci">@ SPELL_DIRECT_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SharedDefines_8h_source.html#l00546">SharedDefines.h:546</a></div></div>
<div class="ttc" id="aSingleton_8h_html"><div class="ttname"><a href="Singleton_8h.html">Singleton.h</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a2d156c8f34440e83664b185be1b851b8"><div class="ttname"><a href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8">AuraState</a></div><div class="ttdeci">AuraState</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00467">SpellAuraDefines.h:468</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a2d156c8f34440e83664b185be1b851b8a2d367a773fa7878bff424e1c11aa2906"><div class="ttname"><a href="SpellAuraDefines_8h.html#a2d156c8f34440e83664b185be1b851b8a2d367a773fa7878bff424e1c11aa2906">AURA_STATE_FROZEN</a></div><div class="ttdeci">@ AURA_STATE_FROZEN</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00474">SpellAuraDefines.h:474</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799">AuraType</a></div><div class="ttdeci">AuraType</div><div class="ttdoc">This is what's used in a Modifier by the Aura class to tell what the Aura should modify.</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00041">SpellAuraDefines.h:42</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a007ec89b67aa5358a7da6c3dd899e4d2"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a007ec89b67aa5358a7da6c3dd899e4d2">SPELL_AURA_PREVENT_RESURRECTION</a></div><div class="ttdeci">@ SPELL_AURA_PREVENT_RESURRECTION</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00450">SpellAuraDefines.h:450</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a1c3516bb8442ba5d970c928ffc976689"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1c3516bb8442ba5d970c928ffc976689">SPELL_AURA_MOD_SHAPESHIFT</a></div><div class="ttdeci">@ SPELL_AURA_MOD_SHAPESHIFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00172">SpellAuraDefines.h:172</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a1e21f5318c8c9e357646f5791c1e69ea"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1e21f5318c8c9e357646f5791c1e69ea">SPELL_AURA_MIRROR_IMAGE</a></div><div class="ttdeci">@ SPELL_AURA_MIRROR_IMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00383">SpellAuraDefines.h:383</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a1e7e5c8d0e92113d05321ff57d81578b"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a1e7e5c8d0e92113d05321ff57d81578b">SPELL_AURA_MOD_DISARM</a></div><div class="ttdeci">@ SPELL_AURA_MOD_DISARM</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00203">SpellAuraDefines.h:203</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a2b7765cedd0bccc0e79d4281e871dee0"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a2b7765cedd0bccc0e79d4281e871dee0">SPELL_AURA_MOD_IGNORE_SHAPESHIFT</a></div><div class="ttdeci">@ SPELL_AURA_MOD_IGNORE_SHAPESHIFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00411">SpellAuraDefines.h:411</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a2eb3f6e6a49bc0b70fa9726b1fa12bb3"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a2eb3f6e6a49bc0b70fa9726b1fa12bb3">SPELL_AURA_PERIODIC_MANA_LEECH</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_MANA_LEECH</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00200">SpellAuraDefines.h:200</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a30ae3c9499778cc5f920e81dc86cd020"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a30ae3c9499778cc5f920e81dc86cd020">SPELL_AURA_MOD_POSSESS_PET</a></div><div class="ttdeci">@ SPELL_AURA_MOD_POSSESS_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00264">SpellAuraDefines.h:264</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a38d26a7bb616c3ee2b31ff72e98ffd71"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a38d26a7bb616c3ee2b31ff72e98ffd71">SPELL_AURA_RANGED_ATTACK_POWER_ATTACKER_BONUS</a></div><div class="ttdeci">@ SPELL_AURA_RANGED_ATTACK_POWER_ATTACKER_BONUS</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00263">SpellAuraDefines.h:263</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a39ea3fa62739b733008d71ebe24a0842"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a39ea3fa62739b733008d71ebe24a0842">SPELL_AURA_ABILITY_CONSUME_NO_AMMO</a></div><div class="ttdeci">@ SPELL_AURA_ABILITY_CONSUME_NO_AMMO</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00410">SpellAuraDefines.h:410</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a409384ae03726c8805f7148ce3867853"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a409384ae03726c8805f7148ce3867853">SPELL_AURA_HASTE_SPELLS</a></div><div class="ttdeci">@ SPELL_AURA_HASTE_SPELLS</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00352">SpellAuraDefines.h:352</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a44cf043145f5a78c5a4e36ecff8a034d"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a44cf043145f5a78c5a4e36ecff8a034d">SPELL_AURA_MOD_FEAR</a></div><div class="ttdeci">@ SPELL_AURA_MOD_FEAR</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00063">SpellAuraDefines.h:63</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a583bf7e94825b7252010ad12dd50ed6f">SPELL_AURA_CONTROL_VEHICLE</a></div><div class="ttdeci">@ SPELL_AURA_CONTROL_VEHICLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00372">SpellAuraDefines.h:372</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a5b09d71c8d286bff5c7cfd7ccec9a5f3"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a5b09d71c8d286bff5c7cfd7ccec9a5f3">SPELL_AURA_SPIRIT_OF_REDEMPTION</a></div><div class="ttdeci">@ SPELL_AURA_SPIRIT_OF_REDEMPTION</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00312">SpellAuraDefines.h:312</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a6442a4a379f82e2f08734296e1e21c9f"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6442a4a379f82e2f08734296e1e21c9f">SPELL_AURA_PERIODIC_HEAL</a></div><div class="ttdeci">@ SPELL_AURA_PERIODIC_HEAL</div><div class="ttdoc">The aura will do periodic heals of a target, handled by Aura::HandlePeriodicHeal, uses Unit::SpellHea...</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00069">SpellAuraDefines.h:69</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a66cca11731d68512cb0bb652cb1e7caf">SPELL_AURA_DUMMY</a></div><div class="ttdeci">@ SPELL_AURA_DUMMY</div><div class="ttdoc">Used by Aura::HandleAuraDummy.</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00056">SpellAuraDefines.h:56</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a6b0ccd5195567a4744da1763b92159e3"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6b0ccd5195567a4744da1763b92159e3">SPELL_AURA_FLY</a></div><div class="ttdeci">@ SPELL_AURA_FLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00337">SpellAuraDefines.h:337</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a6c38d7d76b8741d45023a0ccc3c0f9b3"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6c38d7d76b8741d45023a0ccc3c0f9b3">SPELL_AURA_MOD_PACIFY</a></div><div class="ttdeci">@ SPELL_AURA_MOD_PACIFY</div><div class="ttdoc">Changes whether the target is pacified or not depending on the apply flag.</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00154">SpellAuraDefines.h:154</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a6c684b941fc93d5488ff49a976973596"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6c684b941fc93d5488ff49a976973596">SPELL_AURA_MOD_SILENCE</a></div><div class="ttdeci">@ SPELL_AURA_MOD_SILENCE</div><div class="ttdoc">Silences the target and stops and spell casts that should be stopped, they have the flag SpellPrevent...</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00163">SpellAuraDefines.h:163</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a6f4ce86c39fc491ab2a65efda7566c9f"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a6f4ce86c39fc491ab2a65efda7566c9f">SPELL_AURA_ADD_TARGET_TRIGGER</a></div><div class="ttdeci">@ SPELL_AURA_ADD_TARGET_TRIGGER</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00245">SpellAuraDefines.h:245</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a7b5d0b48f9a7e84bf7a896602e8c66b9">SPELL_AURA_MOD_CHARM</a></div><div class="ttdeci">@ SPELL_AURA_MOD_CHARM</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00062">SpellAuraDefines.h:62</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a8cec8a45f78b8555b8f13b8b00995acf"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a8cec8a45f78b8555b8f13b8b00995acf">SPELL_AURA_MOUNTED</a></div><div class="ttdeci">@ SPELL_AURA_MOUNTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00214">SpellAuraDefines.h:214</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799a914df68f2d9f91943ee1c79f30eb81c2"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799a914df68f2d9f91943ee1c79f30eb81c2">SPELL_AURA_ALLOW_ONLY_ABILITY</a></div><div class="ttdeci">@ SPELL_AURA_ALLOW_ONLY_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00399">SpellAuraDefines.h:399</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799aab7e99142d3a87d93f8586e2a9cd81c8"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aab7e99142d3a87d93f8586e2a9cd81c8">SPELL_AURA_MOD_PACIFY_SILENCE</a></div><div class="ttdeci">@ SPELL_AURA_MOD_PACIFY_SILENCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00196">SpellAuraDefines.h:196</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aada4a291fd71b7b408ec0ac6543e79b1">SPELL_AURA_AOE_CHARM</a></div><div class="ttdeci">@ SPELL_AURA_AOE_CHARM</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00313">SpellAuraDefines.h:313</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799ab3987db9e154ae9a2086efb43e5af610"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab3987db9e154ae9a2086efb43e5af610">SPELL_AURA_MOD_DECREASE_SPEED</a></div><div class="ttdeci">@ SPELL_AURA_MOD_DECREASE_SPEED</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00169">SpellAuraDefines.h:169</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799ab7aebcdfc938aad8e15f24f026994dbb"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab7aebcdfc938aad8e15f24f026994dbb">SPELL_AURA_STRANGULATE</a></div><div class="ttdeci">@ SPELL_AURA_STRANGULATE</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00434">SpellAuraDefines.h:434</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799ab7eb197a8bd93b47521695875517c14e"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ab7eb197a8bd93b47521695875517c14e">SPELL_AURA_REDUCE_PUSHBACK</a></div><div class="ttdeci">@ SPELL_AURA_REDUCE_PUSHBACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00285">SpellAuraDefines.h:285</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799aba4cc8813262b13c7f9f10d41f2ca6a9"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aba4cc8813262b13c7f9f10d41f2ca6a9">SPELL_AURA_MOD_FLIGHT_SPEED_MOUNTED</a></div><div class="ttdeci">@ SPELL_AURA_MOD_FLIGHT_SPEED_MOUNTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00343">SpellAuraDefines.h:343</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799adaa58e2c604243da285d64f4a95b42f7"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adaa58e2c604243da285d64f4a95b42f7">SPELL_AURA_MOD_CONFUSE</a></div><div class="ttdeci">@ SPELL_AURA_MOD_CONFUSE</div><div class="ttdoc">Used by Aura::HandleModConfuse, will either confuse or unconfuse the target depending on whether the ...</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00061">SpellAuraDefines.h:61</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799adc30e3257d95c2736a98331a53766eea">SPELL_AURA_MOD_POSSESS</a></div><div class="ttdeci">@ SPELL_AURA_MOD_POSSESS</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00045">SpellAuraDefines.h:45</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799ae8ad6fbb57be83baab826d947488b535"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799ae8ad6fbb57be83baab826d947488b535">SPELL_AURA_MOD_MAX_AFFECTED_TARGETS</a></div><div class="ttdeci">@ SPELL_AURA_MOD_MAX_AFFECTED_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00413">SpellAuraDefines.h:413</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799aee5e77a6c01eb9fcd338ebf36599e51d"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aee5e77a6c01eb9fcd338ebf36599e51d">SPELL_AURA_BLOCK_SPELL_FAMILY</a></div><div class="ttdeci">@ SPELL_AURA_BLOCK_SPELL_FAMILY</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00433">SpellAuraDefines.h:433</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799afdf00dd634aaa25017ad329f58bd6cfd"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799afdf00dd634aaa25017ad329f58bd6cfd">SPELL_AURA_MOD_STUN</a></div><div class="ttdeci">@ SPELL_AURA_MOD_STUN</div><div class="ttdoc">Stuns targets in different ways, taken care of in Aura::HandleAuraModStun.</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00092">SpellAuraDefines.h:92</a></div></div>
<div class="ttc" id="aSpellAuraDefines_8h_html_a538cdc259460b365f406fe0b3a981799aff313dd31d66c100086b4d9b6a81d329"><div class="ttname"><a href="SpellAuraDefines_8h.html#a538cdc259460b365f406fe0b3a981799aff313dd31d66c100086b4d9b6a81d329">SPELL_AURA_BIND_SIGHT</a></div><div class="ttdeci">@ SPELL_AURA_BIND_SIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuraDefines_8h_source.html#l00044">SpellAuraDefines.h:44</a></div></div>
<div class="ttc" id="aSpellAuras_8cpp_html_a89ce2a8162f56943bafaaa4c4f4fb2ea"><div class="ttname"><a href="SpellAuras_8cpp.html#a89ce2a8162f56943bafaaa4c4f4fb2ea">CreateSpellAuraHolder</a></div><div class="ttdeci">SpellAuraHolder * CreateSpellAuraHolder(SpellEntry const *spellproto, Unit *target, WorldObject *caster, Item *castItem, SpellEntry const *triggeredBy)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8cpp_source.html#l00538">SpellAuras.cpp:538</a></div></div>
<div class="ttc" id="aSpellAuras_8h_html_a1b224092d87cd57536cbe0dafe6dc44aa5a4725ef493acd702a0b3f7b46c72c96"><div class="ttname"><a href="SpellAuras_8h.html#a1b224092d87cd57536cbe0dafe6dc44aa5a4725ef493acd702a0b3f7b46c72c96">SPELLAURAHOLDER_STATE_READY</a></div><div class="ttdeci">@ SPELLAURAHOLDER_STATE_READY</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00087">SpellAuras.h:87</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a02b7267ebc23af3804cb7d2c0fec1580"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a02b7267ebc23af3804cb7d2c0fec1580">SPELL_ATTR_SCALES_WITH_CREATURE_LEVEL</a></div><div class="ttdeci">@ SPELL_ATTR_SCALES_WITH_CREATURE_LEVEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00049">SpellDefines.h:49</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a3c12174ecf9e1ff874ff49c83793e3b1"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a3c12174ecf9e1ff874ff49c83793e3b1">SPELL_ATTR_COOLDOWN_ON_EVENT</a></div><div class="ttdeci">@ SPELL_ATTR_COOLDOWN_ON_EVENT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00055">SpellDefines.h:55</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a48c3c085b4868f5e7ff01b5f10da9050"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a48c3c085b4868f5e7ff01b5f10da9050">SPELL_ATTR_PASSIVE</a></div><div class="ttdeci">@ SPELL_ATTR_PASSIVE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00036">SpellDefines.h:36</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a5197612e32becb781a08c667015ea477"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a5197612e32becb781a08c667015ea477">SPELL_ATTR_ONLY_INDOORS</a></div><div class="ttdeci">@ SPELL_ATTR_ONLY_INDOORS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00044">SpellDefines.h:44</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a556b7c848105f28f2604159798340755"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a556b7c848105f28f2604159798340755">SPELL_ATTR_DO_NOT_SHEATH</a></div><div class="ttdeci">@ SPELL_ATTR_DO_NOT_SHEATH</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00048">SpellDefines.h:48</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a562c93884d9b677274333ca583a3d236"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a562c93884d9b677274333ca583a3d236">SPELL_ATTR_DO_NOT_DISPLAY</a></div><div class="ttdeci">@ SPELL_ATTR_DO_NOT_DISPLAY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00037">SpellDefines.h:37</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a63e2ffc5cf25a1bd13bae9a3f99a181a"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a63e2ffc5cf25a1bd13bae9a3f99a181a">SPELL_ATTR_CANCELS_AUTO_ATTACK_COMBAT</a></div><div class="ttdeci">@ SPELL_ATTR_CANCELS_AUTO_ATTACK_COMBAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00050">SpellDefines.h:50</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a657869ba309551b6af22e53d919c3d6e"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a657869ba309551b6af22e53d919c3d6e">SPELL_ATTR_ONLY_STEALTHED</a></div><div class="ttdeci">@ SPELL_ATTR_ONLY_STEALTHED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00047">SpellDefines.h:47</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a778ac54f29659923e15fc33483600862"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a778ac54f29659923e15fc33483600862">SPELL_ATTR_ALLOW_WHILE_SITTING</a></div><div class="ttdeci">@ SPELL_ATTR_ALLOW_WHILE_SITTING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00057">SpellDefines.h:57</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a81376bc7d7fcc95dcfdd244eca6e5746"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a81376bc7d7fcc95dcfdd244eca6e5746">SPELL_ATTR_USES_RANGED_SLOT</a></div><div class="ttdeci">@ SPELL_ATTR_USES_RANGED_SLOT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00031">SpellDefines.h:31</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a8a29701b50e8e772029f3da2ad046d35"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8a29701b50e8e772029f3da2ad046d35">SPELL_ATTR_NO_IMMUNITIES</a></div><div class="ttdeci">@ SPELL_ATTR_NO_IMMUNITIES</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00059">SpellDefines.h:59</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a8ceeeda77dcebd27daf92f9c1087c036"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8ceeeda77dcebd27daf92f9c1087c036">SPELL_ATTR_NOT_SHAPESHIFT</a></div><div class="ttdeci">@ SPELL_ATTR_NOT_SHAPESHIFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00046">SpellDefines.h:46</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50a8eb753addae32fb84984d8c1c613108f"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50a8eb753addae32fb84984d8c1c613108f">SPELL_ATTR_ALLOW_WHILE_MOUNTED</a></div><div class="ttdeci">@ SPELL_ATTR_ALLOW_WHILE_MOUNTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00054">SpellDefines.h:54</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50aa96ea1ca361d7bcfd729ef6548e1c141"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50aa96ea1ca361d7bcfd729ef6548e1c141">SPELL_ATTR_ALLOW_CAST_WHILE_DEAD</a></div><div class="ttdeci">@ SPELL_ATTR_ALLOW_CAST_WHILE_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00053">SpellDefines.h:53</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50ab0252a3ac57073ca5c330cbb5decd35d"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50ab0252a3ac57073ca5c330cbb5decd35d">SPELL_ATTR_ONLY_OUTDOORS</a></div><div class="ttdeci">@ SPELL_ATTR_ONLY_OUTDOORS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00045">SpellDefines.h:45</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50aba1c104378265f988ef597efd9570e59"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50aba1c104378265f988ef597efd9570e59">SPELL_ATTR_DO_NOT_LOG</a></div><div class="ttdeci">@ SPELL_ATTR_DO_NOT_LOG</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00038">SpellDefines.h:38</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50ac46d6aff18eaddcab3e946b63c819c14"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50ac46d6aff18eaddcab3e946b63c819c14">SPELL_ATTR_HELD_ITEM_ONLY</a></div><div class="ttdeci">@ SPELL_ATTR_HELD_ITEM_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00039">SpellDefines.h:39</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a04059ce462cf1bb194fd9bc0d45e5d50afe58958c98a660c731236f863e88d80e"><div class="ttname"><a href="SpellDefines_8h.html#a04059ce462cf1bb194fd9bc0d45e5d50afe58958c98a660c731236f863e88d80e">SPELL_ATTR_IS_ABILITY</a></div><div class="ttdeci">@ SPELL_ATTR_IS_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00034">SpellDefines.h:34</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a0709fc3ab848cf1b8b4853813b8fe011a1bac192f38d1aa42f3ed728832e1f5ad"><div class="ttname"><a href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a1bac192f38d1aa42f3ed728832e1f5ad">AURA_INTERRUPT_FLAG_ACTION_LATE</a></div><div class="ttdeci">@ AURA_INTERRUPT_FLAG_ACTION_LATE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00662">SpellDefines.h:662</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a0709fc3ab848cf1b8b4853813b8fe011a5de74105b5a79acfa17c7d9db359de38"><div class="ttname"><a href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a5de74105b5a79acfa17c7d9db359de38">AURA_INTERRUPT_FLAG_MOVING</a></div><div class="ttdeci">@ AURA_INTERRUPT_FLAG_MOVING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00649">SpellDefines.h:649</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a0709fc3ab848cf1b8b4853813b8fe011a7c60f7f30376f851d3c8921d4140390d"><div class="ttname"><a href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a7c60f7f30376f851d3c8921d4140390d">AURA_INTERRUPT_FLAG_ACTION</a></div><div class="ttdeci">@ AURA_INTERRUPT_FLAG_ACTION</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00648">SpellDefines.h:648</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a0709fc3ab848cf1b8b4853813b8fe011a7ff7b6e5eb8b89e335cbed2efcc61ec3"><div class="ttname"><a href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011a7ff7b6e5eb8b89e335cbed2efcc61ec3">AURA_INTERRUPT_FLAG_TURNING</a></div><div class="ttdeci">@ AURA_INTERRUPT_FLAG_TURNING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00650">SpellDefines.h:650</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a0709fc3ab848cf1b8b4853813b8fe011acbbf681ff137361f2832cbb1d424fb8c"><div class="ttname"><a href="SpellDefines_8h.html#a0709fc3ab848cf1b8b4853813b8fe011acbbf681ff137361f2832cbb1d424fb8c">AURA_INTERRUPT_FLAG_PVP_ACTIVE_CANCELS</a></div><div class="ttdeci">@ AURA_INTERRUPT_FLAG_PVP_ACTIVE_CANCELS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00669">SpellDefines.h:669</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a28789dbc5476b8d8efa0248edf8a7035a20aa7fa5fe5e07256d0658fac72d186f"><div class="ttname"><a href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035a20aa7fa5fe5e07256d0658fac72d186f">SPELL_ATTR_EX4_BOUNCY_CHAIN_MISSILES</a></div><div class="ttdeci">@ SPELL_ATTR_EX4_BOUNCY_CHAIN_MISSILES</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00192">SpellDefines.h:192</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a28789dbc5476b8d8efa0248edf8a7035a6d5c664016f0bd4bd56a6a7659cb9c81"><div class="ttname"><a href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035a6d5c664016f0bd4bd56a6a7659cb9c81">SPELL_ATTR_EX4_WEAPON_SPEED_COST_SCALING</a></div><div class="ttdeci">@ SPELL_ATTR_EX4_WEAPON_SPEED_COST_SCALING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00184">SpellDefines.h:184</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a28789dbc5476b8d8efa0248edf8a7035a9d9c4d96556a2f5ba8ad93e87101fbb8"><div class="ttname"><a href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035a9d9c4d96556a2f5ba8ad93e87101fbb8">SPELL_ATTR_EX4_CLASS_TRIGGER_ONLY_ON_TARGET</a></div><div class="ttdeci">@ SPELL_ATTR_EX4_CLASS_TRIGGER_ONLY_ON_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00175">SpellDefines.h:175</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a28789dbc5476b8d8efa0248edf8a7035ac28babc82dd18ec816e8dcf5fbce54d1"><div class="ttname"><a href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035ac28babc82dd18ec816e8dcf5fbce54d1">SPELL_ATTR_EX4_ALLOW_CAST_WHILE_CASTING</a></div><div class="ttdeci">@ SPELL_ATTR_EX4_ALLOW_CAST_WHILE_CASTING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00181">SpellDefines.h:181</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a28789dbc5476b8d8efa0248edf8a7035ac9c6721936fd1ae1bdd9e4e06021670b"><div class="ttname"><a href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035ac9c6721936fd1ae1bdd9e4e06021670b">SPELL_ATTR_EX4_AURA_NEVER_BOUNCES</a></div><div class="ttdeci">@ SPELL_ATTR_EX4_AURA_NEVER_BOUNCES</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00194">SpellDefines.h:194</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a28789dbc5476b8d8efa0248edf8a7035acf1fc17c13e831e402411d6550186109"><div class="ttname"><a href="SpellDefines_8h.html#a28789dbc5476b8d8efa0248edf8a7035acf1fc17c13e831e402411d6550186109">SPELL_ATTR_EX4_NO_PARTIAL_IMMUNITY</a></div><div class="ttdeci">@ SPELL_ATTR_EX4_NO_PARTIAL_IMMUNITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00185">SpellDefines.h:185</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a325173c0e664945846d1f4c1e858c20ba503742f0c152ec55d428f07cc2320f3b"><div class="ttname"><a href="SpellDefines_8h.html#a325173c0e664945846d1f4c1e858c20ba503742f0c152ec55d428f07cc2320f3b">SPELL_ATTR_SS_FACING_BACK</a></div><div class="ttdeci">@ SPELL_ATTR_SS_FACING_BACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00321">SpellDefines.h:321</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a325173c0e664945846d1f4c1e858c20bab9f5044522a05a5a5a25d8371a868149"><div class="ttname"><a href="SpellDefines_8h.html#a325173c0e664945846d1f4c1e858c20bab9f5044522a05a5a5a25d8371a868149">SPELL_ATTR_SS_AOE_CAP</a></div><div class="ttdeci">@ SPELL_ATTR_SS_AOE_CAP</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00319">SpellDefines.h:319</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a1203bc676452b3a3902e4c824734156d"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a1203bc676452b3a3902e4c824734156d">SPELL_ATTR_EX2_NOT_AN_ACTION</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_NOT_AN_ACTION</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00130">SpellDefines.h:130</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a17f8c4ebbd048cdcde447fa5083698f5"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a17f8c4ebbd048cdcde447fa5083698f5">SPELL_ATTR_EX2_AUTO_REPEAT</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_AUTO_REPEAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00107">SpellDefines.h:107</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a264c19f3c0c7e399eba0f121e35e17e6"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a264c19f3c0c7e399eba0f121e35e17e6">SPELL_ATTR_EX2_DONT_BLOCK_MANA_REGEN</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_DONT_BLOCK_MANA_REGEN</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00127">SpellDefines.h:127</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a36508afb28bad3c6dbfe30103a3ea46e"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a36508afb28bad3c6dbfe30103a3ea46e">SPELL_ATTR_EX2_CHAIN_FROM_CASTER</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_CHAIN_FROM_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00114">SpellDefines.h:114</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a44f12da1bb63fe2d31a8ce70b6acde88"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a44f12da1bb63fe2d31a8ce70b6acde88">SPELL_ATTR_EX2_ALLOW_LOW_LEVEL_BUFF</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_ALLOW_LOW_LEVEL_BUFF</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00105">SpellDefines.h:105</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a5bbf6c6c2171512553c182a2f1946a06"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a5bbf6c6c2171512553c182a2f1946a06">SPELL_ATTR_EX2_SPECIAL_TAMING_FLAG</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_SPECIAL_TAMING_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00112">SpellDefines.h:112</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a7f7f49eff2aef7a7c3340cd812c876c7"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a7f7f49eff2aef7a7c3340cd812c876c7">SPELL_ATTR_EX2_NO_ACTIVE_PETS</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_NO_ACTIVE_PETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00118">SpellDefines.h:118</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a81ca961d68c744b94e14d93303f3eb22"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a81ca961d68c744b94e14d93303f3eb22">SPELL_ATTR_EX2_DO_NOT_RESET_COMBAT_TIMERS</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_DO_NOT_RESET_COMBAT_TIMERS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00119">SpellDefines.h:119</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a858aae561517cebb142e6af5691d3ef5"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a858aae561517cebb142e6af5691d3ef5">SPELL_ATTR_EX2_NO_INITIAL_THREAT</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_NO_INITIAL_THREAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00124">SpellDefines.h:124</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a9593bb76a5719b0bdafa3c2e69fbae1d"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a9593bb76a5719b0bdafa3c2e69fbae1d">SPELL_ATTR_EX2_FAIL_ON_ALL_TARGETS_IMMUNE</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_FAIL_ON_ALL_TARGETS_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00123">SpellDefines.h:123</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801a9e5fc74325466193bc989105be999795"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801a9e5fc74325466193bc989105be999795">SPELL_ATTR_EX2_ENCHANT_OWN_ITEM_ONLY</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_ENCHANT_OWN_ITEM_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00115">SpellDefines.h:115</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801ab5d894f98237bbbff5e65f9497081078"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801ab5d894f98237bbbff5e65f9497081078">SPELL_ATTR_EX2_INITIATE_COMBAT_POST_CAST</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_INITIATE_COMBAT_POST_CAST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00122">SpellDefines.h:122</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801ad5039b579aed0c0c6d07284fa29bfb10"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801ad5039b579aed0c0c6d07284fa29bfb10">SPELL_ATTR_EX2_RETAIN_ITEM_CAST</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_RETAIN_ITEM_CAST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00133">SpellDefines.h:133</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801ae3fa8042725e82ce05d035ced9338aa3"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801ae3fa8042725e82ce05d035ced9338aa3">SPELL_ATTR_EX2_ALLOW_DEAD_TARGET</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_ALLOW_DEAD_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00102">SpellDefines.h:102</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801af854beb3bfcbb2fa59f784fa54c9e5b0"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801af854beb3bfcbb2fa59f784fa54c9e5b0">SPELL_ATTR_EX2_CANNOT_CAST_ON_TAPPED</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_CANNOT_CAST_ON_TAPPED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00108">SpellDefines.h:108</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a392e10df961d186e42393147f1db9801af942d225af4211007c4da68ddbce6857"><div class="ttname"><a href="SpellDefines_8h.html#a392e10df961d186e42393147f1db9801af942d225af4211007c4da68ddbce6857">SPELL_ATTR_EX2_DO_NOT_REPORT_SPELL_FAILURE</a></div><div class="ttdeci">@ SPELL_ATTR_EX2_DO_NOT_REPORT_SPELL_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00109">SpellDefines.h:109</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351a02be30b0aa7e94e836effcf6882ddea8"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a02be30b0aa7e94e836effcf6882ddea8">SPELLMOD_RANGE</a></div><div class="ttdeci">@ SPELLMOD_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00692">SpellDefines.h:692</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351a2aa9aafa27b11a2395aef543c83eced2"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a2aa9aafa27b11a2395aef543c83eced2">SPELLMOD_NOT_LOSE_CASTING_TIME</a></div><div class="ttdeci">@ SPELLMOD_NOT_LOSE_CASTING_TIME</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00696">SpellDefines.h:696</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351a4729e945549bbeef20534fbd511eab78"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a4729e945549bbeef20534fbd511eab78">SPELLMOD_EFFECT_PAST_FIRST</a></div><div class="ttdeci">@ SPELLMOD_EFFECT_PAST_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00707">SpellDefines.h:707</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351a7251c33da097f1bf91b7b55df34c42cc"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351a7251c33da097f1bf91b7b55df34c42cc">SPELLMOD_SPELL_COST_REFUND_ON_FAIL</a></div><div class="ttdeci">@ SPELLMOD_SPELL_COST_REFUND_ON_FAIL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00717">SpellDefines.h:717</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351ac8da41f19ec3dc98d57d14b6ae22ab7f"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351ac8da41f19ec3dc98d57d14b6ae22ab7f">SPELLMOD_JUMP_TARGETS</a></div><div class="ttdeci">@ SPELLMOD_JUMP_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00704">SpellDefines.h:704</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351aee2e5c475de0fac5532e93699abcd681"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351aee2e5c475de0fac5532e93699abcd681">SPELLMOD_RADIUS</a></div><div class="ttdeci">@ SPELLMOD_RADIUS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00693">SpellDefines.h:693</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a39b60e1f12cca9b6873cb817e7717351af20b74239c863da128fdb51f2d37bdd7"><div class="ttname"><a href="SpellDefines_8h.html#a39b60e1f12cca9b6873cb817e7717351af20b74239c863da128fdb51f2d37bdd7">SPELLMOD_COST</a></div><div class="ttdeci">@ SPELLMOD_COST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00701">SpellDefines.h:701</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9a14ffa28e0a73efac742dceb71e7cc731"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a14ffa28e0a73efac742dceb71e7cc731">SPELL_ATTR_EX7_RESET_SWING_TIMER_AT_SPELL_START</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_RESET_SWING_TIMER_AT_SPELL_START</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00297">SpellDefines.h:297</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9a150ecf3de3f3deecf12f8830d4d7d9a2"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a150ecf3de3f3deecf12f8830d4d7d9a2">SPELL_ATTR_EX7_CAN_CAUSE_INTERRUPT</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_CAN_CAUSE_INTERRUPT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00293">SpellDefines.h:293</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9a363a771ef7a91ce3a4f06e9948760119"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a363a771ef7a91ce3a4f06e9948760119">SPELL_ATTR_EX7_DEBUG_SPELL</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_DEBUG_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00285">SpellDefines.h:285</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9a76a9a8e0d3fe43183e01de34214f31f7"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a76a9a8e0d3fe43183e01de34214f31f7">SPELL_ATTR_EX7_REPORT_SPELL_FAILURE_TO_UNIT_TARGET</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_REPORT_SPELL_FAILURE_TO_UNIT_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00301">SpellDefines.h:301</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9a9bc68a96c5126296e4cdc116685168e1"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9a9bc68a96c5126296e4cdc116685168e1">SPELL_ATTR_EX7_IGNORES_COLD_WEATHER_FLYING_REQUIREMENT</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_IGNORES_COLD_WEATHER_FLYING_REQUIREMENT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00304">SpellDefines.h:304</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9aa5990186f6d643ccf2899290b1afd89f"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9aa5990186f6d643ccf2899290b1afd89f">SPELL_ATTR_EX7_ALWAYS_CAST_LOG</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_ALWAYS_CAST_LOG</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00313">SpellDefines.h:313</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a7530a2997a6c89f362a5641d9f608fa9ab8497b85f983e0682091317fb0606286"><div class="ttname"><a href="SpellDefines_8h.html#a7530a2997a6c89f362a5641d9f608fa9ab8497b85f983e0682091317fb0606286">SPELL_ATTR_EX7_REFLECTION_ONLY_DEFENDS</a></div><div class="ttdeci">@ SPELL_ATTR_EX7_REFLECTION_ONLY_DEFENDS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00311">SpellDefines.h:311</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a0a7f659a1c84875e683b12be98690486"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a0a7f659a1c84875e683b12be98690486">TRIGGERED_DO_NOT_PROC</a></div><div class="ttdeci">@ TRIGGERED_DO_NOT_PROC</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00731">SpellDefines.h:731</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a16535f56de056146743172e37087b879"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a16535f56de056146743172e37087b879">TRIGGERED_IGNORE_UNSELECTABLE_FLAG</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_UNSELECTABLE_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00727">SpellDefines.h:727</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a25fb62b8551cfab083926b40f2e306f1"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a25fb62b8551cfab083926b40f2e306f1">TRIGGERED_CHANNEL_ONLY</a></div><div class="ttdeci">@ TRIGGERED_CHANNEL_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00740">SpellDefines.h:740</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a517c1f96821a2e7aa5c7c6e38aa8e4e0"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a517c1f96821a2e7aa5c7c6e38aa8e4e0">TRIGGERED_IGNORE_UNATTACKABLE_FLAG</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_UNATTACKABLE_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00730">SpellDefines.h:730</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a5b958fa73cfa7edb70dad57c96ca69d8"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a5b958fa73cfa7edb70dad57c96ca69d8">TRIGGERED_INSTANT_CAST</a></div><div class="ttdeci">@ TRIGGERED_INSTANT_CAST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00728">SpellDefines.h:728</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a5d21f7fce865b4cab5bbe0b48698dd61"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a5d21f7fce865b4cab5bbe0b48698dd61">TRIGGERED_IGNORE_CASTER_AURA_STATE</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_CASTER_AURA_STATE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00741">SpellDefines.h:741</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a899fa7df360462673111bbfbb0bbd00d"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a899fa7df360462673111bbfbb0bbd00d">TRIGGERED_IGNORE_GCD</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_GCD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00734">SpellDefines.h:734</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29a8c3d6f3b162ab6c0398ff725e7e4ef69"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29a8c3d6f3b162ab6c0398ff725e7e4ef69">TRIGGERED_HIDE_CAST_IN_COMBAT_LOG</a></div><div class="ttdeci">@ TRIGGERED_HIDE_CAST_IN_COMBAT_LOG</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00738">SpellDefines.h:738</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29aaf2e6f2e4c3f497f195817316711147c"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aaf2e6f2e4c3f497f195817316711147c">TRIGGERED_IGNORE_COOLDOWNS</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_COOLDOWNS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00736">SpellDefines.h:736</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ab89fa5cc12475f894d85c381bed7a2f2">TRIGGERED_OLD_TRIGGERED</a></div><div class="ttdeci">@ TRIGGERED_OLD_TRIGGERED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00725">SpellDefines.h:725</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29abc810f966ed6f07995c8ed514f7ede64"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29abc810f966ed6f07995c8ed514f7ede64">TRIGGERED_AUTOREPEAT</a></div><div class="ttdeci">@ TRIGGERED_AUTOREPEAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00729">SpellDefines.h:729</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29ac9685659ce6bfb28f1b00ee4f9f5be8e"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ac9685659ce6bfb28f1b00ee4f9f5be8e">TRIGGERED_PET_CAST</a></div><div class="ttdeci">@ TRIGGERED_PET_CAST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00732">SpellDefines.h:732</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad2e82d2342b545f831dfe79d922a3b20">TRIGGERED_NONE</a></div><div class="ttdeci">@ TRIGGERED_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00724">SpellDefines.h:724</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29ad52490b339c2e30db5418166416d18c0"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ad52490b339c2e30db5418166416d18c0">TRIGGERED_IGNORE_COSTS</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_COSTS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00735">SpellDefines.h:735</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29ae6af255402f3dfe4ba0549396658ab7f"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29ae6af255402f3dfe4ba0549396658ab7f">TRIGGERED_IGNORE_HIT_CALCULATION</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_HIT_CALCULATION</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00726">SpellDefines.h:726</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29aea48543e222d5f119aba63ec668feecb"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aea48543e222d5f119aba63ec668feecb">TRIGGERED_DO_NOT_RESET_LEASH</a></div><div class="ttdeci">@ TRIGGERED_DO_NOT_RESET_LEASH</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00739">SpellDefines.h:739</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29aedf85a11ac6fb96d0b2d08509bb40a7d"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aedf85a11ac6fb96d0b2d08509bb40a7d">TRIGGERED_IGNORE_CURRENT_CASTED_SPELL</a></div><div class="ttdeci">@ TRIGGERED_IGNORE_CURRENT_CASTED_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00737">SpellDefines.h:737</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a8512d8ac830d80360b33fa46dc884a29aee3c4111b8df4a50e93ca83f992f5682"><div class="ttname"><a href="SpellDefines_8h.html#a8512d8ac830d80360b33fa46dc884a29aee3c4111b8df4a50e93ca83f992f5682">TRIGGERED_NORMAL_COMBAT_CAST</a></div><div class="ttdeci">@ TRIGGERED_NORMAL_COMBAT_CAST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00733">SpellDefines.h:733</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a0cb6ca24fc7bac55a3348b82eecee373"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a0cb6ca24fc7bac55a3348b82eecee373">SPELL_ATTR_EX5_ALLOW_WHILE_FLEEING</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_ALLOW_WHILE_FLEEING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00227">SpellDefines.h:227</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a27b95a6394f56574a6a97b3e5ed885f2"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a27b95a6394f56574a6a97b3e5ed885f2">SPELL_ATTR_EX5_ALLOW_WHILE_CONFUSED</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_ALLOW_WHILE_CONFUSED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00228">SpellDefines.h:228</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a3bb986cc8f8aae9d9fd0f0191c49d960"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a3bb986cc8f8aae9d9fd0f0191c49d960">SPELL_ATTR_EX5_ALWAYS_AOE_LINE_OF_SIGHT</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_ALWAYS_AOE_LINE_OF_SIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00236">SpellDefines.h:236</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a50fa980199dae1942bc37774989ea212"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a50fa980199dae1942bc37774989ea212">SPELL_ATTR_EX5_TREAT_AS_AREA_EFFECT</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_TREAT_AS_AREA_EFFECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00225">SpellDefines.h:225</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a56972efc92caab29f6fa30e2cce3286c"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a56972efc92caab29f6fa30e2cce3286c">SPELL_ATTR_EX5_IGNORE_CASTER_REQUIREMENTS</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_IGNORE_CASTER_REQUIREMENTS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00234">SpellDefines.h:234</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a5db6cd44014f24b32b2ec27d54c66d2b"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a5db6cd44014f24b32b2ec27d54c66d2b">SPELL_ATTR_EX5_NOT_ON_TRIVIAL</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_NOT_ON_TRIVIAL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00232">SpellDefines.h:232</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a65ee564b8f7e72b199e6d6ae55ad8488"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a65ee564b8f7e72b199e6d6ae55ad8488">SPELL_ATTR_EX5_NOT_ON_PLAYER_CONTROLLED_NPC</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_NOT_ON_PLAYER_CONTROLLED_NPC</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00218">SpellDefines.h:218</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734a87857ee440b15e7e5a0e6c3bd293fe8c"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734a87857ee440b15e7e5a0e6c3bd293fe8c">SPELL_ATTR_EX5_IGNORE_AREA_EFFECT_PVP_CHECK</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_IGNORE_AREA_EFFECT_PVP_CHECK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00216">SpellDefines.h:216</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734ab726258a5e89ba7a1bd14e197b486901"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734ab726258a5e89ba7a1bd14e197b486901">SPELL_ATTR_EX5_SPELL_HASTE_AFFECTS_PERIODIC</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_SPELL_HASTE_AFFECTS_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00223">SpellDefines.h:223</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734abba70d43d90380cbf0a5a4fd8af7c928"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734abba70d43d90380cbf0a5a4fd8af7c928">SPELL_ATTR_EX5_ALLOW_WHILE_STUNNED</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_ALLOW_WHILE_STUNNED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00213">SpellDefines.h:213</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734ad4e0ee8d9bd227b06b832fcc75c9f80f"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734ad4e0ee8d9bd227b06b832fcc75c9f80f">SPELL_ATTR_EX5_AI_DOESNT_FACE_TARGET</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_AI_DOESNT_FACE_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00229">SpellDefines.h:229</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734aecac7642facd23e9417444b47534355b"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734aecac7642facd23e9417444b47534355b">SPELL_ATTR_EX5_ALLOW_ACTIONS_DURING_CHANNEL</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_ALLOW_ACTIONS_DURING_CHANNEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00210">SpellDefines.h:210</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734aee2774e1e020ab2de7912a0b4cb0aaba"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734aee2774e1e020ab2de7912a0b4cb0aaba">SPELL_ATTR_EX5_ALWAYS_LINE_OF_SIGHT</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_ALWAYS_LINE_OF_SIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00235">SpellDefines.h:235</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734af314637b5b06e3f25a2bb8e87abc68d3"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734af314637b5b06e3f25a2bb8e87abc68d3">SPELL_ATTR_EX5_NOT_ON_PLAYER</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_NOT_ON_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00217">SpellDefines.h:217</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734af389b38f76fd80d64d0ea3b37a665c29"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734af389b38f76fd80d64d0ea3b37a665c29">SPELL_ATTR_EX5_MELEE_CHAIN_TARGETING</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_MELEE_CHAIN_TARGETING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00222">SpellDefines.h:222</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_a94a65b6cc4aa4d5bd2212fd04b522734afa23757176cfe70e555bd7737a7f03c2"><div class="ttname"><a href="SpellDefines_8h.html#a94a65b6cc4aa4d5bd2212fd04b522734afa23757176cfe70e555bd7737a7f03c2">SPELL_ATTR_EX5_IMPLIED_TARGETING</a></div><div class="ttdeci">@ SPELL_ATTR_EX5_IMPLIED_TARGETING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00221">SpellDefines.h:221</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aa0ddf79b3067038e8f35cecd153cef58ad974738974feec8a1f2cc2415159afbe"><div class="ttname"><a href="SpellDefines_8h.html#aa0ddf79b3067038e8f35cecd153cef58ad974738974feec8a1f2cc2415159afbe">SPELL_CATEGORY_FLAG_EVENT_ON_LEAVE_COMBAT</a></div><div class="ttdeci">@ SPELL_CATEGORY_FLAG_EVENT_ON_LEAVE_COMBAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00328">SpellDefines.h:328</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aa7550118be028897d7ad49cae5a652dea84a18aebfa58f0d225b15fef9c2f2534"><div class="ttname"><a href="SpellDefines_8h.html#aa7550118be028897d7ad49cae5a652dea84a18aebfa58f0d225b15fef9c2f2534">SPELL_FAILED_CUSTOM_ERROR_65</a></div><div class="ttdeci">@ SPELL_FAILED_CUSTOM_ERROR_65</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00596">SpellDefines.h:596</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a0369a5743cc4df083542161d8975656b"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a0369a5743cc4df083542161d8975656b">SPELL_ATTR_EX6_NOT_AN_ATTACK</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_NOT_AN_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00248">SpellDefines.h:248</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a15d161cf7035492df160807e1fa1fcb1"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a15d161cf7035492df160807e1fa1fcb1">SPELL_ATTR_EX6_NO_PUSHBACK</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_NO_PUSHBACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00261">SpellDefines.h:261</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a1e4d63776ace92d6c631f8f9de87f2df"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a1e4d63776ace92d6c631f8f9de87f2df">SPELL_ATTR_EX6_IGNORE_PHASE_SHIFT</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_IGNORE_PHASE_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00259">SpellDefines.h:259</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a241a5d4ba7a1aa5228ecb67793f31400"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a241a5d4ba7a1aa5228ecb67793f31400">SPELL_ATTR_EX6_CAN_TARGET_UNTARGETABLE</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_CAN_TARGET_UNTARGETABLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00270">SpellDefines.h:270</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a4812e0755be6918d62a7760f9b33ac68"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a4812e0755be6918d62a7760f9b33ac68">SPELL_ATTR_EX6_ORIGINATE_FROM_CONTROLLER</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_ORIGINATE_FROM_CONTROLLER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00264">SpellDefines.h:264</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a6e293fbb4665079fb8b3aa753018f66c"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a6e293fbb4665079fb8b3aa753018f66c">SPELL_ATTR_EX6_DOESNT_RESET_SWING_TIMER_IF_INSTANT</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_DOESNT_RESET_SWING_TIMER_IF_INSTANT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00271">SpellDefines.h:271</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0a99b6da32b575b04d705fc8254d41b352"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0a99b6da32b575b04d705fc8254d41b352">SPELL_ATTR_EX6_NO_JUMP_PATHING</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_NO_JUMP_PATHING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00262">SpellDefines.h:262</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0aa553bd77c64bd5136e0b578b93199622"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0aa553bd77c64bd5136e0b578b93199622">SPELL_ATTR_EX6_DO_NOT_CHAIN_TO_CROWD_CONTROLLED_TARGETS</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_DO_NOT_CHAIN_TO_CROWD_CONTROLLED_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00254">SpellDefines.h:254</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0adc2a8bfee369bdbfd6bf659e60029ecb"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0adc2a8bfee369bdbfd6bf659e60029ecb">SPELL_ATTR_EX6_DO_NOT_CONSUME_RESOURCES</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_DO_NOT_CONSUME_RESOURCES</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00251">SpellDefines.h:251</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aaa549a9e4557a595a27ac493b8fbd1a0af18ed96ca251fb247f188fbf1690b08e"><div class="ttname"><a href="SpellDefines_8h.html#aaa549a9e4557a595a27ac493b8fbd1a0af18ed96ca251fb247f188fbf1690b08e">SPELL_ATTR_EX6_ALLOW_WHILE_RIDING_VEHICLE</a></div><div class="ttdeci">@ SPELL_ATTR_EX6_ALLOW_WHILE_RIDING_VEHICLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00258">SpellDefines.h:258</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a11629ba94e35782022fabd1f567551df"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a11629ba94e35782022fabd1f567551df">SPELL_ATTR_EX_ONLY_PEACEFUL_TARGETS</a></div><div class="ttdeci">@ SPELL_ATTR_EX_ONLY_PEACEFUL_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00074">SpellDefines.h:74</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a154e57d2932847861392103577c42779"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a154e57d2932847861392103577c42779">SPELL_ATTR_EX_REQUIRE_ALL_TARGETS</a></div><div class="ttdeci">@ SPELL_ATTR_EX_REQUIRE_ALL_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00092">SpellDefines.h:92</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a2d9dc7de711bae7450a53336cf845387">SPELL_ATTR_EX_DISMISS_PET_FIRST</a></div><div class="ttdeci">@ SPELL_ATTR_EX_DISMISS_PET_FIRST</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00066">SpellDefines.h:66</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a4d92db4bb064cb51ad9716a543a720cf"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a4d92db4bb064cb51ad9716a543a720cf">SPELL_ATTR_EX_IS_CHANNELED</a></div><div class="ttdeci">@ SPELL_ATTR_EX_IS_CHANNELED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00068">SpellDefines.h:68</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a6e67c0304fea4fcb36f77265f52ffed2"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a6e67c0304fea4fcb36f77265f52ffed2">SPELL_ATTR_EX_THREAT_ONLY_ON_MISS</a></div><div class="ttdeci">@ SPELL_ATTR_EX_THREAT_ONLY_ON_MISS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00087">SpellDefines.h:87</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a773f4c5cfef9eb087607ad1414706532"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a773f4c5cfef9eb087607ad1414706532">SPELL_ATTR_EX_TRACK_TARGET_IN_CHANNEL</a></div><div class="ttdeci">@ SPELL_ATTR_EX_TRACK_TARGET_IN_CHANNEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00080">SpellDefines.h:80</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a9055b406a86e1f19015561a20e239bfc"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a9055b406a86e1f19015561a20e239bfc">SPELL_ATTR_EX_USE_ALL_MANA</a></div><div class="ttdeci">@ SPELL_ATTR_EX_USE_ALL_MANA</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00067">SpellDefines.h:67</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2a9255c95e4790afbc6f750c9af860114a"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2a9255c95e4790afbc6f750c9af860114a">SPELL_ATTR_EX_DISCOUNT_POWER_ON_MISS</a></div><div class="ttdeci">@ SPELL_ATTR_EX_DISCOUNT_POWER_ON_MISS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00093">SpellDefines.h:93</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2ab5f4362a2cdc7da05c8c28e80c5e13b7"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ab5f4362a2cdc7da05c8c28e80c5e13b7">SPELL_ATTR_EX_FINISHING_MOVE_DAMAGE</a></div><div class="ttdeci">@ SPELL_ATTR_EX_FINISHING_MOVE_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00086">SpellDefines.h:86</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2ab8b7943d1cb9e62f6f5cb6720ec59d32"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ab8b7943d1cb9e62f6f5cb6720ec59d32">SPELL_ATTR_EX_NO_THREAT</a></div><div class="ttdeci">@ SPELL_ATTR_EX_NO_THREAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00076">SpellDefines.h:76</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2ac4ec9bdb1506ec6034067363b1a0cea4"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ac4ec9bdb1506ec6034067363b1a0cea4">SPELL_ATTR_EX_EXCLUDE_CASTER</a></div><div class="ttdeci">@ SPELL_ATTR_EX_EXCLUDE_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00085">SpellDefines.h:85</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aab5e6a96aa8fdc62f97d37fec739d9c2ac4f26223051a108cbe9c2b010450ae02"><div class="ttname"><a href="SpellDefines_8h.html#aab5e6a96aa8fdc62f97d37fec739d9c2ac4f26223051a108cbe9c2b010450ae02">SPELL_ATTR_EX_INITIATES_COMBAT_ENABLES_AUTO_ATTACK</a></div><div class="ttdeci">@ SPELL_ATTR_EX_INITIATES_COMBAT_ENABLES_AUTO_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00075">SpellDefines.h:75</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_abadf2f982fd866917c372d16ab99c109a6003b0d5211156ba175b18e6719326ed"><div class="ttname"><a href="SpellDefines_8h.html#abadf2f982fd866917c372d16ab99c109a6003b0d5211156ba175b18e6719326ed">SPELL_INTERRUPT_FLAG_DAMAGE_PUSHBACK</a></div><div class="ttdeci">@ SPELL_INTERRUPT_FLAG_DAMAGE_PUSHBACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00637">SpellDefines.h:637</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_abadf2f982fd866917c372d16ab99c109a652afef72a005336c4715d69b39a9821"><div class="ttname"><a href="SpellDefines_8h.html#abadf2f982fd866917c372d16ab99c109a652afef72a005336c4715d69b39a9821">SPELL_INTERRUPT_FLAG_COMBAT</a></div><div class="ttdeci">@ SPELL_INTERRUPT_FLAG_COMBAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00639">SpellDefines.h:639</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_abadf2f982fd866917c372d16ab99c109a986dc87f6033e6ccfb4510dfdb0f41fd"><div class="ttname"><a href="SpellDefines_8h.html#abadf2f982fd866917c372d16ab99c109a986dc87f6033e6ccfb4510dfdb0f41fd">SPELL_INTERRUPT_FLAG_MOVEMENT</a></div><div class="ttdeci">@ SPELL_INTERRUPT_FLAG_MOVEMENT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00636">SpellDefines.h:636</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_ac8791ee2f758e00e9621a849273a8549ac8e8981ed6a7cb479ac7a0911f51ff6c"><div class="ttname"><a href="SpellDefines_8h.html#ac8791ee2f758e00e9621a849273a8549ac8e8981ed6a7cb479ac7a0911f51ff6c">SPELL_FACING_FLAG_INFRONT</a></div><div class="ttdeci">@ SPELL_FACING_FLAG_INFRONT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00683">SpellDefines.h:682</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34ea065cd304dcdf77d6d2fdef81f2a72b87"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea065cd304dcdf77d6d2fdef81f2a72b87">SPELL_ATTR_EX3_ONLY_ON_PLAYER</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_ONLY_ON_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00146">SpellDefines.h:146</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34ea1970b8b3ccb8ca34ce646b342cd00421"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea1970b8b3ccb8ca34ce646b342cd00421">SPELL_ATTR_EX3_IGNORE_CASTER_MODIFIERS</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_IGNORE_CASTER_MODIFIERS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00167">SpellDefines.h:167</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34ea5ac6ce4030c3d3d2c9fd8ecde25db77d"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea5ac6ce4030c3d3d2c9fd8ecde25db77d">SPELL_ATTR_EX3_SUPPRESS_CASTER_PROCS</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_SUPPRESS_CASTER_PROCS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00154">SpellDefines.h:154</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34ea8840d7716c30eddbc8b0bb0e32bd4834"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea8840d7716c30eddbc8b0bb0e32bd4834">SPELL_ATTR_EX3_ALLOW_AURA_WHILE_DEAD</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_ALLOW_AURA_WHILE_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00158">SpellDefines.h:158</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34ea8bb36703be604178fb8710c4187d91bb"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34ea8bb36703be604178fb8710c4187d91bb">SPELL_ATTR_EX3_ONLY_ON_GHOSTS</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_ONLY_ON_GHOSTS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00150">SpellDefines.h:150</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34eaac5b3a2eda0f211532c20f52e02454ae"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34eaac5b3a2eda0f211532c20f52e02454ae">SPELL_ATTR_EX3_IGNORE_CASTER_AND_TARGET_RESTRICTIONS</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_IGNORE_CASTER_AND_TARGET_RESTRICTIONS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00166">SpellDefines.h:166</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34eac268ac21729dac14538c60dacbd85f49"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34eac268ac21729dac14538c60dacbd85f49">SPELL_ATTR_EX3_NOT_ON_AOE_IMMUNE</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_NOT_ON_AOE_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00169">SpellDefines.h:169</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_afe3a5d430a5ca7ee7bbf516567f0f34eaeefa14b79df399ff8c3a9848e925e281"><div class="ttname"><a href="SpellDefines_8h.html#afe3a5d430a5ca7ee7bbf516567f0f34eaeefa14b79df399ff8c3a9848e925e281">SPELL_ATTR_EX3_TREAT_AS_PERIODIC</a></div><div class="ttdeci">@ SPELL_ATTR_EX3_TREAT_AS_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00163">SpellDefines.h:163</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cb"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cb">SpellCastResult</a></div><div class="ttdeci">SpellCastResult</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00331">SpellDefines.h:332</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba010f9248a8f946a89ed5afa1a71d9bbc"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba010f9248a8f946a89ed5afa1a71d9bbc">SPELL_FAILED_TARGET_NOT_LOOTED</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_NOT_LOOTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00454">SpellDefines.h:454</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba0201f3ee2e3101af63e54aafbf14c226"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0201f3ee2e3101af63e54aafbf14c226">SPELL_FAILED_UNIT_NOT_INFRONT</a></div><div class="ttdeci">@ SPELL_FAILED_UNIT_NOT_INFRONT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00467">SpellDefines.h:467</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba02f640e1a5bbadb65809043082d521e9"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba02f640e1a5bbadb65809043082d521e9">SPELL_FAILED_NEED_EXOTIC_AMMO</a></div><div class="ttdeci">@ SPELL_FAILED_NEED_EXOTIC_AMMO</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00387">SpellDefines.h:387</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba0418a0d501e729bbd540dcfab1e88556"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0418a0d501e729bbd540dcfab1e88556">SPELL_FAILED_NOT_INFRONT</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_INFRONT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00394">SpellDefines.h:394</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba0936bc5119bbdacad4096fdd55a0c3ee"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0936bc5119bbdacad4096fdd55a0c3ee">SPELL_FAILED_STUNNED</a></div><div class="ttdeci">@ SPELL_FAILED_STUNNED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00441">SpellDefines.h:441</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba0c67457bbdc9de5c80ae6894f6129f90"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0c67457bbdc9de5c80ae6894f6129f90">SPELL_FAILED_FISHING_TOO_LOW</a></div><div class="ttdeci">@ SPELL_FAILED_FISHING_TOO_LOW</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00514">SpellDefines.h:514</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba0dc7c11206c85c14a7c4243153d86875"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba0dc7c11206c85c14a7c4243153d86875">SPELL_FAILED_CANT_BE_MILLED</a></div><div class="ttdeci">@ SPELL_FAILED_CANT_BE_MILLED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00349">SpellDefines.h:349</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba11cd41b98b17d534ca5a171df834d909"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba11cd41b98b17d534ca5a171df834d909">SPELL_FAILED_NOT_MOUNTED</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_MOUNTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00397">SpellDefines.h:397</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba145cdf9d18f777b5f93858ce52d27581"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba145cdf9d18f777b5f93858ce52d27581">SPELL_FAILED_EQUIPPED_ITEM_CLASS_OFFHAND</a></div><div class="ttdeci">@ SPELL_FAILED_EQUIPPED_ITEM_CLASS_OFFHAND</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00364">SpellDefines.h:364</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba14dbc498af8458773a0095bb98957889"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba14dbc498af8458773a0095bb98957889">SPELL_FAILED_AFFECTING_COMBAT</a></div><div class="ttdeci">@ SPELL_FAILED_AFFECTING_COMBAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00334">SpellDefines.h:334</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba18552f5d30b48824016eafa3b1b411b6">SPELL_FAILED_CASTER_AURASTATE</a></div><div class="ttdeci">@ SPELL_FAILED_CASTER_AURASTATE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00355">SpellDefines.h:355</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba189024402cf4723fd717ba84cde101fa"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba189024402cf4723fd717ba84cde101fa">SPELL_FAILED_EQUIPPED_ITEM_CLASS</a></div><div class="ttdeci">@ SPELL_FAILED_EQUIPPED_ITEM_CLASS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00362">SpellDefines.h:362</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba190b67f5dadc0d719211257c5f91c2dd"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba190b67f5dadc0d719211257c5f91c2dd">SPELL_FAILED_TOO_CLOSE</a></div><div class="ttdeci">@ SPELL_FAILED_TOO_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00461">SpellDefines.h:461</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba1a54b16fbf940ffc9f6451e815579b8d"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1a54b16fbf940ffc9f6451e815579b8d">SPELL_FAILED_ITEM_AT_MAX_CHARGES</a></div><div class="ttdeci">@ SPELL_FAILED_ITEM_AT_MAX_CHARGES</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00512">SpellDefines.h:512</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba1aac9d46e45a1eacb68c46b1c3e16014"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1aac9d46e45a1eacb68c46b1c3e16014">SPELL_FAILED_TARGET_NOT_PLAYER</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_NOT_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00455">SpellDefines.h:455</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba1e0deafa01f42a456c4f425717997989"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba1e0deafa01f42a456c4f425717997989">SPELL_FAILED_MIN_SKILL</a></div><div class="ttdeci">@ SPELL_FAILED_MIN_SKILL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00483">SpellDefines.h:483</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba24fad721a4cf3b105b67b9d0613be0c3"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba24fad721a4cf3b105b67b9d0613be0c3">SPELL_FAILED_NO_POWER</a></div><div class="ttdeci">@ SPELL_FAILED_NO_POWER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00418">SpellDefines.h:418</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba270280418a53c9d018219f9cddda4e3c"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba270280418a53c9d018219f9cddda4e3c">SPELL_FAILED_NOT_KNOWN</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_KNOWN</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00396">SpellDefines.h:396</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba2978fb13bfa559f6fe707282f9ae209e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2978fb13bfa559f6fe707282f9ae209e">SPELL_FAILED_FOOD_LOWLEVEL</a></div><div class="ttdeci">@ SPELL_FAILED_FOOD_LOWLEVEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00368">SpellDefines.h:368</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba2afb5e4b72a353abe6677d7d9ee8eeec"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2afb5e4b72a353abe6677d7d9ee8eeec">SPELL_FAILED_NOT_HERE</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_HERE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00393">SpellDefines.h:393</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba2ecfb8aa0b123d8a065470434835075e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba2ecfb8aa0b123d8a065470434835075e">SPELL_FAILED_NOT_STANDING</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_STANDING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00402">SpellDefines.h:402</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba3146bc5b21d4e3b9a68e89d834b543fc"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3146bc5b21d4e3b9a68e89d834b543fc">SPELL_FAILED_ROOTED</a></div><div class="ttdeci">@ SPELL_FAILED_ROOTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00436">SpellDefines.h:436</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba32fda87d13db4d9c3e234cc4e4e90bf6"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba32fda87d13db4d9c3e234cc4e4e90bf6">SPELL_FAILED_TARGET_NOT_DEAD</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_NOT_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00452">SpellDefines.h:452</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba3396957a80f674588a97d40eb1a2f064"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3396957a80f674588a97d40eb1a2f064">SPELL_FAILED_CHEST_IN_USE</a></div><div class="ttdeci">@ SPELL_FAILED_CHEST_IN_USE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00358">SpellDefines.h:358</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba379308e1f442458eb4d1f1dde308b7c7"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba379308e1f442458eb4d1f1dde308b7c7">SPELL_FAILED_TARGET_IN_COMBAT</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_IN_COMBAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00449">SpellDefines.h:449</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba3c4802dcde9c3d8be05c8028764a7ff4"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3c4802dcde9c3d8be05c8028764a7ff4">SPELL_FAILED_WRONG_PET_FOOD</a></div><div class="ttdeci">@ SPELL_FAILED_WRONG_PET_FOOD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00468">SpellDefines.h:468</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba3edca33213e571cce6e1c1039ee33751"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba3edca33213e571cce6e1c1039ee33751">SPELL_FAILED_CUSTOM_ERROR</a></div><div class="ttdeci">@ SPELL_FAILED_CUSTOM_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00505">SpellDefines.h:505</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba413f89a20f52b5ee916ca64f50fc4467"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba413f89a20f52b5ee916ca64f50fc4467">SPELL_FAILED_UNKNOWN</a></div><div class="ttdeci">@ SPELL_FAILED_UNKNOWN</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00520">SpellDefines.h:520</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba4333fb3114462db8facc40c46d92c40e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4333fb3114462db8facc40c46d92c40e">SPELL_FAILED_DAMAGE_IMMUNE</a></div><div class="ttdeci">@ SPELL_FAILED_DAMAGE_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00479">SpellDefines.h:479</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba44b93fb9fe8561fde2a6bf37ceaf1970">SPELL_FAILED_BAD_IMPLICIT_TARGETS</a></div><div class="ttdeci">@ SPELL_FAILED_BAD_IMPLICIT_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00344">SpellDefines.h:344</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba466e084dd0f4d95636614c0f00105d09"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba466e084dd0f4d95636614c0f00105d09">SPELL_FAILED_TARGET_IS_TRIVIAL</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_IS_TRIVIAL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00491">SpellDefines.h:491</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba47a5ddf521d02893e0a4132fc8d3ef90"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba47a5ddf521d02893e0a4132fc8d3ef90">SPELL_FAILED_TRY_AGAIN</a></div><div class="ttdeci">@ SPELL_FAILED_TRY_AGAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00465">SpellDefines.h:465</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba49c5a69312003b5a03234fbac6b460b0"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba49c5a69312003b5a03234fbac6b460b0">SPELL_FAILED_NO_COMBO_POINTS</a></div><div class="ttdeci">@ SPELL_FAILED_NO_COMBO_POINTS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00411">SpellDefines.h:411</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4be3e77341339855ead6c47f42b2eb5a">SPELL_FAILED_ALREADY_HAVE_SUMMON</a></div><div class="ttdeci">@ SPELL_FAILED_ALREADY_HAVE_SUMMON</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00340">SpellDefines.h:340</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba4c3f7a0632ca530f1240ef3bec4a8dac"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4c3f7a0632ca530f1240ef3bec4a8dac">SPELL_FAILED_ALREADY_AT_FULL_POWER</a></div><div class="ttdeci">@ SPELL_FAILED_ALREADY_AT_FULL_POWER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00337">SpellDefines.h:337</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba4d4bd06fea08b64dd0e963b9ba714942"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba4d4bd06fea08b64dd0e963b9ba714942">SPELL_FAILED_NOT_TRADEABLE</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_TRADEABLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00403">SpellDefines.h:403</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba502cb600f20a34621d9b04b897c1046b"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba502cb600f20a34621d9b04b897c1046b">SPELL_FAILED_ALREADY_OPEN</a></div><div class="ttdeci">@ SPELL_FAILED_ALREADY_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00341">SpellDefines.h:341</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba529a897ba353bc5fcaba4711ed78c02f"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba529a897ba353bc5fcaba4711ed78c02f">SPELL_FAILED_ITEM_NOT_READY</a></div><div class="ttdeci">@ SPELL_FAILED_ITEM_NOT_READY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00378">SpellDefines.h:378</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba545130a442f0e0877608381ba7bc0458"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba545130a442f0e0877608381ba7bc0458">SPELL_FAILED_NOT_TRADING</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_TRADING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00404">SpellDefines.h:404</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba54cc630c056dcd9d3f6c2736bb4f7ef5"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba54cc630c056dcd9d3f6c2736bb4f7ef5">SPELL_FAILED_NO_CHARGES_REMAIN</a></div><div class="ttdeci">@ SPELL_FAILED_NO_CHARGES_REMAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00409">SpellDefines.h:409</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba56178933380524354520fc81ffa3b350"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba56178933380524354520fc81ffa3b350">SPELL_FAILED_ITEM_GONE</a></div><div class="ttdeci">@ SPELL_FAILED_ITEM_GONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00376">SpellDefines.h:376</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba57bf9e02ebe1906a99001f3de731f757"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba57bf9e02ebe1906a99001f3de731f757">SPELL_FAILED_TARGET_NO_POCKETS</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_NO_POCKETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00456">SpellDefines.h:456</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba5a48fe3abb749ced7e5699f031ec1be7">SPELL_FAILED_NO_AMMO</a></div><div class="ttdeci">@ SPELL_FAILED_NO_AMMO</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00408">SpellDefines.h:408</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6084b07c392d47c533ddb7fc2660f602"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6084b07c392d47c533ddb7fc2660f602">SPELL_FAILED_NO_MOUNTS_ALLOWED</a></div><div class="ttdeci">@ SPELL_FAILED_NO_MOUNTS_ALLOWED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00416">SpellDefines.h:416</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba643172514f0c397f42a9d70a243782b7">SPELL_FAILED_ITEM_NOT_FOUND</a></div><div class="ttdeci">@ SPELL_FAILED_ITEM_NOT_FOUND</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00377">SpellDefines.h:377</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba65ebd8801e5a2b6424e3a7064f09c011"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba65ebd8801e5a2b6424e3a7064f09c011">SPELL_FAILED_TARGET_IS_PLAYER</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_IS_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00450">SpellDefines.h:450</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6845123487453490658f1b1f746ef8c5">SPELL_FAILED_OUT_OF_RANGE</a></div><div class="ttdeci">@ SPELL_FAILED_OUT_OF_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00430">SpellDefines.h:430</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6bdfdb4e6881af86168c722df5d0b2dc"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6bdfdb4e6881af86168c722df5d0b2dc">SPELL_FAILED_NOT_FISHABLE</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_FISHABLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00391">SpellDefines.h:391</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6c985f3372baa7af2864bb483d1f16a5"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6c985f3372baa7af2864bb483d1f16a5">SPELL_FAILED_IMMUNE</a></div><div class="ttdeci">@ SPELL_FAILED_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00371">SpellDefines.h:371</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6e18028072d461188e44ba8b28b7865a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6e18028072d461188e44ba8b28b7865a">SPELL_FAILED_EQUIPPED_ITEM</a></div><div class="ttdeci">@ SPELL_FAILED_EQUIPPED_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00361">SpellDefines.h:361</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6ee4ae4e17351b6ba37cc731e814062e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6ee4ae4e17351b6ba37cc731e814062e">SPELL_FAILED_NOT_BEHIND</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_BEHIND</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00390">SpellDefines.h:390</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6f1577d756a021a3789b7b85da15e4e0"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6f1577d756a021a3789b7b85da15e4e0">SPELL_FAILED_ALREADY_AT_FULL_HEALTH</a></div><div class="ttdeci">@ SPELL_FAILED_ALREADY_AT_FULL_HEALTH</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00335">SpellDefines.h:335</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba6ff414333f83deadfa05e6b4406af895"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba6ff414333f83deadfa05e6b4406af895">SPELL_FAILED_PREVENTED_BY_MECHANIC</a></div><div class="ttdeci">@ SPELL_FAILED_PREVENTED_BY_MECHANIC</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00480">SpellDefines.h:480</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba72572bc33a90fcfedb04e2930230fa6c">SPELL_FAILED_ALREADY_HAVE_CHARM</a></div><div class="ttdeci">@ SPELL_FAILED_ALREADY_HAVE_CHARM</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00339">SpellDefines.h:339</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba731c7dfda368c8bfdb1b9cc7d3f696b8"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba731c7dfda368c8bfdb1b9cc7d3f696b8">SPELL_FAILED_TARGET_NOT_IN_INSTANCE</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_NOT_IN_INSTANCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00470">SpellDefines.h:470</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba76455f29fb795f37f695bc796e17459e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba76455f29fb795f37f695bc796e17459e">SPELL_FAILED_HIGHLEVEL</a></div><div class="ttdeci">@ SPELL_FAILED_HIGHLEVEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00369">SpellDefines.h:369</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba768883072914aec215a9b37c0f8d7565">SPELL_FAILED_DONT_REPORT</a></div><div class="ttdeci">@ SPELL_FAILED_DONT_REPORT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00360">SpellDefines.h:360</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba7d281dd496eaa35f843af512b12edb2b"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba7d281dd496eaa35f843af512b12edb2b">SPELL_FAILED_CANT_CAST_ON_TAPPED</a></div><div class="ttdeci">@ SPELL_FAILED_CANT_CAST_ON_TAPPED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00351">SpellDefines.h:351</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba847437f05d4dfe914c63dffe4badc3a1"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba847437f05d4dfe914c63dffe4badc3a1">SPELL_FAILED_NOT_WHILE_LOOTING</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_WHILE_LOOTING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00407">SpellDefines.h:407</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba848d985f216792498681d596be825234">SPELL_FAILED_TARGET_AURASTATE</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_AURASTATE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00444">SpellDefines.h:444</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba85507d5434460a32675c0e5601110d3f"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba85507d5434460a32675c0e5601110d3f">SPELL_FAILED_TOTEMS</a></div><div class="ttdeci">@ SPELL_FAILED_TOTEMS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00464">SpellDefines.h:464</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba88b9e72c69a71b97dd9f7f381aaf20d2">SPELL_FAILED_ERROR</a></div><div class="ttdeci">@ SPELL_FAILED_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00365">SpellDefines.h:365</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba89d92a0c6d087b8a84f1e5df6b565caf">SPELL_FAILED_LOWLEVEL</a></div><div class="ttdeci">@ SPELL_FAILED_LOWLEVEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00381">SpellDefines.h:381</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba8b8a8978f57575bd089e2da378bf03ad"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba8b8a8978f57575bd089e2da378bf03ad">SPELL_FAILED_NOT_READY</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_READY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00400">SpellDefines.h:400</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba9619c758351ce747a4c0a575673ae07f"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9619c758351ce747a4c0a575673ae07f">SPELL_FAILED_ONLY_STEALTHED</a></div><div class="ttdeci">@ SPELL_FAILED_ONLY_STEALTHED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00428">SpellDefines.h:428</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba9c6a5ea90b0797694ebec8b386fd920b"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9c6a5ea90b0797694ebec8b386fd920b">SPELL_FAILED_CANT_DO_THAT_RIGHT_NOW</a></div><div class="ttdeci">@ SPELL_FAILED_CANT_DO_THAT_RIGHT_NOW</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00506">SpellDefines.h:506</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cba9d6ef68d218b7aa9b8cf1677a1c7bba8"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cba9d6ef68d218b7aa9b8cf1677a1c7bba8">SPELL_FAILED_ONLY_SHAPESHIFT</a></div><div class="ttdeci">@ SPELL_FAILED_ONLY_SHAPESHIFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00427">SpellDefines.h:427</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaa596afe8da53297dd96515ebba6adc5a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa596afe8da53297dd96515ebba6adc5a">SPELL_FAILED_TARGET_IS_PLAYER_CONTROLLED</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_IS_PLAYER_CONTROLLED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00451">SpellDefines.h:451</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaa628da71e8ecb35003c937c46662d243"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa628da71e8ecb35003c937c46662d243">SPELL_FAILED_REAGENTS</a></div><div class="ttdeci">@ SPELL_FAILED_REAGENTS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00433">SpellDefines.h:433</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaa6cc63143dadc031b5c849e25b6b6647"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaa6cc63143dadc031b5c849e25b6b6647">SPELL_FAILED_ONLY_ABOVEWATER</a></div><div class="ttdeci">@ SPELL_FAILED_ONLY_ABOVEWATER</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00421">SpellDefines.h:421</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaaa8582c07f58c05e32b1885a14e8320a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaa8582c07f58c05e32b1885a14e8320a">SPELL_FAILED_TARGETS_DEAD</a></div><div class="ttdeci">@ SPELL_FAILED_TARGETS_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00442">SpellDefines.h:442</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaab6c81dc718677e5461e405c0140ed84"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaab6c81dc718677e5461e405c0140ed84">SPELL_FAILED_AURA_BOUNCED</a></div><div class="ttdeci">@ SPELL_FAILED_AURA_BOUNCED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00342">SpellDefines.h:342</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaaf1433b9120020e34699cd0774d09830"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaaf1433b9120020e34699cd0774d09830">SPELL_FAILED_CANT_BE_CHARMED</a></div><div class="ttdeci">@ SPELL_FAILED_CANT_BE_CHARMED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00346">SpellDefines.h:346</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbab46f3fd2e85aca9f1293d380385bf0d8"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbab46f3fd2e85aca9f1293d380385bf0d8">SPELL_FAILED_CASTER_DEAD</a></div><div class="ttdeci">@ SPELL_FAILED_CASTER_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00356">SpellDefines.h:356</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabac1a9f442523ff297fbca0beea649b3">SPELL_FAILED_BAD_TARGETS</a></div><div class="ttdeci">@ SPELL_FAILED_BAD_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00345">SpellDefines.h:345</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbabaec038b3106e2f9345b84a4396711da"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbabaec038b3106e2f9345b84a4396711da">SPELL_FAILED_CANT_BE_DISENCHANTED</a></div><div class="ttdeci">@ SPELL_FAILED_CANT_BE_DISENCHANTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00347">SpellDefines.h:347</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbac060d1a222e61fb41adb93c9cf15e587"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac060d1a222e61fb41adb93c9cf15e587">SPELL_FAILED_ITEM_ENCHANT_TRADE_WINDOW</a></div><div class="ttdeci">@ SPELL_FAILED_ITEM_ENCHANT_TRADE_WINDOW</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00515">SpellDefines.h:515</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac234c263c91b72ee0f67eee75f28f9c4">SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_CANNOT_BE_RESURRECTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00519">SpellDefines.h:519</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbac434f4f7f84bea20939be3067eb33c5f"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac434f4f7f84bea20939be3067eb33c5f">SPELL_FAILED_TOO_MANY_OF_ITEM</a></div><div class="ttdeci">@ SPELL_FAILED_TOO_MANY_OF_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00462">SpellDefines.h:462</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbac5b4c7f6ad3c18c893d7183117bcbbda"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac5b4c7f6ad3c18c893d7183117bcbbda">SPELL_FAILED_FIZZLE</a></div><div class="ttdeci">@ SPELL_FAILED_FIZZLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00366">SpellDefines.h:366</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbac74ff5725df2905f4d85db915b8be032"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbac74ff5725df2905f4d85db915b8be032">SPELL_FAILED_CONFUSED</a></div><div class="ttdeci">@ SPELL_FAILED_CONFUSED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00359">SpellDefines.h:359</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbad08fa9eaa1789401b21326a44252763a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad08fa9eaa1789401b21326a44252763a">SPELL_FAILED_TARGET_UNSKINNABLE</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_UNSKINNABLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00459">SpellDefines.h:459</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbad0d4fef991322bbae678d56d2785226d"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad0d4fef991322bbae678d56d2785226d">SPELL_FAILED_SILENCED</a></div><div class="ttdeci">@ SPELL_FAILED_SILENCED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00437">SpellDefines.h:437</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbad371eadb638a77bf90ef71652bed1ea4"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad371eadb638a77bf90ef71652bed1ea4">SPELL_FAILED_NOT_SHAPESHIFT</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_SHAPESHIFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00401">SpellDefines.h:401</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbad611ba5231ffb877f1c3652394038d6c"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad611ba5231ffb877f1c3652394038d6c">SPELL_FAILED_UNIQUE_GLYPH</a></div><div class="ttdeci">@ SPELL_FAILED_UNIQUE_GLYPH</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00509">SpellDefines.h:509</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbad844177691a3eb714772f0bf8bf85bb6"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad844177691a3eb714772f0bf8bf85bb6">SPELL_FAILED_NEED_MORE_ITEMS</a></div><div class="ttdeci">@ SPELL_FAILED_NEED_MORE_ITEMS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00388">SpellDefines.h:388</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbad9886ecfbc82a37ce9448c2706100668"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbad9886ecfbc82a37ce9448c2706100668">SPELL_FAILED_TARGET_NO_WEAPONS</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_NO_WEAPONS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00457">SpellDefines.h:457</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbadb39054d5491d07a158b74ffc64c30e6"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb39054d5491d07a158b74ffc64c30e6">SPELL_FAILED_ONLY_OUTDOORS</a></div><div class="ttdeci">@ SPELL_FAILED_ONLY_OUTDOORS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00426">SpellDefines.h:426</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadb56426fd2113c3ff3ff3d1815d79fa6">SPELL_CAST_OK</a></div><div class="ttdeci">@ SPELL_CAST_OK</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00526">SpellDefines.h:525</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadda35e8693c1a5918f4df6a87f855875">SPELL_FAILED_CHARMED</a></div><div class="ttdeci">@ SPELL_FAILED_CHARMED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00357">SpellDefines.h:357</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbadf757f682707cde6cc82952b26cdf505">SPELL_FAILED_LOW_CASTLEVEL</a></div><div class="ttdeci">@ SPELL_FAILED_LOW_CASTLEVEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00382">SpellDefines.h:382</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbae4731a85085ddbbf17c538cb5d910f71"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae4731a85085ddbbf17c538cb5d910f71">SPELL_FAILED_CANT_BE_PROSPECTED</a></div><div class="ttdeci">@ SPELL_FAILED_CANT_BE_PROSPECTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00350">SpellDefines.h:350</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbae48a6bed6e0e1b5748062142c97d1669"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae48a6bed6e0e1b5748062142c97d1669">SPELL_FAILED_ONLY_MOUNTED</a></div><div class="ttdeci">@ SPELL_FAILED_ONLY_MOUNTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00424">SpellDefines.h:424</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbae5166b7133ecb3db49d7ce2e94d470e2"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5166b7133ecb3db49d7ce2e94d470e2">SPELL_FAILED_NOT_ON_TRANSPORT</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_ON_TRANSPORT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00399">SpellDefines.h:399</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae5f436c2cbfbb49ae7ab2b21ac2b675d">SPELL_FAILED_LINE_OF_SIGHT</a></div><div class="ttdeci">@ SPELL_FAILED_LINE_OF_SIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00380">SpellDefines.h:380</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbae6d69f69f6cdd70d7a287c9b1a40ce25"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae6d69f69f6cdd70d7a287c9b1a40ce25">SPELL_FAILED_FLEEING</a></div><div class="ttdeci">@ SPELL_FAILED_FLEEING</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00367">SpellDefines.h:367</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbae828ac076cd78171682ba1ac82eb57f2"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbae828ac076cd78171682ba1ac82eb57f2">SPELL_FAILED_PACIFIED</a></div><div class="ttdeci">@ SPELL_FAILED_PACIFIED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00431">SpellDefines.h:431</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaedcd1b6ac24138162134e6987ea74d5e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaedcd1b6ac24138162134e6987ea74d5e">SPELL_FAILED_EQUIPPED_ITEM_CLASS_MAINHAND</a></div><div class="ttdeci">@ SPELL_FAILED_EQUIPPED_ITEM_CLASS_MAINHAND</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00363">SpellDefines.h:363</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaeecb06edf432f8f464c1e4ba2704095a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaeecb06edf432f8f464c1e4ba2704095a">SPELL_FAILED_SPELL_IN_PROGRESS</a></div><div class="ttdeci">@ SPELL_FAILED_SPELL_IN_PROGRESS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00438">SpellDefines.h:438</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaefb143fec77b4fcde0bc45deb3c38b7c">SPELL_FAILED_NO_PET</a></div><div class="ttdeci">@ SPELL_FAILED_NO_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00417">SpellDefines.h:417</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf05e1b2262997839340ddceb8bc9dc39"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf05e1b2262997839340ddceb8bc9dc39">SPELL_FAILED_MAINHAND_EMPTY</a></div><div class="ttdeci">@ SPELL_FAILED_MAINHAND_EMPTY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00383">SpellDefines.h:383</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf0978a4bf6c56edcecb0fdc39b56ea85"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf0978a4bf6c56edcecb0fdc39b56ea85">SPELL_FAILED_TARGET_LOCKED_TO_RAID_INSTANCE</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_LOCKED_TO_RAID_INSTANCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00502">SpellDefines.h:502</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf43ad3199e8e395f348d768f4f11b39c"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf43ad3199e8e395f348d768f4f11b39c">SPELL_FAILED_REQUIRES_SPELL_FOCUS</a></div><div class="ttdeci">@ SPELL_FAILED_REQUIRES_SPELL_FOCUS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00435">SpellDefines.h:435</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf4769b8c59264918bb4ae14e2452eb8f"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf4769b8c59264918bb4ae14e2452eb8f">SPELL_FAILED_NOPATH</a></div><div class="ttdeci">@ SPELL_FAILED_NOPATH</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00389">SpellDefines.h:389</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf5c8961a3681a64ace4b65bd9927d31a"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf5c8961a3681a64ace4b65bd9927d31a">SPELL_FAILED_TOTEM_CATEGORY</a></div><div class="ttdeci">@ SPELL_FAILED_TOTEM_CATEGORY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00463">SpellDefines.h:463</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf7e1c974889123cf0b779d9508c46c2f"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf7e1c974889123cf0b779d9508c46c2f">SPELL_FAILED_SPELL_UNAVAILABLE</a></div><div class="ttdeci">@ SPELL_FAILED_SPELL_UNAVAILABLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00440">SpellDefines.h:440</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbaf8d707921901db4647124ccbc08dc83c"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbaf8d707921901db4647124ccbc08dc83c">SPELL_FAILED_REQUIRES_AREA</a></div><div class="ttdeci">@ SPELL_FAILED_REQUIRES_AREA</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00434">SpellDefines.h:434</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbafcdfe7569de0abc1be48e73fc20e29c3"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafcdfe7569de0abc1be48e73fc20e29c3">SPELL_FAILED_NO_EDIBLE_CORPSES</a></div><div class="ttdeci">@ SPELL_FAILED_NO_EDIBLE_CORPSES</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00474">SpellDefines.h:474</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbafd0beaff636dbf2950814f9697dcb341"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd0beaff636dbf2950814f9697dcb341">SPELL_FAILED_INTERRUPTED</a></div><div class="ttdeci">@ SPELL_FAILED_INTERRUPTED</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00373">SpellDefines.h:373</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbafd13b78a42399b124398e3b039cfd0f2"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafd13b78a42399b124398e3b039cfd0f2">SPELL_FAILED_TARGET_AFFECTING_COMBAT</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_AFFECTING_COMBAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00443">SpellDefines.h:443</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbafe03e4549529ce5f78d26d7c2c46e414"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafe03e4549529ce5f78d26d7c2c46e414">SPELL_FAILED_ONLY_INDOORS</a></div><div class="ttdeci">@ SPELL_FAILED_ONLY_INDOORS</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00423">SpellDefines.h:423</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbafede20d779c776cfb3cf819a7589801b"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafede20d779c776cfb3cf819a7589801b">SPELL_FAILED_NOT_ON_TAXI</a></div><div class="ttdeci">@ SPELL_FAILED_NOT_ON_TAXI</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00398">SpellDefines.h:398</a></div></div>
<div class="ttc" id="aSpellDefines_8h_html_aff3ab1b558940f59a9d1aab9f95943cbafee5892d26e2d5331a343b1e0a40097e"><div class="ttname"><a href="SpellDefines_8h.html#aff3ab1b558940f59a9d1aab9f95943cbafee5892d26e2d5331a343b1e0a40097e">SPELL_FAILED_TARGET_FRIENDLY</a></div><div class="ttdeci">@ SPELL_FAILED_TARGET_FRIENDLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellDefines_8h_source.html#l00448">SpellDefines.h:448</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97">SpellEffects</a></div><div class="ttdeci">SpellEffects</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00024">SpellEffectDefines.h:25</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a027bcdf3b42e90e7374802fe61fd776d"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a027bcdf3b42e90e7374802fe61fd776d">SPELL_EFFECT_DUMMY</a></div><div class="ttdeci">@ SPELL_EFFECT_DUMMY</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00029">SpellEffectDefines.h:29</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a07034baa2b6fe31ad40f733e0b943764"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a07034baa2b6fe31ad40f733e0b943764">SPELL_EFFECT_SUMMON_CHANGE_ITEM</a></div><div class="ttdeci">@ SPELL_EFFECT_SUMMON_CHANGE_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00060">SpellEffectDefines.h:60</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a07e1f1c3187108c179e65e9b313258cd"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a07e1f1c3187108c179e65e9b313258cd">SPELL_EFFECT_LEAP</a></div><div class="ttdeci">@ SPELL_EFFECT_LEAP</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00055">SpellEffectDefines.h:55</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a0a43a6be2a57b573021530d45a1e367e"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a0a43a6be2a57b573021530d45a1e367e">SPELL_EFFECT_POWER_BURN</a></div><div class="ttdeci">@ SPELL_EFFECT_POWER_BURN</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00088">SpellEffectDefines.h:88</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a0e77fe9c0e808131a2440afe38a856af"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a0e77fe9c0e808131a2440afe38a856af">SPELL_EFFECT_SUMMON_PET</a></div><div class="ttdeci">@ SPELL_EFFECT_SUMMON_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00082">SpellEffectDefines.h:82</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a10e5f9dd8abe4f069a1f244ac042ac73"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a10e5f9dd8abe4f069a1f244ac042ac73">SPELL_EFFECT_DISENCHANT</a></div><div class="ttdeci">@ SPELL_EFFECT_DISENCHANT</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00125">SpellEffectDefines.h:125</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a13356fe4dbcf454b9b7078fba9037965"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a13356fe4dbcf454b9b7078fba9037965">SPELL_EFFECT_PROSPECTING</a></div><div class="ttdeci">@ SPELL_EFFECT_PROSPECTING</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00153">SpellEffectDefines.h:153</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a1ab15c363eaea4e2bc8d7f8fc0c564cf"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a1ab15c363eaea4e2bc8d7f8fc0c564cf">SPELL_EFFECT_SELF_RESURRECT</a></div><div class="ttdeci">@ SPELL_EFFECT_SELF_RESURRECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00120">SpellEffectDefines.h:120</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a28e7a1160ba7ba1c53fff6591320ae32"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a28e7a1160ba7ba1c53fff6591320ae32">SPELL_EFFECT_DISTRACT</a></div><div class="ttdeci">@ SPELL_EFFECT_DISTRACT</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00095">SpellEffectDefines.h:95</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a2c6434d09a221f75cf5496947aa2eb89"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a2c6434d09a221f75cf5496947aa2eb89">SPELL_EFFECT_ENCHANT_HELD_ITEM</a></div><div class="ttdeci">@ SPELL_EFFECT_ENCHANT_HELD_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00118">SpellEffectDefines.h:118</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a3467958b5173482af8149b7c32c9ed4d"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a3467958b5173482af8149b7c32c9ed4d">SPELL_EFFECT_ENCHANT_ITEM</a></div><div class="ttdeci">@ SPELL_EFFECT_ENCHANT_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00079">SpellEffectDefines.h:79</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a35549e2c13c9b3d489d961b8dbf014fe"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a35549e2c13c9b3d489d961b8dbf014fe">SPELL_EFFECT_WMO_REPAIR</a></div><div class="ttdeci">@ SPELL_EFFECT_WMO_REPAIR</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00114">SpellEffectDefines.h:114</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a38f4a390f591eee0f8f7873d4ef4ec49"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a38f4a390f591eee0f8f7873d4ef4ec49">MAX_SPELL_EFFECTS</a></div><div class="ttdeci">@ MAX_SPELL_EFFECTS</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00192">SpellEffectDefines.h:191</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a39bbbdfde62217be6a4d4166366aca56"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a39bbbdfde62217be6a4d4166366aca56">SPELL_EFFECT_STUCK</a></div><div class="ttdeci">@ SPELL_EFFECT_STUCK</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00110">SpellEffectDefines.h:110</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a43e6a57d62764387de4c1dd5d4aeed33"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a43e6a57d62764387de4c1dd5d4aeed33">SPELL_EFFECT_SUMMON_RAF_FRIEND</a></div><div class="ttdeci">@ SPELL_EFFECT_SUMMON_RAF_FRIEND</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00178">SpellEffectDefines.h:178</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a44d3da0109cb50c42bad53e2790715e4"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a44d3da0109cb50c42bad53e2790715e4">SPELL_EFFECT_WEAPON_DAMAGE</a></div><div class="ttdeci">@ SPELL_EFFECT_WEAPON_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00084">SpellEffectDefines.h:84</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a4709170900adb00870701e66eb1b2837"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4709170900adb00870701e66eb1b2837">SPELL_EFFECT_APPLY_GLYPH</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_GLYPH</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00100">SpellEffectDefines.h:100</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a4882157067be8542f9192927816acda1"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4882157067be8542f9192927816acda1">SPELL_EFFECT_HEAL</a></div><div class="ttdeci">@ SPELL_EFFECT_HEAL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00036">SpellEffectDefines.h:36</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a4a3d78eee24d6e6d28fbaa67213be92d"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4a3d78eee24d6e6d28fbaa67213be92d">SPELL_EFFECT_NORMALIZED_WEAPON_DMG</a></div><div class="ttdeci">@ SPELL_EFFECT_NORMALIZED_WEAPON_DMG</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00147">SpellEffectDefines.h:147</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a4bf59655f967f14cdb70296778f47d20"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4bf59655f967f14cdb70296778f47d20">SPELL_EFFECT_FEED_PET</a></div><div class="ttdeci">@ SPELL_EFFECT_FEED_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00127">SpellEffectDefines.h:127</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a4ef88119cf7545ebf2a3402027bf112a"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a4ef88119cf7545ebf2a3402027bf112a">SPELL_EFFECT_SUMMON_PLAYER</a></div><div class="ttdeci">@ SPELL_EFFECT_SUMMON_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00111">SpellEffectDefines.h:111</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a5200f96531d02c2c5665e418f588a489"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a5200f96531d02c2c5665e418f588a489">SPELL_EFFECT_WMO_DAMAGE</a></div><div class="ttdeci">@ SPELL_EFFECT_WMO_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00113">SpellEffectDefines.h:113</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a610efccb231f65a5c00189122f7ef907"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a610efccb231f65a5c00189122f7ef907">SPELL_EFFECT_DISPEL</a></div><div class="ttdeci">@ SPELL_EFFECT_DISPEL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00064">SpellEffectDefines.h:64</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a61ab002c9f8774c1c907da108a721328"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a61ab002c9f8774c1c907da108a721328">SPELL_EFFECT_TRIGGER_SPELL_2</a></div><div class="ttdeci">@ SPELL_EFFECT_TRIGGER_SPELL_2</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00177">SpellEffectDefines.h:177</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a62333a50634af5b796a5de9a8cc42084"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a62333a50634af5b796a5de9a8cc42084">SPELL_EFFECT_NONE</a></div><div class="ttdeci">@ SPELL_EFFECT_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00026">SpellEffectDefines.h:26</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a64cdaec1ed4305de209cd2aeab92aff1"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a64cdaec1ed4305de209cd2aeab92aff1">SPELL_EFFECT_MILLING</a></div><div class="ttdeci">@ SPELL_EFFECT_MILLING</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00184">SpellEffectDefines.h:184</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a6a7c4e6691a082baa4ccf8e8c2efe6b3"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a6a7c4e6691a082baa4ccf8e8c2efe6b3">SPELL_EFFECT_TAMECREATURE</a></div><div class="ttdeci">@ SPELL_EFFECT_TAMECREATURE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00081">SpellEffectDefines.h:81</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a6b546cbd034b7414776e260f8431789b"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a6b546cbd034b7414776e260f8431789b">SPELL_EFFECT_JUMP_DEST</a></div><div class="ttdeci">@ SPELL_EFFECT_JUMP_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00068">SpellEffectDefines.h:68</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a7382f976f2e8ff06e041558e5292f32e"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a7382f976f2e8ff06e041558e5292f32e">SPELL_EFFECT_TELEPORT_UNITS_FACE_CASTER</a></div><div class="ttdeci">@ SPELL_EFFECT_TELEPORT_UNITS_FACE_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00069">SpellEffectDefines.h:69</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a80153156c6cdcf1436c5a4fc33ae95c7"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a80153156c6cdcf1436c5a4fc33ae95c7">SPELL_EFFECT_PICKPOCKET</a></div><div class="ttdeci">@ SPELL_EFFECT_PICKPOCKET</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00097">SpellEffectDefines.h:97</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a8505f4858ac2e4cdcf252b949f082c36"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a8505f4858ac2e4cdcf252b949f082c36">SPELL_EFFECT_ADD_EXTRA_ATTACKS</a></div><div class="ttdeci">@ SPELL_EFFECT_ADD_EXTRA_ATTACKS</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00045">SpellEffectDefines.h:45</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a8e8f8712c494e5f9bffca881c9398304"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a8e8f8712c494e5f9bffca881c9398304">SPELL_EFFECT_HEAL_MECHANICAL</a></div><div class="ttdeci">@ SPELL_EFFECT_HEAL_MECHANICAL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00101">SpellEffectDefines.h:101</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a905e6b16c4a6a4f7e538f0b6b97190d5"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a905e6b16c4a6a4f7e538f0b6b97190d5">SPELL_EFFECT_WEAPON_PERCENT_DAMAGE</a></div><div class="ttdeci">@ SPELL_EFFECT_WEAPON_PERCENT_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00057">SpellEffectDefines.h:57</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97a96bae50ba11bd175354f4db26746867f">SPELL_EFFECT_APPLY_AREA_AURA_RAID</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AREA_AURA_RAID</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00091">SpellEffectDefines.h:91</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aa2beb2e0d1440f64ea1661312ed02628"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa2beb2e0d1440f64ea1661312ed02628">SPELL_EFFECT_WEAPON_DAMAGE_NOSCHOOL</a></div><div class="ttdeci">@ SPELL_EFFECT_WEAPON_DAMAGE_NOSCHOOL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00043">SpellEffectDefines.h:43</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aa3290e738b6cd09859039989143f9ac1"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa3290e738b6cd09859039989143f9ac1">SPELL_EFFECT_PERSISTENT_AREA_AURA</a></div><div class="ttdeci">@ SPELL_EFFECT_PERSISTENT_AREA_AURA</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00053">SpellEffectDefines.h:53</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aa7be476935ce81144c2b383b7af7bf47"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aa7be476935ce81144c2b383b7af7bf47">SPELL_EFFECT_SUMMON</a></div><div class="ttdeci">@ SPELL_EFFECT_SUMMON</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00054">SpellEffectDefines.h:54</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ab0727b6312cbc0d83b93ab5d5578fe8b"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab0727b6312cbc0d83b93ab5d5578fe8b">SPELL_EFFECT_ENERGIZE</a></div><div class="ttdeci">@ SPELL_EFFECT_ENERGIZE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00056">SpellEffectDefines.h:56</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ab12a0929cec4bc67031a93fe03f51e18"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab12a0929cec4bc67031a93fe03f51e18">SPELL_EFFECT_BIND</a></div><div class="ttdeci">@ SPELL_EFFECT_BIND</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00037">SpellEffectDefines.h:37</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ab7df9b34a249eff2c2ee82925fbc87d9"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab7df9b34a249eff2c2ee82925fbc87d9">SPELL_EFFECT_POWER_DRAIN</a></div><div class="ttdeci">@ SPELL_EFFECT_POWER_DRAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00034">SpellEffectDefines.h:34</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ab9b202bef395b4217a5b4c47011e1d18"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab9b202bef395b4217a5b4c47011e1d18">SPELL_EFFECT_RESURRECT</a></div><div class="ttdeci">@ SPELL_EFFECT_RESURRECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00044">SpellEffectDefines.h:44</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ab9f95780d14ce3a3d80b05f6955a5814"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ab9f95780d14ce3a3d80b05f6955a5814">SPELL_EFFECT_CHARGE</a></div><div class="ttdeci">@ SPELL_EFFECT_CHARGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00122">SpellEffectDefines.h:122</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97abb61d351517b94c04b1b9da9369691ae"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abb61d351517b94c04b1b9da9369691ae">SPELL_EFFECT_RESURRECT_NEW</a></div><div class="ttdeci">@ SPELL_EFFECT_RESURRECT_NEW</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00139">SpellEffectDefines.h:139</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97abc9a693ab6bbdd32a329d73f299ff125"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abc9a693ab6bbdd32a329d73f299ff125">SPELL_EFFECT_WMO_CHANGE</a></div><div class="ttdeci">@ SPELL_EFFECT_WMO_CHANGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00115">SpellEffectDefines.h:115</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97abd12cbfc6a8daf7ca788d06a77256e01"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97abd12cbfc6a8daf7ca788d06a77256e01">SPELL_EFFECT_SCHOOL_DAMAGE</a></div><div class="ttdeci">@ SPELL_EFFECT_SCHOOL_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00028">SpellEffectDefines.h:28</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ac4b6fe5309268ff656d1606ebdc637ce"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ac4b6fe5309268ff656d1606ebdc637ce">SPELL_EFFECT_SUMMON_DEAD_PET</a></div><div class="ttdeci">@ SPELL_EFFECT_SUMMON_DEAD_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00135">SpellEffectDefines.h:135</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ac9e93e2be484a200e2198e609ca8224e"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ac9e93e2be484a200e2198e609ca8224e">SPELL_EFFECT_CHARGE_DEST</a></div><div class="ttdeci">@ SPELL_EFFECT_CHARGE_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00175">SpellEffectDefines.h:175</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97acc3029fb0c202edd84a65d07ef68014e"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97acc3029fb0c202edd84a65d07ef68014e">SPELL_EFFECT_RESTORE_ITEM_CHARGES</a></div><div class="ttdeci">@ SPELL_EFFECT_RESTORE_ITEM_CHARGES</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00092">SpellEffectDefines.h:92</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97acef490c9f3480852d33dbbec7727fa7f"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97acef490c9f3480852d33dbbec7727fa7f">SPELL_EFFECT_LEARN_SPELL</a></div><div class="ttdeci">@ SPELL_EFFECT_LEARN_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00062">SpellEffectDefines.h:62</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ad67447fe7865d527f6408501a8fabd11"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ad67447fe7865d527f6408501a8fabd11">SPELL_EFFECT_CREATE_PET</a></div><div class="ttdeci">@ SPELL_EFFECT_CREATE_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00179">SpellEffectDefines.h:179</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ad7703a913968b0c340aa072bec1182fb"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ad7703a913968b0c340aa072bec1182fb">SPELL_EFFECT_INSTAKILL</a></div><div class="ttdeci">@ SPELL_EFFECT_INSTAKILL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00027">SpellEffectDefines.h:27</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97adca1c3aa0e67875dd6c075066aafe6b9"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97adca1c3aa0e67875dd6c075066aafe6b9">SPELL_EFFECT_JUMP</a></div><div class="ttdeci">@ SPELL_EFFECT_JUMP</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00067">SpellEffectDefines.h:67</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ae0cab2a09ad0acd69cdc260048bf31b5"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ae0cab2a09ad0acd69cdc260048bf31b5">SPELL_EFFECT_HEAL_PCT</a></div><div class="ttdeci">@ SPELL_EFFECT_HEAL_PCT</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00162">SpellEffectDefines.h:162</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97ae183bb456e27ed2416c7b0d2a78dd2c0"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97ae183bb456e27ed2416c7b0d2a78dd2c0">SPELL_EFFECT_SKINNING</a></div><div class="ttdeci">@ SPELL_EFFECT_SKINNING</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00121">SpellEffectDefines.h:121</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aea1b56989980b9b6059bcd31de21bf59"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aea1b56989980b9b6059bcd31de21bf59">SPELL_EFFECT_TELEPORT_UNITS</a></div><div class="ttdeci">@ SPELL_EFFECT_TELEPORT_UNITS</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00031">SpellEffectDefines.h:31</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aeb1d7a27ab01055bd66d8b012dbea7be"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aeb1d7a27ab01055bd66d8b012dbea7be">SPELL_EFFECT_ENCHANT_ITEM_PRISMATIC</a></div><div class="ttdeci">@ SPELL_EFFECT_ENCHANT_ITEM_PRISMATIC</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00182">SpellEffectDefines.h:182</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aef19cb2a68fa76f831bb9ddcff67fa65"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aef19cb2a68fa76f831bb9ddcff67fa65">SPELL_EFFECT_ENCHANT_ITEM_TEMPORARY</a></div><div class="ttdeci">@ SPELL_EFFECT_ENCHANT_ITEM_TEMPORARY</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00080">SpellEffectDefines.h:80</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aef7bb8a1f1b7064a44d136d9f622618a"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aef7bb8a1f1b7064a44d136d9f622618a">SPELL_EFFECT_THREAT</a></div><div class="ttdeci">@ SPELL_EFFECT_THREAT</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00089">SpellEffectDefines.h:89</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97aef9e266be3bbaf4fb858584a5a61bf7e"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97aef9e266be3bbaf4fb858584a5a61bf7e">SPELL_EFFECT_OPEN_LOCK</a></div><div class="ttdeci">@ SPELL_EFFECT_OPEN_LOCK</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00059">SpellEffectDefines.h:59</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97af49d37b2af49b03941198276e9599e60"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af49d37b2af49b03941198276e9599e60">SPELL_EFFECT_STEAL_BENEFICIAL_BUFF</a></div><div class="ttdeci">@ SPELL_EFFECT_STEAL_BENEFICIAL_BUFF</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00152">SpellEffectDefines.h:152</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97af5abf258b008fbff818ad32ac7a95fbb"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af5abf258b008fbff818ad32ac7a95fbb">SPELL_EFFECT_CREATE_ITEM</a></div><div class="ttdeci">@ SPELL_EFFECT_CREATE_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00050">SpellEffectDefines.h:50</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af737ae1ce32d016e21279dfed355d63d">SPELL_EFFECT_APPLY_AURA</a></div><div class="ttdeci">@ SPELL_EFFECT_APPLY_AURA</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00032">SpellEffectDefines.h:32</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a292c893150c454dd75628b719db1fe97af8a88e3b930f739bc8327f4df29d9904"><div class="ttname"><a href="SpellEffectDefines_8h.html#a292c893150c454dd75628b719db1fe97af8a88e3b930f739bc8327f4df29d9904">SPELL_EFFECT_LEARN_PET_SPELL</a></div><div class="ttdeci">@ SPELL_EFFECT_LEARN_PET_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00083">SpellEffectDefines.h:83</a></div></div>
<div class="ttc" id="aSpellEffectDefines_8h_html_a7474a108ebf7ca30ffb3203a3af11009"><div class="ttname"><a href="SpellEffectDefines_8h.html#a7474a108ebf7ca30ffb3203a3af11009">SpellEffectInfoTable</a></div><div class="ttdeci">SpellEffectInfo SpellEffectInfoTable[MAX_SPELL_EFFECTS]</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8cpp_source.html#l00146">SpellTargets.cpp:146</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_a21276e72bb353d9930509922bfc6243b"><div class="ttname"><a href="SpellMgr_8cpp.html#a21276e72bb353d9930509922bfc6243b">GetSpellCastTime</a></div><div class="ttdeci">uint32 GetSpellCastTime(SpellEntry const *spellInfo, WorldObject *caster, Spell *spell, bool consume)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l00110">SpellMgr.cpp:110</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_a28b958e9db34bdad035df1f81ed2a280"><div class="ttname"><a href="SpellMgr_8cpp.html#a28b958e9db34bdad035df1f81ed2a280">IsPassiveSpell</a></div><div class="ttdeci">bool IsPassiveSpell(uint32 spellId)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l00363">SpellMgr.cpp:363</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_a46823309ec434fd0636f6f06099b8919"><div class="ttname"><a href="SpellMgr_8cpp.html#a46823309ec434fd0636f6f06099b8919">GetDiminishingReturnsGroupForSpell</a></div><div class="ttdeci">DiminishingGroup GetDiminishingReturnsGroupForSpell(SpellEntry const *spellproto, bool triggered)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l03293">SpellMgr.cpp:3293</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_a52622b129525509eb04c79a18ed7661b"><div class="ttname"><a href="SpellMgr_8cpp.html#a52622b129525509eb04c79a18ed7661b">IsCreatureDRSpell</a></div><div class="ttdeci">bool IsCreatureDRSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l03502">SpellMgr.cpp:3502</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_a59d0590019858d9eb3b45f9e482f1431"><div class="ttname"><a href="SpellMgr_8cpp.html#a59d0590019858d9eb3b45f9e482f1431">IsSubjectToDiminishingLevels</a></div><div class="ttdeci">bool IsSubjectToDiminishingLevels(DiminishingGroup group, bool pvp)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l03495">SpellMgr.cpp:3495</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_a8a6c654559ee1eedaa1c460dd60f1823"><div class="ttname"><a href="SpellMgr_8cpp.html#a8a6c654559ee1eedaa1c460dd60f1823">GetWeaponAttackType</a></div><div class="ttdeci">WeaponAttackType GetWeaponAttackType(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l00338">SpellMgr.cpp:338</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_ab4186b06cc81cf862ba2c93c23b77786"><div class="ttname"><a href="SpellMgr_8cpp.html#ab4186b06cc81cf862ba2c93c23b77786">GetSpellEntryByDifficulty</a></div><div class="ttdeci">SpellEntry const  * GetSpellEntryByDifficulty(uint32 id, Difficulty difficulty, bool isRaid)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l03586">SpellMgr.cpp:3586</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_ab4874b247401539ddc5f6838fb5abf6b"><div class="ttname"><a href="SpellMgr_8cpp.html#ab4874b247401539ddc5f6838fb5abf6b">GetErrorAtShapeshiftedCast</a></div><div class="ttdeci">SpellCastResult GetErrorAtShapeshiftedCast(SpellEntry const *spellInfo, uint32 form)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l00527">SpellMgr.cpp:527</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_ac8cbcaf933a719c961ea28ae0be73c10"><div class="ttname"><a href="SpellMgr_8cpp.html#ac8cbcaf933a719c961ea28ae0be73c10">GetSpellDuration</a></div><div class="ttdeci">int32 GetSpellDuration(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l00059">SpellMgr.cpp:59</a></div></div>
<div class="ttc" id="aSpellMgr_8cpp_html_adcb922f517a421f170e35fae73441af5"><div class="ttname"><a href="SpellMgr_8cpp.html#adcb922f517a421f170e35fae73441af5">CalculateSpellDuration</a></div><div class="ttdeci">int32 CalculateSpellDuration(SpellEntry const *spellInfo, Unit const *caster, Unit const *target, AuraScript *auraScript)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8cpp_source.html#l00079">SpellMgr.cpp:79</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html"><div class="ttname"><a href="SpellMgr_8h.html">SpellMgr.h</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a08447d37cb40951326a87b9889fa237f"><div class="ttname"><a href="SpellMgr_8h.html#a08447d37cb40951326a87b9889fa237f">GetChainJumpRange</a></div><div class="ttdeci">void GetChainJumpRange(SpellEntry const *spellInfo, SpellEffectIndex effIdx, float &amp;minSearchRangeCaster, float &amp;maxSearchRangeTarget)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01725">SpellMgr.h:1725</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a08a8e032a6c528587b4165de8e554b20"><div class="ttname"><a href="SpellMgr_8h.html#a08a8e032a6c528587b4165de8e554b20">IsAuraApplyEffects</a></div><div class="ttdeci">bool IsAuraApplyEffects(SpellEntry const *entry, SpellEffectIndexMask mask)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00138">SpellMgr.h:138</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a10aebceeaf3bffcaaabaaa3b99628bcea07b2f1753e6047dcfef05d8ec0de5b87"><div class="ttname"><a href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea07b2f1753e6047dcfef05d8ec0de5b87">PROC_EX_NONE</a></div><div class="ttdeci">@ PROC_EX_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02489">SpellMgr.h:2489</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a10aebceeaf3bffcaaabaaa3b99628bcea368fb0746e60a288bf2d28cd0002b30f"><div class="ttname"><a href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea368fb0746e60a288bf2d28cd0002b30f">PROC_EX_CAST_END</a></div><div class="ttdeci">@ PROC_EX_CAST_END</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02509">SpellMgr.h:2509</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a10aebceeaf3bffcaaabaaa3b99628bcea970bdf3e5f6192a44f1047c0a9c01310"><div class="ttname"><a href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bcea970bdf3e5f6192a44f1047c0a9c01310">PROC_EX_CRITICAL_HIT</a></div><div class="ttdeci">@ PROC_EX_CRITICAL_HIT</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02491">SpellMgr.h:2491</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a10aebceeaf3bffcaaabaaa3b99628bceaa0c2a4e7377d6217e94cc8fc7c77b5b2"><div class="ttname"><a href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceaa0c2a4e7377d6217e94cc8fc7c77b5b2">PROC_EX_NORMAL_HIT</a></div><div class="ttdeci">@ PROC_EX_NORMAL_HIT</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02490">SpellMgr.h:2490</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a10aebceeaf3bffcaaabaaa3b99628bceac0f0575131b658e1143778206283552a"><div class="ttname"><a href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceac0f0575131b658e1143778206283552a">PROC_EX_REFLECT</a></div><div class="ttdeci">@ PROC_EX_REFLECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02501">SpellMgr.h:2501</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a10aebceeaf3bffcaaabaaa3b99628bceae057538545abcefc641c676fc33698ac"><div class="ttname"><a href="SpellMgr_8h.html#a10aebceeaf3bffcaaabaaa3b99628bceae057538545abcefc641c676fc33698ac">PROC_EX_MAGNET</a></div><div class="ttdeci">@ PROC_EX_MAGNET</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02510">SpellMgr.h:2510</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a11f87f40d3653c7085578227da35a538"><div class="ttname"><a href="SpellMgr_8h.html#a11f87f40d3653c7085578227da35a538">IsSpellAppliesAura</a></div><div class="ttdeci">bool IsSpellAppliesAura(SpellEntry const *spellInfo, uint32 effectMask=((1&lt;&lt; EFFECT_INDEX_0)|(1&lt;&lt; EFFECT_INDEX_1)|(1&lt;&lt; EFFECT_INDEX_2)))</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00159">SpellMgr.h:159</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a1283f17a75d0faa251cb81d1b847c24a"><div class="ttname"><a href="SpellMgr_8h.html#a1283f17a75d0faa251cb81d1b847c24a">NeedsComboPoints</a></div><div class="ttdeci">bool NeedsComboPoints(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01865">SpellMgr.h:1865</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a12b5a317cf83d3b2e09b6aad48050362"><div class="ttname"><a href="SpellMgr_8h.html#a12b5a317cf83d3b2e09b6aad48050362">IsSpellWithCasterSourceTargetsOnly</a></div><div class="ttdeci">bool IsSpellWithCasterSourceTargetsOnly(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01051">SpellMgr.h:1051</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a22e0f1c7f488563ce1e10a2ae2d4906d"><div class="ttname"><a href="SpellMgr_8h.html#a22e0f1c7f488563ce1e10a2ae2d4906d">GetSpellSchoolMask</a></div><div class="ttdeci">SpellSchoolMask GetSpellSchoolMask(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01870">SpellMgr.h:1870</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a2763a918baa144ce10d9dcbf1d6f9c70"><div class="ttname"><a href="SpellMgr_8h.html#a2763a918baa144ce10d9dcbf1d6f9c70">IsSpellHaveAura</a></div><div class="ttdeci">bool IsSpellHaveAura(SpellEntry const *spellInfo, AuraType aura, uint32 effectMask=(1&lt;&lt; EFFECT_INDEX_0)|(1&lt;&lt; EFFECT_INDEX_1)|(1&lt;&lt; EFFECT_INDEX_2))</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00225">SpellMgr.h:225</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a2b05b6d33fb015d675684adbf831cf11"><div class="ttname"><a href="SpellMgr_8h.html#a2b05b6d33fb015d675684adbf831cf11">IsDeathOnlySpell</a></div><div class="ttdeci">bool IsDeathOnlySpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00552">SpellMgr.h:552</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a364b0ed4591d44ab3e7bca875e779b50"><div class="ttname"><a href="SpellMgr_8h.html#a364b0ed4591d44ab3e7bca875e779b50">IsNextMeleeSwingSpell</a></div><div class="ttdeci">bool IsNextMeleeSwingSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00234">SpellMgr.h:234</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a39d94fd32d1940827be85b280f1d5300"><div class="ttname"><a href="SpellMgr_8h.html#a39d94fd32d1940827be85b280f1d5300">NEGATIVE_TRIGGER_MASK</a></div><div class="ttdeci">#define NEGATIVE_TRIGGER_MASK</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02474">SpellMgr.h:2474</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a3d8ecd789903bb522e3563819035af97"><div class="ttname"><a href="SpellMgr_8h.html#a3d8ecd789903bb522e3563819035af97">GetAllowedMechanicMask</a></div><div class="ttdeci">uint32 GetAllowedMechanicMask(SpellEntry const *spellProto)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00492">SpellMgr.h:492</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a3ea1c5b64fc74502330c53095ada0cf1"><div class="ttname"><a href="SpellMgr_8h.html#a3ea1c5b64fc74502330c53095ada0cf1">GetCheckCastSelfEffectMask</a></div><div class="ttdeci">uint32 GetCheckCastSelfEffectMask(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01261">SpellMgr.h:1261</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a4b52705bf9b40c5afc1698bf9a165663"><div class="ttname"><a href="SpellMgr_8h.html#a4b52705bf9b40c5afc1698bf9a165663">IsAllowingDeadTarget</a></div><div class="ttdeci">bool IsAllowingDeadTarget(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00320">SpellMgr.h:320</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a53853caca4c1bcb4809cfc22ef9fd199"><div class="ttname"><a href="SpellMgr_8h.html#a53853caca4c1bcb4809cfc22ef9fd199">IsSimilarExistingAuraStronger</a></div><div class="ttdeci">bool IsSimilarExistingAuraStronger(const SpellAuraHolder *holder, const SpellAuraHolder *existing)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02333">SpellMgr.h:2333</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a54d6e078fafae11db185b5c00398e17d"><div class="ttname"><a href="SpellMgr_8h.html#a54d6e078fafae11db185b5c00398e17d">IsChanneledSpell</a></div><div class="ttdeci">bool IsChanneledSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01781">SpellMgr.h:1781</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a7728c56eea783417340528757e74eeae"><div class="ttname"><a href="SpellMgr_8h.html#a7728c56eea783417340528757e74eeae">SpellCancelsAuraEffect</a></div><div class="ttdeci">bool SpellCancelsAuraEffect(SpellEntry const *spellInfo, SpellEntry const *auraSpellInfo, uint8 auraEffIndex)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00509">SpellMgr.h:509</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a84ee22edbc6f3e4d981cd668ffeda1a2a0b85aa6e0df9762ad1548fd70ac84962"><div class="ttname"><a href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a0b85aa6e0df9762ad1548fd70ac84962">SPELL_TARGET_TYPE_CREATURE</a></div><div class="ttdeci">@ SPELL_TARGET_TYPE_CREATURE</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02561">SpellMgr.h:2561</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b"><div class="ttname"><a href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2a971f9d8495ef200b43c8668e3f01a56b">SPELL_TARGET_TYPE_GAMEOBJECT_GUID</a></div><div class="ttdeci">@ SPELL_TARGET_TYPE_GAMEOBJECT_GUID</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02564">SpellMgr.h:2564</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a84ee22edbc6f3e4d981cd668ffeda1a2ab1c1ebb7458162f26377e273a8a779fa"><div class="ttname"><a href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ab1c1ebb7458162f26377e273a8a779fa">SPELL_TARGET_TYPE_STRING_ID</a></div><div class="ttdeci">@ SPELL_TARGET_TYPE_STRING_ID</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02565">SpellMgr.h:2565</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7"><div class="ttname"><a href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2acb491e7f61acb914e24656bd94c633a7">SPELL_TARGET_TYPE_CREATURE_GUID</a></div><div class="ttdeci">@ SPELL_TARGET_TYPE_CREATURE_GUID</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02563">SpellMgr.h:2563</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d"><div class="ttname"><a href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ad06f960688f4a16f0f2ce8672398215d">SPELL_TARGET_TYPE_DEAD</a></div><div class="ttdeci">@ SPELL_TARGET_TYPE_DEAD</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02562">SpellMgr.h:2562</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a84ee22edbc6f3e4d981cd668ffeda1a2ae7ce658fcd9ebcff46e1c1228325f7dd"><div class="ttname"><a href="SpellMgr_8h.html#a84ee22edbc6f3e4d981cd668ffeda1a2ae7ce658fcd9ebcff46e1c1228325f7dd">SPELL_TARGET_TYPE_GAMEOBJECT</a></div><div class="ttdeci">@ SPELL_TARGET_TYPE_GAMEOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02560">SpellMgr.h:2560</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a856f63fc12dc903b8122624a5bbfec3b"><div class="ttname"><a href="SpellMgr_8h.html#a856f63fc12dc903b8122624a5bbfec3b">IsIgnoreLosSpell</a></div><div class="ttdeci">bool IsIgnoreLosSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01808">SpellMgr.h:1808</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a85e2a224d75abe47239cc1c33300cb23"><div class="ttname"><a href="SpellMgr_8h.html#a85e2a224d75abe47239cc1c33300cb23">IsEffectHandledImmediatelySpellLaunch</a></div><div class="ttdeci">bool IsEffectHandledImmediatelySpellLaunch(SpellEntry const *spellInfo, SpellEffectIndex effecIdx)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00188">SpellMgr.h:188</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a8725a06093ceafbdf644303cd4af633e"><div class="ttname"><a href="SpellMgr_8h.html#a8725a06093ceafbdf644303cd4af633e">IsReflectableSpell</a></div><div class="ttdeci">bool IsReflectableSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01800">SpellMgr.h:1800</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a99b33426a4b89335f7f93b0a630f658d"><div class="ttname"><a href="SpellMgr_8h.html#a99b33426a4b89335f7f93b0a630f658d">IsIgnoreLosSpellCast</a></div><div class="ttdeci">bool IsIgnoreLosSpellCast(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01848">SpellMgr.h:1848</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a9eba646a055328c2c385f4426ac41874"><div class="ttname"><a href="SpellMgr_8h.html#a9eba646a055328c2c385f4426ac41874">GetSpellMaxRange</a></div><div class="ttdeci">float GetSpellMaxRange(SpellRangeEntry const *range, bool friendly=false)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00099">SpellMgr.h:99</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_a9fd9fd7aff5bf01e30dc3b9a6858058e"><div class="ttname"><a href="SpellMgr_8h.html#a9fd9fd7aff5bf01e30dc3b9a6858058e">IsAutoRepeatRangedSpell</a></div><div class="ttdeci">bool IsAutoRepeatRangedSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01769">SpellMgr.h:1769</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aa0a17355e9a81e14b37013cd45e4aa75"><div class="ttname"><a href="SpellMgr_8h.html#aa0a17355e9a81e14b37013cd45e4aa75">IsSpellDoNotReportFailure</a></div><div class="ttdeci">bool IsSpellDoNotReportFailure(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01674">SpellMgr.h:1674</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aa21e14d8e1145507b746a69b5487109d"><div class="ttname"><a href="SpellMgr_8h.html#aa21e14d8e1145507b746a69b5487109d">sSpellMgr</a></div><div class="ttdeci">#define sSpellMgr</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l03356">SpellMgr.h:3356</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aa411d9ba79e820e95f1e03d5be4b5a08"><div class="ttname"><a href="SpellMgr_8h.html#aa411d9ba79e820e95f1e03d5be4b5a08">IsOnlySelfTargeting</a></div><div class="ttdeci">bool IsOnlySelfTargeting(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01181">SpellMgr.h:1181</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aa48055df917f805e2ef4b8e56f78cc93"><div class="ttname"><a href="SpellMgr_8h.html#aa48055df917f805e2ef4b8e56f78cc93">IsPositiveSpell</a></div><div class="ttdeci">bool IsPositiveSpell(const SpellEntry *entry, const WorldObject *caster=nullptr, const WorldObject *target=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01642">SpellMgr.h:1642</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aa6d85cc3b560ba3035bf489e92e69d2d"><div class="ttname"><a href="SpellMgr_8h.html#aa6d85cc3b560ba3035bf489e92e69d2d">GetAuraEffectMask</a></div><div class="ttdeci">uint32 GetAuraEffectMask(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00178">SpellMgr.h:178</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aac877d83d1d2b22d02c52c695a5c6402"><div class="ttname"><a href="SpellMgr_8h.html#aac877d83d1d2b22d02c52c695a5c6402">MAX_SPELL_TARGET_TYPE</a></div><div class="ttdeci">#define MAX_SPELL_TARGET_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02568">SpellMgr.h:2568</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ab3038f54f63721701513c9ebc5c3de2e"><div class="ttname"><a href="SpellMgr_8h.html#ab3038f54f63721701513c9ebc5c3de2e">IsPositiveEffect</a></div><div class="ttdeci">bool IsPositiveEffect(const SpellEntry *spellproto, SpellEffectIndex effIndex, const WorldObject *caster=nullptr, const WorldObject *target=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01423">SpellMgr.h:1423</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ab4b1d536a5b410eaf601a13235196d3a"><div class="ttname"><a href="SpellMgr_8h.html#ab4b1d536a5b410eaf601a13235196d3a">GetSpellRadius</a></div><div class="ttdeci">float GetSpellRadius(SpellRadiusEntry const *radius)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00089">SpellMgr.h:89</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ac080470c59071a67207dd338d64f6954"><div class="ttname"><a href="SpellMgr_8h.html#ac080470c59071a67207dd338d64f6954">HasSpellTarget</a></div><div class="ttdeci">bool HasSpellTarget(SpellEntry const *spellInfo, uint32 target)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01252">SpellMgr.h:1252</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ac32804d06d237ef6a0a61714ca168ae3"><div class="ttname"><a href="SpellMgr_8h.html#ac32804d06d237ef6a0a61714ca168ae3">IsSpellWithScriptUnitTarget</a></div><div class="ttdeci">bool IsSpellWithScriptUnitTarget(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01035">SpellMgr.h:1035</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ac821b7d2d8a9effd8fafef038528e877"><div class="ttname"><a href="SpellMgr_8h.html#ac821b7d2d8a9effd8fafef038528e877">SkillLineAbilityMapBounds</a></div><div class="ttdeci">std::pair&lt; SkillLineAbilityMap::const_iterator, SkillLineAbilityMap::const_iterator &gt; SkillLineAbilityMapBounds</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02706">SpellMgr.h:2706</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_acbfba02f9156a417c23e91207de7ee8a"><div class="ttname"><a href="SpellMgr_8h.html#acbfba02f9156a417c23e91207de7ee8a">IsAuraApplyEffect</a></div><div class="ttdeci">bool IsAuraApplyEffect(SpellEntry const *spellInfo, SpellEffectIndex effecIdx)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00121">SpellMgr.h:121</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace3da75b505e34c32ab1294c4a4d5a2f"><div class="ttname"><a href="SpellMgr_8h.html#ace3da75b505e34c32ab1294c4a4d5a2f">IsAreaAuraEffect</a></div><div class="ttdeci">bool IsAreaAuraEffect(uint32 effect)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01155">SpellMgr.h:1155</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba0364d6ed21318af6a09bcb9e97a0e0ce"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba0364d6ed21318af6a09bcb9e97a0e0ce">PROC_FLAG_DEAL_MELEE_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_MELEE_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02432">SpellMgr.h:2432</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba0ab87eaab1eb027e27aee1c94f3b691e"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba0ab87eaab1eb027e27aee1c94f3b691e">PROC_FLAG_TAKE_HARMFUL_PERIODIC</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_HARMFUL_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02454">SpellMgr.h:2454</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba0e47443cbbeffae8acb764b444174517"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba0e47443cbbeffae8acb764b444174517">PROC_FLAG_MAIN_HAND_WEAPON_SWING</a></div><div class="ttdeci">@ PROC_FLAG_MAIN_HAND_WEAPON_SWING</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02459">SpellMgr.h:2459</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba1276e4b9b12f6a3ce5dd3fd6238fd3ef"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba1276e4b9b12f6a3ce5dd3fd6238fd3ef">PROC_FLAG_TAKE_MELEE_SWING</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_MELEE_SWING</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02430">SpellMgr.h:2430</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba294d96b6f102953561cee232fdf9b5f4"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba294d96b6f102953561cee232fdf9b5f4">PROC_FLAG_TAKE_ANY_DAMAGE</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_ANY_DAMAGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02456">SpellMgr.h:2456</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba3f64d61f9acc0b73d45951487b167010"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba3f64d61f9acc0b73d45951487b167010">PROC_FLAG_TAKE_HELPFUL_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_HELPFUL_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02442">SpellMgr.h:2442</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba41466041b8d8c8d30ff31bf73895a242"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba41466041b8d8c8d30ff31bf73895a242">PROC_FLAG_DEAL_RANGED_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_RANGED_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02438">SpellMgr.h:2438</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba466ae386c270f5d40d8f11eece38ab2a"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba466ae386c270f5d40d8f11eece38ab2a">PROC_FLAG_DEAL_MELEE_SWING</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_MELEE_SWING</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02429">SpellMgr.h:2429</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba4fc6208f1395f4e74758cd4b95332355"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba4fc6208f1395f4e74758cd4b95332355">PROC_FLAG_TAKE_HELPFUL_SPELL</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_HELPFUL_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02448">SpellMgr.h:2448</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba6199565a6a020d7e7e533c54d906e958"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6199565a6a020d7e7e533c54d906e958">PROC_FLAG_DEAL_HELPFUL_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_HELPFUL_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02441">SpellMgr.h:2441</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba68338843489945531e1ba10e0c0a9e19"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba68338843489945531e1ba10e0c0a9e19">PROC_FLAG_DEAL_RANGED_ATTACK</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_RANGED_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02435">SpellMgr.h:2435</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba6dee6718a32d2b2ada5d7c55bdc45546"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba6dee6718a32d2b2ada5d7c55bdc45546">PROC_FLAG_TAKE_HARMFUL_SPELL</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_HARMFUL_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02451">SpellMgr.h:2451</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba7b76c7ee4e3158f61043eb4dcd4cca7d"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba7b76c7ee4e3158f61043eb4dcd4cca7d">PROC_FLAG_TAKE_MELEE_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_MELEE_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02433">SpellMgr.h:2433</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba8cfbfb43731d87c3f18b2bfaa2523537"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba8cfbfb43731d87c3f18b2bfaa2523537">PROC_FLAG_DEAL_HARMFUL_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_HARMFUL_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02444">SpellMgr.h:2444</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9ba8edd4968ba96d5d73a6983c5982079ce"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9ba8edd4968ba96d5d73a6983c5982079ce">PROC_FLAG_DEAL_HARMFUL_PERIODIC</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_HARMFUL_PERIODIC</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02453">SpellMgr.h:2453</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9baaa24701022923cf3128ab18e168d24a5"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baaa24701022923cf3128ab18e168d24a5">PROC_FLAG_OFF_HAND_WEAPON_SWING</a></div><div class="ttdeci">@ PROC_FLAG_OFF_HAND_WEAPON_SWING</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02460">SpellMgr.h:2460</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9bac3f15701eb93cfb46beb4f032caad372"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9bac3f15701eb93cfb46beb4f032caad372">PROC_FLAG_DEAL_HELPFUL_SPELL</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_HELPFUL_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02447">SpellMgr.h:2447</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9badaf23b32ed2865f5995e81f2fec996d9"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9badaf23b32ed2865f5995e81f2fec996d9">PROC_FLAG_DEAL_HARMFUL_SPELL</a></div><div class="ttdeci">@ PROC_FLAG_DEAL_HARMFUL_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02450">SpellMgr.h:2450</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9badfbe02020d9532ca0c99060a3fbb7a5c"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9badfbe02020d9532ca0c99060a3fbb7a5c">PROC_FLAG_TAKE_RANGED_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_RANGED_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02439">SpellMgr.h:2439</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9baf278f87dd654facbbe75d8acb32a8d0d"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf278f87dd654facbbe75d8acb32a8d0d">PROC_FLAG_ON_TRAP_ACTIVATION</a></div><div class="ttdeci">@ PROC_FLAG_ON_TRAP_ACTIVATION</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02457">SpellMgr.h:2457</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9baf35ac4894624c305e6bf3aa8fed13bbd"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf35ac4894624c305e6bf3aa8fed13bbd">PROC_FLAG_TAKE_RANGED_ATTACK</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_RANGED_ATTACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02436">SpellMgr.h:2436</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf765023e3e3f58d814e32d66d0f8fe45">PROC_FLAG_NONE</a></div><div class="ttdeci">@ PROC_FLAG_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02424">SpellMgr.h:2424</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ace42a0c423a108b6e1d667a68187ca9baf844ac5c2df378e88f50e0e542116c38"><div class="ttname"><a href="SpellMgr_8h.html#ace42a0c423a108b6e1d667a68187ca9baf844ac5c2df378e88f50e0e542116c38">PROC_FLAG_TAKE_HARMFUL_ABILITY</a></div><div class="ttdeci">@ PROC_FLAG_TAKE_HARMFUL_ABILITY</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02445">SpellMgr.h:2445</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ad87d37c678e30ca6731dbecf89a7f2b9"><div class="ttname"><a href="SpellMgr_8h.html#ad87d37c678e30ca6731dbecf89a7f2b9">IsNonCombatSpell</a></div><div class="ttdeci">bool IsNonCombatSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00562">SpellMgr.h:562</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ae14122cf8c3c2468d64d5582e9574dfb"><div class="ttname"><a href="SpellMgr_8h.html#ae14122cf8c3c2468d64d5582e9574dfb">HasPersistentAuraEffect</a></div><div class="ttdeci">bool HasPersistentAuraEffect(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01173">SpellMgr.h:1173</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ae1cd216886dd278e680ec76fd40fba4e"><div class="ttname"><a href="SpellMgr_8h.html#ae1cd216886dd278e680ec76fd40fba4e">IsAreaOfEffectSpell</a></div><div class="ttdeci">bool IsAreaOfEffectSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01144">SpellMgr.h:1144</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ae21aa77332ab7e86c1fef7ec58d3c866"><div class="ttname"><a href="SpellMgr_8h.html#ae21aa77332ab7e86c1fef7ec58d3c866">IsIgnoreLosSpellEffect</a></div><div class="ttdeci">bool IsIgnoreLosSpellEffect(SpellEntry const *spellInfo, SpellEffectIndex effIdx)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01830">SpellMgr.h:1830</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_ae416332245463d653332abb464abfd28"><div class="ttname"><a href="SpellMgr_8h.html#ae416332245463d653332abb464abfd28">IsIgnoreRootSpell</a></div><div class="ttdeci">bool IsIgnoreRootSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01913">SpellMgr.h:1913</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aeb77ce79b009e64c44d67dd7e993cd4e"><div class="ttname"><a href="SpellMgr_8h.html#aeb77ce79b009e64c44d67dd7e993cd4e">IsSpellWithNonAuraEffect</a></div><div class="ttdeci">bool IsSpellWithNonAuraEffect(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00169">SpellMgr.h:169</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_af84ca241db09e811f5d3ef3ccdff8188"><div class="ttname"><a href="SpellMgr_8h.html#af84ca241db09e811f5d3ef3ccdff8188">HasAreaAuraEffect</a></div><div class="ttdeci">bool HasAreaAuraEffect(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01160">SpellMgr.h:1160</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_af992734f80d9f691f34ebc42ffdbae93"><div class="ttname"><a href="SpellMgr_8h.html#af992734f80d9f691f34ebc42ffdbae93">IsSpellHaveEffect</a></div><div class="ttdeci">bool IsSpellHaveEffect(SpellEntry const *spellInfo, SpellEffects effect)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00113">SpellMgr.h:113</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_afa7b10fb48285a79d754be9a11a6b30a"><div class="ttname"><a href="SpellMgr_8h.html#afa7b10fb48285a79d754be9a11a6b30a">IsPositiveEffectMask</a></div><div class="ttdeci">bool IsPositiveEffectMask(const SpellEntry *entry, uint8 effectMask, const WorldObject *caster=nullptr, const WorldObject *target=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01655">SpellMgr.h:1655</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_afdaaa77d67a9fc399f5f74453f5967ad"><div class="ttname"><a href="SpellMgr_8h.html#afdaaa77d67a9fc399f5f74453f5967ad">GetCheckCastEffectMask</a></div><div class="ttdeci">uint32 GetCheckCastEffectMask(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l01243">SpellMgr.h:1243</a></div></div>
<div class="ttc" id="aSpellMgr_8h_html_aff490dc835c75af68cdf1ed77d85d798"><div class="ttname"><a href="SpellMgr_8h.html#aff490dc835c75af68cdf1ed77d85d798">GetSpellMinRange</a></div><div class="ttdeci">float GetSpellMinRange(SpellRangeEntry const *range, bool friendly=false)</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l00093">SpellMgr.h:93</a></div></div>
<div class="ttc" id="aSpellScript_8h_html"><div class="ttname"><a href="SpellScript_8h.html">SpellScript.h</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8af"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8af">SpellTargetImplicitType</a></div><div class="ttdeci">SpellTargetImplicitType</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00164">SpellTargetDefines.h:165</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa185156b67fc8f6bf827a79de6fdc9626">TARGET_TYPE_UNIT</a></div><div class="ttdeci">@ TARGET_TYPE_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00171">SpellTargetDefines.h:171</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa26d8044284eb711be1d91940d12f2c4a"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa26d8044284eb711be1d91940d12f2c4a">TARGET_TYPE_LOCATION_TRAJ</a></div><div class="ttdeci">@ TARGET_TYPE_LOCATION_TRAJ</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00169">SpellTargetDefines.h:169</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa8f11fdfadfb8c0ce58bfae1901d10948"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8f11fdfadfb8c0ce58bfae1901d10948">TARGET_TYPE_UNIT_DEST</a></div><div class="ttdeci">@ TARGET_TYPE_UNIT_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00178">SpellTargetDefines.h:178</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa8fb995e48c74119f7f7f849a08a66a17"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa8fb995e48c74119f7f7f849a08a66a17">TARGET_TYPE_LOCATION_DEST</a></div><div class="ttdeci">@ TARGET_TYPE_LOCATION_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00168">SpellTargetDefines.h:168</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa977aded5972aa7f6e73beb9bece220cc"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa977aded5972aa7f6e73beb9bece220cc">TARGET_TYPE_SPECIAL_UNIT</a></div><div class="ttdeci">@ TARGET_TYPE_SPECIAL_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00182">SpellTargetDefines.h:182</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa985a04af38ba4b8eb3ffdb5d7aab4d6d"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa985a04af38ba4b8eb3ffdb5d7aab4d6d">TARGET_TYPE_CORPSE</a></div><div class="ttdeci">@ TARGET_TYPE_CORPSE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00173">SpellTargetDefines.h:173</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afa9e02b36361708a05834cac5b4c153aed"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afa9e02b36361708a05834cac5b4c153aed">TARGET_TYPE_LOCK</a></div><div class="ttdeci">@ TARGET_TYPE_LOCK</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00174">SpellTargetDefines.h:174</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afaa6ded98eff76a3b61d4c0e3e6d93997d"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaa6ded98eff76a3b61d4c0e3e6d93997d">TARGET_TYPE_ITEM</a></div><div class="ttdeci">@ TARGET_TYPE_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00177">SpellTargetDefines.h:177</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afaac869e5c9689c7f30e88e42206b4780e"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaac869e5c9689c7f30e88e42206b4780e">TARGET_TYPE_SPECIAL_DEST</a></div><div class="ttdeci">@ TARGET_TYPE_SPECIAL_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00181">SpellTargetDefines.h:181</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afae50a421df1d4e5542b1bf61864f49903"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afae50a421df1d4e5542b1bf61864f49903">TARGET_TYPE_PLAYER</a></div><div class="ttdeci">@ TARGET_TYPE_PLAYER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00172">SpellTargetDefines.h:172</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afaf14bf2f7d5c286e6777461e40c41b6d9"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaf14bf2f7d5c286e6777461e40c41b6d9">TARGET_TYPE_NONE</a></div><div class="ttdeci">@ TARGET_TYPE_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00176">SpellTargetDefines.h:176</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a371ad2c030cf48a3bbd93fecbdc1e8afaff677b466a96dba01f1d816dfef5c33e"><div class="ttname"><a href="SpellTargetDefines_8h.html#a371ad2c030cf48a3bbd93fecbdc1e8afaff677b466a96dba01f1d816dfef5c33e">TARGET_TYPE_GAMEOBJECT</a></div><div class="ttdeci">@ TARGET_TYPE_GAMEOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00170">SpellTargetDefines.h:170</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa03c8f27ac662b23e30c405f800e13da4">TARGET_FLAG_TRADE_ITEM</a></div><div class="ttdeci">@ TARGET_FLAG_TRADE_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00154">SpellTargetDefines.h:154</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa0b198012d8080657fe78d2b311503d5e"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0b198012d8080657fe78d2b311503d5e">TARGET_FLAG_LOCKED</a></div><div class="ttdeci">@ TARGET_FLAG_LOCKED</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00156">SpellTargetDefines.h:156</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa0cc43eed3775f0742de2f496d9dadc49"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa0cc43eed3775f0742de2f496d9dadc49">TARGET_FLAG_GAMEOBJECT</a></div><div class="ttdeci">@ TARGET_FLAG_GAMEOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00153">SpellTargetDefines.h:153</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa24d43cf0043fec76138893870d0f33e4"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa24d43cf0043fec76138893870d0f33e4">TARGET_FLAG_STRING</a></div><div class="ttdeci">@ TARGET_FLAG_STRING</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00155">SpellTargetDefines.h:155</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa3325fba850592588fce959a992007a87"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa3325fba850592588fce959a992007a87">TARGET_FLAG_UNIT_ENEMY</a></div><div class="ttdeci">@ TARGET_FLAG_UNIT_ENEMY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00149">SpellTargetDefines.h:149</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa38cb131e0c7ed94b462d3b610b6d7a11">TARGET_FLAG_CORPSE_ALLY</a></div><div class="ttdeci">@ TARGET_FLAG_CORPSE_ALLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00157">SpellTargetDefines.h:157</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa39c1b2ff3bdce8072d074f15c6c2af49">TARGET_FLAG_ITEM</a></div><div class="ttdeci">@ TARGET_FLAG_ITEM</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00146">SpellTargetDefines.h:146</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa41f9f26a19c99a5517d021765a1173e3"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa41f9f26a19c99a5517d021765a1173e3">TARGET_FLAG_UNIT_MINIPET</a></div><div class="ttdeci">@ TARGET_FLAG_UNIT_MINIPET</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00158">SpellTargetDefines.h:158</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6743615e8912aefb100fe3f804c162be">TARGET_FLAG_DEST_LOCATION</a></div><div class="ttdeci">@ TARGET_FLAG_DEST_LOCATION</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00148">SpellTargetDefines.h:148</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa6ff2692c36a92d32bc4fc2d1eec84cec"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa6ff2692c36a92d32bc4fc2d1eec84cec">TARGET_FLAG_UNIT_ALLY</a></div><div class="ttdeci">@ TARGET_FLAG_UNIT_ALLY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00150">SpellTargetDefines.h:150</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa75b709f5c716c261658a88f578e15899"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa75b709f5c716c261658a88f578e15899">TARGET_FLAG_VISUAL_CHAIN</a></div><div class="ttdeci">@ TARGET_FLAG_VISUAL_CHAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00162">SpellTargetDefines.h:161</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa76062c8af712eecc1b87da7a458a86eb">TARGET_FLAG_SOURCE_LOCATION</a></div><div class="ttdeci">@ TARGET_FLAG_SOURCE_LOCATION</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00147">SpellTargetDefines.h:147</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fa9bdbe71c2e8d869741084e7d1b9c0e7e">TARGET_FLAG_UNIT</a></div><div class="ttdeci">@ TARGET_FLAG_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00143">SpellTargetDefines.h:143</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54facb6946c76f4df16a44d6575253869d2b">TARGET_FLAG_CORPSE_ENEMY</a></div><div class="ttdeci">@ TARGET_FLAG_CORPSE_ENEMY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00151">SpellTargetDefines.h:151</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a3c11f0d0cd9689554b34ccbc325da54fafe9a52eb16cad63aeb4202ecae8e2c18"><div class="ttname"><a href="SpellTargetDefines_8h.html#a3c11f0d0cd9689554b34ccbc325da54fafe9a52eb16cad63aeb4202ecae8e2c18">TARGET_FLAG_SELF</a></div><div class="ttdeci">@ TARGET_FLAG_SELF</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00141">SpellTargetDefines.h:141</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a79f2ae9bf0ff964b05145bb73becb699a3b1f9b14b486ccf9353b5c96744f749f"><div class="ttname"><a href="SpellTargetDefines_8h.html#a79f2ae9bf0ff964b05145bb73becb699a3b1f9b14b486ccf9353b5c96744f749f">TARGET_LOS_DEST</a></div><div class="ttdeci">@ TARGET_LOS_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00222">SpellTargetDefines.h:222</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a79f2ae9bf0ff964b05145bb73becb699acc07bf679f1941dbdcc1cddf2dfd2137"><div class="ttname"><a href="SpellTargetDefines_8h.html#a79f2ae9bf0ff964b05145bb73becb699acc07bf679f1941dbdcc1cddf2dfd2137">TARGET_LOS_CASTER</a></div><div class="ttdeci">@ TARGET_LOS_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00220">SpellTargetDefines.h:220</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_a79f2ae9bf0ff964b05145bb73becb699ad7853c5e91e5832b4218a5618f4d919c"><div class="ttname"><a href="SpellTargetDefines_8h.html#a79f2ae9bf0ff964b05145bb73becb699ad7853c5e91e5832b4218a5618f4d919c">TARGET_LOS_SRC</a></div><div class="ttdeci">@ TARGET_LOS_SRC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00221">SpellTargetDefines.h:221</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aa6284b14639a370c92f15833a131f502a570a3901e62080a86098350ecafeec2e"><div class="ttname"><a href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a570a3901e62080a86098350ecafeec2e">TARGET_PARTY</a></div><div class="ttdeci">@ TARGET_PARTY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00200">SpellTargetDefines.h:200</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aa6284b14639a370c92f15833a131f502a76152bae5512ab0aeaf68f34c550d33a"><div class="ttname"><a href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a76152bae5512ab0aeaf68f34c550d33a">TARGET_SCRIPT</a></div><div class="ttdeci">@ TARGET_SCRIPT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00202">SpellTargetDefines.h:202</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aa6284b14639a370c92f15833a131f502a91709d6ba94197217509324cb71783b5"><div class="ttname"><a href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502a91709d6ba94197217509324cb71783b5">TARGET_HARMFUL</a></div><div class="ttdeci">@ TARGET_HARMFUL</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00198">SpellTargetDefines.h:198</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aa6284b14639a370c92f15833a131f502ab28844a73c37b35cde400ace4704ac9f"><div class="ttname"><a href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502ab28844a73c37b35cde400ace4704ac9f">TARGET_GROUP</a></div><div class="ttdeci">@ TARGET_GROUP</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00201">SpellTargetDefines.h:201</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aa6284b14639a370c92f15833a131f502ad09d82da366aedd07fc12f30cdc8163a"><div class="ttname"><a href="SpellTargetDefines_8h.html#aa6284b14639a370c92f15833a131f502ad09d82da366aedd07fc12f30cdc8163a">TARGET_HELPFUL</a></div><div class="ttdeci">@ TARGET_HELPFUL</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00199">SpellTargetDefines.h:199</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aaf91448fd3857ce0356e73523067e128a578da5f5ffca03e698701e59307875fd"><div class="ttname"><a href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a578da5f5ffca03e698701e59307875fd">TARGET_ENUMERATOR_CONE</a></div><div class="ttdeci">@ TARGET_ENUMERATOR_CONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00192">SpellTargetDefines.h:192</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aaf91448fd3857ce0356e73523067e128a6c7f6ab7a64e6d33d3a06ddb6b84e6a4"><div class="ttname"><a href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a6c7f6ab7a64e6d33d3a06ddb6b84e6a4">TARGET_ENUMERATOR_AOE</a></div><div class="ttdeci">@ TARGET_ENUMERATOR_AOE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00191">SpellTargetDefines.h:191</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aaf91448fd3857ce0356e73523067e128a8e5483b8a18d10590d68cbeba15ce870"><div class="ttname"><a href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128a8e5483b8a18d10590d68cbeba15ce870">TARGET_ENUMERATOR_CHAIN</a></div><div class="ttdeci">@ TARGET_ENUMERATOR_CHAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00190">SpellTargetDefines.h:190</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_aaf91448fd3857ce0356e73523067e128aafe7cc364fd8375e47c1e02c7c640aa1"><div class="ttname"><a href="SpellTargetDefines_8h.html#aaf91448fd3857ce0356e73523067e128aafe7cc364fd8375e47c1e02c7c640aa1">TARGET_ENUMERATOR_SINGLE</a></div><div class="ttdeci">@ TARGET_ENUMERATOR_SINGLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00189">SpellTargetDefines.h:189</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985">SpellTargetFilterScheme</a></div><div class="ttdeci">SpellTargetFilterScheme</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00205">SpellTargetDefines.h:206</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985a19012b13b855a490e0b76cc2bfecead7"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a19012b13b855a490e0b76cc2bfecead7">SCHEME_CLOSEST</a></div><div class="ttdeci">@ SCHEME_CLOSEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00209">SpellTargetDefines.h:209</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985a3eea6d8d009c826e1d14f3aa2ccc78ee"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a3eea6d8d009c826e1d14f3aa2ccc78ee">SCHEME_HIGHEST_HP</a></div><div class="ttdeci">@ SCHEME_HIGHEST_HP</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00212">SpellTargetDefines.h:212</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985a52f8be0444a1f44f2ad742317ee4c10f"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a52f8be0444a1f44f2ad742317ee4c10f">SCHEME_PRIORITIZE_MANA</a></div><div class="ttdeci">@ SCHEME_PRIORITIZE_MANA</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00215">SpellTargetDefines.h:215</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985a587b1efe366e181d34e1f2d8c9bd16aa"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a587b1efe366e181d34e1f2d8c9bd16aa">SCHEME_LOWEST_HP_CHAIN</a></div><div class="ttdeci">@ SCHEME_LOWEST_HP_CHAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00213">SpellTargetDefines.h:213</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985a9a11c7682370a4122d01d089099df83e"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a9a11c7682370a4122d01d089099df83e">SCHEME_FURTHEST</a></div><div class="ttdeci">@ SCHEME_FURTHEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00211">SpellTargetDefines.h:211</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985a9f57d792380f0419583e3f26fe869361"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985a9f57d792380f0419583e3f26fe869361">SCHEME_RANDOM</a></div><div class="ttdeci">@ SCHEME_RANDOM</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00207">SpellTargetDefines.h:207</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985ab3174c83a195b132a24d708c649fc3d6"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985ab3174c83a195b132a24d708c649fc3d6">SCHEME_PRIORITIZE_HEALTH</a></div><div class="ttdeci">@ SCHEME_PRIORITIZE_HEALTH</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00214">SpellTargetDefines.h:214</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985ae410d4c74ef7f7fc0e271b99acc718f1"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985ae410d4c74ef7f7fc0e271b99acc718f1">SCHEME_CLOSEST_CHAIN</a></div><div class="ttdeci">@ SCHEME_CLOSEST_CHAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00210">SpellTargetDefines.h:210</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_ab3e3b56c923e19d3ec6a457cd90a5985afc576d5edda33c47cd495826c7c112af"><div class="ttname"><a href="SpellTargetDefines_8h.html#ab3e3b56c923e19d3ec6a457cd90a5985afc576d5edda33c47cd495826c7c112af">SCHEME_RANDOM_CHAIN</a></div><div class="ttdeci">@ SCHEME_RANDOM_CHAIN</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00208">SpellTargetDefines.h:208</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa0045d75513ac7ec4c9f24d1e5298018c"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0045d75513ac7ec4c9f24d1e5298018c">TARGET_LOCATION_CURRENT_REFERENCE</a></div><div class="ttdeci">@ TARGET_LOCATION_CURRENT_REFERENCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00111">SpellTargetDefines.h:111</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05abdb25817cbfe38a210d5be259bfe6">TARGET_LOCATION_SCRIPT_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_LOCATION_SCRIPT_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00070">SpellTargetDefines.h:70</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa05b1b87e8a9598b3146a5bde452c254e"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa05b1b87e8a9598b3146a5bde452c254e">TARGET_LOCATION_SE</a></div><div class="ttdeci">@ TARGET_LOCATION_SE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00108">SpellTargetDefines.h:108</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa0677dd3c8e41efb02de421bcb418e8eb"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0677dd3c8e41efb02de421bcb418e8eb">TARGET_UNIT_CASTER_MASTER</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_MASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00051">SpellTargetDefines.h:51</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa0aa5ea5eb36299739b7aea83aaf35035"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0aa5ea5eb36299739b7aea83aaf35035">TARGET_LOCATION_CASTER_RANDOM_CIRCUMFERENCE</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_RANDOM_CIRCUMFERENCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00097">SpellTargetDefines.h:97</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa0b2da5fbf74e11ae1df757694013207b"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0b2da5fbf74e11ae1df757694013207b">TARGET_ENUM_UNITS_SCRIPT_IN_CONE_110</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_SCRIPT_IN_CONE_110</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00134">SpellTargetDefines.h:134</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa0f919e108bdd31c96eaf3ae22e8afc81"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa0f919e108bdd31c96eaf3ae22e8afc81">TARGET_UNIT_CASTER_VEHICLE</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_VEHICLE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00118">SpellTargetDefines.h:118</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa1052b305d8ac2bcc0f1615688d85ad87"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa1052b305d8ac2bcc0f1615688d85ad87">TARGET_ENUM_UNITS_FRIEND_AOE_AT_SRC_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_FRIEND_AOE_AT_SRC_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00054">SpellTargetDefines.h:54</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa14b9e05e6fddd8c7f4c22a48f884277d"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa14b9e05e6fddd8c7f4c22a48f884277d">TARGET_LOCATION_UNIT_RANDOM_CIRCUMFERENCE</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_RANDOM_CIRCUMFERENCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00099">SpellTargetDefines.h:99</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa16abf06e96a64fa495bb02437ce9e1e5"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa16abf06e96a64fa495bb02437ce9e1e5">TARGET_NONE</a></div><div class="ttdeci">@ TARGET_NONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00024">SpellTargetDefines.h:24</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa192bf55bc11e794f05b93959677aaeac"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa192bf55bc11e794f05b93959677aaeac">TARGET_LOCATION_UNIT_FRONT_RIGHT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_FRONT_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00092">SpellTargetDefines.h:92</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa1c9e6d0a0c1c1f97e8425600d2d59074"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa1c9e6d0a0c1c1f97e8425600d2d59074">TARGET_UNIT</a></div><div class="ttdeci">@ TARGET_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00049">SpellTargetDefines.h:49</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa21b3cc1c648b4c7dfd528825f646547b"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa21b3cc1c648b4c7dfd528825f646547b">TARGET_LOCATION_UNIT_BACK_RIGHT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_BACK_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00093">SpellTargetDefines.h:93</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa2227c3934c959026126c590aa976120c"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa2227c3934c959026126c590aa976120c">TARGET_LOCATION_CASTER_DEST</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00042">SpellTargetDefines.h:42</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa2285d4c0c11aba1a9ef7624dd73f3154"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa2285d4c0c11aba1a9ef7624dd73f3154">TARGET_ENUM_UNITS_ENEMY_WITHIN_CASTER_RANGE</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_WITHIN_CASTER_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00060">SpellTargetDefines.h:60</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa241414530f70f1d99f9fb5ea7e0b2e9a"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa241414530f70f1d99f9fb5ea7e0b2e9a">TARGET_LOCATION_UNIT_FRONT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_FRONT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00088">SpellTargetDefines.h:88</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa243315a1a971c411ef893f4a10e89ab8"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa243315a1a971c411ef893f4a10e89ab8">TARGET_ENUM_UNITS_ENEMY_IN_CONE_24</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_IN_CONE_24</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00048">SpellTargetDefines.h:48</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa2f922538098b12f53c92f45d58f2ace0"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa2f922538098b12f53c92f45d58f2ace0">TARGET_LOCATION_UNIT_POSITION</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_POSITION</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00087">SpellTargetDefines.h:87</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3293d63207f1eacff69d0e5c01f9102e"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3293d63207f1eacff69d0e5c01f9102e">TARGET_ENUM_UNITS_ENEMY_AOE_AT_SRC_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_AOE_AT_SRC_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00039">SpellTargetDefines.h:39</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa330b81de27a4a8f562ae8f60de81d8bf"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa330b81de27a4a8f562ae8f60de81d8bf">TARGET_GAMEOBJECT</a></div><div class="ttdeci">@ TARGET_GAMEOBJECT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00047">SpellTargetDefines.h:47</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa35743402a8e82ed7a0dbf9dc40e765e8"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa35743402a8e82ed7a0dbf9dc40e765e8">TARGET_UNIT_FRIEND_AND_PARTY</a></div><div class="ttdeci">@ TARGET_UNIT_FRIEND_AND_PARTY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00061">SpellTargetDefines.h:61</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3888b9db5eaa2d6c9c5001a61fed215a"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3888b9db5eaa2d6c9c5001a61fed215a">TARGET_UNIT_PARTY</a></div><div class="ttdeci">@ TARGET_UNIT_PARTY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00059">SpellTargetDefines.h:59</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa389a4d3fa9b3d068ec5b545adcd8197f">TARGET_UNIT_CASTER_PET</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PET</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00029">SpellTargetDefines.h:29</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3927316559e8203c94784bc6312b8f1e"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3927316559e8203c94784bc6312b8f1e">TARGET_LOCATION_CASTER_FRONT_LEFT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_FRONT_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00068">SpellTargetDefines.h:68</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3afaf215630b5f1190a9a01af1647ff8"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3afaf215630b5f1190a9a01af1647ff8">TARGET_LOCATION_DATABASE</a></div><div class="ttdeci">@ TARGET_LOCATION_DATABASE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00041">SpellTargetDefines.h:41</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3c61620f3225fc58bf21fd0b28b03bb1"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3c61620f3225fc58bf21fd0b28b03bb1">TARGET_LOCATION_UNIT_LEFT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00091">SpellTargetDefines.h:91</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3e384548d63f5185979b9b85fac98260"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3e384548d63f5185979b9b85fac98260">TARGET_LOCATION_CASTER_BACK_LEFT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_BACK_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00067">SpellTargetDefines.h:67</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3e71172e3097833ab57cfa71a1948e01"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3e71172e3097833ab57cfa71a1948e01">TARGET_ENUM_UNITS_PARTY_WITHIN_CASTER_RANGE</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_PARTY_WITHIN_CASTER_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00044">SpellTargetDefines.h:44</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3eb863d0ed50b7cb140558155fb07a69"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3eb863d0ed50b7cb140558155fb07a69">TARGET_LOCATION_UNIT_MINION_POSITION</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_MINION_POSITION</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00056">SpellTargetDefines.h:56</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa3ee0e7ae710be02a672579f9a2cdaa1c"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa3ee0e7ae710be02a672579f9a2cdaa1c">TARGET_LOCATION_UNIT_RANDOM_SIDE</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_RANDOM_SIDE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00098">SpellTargetDefines.h:98</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa43d815f21348faf787193e3f132b4abc"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa43d815f21348faf787193e3f132b4abc">TARGET_CORPSE_ENEMY_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_CORPSE_ENEMY_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00117">SpellTargetDefines.h:117</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa45194d914c53adbad3f5c3ef37e45bb0"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa45194d914c53adbad3f5c3ef37e45bb0">TARGET_LOCATION_UNIT_BACK_LEFT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_BACK_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00094">SpellTargetDefines.h:94</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa497adaa813966fde1c3f47c2a9372b52"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa497adaa813966fde1c3f47c2a9372b52">TARGET_LOCATION_CASTER_HOME_BIND</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_HOME_BIND</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00033">SpellTargetDefines.h:33</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa4f5212bbde3482ca71754fce4a234623"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa4f5212bbde3482ca71754fce4a234623">TARGET_UNIT_FRIEND_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_UNIT_FRIEND_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00027">SpellTargetDefines.h:27</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa540ed708172827ecd79c9c90353a2814"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa540ed708172827ecd79c9c90353a2814">TARGET_UNIT_CASTER_PASSENGER_5</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_5</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00125">SpellTargetDefines.h:125</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa54b69935ff7431bbb3c212446751e74c"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa54b69935ff7431bbb3c212446751e74c">TARGET_ENUM_UNITS_ENEMY_IN_CONE_54</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_IN_CONE_54</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00078">SpellTargetDefines.h:78</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa5b0248090de8cd76bbc9613857c457a3"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa5b0248090de8cd76bbc9613857c457a3">TARGET_LOCATION_CASTER_FRONT_LEAP</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_FRONT_LEAP</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00079">SpellTargetDefines.h:79</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa626095e279ff1c2a3bef55233a562e04"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa626095e279ff1c2a3bef55233a562e04">TARGET_ENUM_GAMEOBJECTS_IN_CONE</a></div><div class="ttdeci">@ TARGET_ENUM_GAMEOBJECTS_IN_CONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00132">SpellTargetDefines.h:132</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa68001c3e90363ad1a4c5f757230d16be"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa68001c3e90363ad1a4c5f757230d16be">TARGET_LOCATION_NORTH</a></div><div class="ttdeci">@ TARGET_LOCATION_NORTH</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00102">SpellTargetDefines.h:102</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa68f754204abfef163e7033e55f110969"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa68f754204abfef163e7033e55f110969">TARGET_ENUM_UNITS_FRIEND_IN_CONE</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_FRIEND_IN_CONE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00083">SpellTargetDefines.h:83</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa6d07f243eca1c5b5700d3f458aac14ac"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa6d07f243eca1c5b5700d3f458aac14ac">TARGET_LOCATION_CHANNEL_TARGET_DEST</a></div><div class="ttdeci">@ TARGET_LOCATION_CHANNEL_TARGET_DEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00100">SpellTargetDefines.h:100</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa72096d416a65b6afc3bca4b433133076"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa72096d416a65b6afc3bca4b433133076">TARGET_LOCATION_CASTER_RANDOM_SIDE</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_RANDOM_SIDE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00096">SpellTargetDefines.h:96</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa7463ec8df96cd907f1ee4f4c1d26eec2"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa7463ec8df96cd907f1ee4f4c1d26eec2">TARGET_UNIT_CHANNEL_TARGET</a></div><div class="ttdeci">@ TARGET_UNIT_CHANNEL_TARGET</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00101">SpellTargetDefines.h:101</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa7af2a583a54b79cd9ef202bf80034a39"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa7af2a583a54b79cd9ef202bf80034a39">TARGET_LOCATION_WEST</a></div><div class="ttdeci">@ TARGET_LOCATION_WEST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00105">SpellTargetDefines.h:105</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa803ca1e0762a0164a4878ca4b6ee2574"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa803ca1e0762a0164a4878ca4b6ee2574">TARGET_UNIT_CASTER_PASSENGER_4</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_4</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00124">SpellTargetDefines.h:124</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa8143b77ebd5c7094f838b3706e28e7a5"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8143b77ebd5c7094f838b3706e28e7a5">TARGET_LOCATION_CASTER_FRONT_RIGHT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_FRONT_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00065">SpellTargetDefines.h:65</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa845d637ab032718a6bb70208004c5f77"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa845d637ab032718a6bb70208004c5f77">TARGET_ENUM_UNITS_ENEMY_AOE_AT_DYNOBJ_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_AOE_AT_DYNOBJ_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00052">SpellTargetDefines.h:52</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa847b95c95f887aed227e248da6ea7ef1"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa847b95c95f887aed227e248da6ea7ef1">TARGET_LOCKED</a></div><div class="ttdeci">@ TARGET_LOCKED</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00050">SpellTargetDefines.h:50</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa849ce98133e98ace927a223200cc9921"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa849ce98133e98ace927a223200cc9921">TARGET_ENUM_UNITS_RAID_WITHIN_CASTER_RANGE</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_RAID_WITHIN_CASTER_RANGE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00080">SpellTargetDefines.h:80</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa869a42510d816979e688662fbb633ea8"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa869a42510d816979e688662fbb633ea8">TARGET_UNIT_CASTER_COMPANION</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_COMPANION</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00114">SpellTargetDefines.h:114</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa8a0acf77fa924aaf8246959c0e9d9056"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8a0acf77fa924aaf8246959c0e9d9056">TARGET_UNIT_CASTER_PASSENGER_6</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_6</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00126">SpellTargetDefines.h:126</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa8e1ef902fbc13497db3f304f7333e3a9"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa8e1ef902fbc13497db3f304f7333e3a9">TARGET_UNIT_CASTER_DRIVER</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_DRIVER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00119">SpellTargetDefines.h:119</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa90d5a5a4d11d73a97b38d6a517c1be54"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa90d5a5a4d11d73a97b38d6a517c1be54">TARGET_LOCATION_SW</a></div><div class="ttdeci">@ TARGET_LOCATION_SW</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00109">SpellTargetDefines.h:109</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa928c214f7931bfcfd48ced9324112018"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa928c214f7931bfcfd48ced9324112018">TARGET_UNIT_CASTER_SUMMONER</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_SUMMONER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00116">SpellTargetDefines.h:116</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa92e3c1771e12ca7d6ade02a2bfb68aac"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa92e3c1771e12ca7d6ade02a2bfb68aac">TARGET_UNIT_CASTER_PASSENGER_2</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_2</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00122">SpellTargetDefines.h:122</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa93e38ce98bd2e26008dabeee153d70e7"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa93e38ce98bd2e26008dabeee153d70e7">TARGET_ENUM_UNITS_SCRIPT_AOE_AT_SRC_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_SCRIPT_AOE_AT_SRC_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00031">SpellTargetDefines.h:31</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa9489af0c1d71883a98d467b641a15701"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9489af0c1d71883a98d467b641a15701">TARGET_LOCATION_CASTER_RIGHT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00074">SpellTargetDefines.h:74</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa976b3231fb7f86856ce42df5b0c5d11a"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa976b3231fb7f86856ce42df5b0c5d11a">TARGET_ENUM_UNITS_SCRIPT_AOE_AT_DEST_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_SCRIPT_AOE_AT_DEST_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00032">SpellTargetDefines.h:32</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa9ae0d0fca4f7ea335145567b080452d2"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9ae0d0fca4f7ea335145567b080452d2">TARGET_LOCATION_CASTER_TARGET_POSITION</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_TARGET_POSITION</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00077">SpellTargetDefines.h:77</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fa9cb75fbf2cf80f4f7c136cbe37cfa24a"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fa9cb75fbf2cf80f4f7c136cbe37cfa24a">TARGET_LOCATION_NE</a></div><div class="ttdeci">@ TARGET_LOCATION_NE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00106">SpellTargetDefines.h:106</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faa14db836506dc1ea18ce822a31226b09"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa14db836506dc1ea18ce822a31226b09">TARGET_UNIT_RAID_AND_CLASS</a></div><div class="ttdeci">@ TARGET_UNIT_RAID_AND_CLASS</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00085">SpellTargetDefines.h:85</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faa293afadabc29273eadc698cf4b8d81a"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa293afadabc29273eadc698cf4b8d81a">TARGET_UNIT_FRIEND</a></div><div class="ttdeci">@ TARGET_UNIT_FRIEND</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00045">SpellTargetDefines.h:45</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faa7d217ba9f3a4619509d16df0845c494"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa7d217ba9f3a4619509d16df0845c494">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_DEST_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_DEST_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00076">SpellTargetDefines.h:76</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faa9cc352b03a763e4700d42b4a0679da4"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faa9cc352b03a763e4700d42b4a0679da4">TARGET_UNIT_CASTER_PASSENGER_0</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_0</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00120">SpellTargetDefines.h:120</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faab022171764c300280bec9c133e7dcd0"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faab022171764c300280bec9c133e7dcd0">TARGET_UNIT_ENEMY_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_UNIT_ENEMY_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00026">SpellTargetDefines.h:26</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faaf962faa0b0436ea23fa0615d2b7d07f"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faaf962faa0b0436ea23fa0615d2b7d07f">TARGET_LOCATION_NW</a></div><div class="ttdeci">@ TARGET_LOCATION_NW</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00107">SpellTargetDefines.h:107</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faafa68d7e3edd5e9a880f11c638d90ac2"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faafa68d7e3edd5e9a880f11c638d90ac2">TARGET_LOCATION_CASTER_BACK</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_BACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00072">SpellTargetDefines.h:72</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fab149d12968885342322cafcd890a69f5"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab149d12968885342322cafcd890a69f5">TARGET_LOCATION_RANDOM_SIDE</a></div><div class="ttdeci">@ TARGET_LOCATION_RANDOM_SIDE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00110">SpellTargetDefines.h:110</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fab258945225308f618ff4115a061d5216"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab258945225308f618ff4115a061d5216">TARGET_LOCATION_EAST</a></div><div class="ttdeci">@ TARGET_LOCATION_EAST</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00104">SpellTargetDefines.h:104</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fab27a47f743380539f673cfe7442e022d"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab27a47f743380539f673cfe7442e022d">TARGET_LOCATION_UNIT_FRONT_LEFT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_FRONT_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00095">SpellTargetDefines.h:95</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fab44f3e93e122acf78161b2342b778085"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab44f3e93e122acf78161b2342b778085">TARGET_ENUM_UNITS_ENEMY_IN_CONE_104</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_IN_CONE_104</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00128">SpellTargetDefines.h:128</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab4bbd0b2345bb3f962fd1b40d034a770">TARGET_UNIT_CASTER</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00025">SpellTargetDefines.h:25</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fab6dc6f1ac5022265ef1c62c76c27f173"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fab6dc6f1ac5022265ef1c62c76c27f173">TARGET_ENUM_UNITS_ENEMY_AOE_AT_DEST_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_ENEMY_AOE_AT_DEST_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00040">SpellTargetDefines.h:40</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fabb9be74f0eb3b8751c3c43180c5419fa"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabb9be74f0eb3b8751c3c43180c5419fa">TARGET_ENUM_UNITS_PARTY_AOE_AT_SRC_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_PARTY_AOE_AT_SRC_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00057">SpellTargetDefines.h:57</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fabd53e14fd8c6ef0e080679a91baf5177"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabd53e14fd8c6ef0e080679a91baf5177">TARGET_UNIT_CASTER_PASSENGER_7</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_7</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00127">SpellTargetDefines.h:127</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fabf4944d6625889f7769894a9af1aef1d"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fabf4944d6625889f7769894a9af1aef1d">TARGET_LOCATION_UNIT_BACK</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_BACK</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00089">SpellTargetDefines.h:89</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fac00ea1262694e1b6dd1508248ce627d9"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac00ea1262694e1b6dd1508248ce627d9">TARGET_UNIT_CASTER_PASSENGER_1</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_1</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00121">SpellTargetDefines.h:121</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fac3aa00cf33ff8b8dd6c07d25c6a3a271"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac3aa00cf33ff8b8dd6c07d25c6a3a271">TARGET_LOCATION_SOUTH</a></div><div class="ttdeci">@ TARGET_LOCATION_SOUTH</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00103">SpellTargetDefines.h:103</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fac6f4933c07d252653eb4e176093ab243"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac6f4933c07d252653eb4e176093ab243">TARGET_UNIT_CASTER_PASSENGER_3</a></div><div class="ttdeci">@ TARGET_UNIT_CASTER_PASSENGER_3</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00123">SpellTargetDefines.h:123</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fac87a16d4727bd15a2a30716d2a33efc1"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fac87a16d4727bd15a2a30716d2a33efc1">TARGET_LOCATION_CASTER_BACK_RIGHT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_BACK_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00066">SpellTargetDefines.h:66</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faca4a795bfc72905cda7e69b27f55fad5"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faca4a795bfc72905cda7e69b27f55fad5">TARGET_LOCATION_RANDOM_CIRCUMFERENCE</a></div><div class="ttdeci">@ TARGET_LOCATION_RANDOM_CIRCUMFERENCE</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00115">SpellTargetDefines.h:115</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fad4edcef40bb4b4c44e2c069b072dd774"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad4edcef40bb4b4c44e2c069b072dd774">TARGET_LOCATION_CASTER_FISHING_SPOT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_FISHING_SPOT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00063">SpellTargetDefines.h:63</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fad858d28d86ff46a5486f44c22633afd1"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad858d28d86ff46a5486f44c22633afd1">TARGET_ENUM_UNITS_PARTY_AOE_AT_DEST_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_PARTY_AOE_AT_DEST_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00058">SpellTargetDefines.h:58</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fad9889609489e68c367a004d563122c18"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9889609489e68c367a004d563122c18">TARGET_UNIT_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_UNIT_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00028">SpellTargetDefines.h:28</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fad9cf5a201243f1d419decd3fdad93380"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fad9cf5a201243f1d419decd3fdad93380">TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_SRC_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_GAMEOBJECTS_SCRIPT_AOE_AT_SRC_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00075">SpellTargetDefines.h:75</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fadda43b90ff97d6de36f0753dfe22253e"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadda43b90ff97d6de36f0753dfe22253e">TARGET_UNIT_FRIEND_CHAIN_HEAL</a></div><div class="ttdeci">@ TARGET_UNIT_FRIEND_CHAIN_HEAL</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00069">SpellTargetDefines.h:69</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fadf337d96d4533d435edc95a03b033035"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadf337d96d4533d435edc95a03b033035">TARGET_LOCATION_CASTER_SRC</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_SRC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00046">SpellTargetDefines.h:46</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fadf47750aa58fa5026d9afefdd3140b64"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadf47750aa58fa5026d9afefdd3140b64">TARGET_ENUM_UNITS_FRIEND_AOE_AT_DEST_LOC</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_FRIEND_AOE_AT_DEST_LOC</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00055">SpellTargetDefines.h:55</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fadfe9fb54503ef1480fee762d58e08388"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fadfe9fb54503ef1480fee762d58e08388">TARGET_LOCATION_UNIT_RIGHT</a></div><div class="ttdeci">@ TARGET_LOCATION_UNIT_RIGHT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00090">SpellTargetDefines.h:90</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fae1dbf35279c8e9d2da10764df673261e"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae1dbf35279c8e9d2da10764df673261e">TARGET_UNIT_RAID</a></div><div class="ttdeci">@ TARGET_UNIT_RAID</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00081">SpellTargetDefines.h:81</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fae46169d7118e2f9a826dbde4ff6e656f"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae46169d7118e2f9a826dbde4ff6e656f">TARGET_LOCATION_CASTER_LEFT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_LEFT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00073">SpellTargetDefines.h:73</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fae5d790ba3d9643df7cb762af14e36c38"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae5d790ba3d9643df7cb762af14e36c38">TARGET_LOCATION_TRAJECTORY</a></div><div class="ttdeci">@ TARGET_LOCATION_TRAJECTORY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00113">SpellTargetDefines.h:113</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30fae926e00811e9e5e3dd31c0145306d783"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30fae926e00811e9e5e3dd31c0145306d783">TARGET_LOCATION_CASTER_FRONT</a></div><div class="ttdeci">@ TARGET_LOCATION_CASTER_FRONT</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00071">SpellTargetDefines.h:71</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faedcd06b127e6929ec44b33d36e639b9b"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faedcd06b127e6929ec44b33d36e639b9b">TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_GAMEOBJECT_SCRIPT_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00064">SpellTargetDefines.h:64</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faf017755d35fc98dfff49309dc15909a6"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf017755d35fc98dfff49309dc15909a6">TARGET_ENUM_UNITS_SCRIPT_IN_CONE_60</a></div><div class="ttdeci">@ TARGET_ENUM_UNITS_SCRIPT_IN_CONE_60</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00084">SpellTargetDefines.h:84</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faf70a4efa83b11389d844309475184e3e"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf70a4efa83b11389d844309475184e3e">TARGET_UNIT_SCRIPT_NEAR_CASTER</a></div><div class="ttdeci">@ TARGET_UNIT_SCRIPT_NEAR_CASTER</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00062">SpellTargetDefines.h:62</a></div></div>
<div class="ttc" id="aSpellTargetDefines_8h_html_acdecc5683aafec67de3b763b82cec30faf942ecb11955a03d4b522c3981b71689"><div class="ttname"><a href="SpellTargetDefines_8h.html#acdecc5683aafec67de3b763b82cec30faf942ecb11955a03d4b522c3981b71689">TARGET_UNIT_ENEMY</a></div><div class="ttdeci">@ TARGET_UNIT_ENEMY</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargetDefines_8h_source.html#l00030">SpellTargetDefines.h:30</a></div></div>
<div class="ttc" id="aSpellTargets_8cpp_html_a61237003f35a46369a2a576ccedeb4d9"><div class="ttname"><a href="SpellTargets_8cpp.html#a61237003f35a46369a2a576ccedeb4d9">SpellTargetInfoTable</a></div><div class="ttdeci">SpellTargetInfo SpellTargetInfoTable[MAX_SPELL_TARGETS]</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8cpp_source.html#l00031">SpellTargets.cpp:31</a></div></div>
<div class="ttc" id="aSpell_8cpp_html_a383f3a05d4be51b435ee3729ecef2945"><div class="ttname"><a href="Spell_8cpp.html#a383f3a05d4be51b435ee3729ecef2945">PrioritizeHealthUnitQueue</a></div><div class="ttdeci">std::priority_queue&lt; PrioritizeHealthUnitWraper, std::vector&lt; PrioritizeHealthUnitWraper &gt;, PrioritizeHealth &gt; PrioritizeHealthUnitQueue</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00102">Spell.cpp:102</a></div></div>
<div class="ttc" id="aSpell_8cpp_html_a75fe3a63b7f03e4148a49154481cd53d"><div class="ttname"><a href="Spell_8cpp.html#a75fe3a63b7f03e4148a49154481cd53d">PrioritizeManaUnitQueue</a></div><div class="ttdeci">std::priority_queue&lt; PrioritizeManaUnitWraper, std::vector&lt; PrioritizeManaUnitWraper &gt;, PrioritizeMana &gt; PrioritizeManaUnitQueue</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00078">Spell.cpp:78</a></div></div>
<div class="ttc" id="aSpell_8cpp_html_a9139404c5db8890c4fa92c1a7a8e68b1"><div class="ttname"><a href="Spell_8cpp.html#a9139404c5db8890c4fa92c1a7a8e68b1">IsQuestTameSpell</a></div><div class="ttdeci">bool IsQuestTameSpell(uint32 spellId)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00104">Spell.cpp:104</a></div></div>
<div class="ttc" id="aSpell_8h_html"><div class="ttname"><a href="Spell_8h.html">Spell.h</a></div></div>
<div class="ttc" id="aSpell_8h_html_a26481736169727a2aefce2cac71c5bee"><div class="ttname"><a href="Spell_8h.html#a26481736169727a2aefce2cac71c5bee">SpellNotifyPushType</a></div><div class="ttdeci">SpellNotifyPushType</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00079">Spell.h:80</a></div></div>
<div class="ttc" id="aSpell_8h_html_a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2"><div class="ttname"><a href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea1bb4ed5d94b5043026124678e75614f2">PUSH_SELF_CENTER</a></div><div class="ttdeci">@ PUSH_SELF_CENTER</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00082">Spell.h:82</a></div></div>
<div class="ttc" id="aSpell_8h_html_a26481736169727a2aefce2cac71c5beea8b8284b655c0fc1cf036759c5b15ec91"><div class="ttname"><a href="Spell_8h.html#a26481736169727a2aefce2cac71c5beea8b8284b655c0fc1cf036759c5b15ec91">PUSH_CONE</a></div><div class="ttdeci">@ PUSH_CONE</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00081">Spell.h:81</a></div></div>
<div class="ttc" id="aSpell_8h_html_a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82"><div class="ttname"><a href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeaa2de4f65fdb6a9714d35ca0915d97e82">PUSH_DEST_CENTER</a></div><div class="ttdeci">@ PUSH_DEST_CENTER</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00084">Spell.h:84</a></div></div>
<div class="ttc" id="aSpell_8h_html_a26481736169727a2aefce2cac71c5beeabb9c9e877dd5e758ed6738ea93caf4cd"><div class="ttname"><a href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeabb9c9e877dd5e758ed6738ea93caf4cd">PUSH_TARGET_CENTER</a></div><div class="ttdeci">@ PUSH_TARGET_CENTER</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00086">Spell.h:85</a></div></div>
<div class="ttc" id="aSpell_8h_html_a26481736169727a2aefce2cac71c5beeae489e922bd8a08171622196e027c7b9e"><div class="ttname"><a href="Spell_8h.html#a26481736169727a2aefce2cac71c5beeae489e922bd8a08171622196e027c7b9e">PUSH_SRC_CENTER</a></div><div class="ttdeci">@ PUSH_SRC_CENTER</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00083">Spell.h:83</a></div></div>
<div class="ttc" id="aSpell_8h_html_a320d41db75cda1bb9e0e6c9fde0c05eb"><div class="ttname"><a href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eb">CheckException</a></div><div class="ttdeci">CheckException</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00088">Spell.h:89</a></div></div>
<div class="ttc" id="aSpell_8h_html_a320d41db75cda1bb9e0e6c9fde0c05eba1d50ba8ddaa28f38304b557bbf8cdfc6"><div class="ttname"><a href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba1d50ba8ddaa28f38304b557bbf8cdfc6">EXCEPTION_NONE</a></div><div class="ttdeci">@ EXCEPTION_NONE</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00090">Spell.h:90</a></div></div>
<div class="ttc" id="aSpell_8h_html_a320d41db75cda1bb9e0e6c9fde0c05eba4fafb5864cb471a67bb473eb292c73ba"><div class="ttname"><a href="Spell_8h.html#a320d41db75cda1bb9e0e6c9fde0c05eba4fafb5864cb471a67bb473eb292c73ba">EXCEPTION_MAGNET</a></div><div class="ttdeci">@ EXCEPTION_MAGNET</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00091">Spell.h:91</a></div></div>
<div class="ttc" id="aSpell_8h_html_a68423826ac8d5f2d2aca7e83dfa9d2c2a821083f58cdc2d250afcee151634e757"><div class="ttname"><a href="Spell_8h.html#a68423826ac8d5f2d2aca7e83dfa9d2c2a821083f58cdc2d250afcee151634e757">SPELL_FLAG_REFLECTED</a></div><div class="ttdeci">@ SPELL_FLAG_REFLECTED</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00075">Spell.h:75</a></div></div>
<div class="ttc" id="aSpell_8h_html_a68423826ac8d5f2d2aca7e83dfa9d2c2abc18f1a292e6163055b15c50854a6cbe"><div class="ttname"><a href="Spell_8h.html#a68423826ac8d5f2d2aca7e83dfa9d2c2abc18f1a292e6163055b15c50854a6cbe">SPELL_FLAG_NORMAL</a></div><div class="ttdeci">@ SPELL_FLAG_NORMAL</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00074">Spell.h:74</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa1fa19ee882c9fe4c5ce629bbe7cf46d7">SPELL_STATE_CHANNELING</a></div><div class="ttdeci">@ SPELL_STATE_CHANNELING</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00254">Spell.h:254</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aa2469fe6b82004a0a40c5f2162b362dd0"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa2469fe6b82004a0a40c5f2162b362dd0">SPELL_STATE_CREATED</a></div><div class="ttdeci">@ SPELL_STATE_CREATED</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00248">Spell.h:248</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa620ae87eec478ce64981cb346d628a44">SPELL_STATE_FINISHED</a></div><div class="ttdeci">@ SPELL_STATE_FINISHED</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00255">Spell.h:255</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aa763d6493fb2b6b556c84aee4e0f1bad3"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aa763d6493fb2b6b556c84aee4e0f1bad3">SPELL_STATE_TARGETING</a></div><div class="ttdeci">@ SPELL_STATE_TARGETING</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00249">Spell.h:249</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aadbd6fe601af63646085c41f24bd45c62">SPELL_STATE_TRAVELING</a></div><div class="ttdeci">@ SPELL_STATE_TRAVELING</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00252">Spell.h:252</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aae175109189bc7f989a42de7f088cb6fa"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aae175109189bc7f989a42de7f088cb6fa">SPELL_STATE_CASTING</a></div><div class="ttdeci">@ SPELL_STATE_CASTING</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00250">Spell.h:250</a></div></div>
<div class="ttc" id="aSpell_8h_html_a821bd91389a0f4046989739b12e84f0aaf3ec0c7a0bbd78bc7ee9137522143073"><div class="ttname"><a href="Spell_8h.html#a821bd91389a0f4046989739b12e84f0aaf3ec0c7a0bbd78bc7ee9137522143073">SPELL_STATE_LANDING</a></div><div class="ttdeci">@ SPELL_STATE_LANDING</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00253">Spell.h:253</a></div></div>
<div class="ttc" id="aSpell_8h_html_a925df27fa7c1cddda3066155bff0ef5c"><div class="ttname"><a href="Spell_8h.html#a925df27fa7c1cddda3066155bff0ef5c">SPELL_INTERRUPT_NONPLAYER</a></div><div class="ttdeci">static const uint32 SPELL_INTERRUPT_NONPLAYER</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00396">Spell.h:396</a></div></div>
<div class="ttc" id="aSpell_8h_html_abdc7a5fee946eeffe8bfaad9e6b4b069"><div class="ttname"><a href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069">SpellTargets</a></div><div class="ttdeci">SpellTargets</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00258">Spell.h:259</a></div></div>
<div class="ttc" id="aSpell_8h_html_abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3"><div class="ttname"><a href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069a4fe3ea6f9fdd7dde6913ba898f1e11e3">SPELL_TARGETS_ALL</a></div><div class="ttdeci">@ SPELL_TARGETS_ALL</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00264">Spell.h:263</a></div></div>
<div class="ttc" id="aSpell_8h_html_abdc7a5fee946eeffe8bfaad9e6b4b069aaf1e1f6abc10d870a060042c81c9a8ea"><div class="ttname"><a href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069aaf1e1f6abc10d870a060042c81c9a8ea">SPELL_TARGETS_ASSISTABLE</a></div><div class="ttdeci">@ SPELL_TARGETS_ASSISTABLE</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00260">Spell.h:260</a></div></div>
<div class="ttc" id="aSpell_8h_html_abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae"><div class="ttname"><a href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ace861fadf3bdf143745f025e152ad3ae">SPELL_TARGETS_AOE_ATTACKABLE</a></div><div class="ttdeci">@ SPELL_TARGETS_AOE_ATTACKABLE</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00261">Spell.h:261</a></div></div>
<div class="ttc" id="aSpell_8h_html_abdc7a5fee946eeffe8bfaad9e6b4b069ae187cfead2e915ac383583ad0eaa6f50"><div class="ttname"><a href="Spell_8h.html#abdc7a5fee946eeffe8bfaad9e6b4b069ae187cfead2e915ac383583ad0eaa6f50">SPELL_TARGETS_CHAIN_ATTACKABLE</a></div><div class="ttdeci">@ SPELL_TARGETS_CHAIN_ATTACKABLE</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00262">Spell.h:262</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a04f23993f9ac92c42034f26148fae84a"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a04f23993f9ac92c42034f26148fae84a">CAST_FLAG_UNKNOWN9</a></div><div class="ttdeci">@ CAST_FLAG_UNKNOWN9</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00055">Spell.h:55</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a0c8ef953a07121a38ba7875e32720953"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a0c8ef953a07121a38ba7875e32720953">CAST_FLAG_AMMO</a></div><div class="ttdeci">@ CAST_FLAG_AMMO</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00052">Spell.h:52</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a20c95c624718076edc4b69e74aba3b69"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a20c95c624718076edc4b69e74aba3b69">CAST_FLAG_VISUAL_CHAIN</a></div><div class="ttdeci">@ CAST_FLAG_VISUAL_CHAIN</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00066">Spell.h:66</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a25ea230a991929d0783ee73277ceeaa0"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a25ea230a991929d0783ee73277ceeaa0">CAST_FLAG_PREDICTED_POWER</a></div><div class="ttdeci">@ CAST_FLAG_PREDICTED_POWER</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00058">Spell.h:58</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a262d78c35fb74238ec4a1afdb28219db"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a262d78c35fb74238ec4a1afdb28219db">CAST_FLAG_ADJUST_MISSILE</a></div><div class="ttdeci">@ CAST_FLAG_ADJUST_MISSILE</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00064">Spell.h:64</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a2c68cf73413c91489ff4405cf2b49797"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a2c68cf73413c91489ff4405cf2b49797">CAST_FLAG_PREDICTED_RUNES</a></div><div class="ttdeci">@ CAST_FLAG_PREDICTED_RUNES</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00068">Spell.h:68</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a392ab315fc9125f98dbd806ceaf711b0"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a392ab315fc9125f98dbd806ceaf711b0">CAST_FLAG_UNKNOWN7</a></div><div class="ttdeci">@ CAST_FLAG_UNKNOWN7</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00053">Spell.h:53</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a736df7bee6e7361d9637de90959f9169"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a736df7bee6e7361d9637de90959f9169">CAST_FLAG_NO_GCD</a></div><div class="ttdeci">@ CAST_FLAG_NO_GCD</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00065">Spell.h:65</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a8980c27eb74f67451b1a58348b6583a2"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a8980c27eb74f67451b1a58348b6583a2">CAST_FLAG_HIDDEN_COMBATLOG</a></div><div class="ttdeci">@ CAST_FLAG_HIDDEN_COMBATLOG</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00047">Spell.h:47</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5a953c4436ce4e0d1ef72b926c51f8fd76"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5a953c4436ce4e0d1ef72b926c51f8fd76">CAST_FLAG_PERSISTENT_AA</a></div><div class="ttdeci">@ CAST_FLAG_PERSISTENT_AA</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00051">Spell.h:51</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5aeb6eabdc1379fa5bc61395a9ea1d29ab"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5aeb6eabdc1379fa5bc61395a9ea1d29ab">CAST_FLAG_IMMUNITY</a></div><div class="ttdeci">@ CAST_FLAG_IMMUNITY</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00070">Spell.h:69</a></div></div>
<div class="ttc" id="aSpell_8h_html_abed1822d323e37699c2c01a115a1d2f5af886177dd798d8295ddce2bfd2499d5b"><div class="ttname"><a href="Spell_8h.html#abed1822d323e37699c2c01a115a1d2f5af886177dd798d8295ddce2bfd2499d5b">CAST_FLAG_UNKNOWN2</a></div><div class="ttdeci">@ CAST_FLAG_UNKNOWN2</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00048">Spell.h:48</a></div></div>
<div class="ttc" id="aSpell_8h_html_abf8a42faff2e4c924eb6200d1243470e"><div class="ttname"><a href="Spell_8h.html#abf8a42faff2e4c924eb6200d1243470e">pEffect</a></div><div class="ttdeci">void(Spell::* pEffect)(SpellEffectIndex eff_idx)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01314">Spell.h:1314</a></div></div>
<div class="ttc" id="aTemporarySpawn_8h_html"><div class="ttname"><a href="TemporarySpawn_8h.html">TemporarySpawn.h</a></div></div>
<div class="ttc" id="aTransports_8h_html"><div class="ttname"><a href="Transports_8h.html">Transports.h</a></div></div>
<div class="ttc" id="aUnit_8h_html"><div class="ttname"><a href="Unit_8h.html">Unit.h</a></div></div>
<div class="ttc" id="aUpdateData_8h_html"><div class="ttname"><a href="UpdateData_8h.html">UpdateData.h</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881a1f16c4385c6f555e384b123886377fa1"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a1f16c4385c6f555e384b123886377fa1">UNIT_FIELD_POWER_COST_MODIFIER</a></div><div class="ttdeci">@ UNIT_FIELD_POWER_COST_MODIFIER</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00173">UpdateFields.h:173</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881a65a8142f4727b52425e593eb2727d9f4"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a65a8142f4727b52425e593eb2727d9f4">PLAYER_FLAGS</a></div><div class="ttdeci">@ PLAYER_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00181">UpdateFields.h:181</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881a6b03ad8147a368bbf29c0b92b12b0679"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a6b03ad8147a368bbf29c0b92b12b0679">UNIT_FIELD_FLAGS_2</a></div><div class="ttdeci">@ UNIT_FIELD_FLAGS_2</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00121">UpdateFields.h:121</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881a89f1b8c28d6c8813b9ece7c17144995c"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a89f1b8c28d6c8813b9ece7c17144995c">UNIT_VIRTUAL_ITEM_SLOT_ID</a></div><div class="ttdeci">@ UNIT_VIRTUAL_ITEM_SLOT_ID</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00119">UpdateFields.h:119</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881a98b3337ada4a0939a660090381c648b6"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881a98b3337ada4a0939a660090381c648b6">PLAYER_AMMO_ID</a></div><div class="ttdeci">@ PLAYER_AMMO_ID</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00372">UpdateFields.h:372</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881aab4868b631f1cfaf30faee627f7c9dbf">UNIT_FIELD_FLAGS</a></div><div class="ttdeci">@ UNIT_FIELD_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00120">UpdateFields.h:120</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881ab0b0eb5c95c9a8b5a1ff279e5f8bfb03"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881ab0b0eb5c95c9a8b5a1ff279e5f8bfb03">UNIT_FIELD_CHANNEL_SPELL</a></div><div class="ttdeci">@ UNIT_FIELD_CHANNEL_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00097">UpdateFields.h:97</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a0e42dc606678c9df7884e1aad621e881ae2928aeed1af182ed918045f3823ac38"><div class="ttname"><a href="UpdateFields_8h.html#a0e42dc606678c9df7884e1aad621e881ae2928aeed1af182ed918045f3823ac38">UNIT_FIELD_POWER_COST_MULTIPLIER</a></div><div class="ttdeci">@ UNIT_FIELD_POWER_COST_MULTIPLIER</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00174">UpdateFields.h:174</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_a529e4bfaaee7e3c2dc52aaa447287cfba3fdc4d82d91ec74b4223b5233aa78efe"><div class="ttname"><a href="UpdateFields_8h.html#a529e4bfaaee7e3c2dc52aaa447287cfba3fdc4d82d91ec74b4223b5233aa78efe">ITEM_FIELD_FLAGS</a></div><div class="ttdeci">@ ITEM_FIELD_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00045">UpdateFields.h:45</a></div></div>
<div class="ttc" id="aUpdateFields_8h_html_aee9d327a38d3cfe074ba81a44817491fad08f691f9fe08339350689b33ca12d66"><div class="ttname"><a href="UpdateFields_8h.html#aee9d327a38d3cfe074ba81a44817491fad08f691f9fe08339350689b33ca12d66">GAMEOBJECT_FLAGS</a></div><div class="ttdeci">@ GAMEOBJECT_FLAGS</div><div class="ttdef"><b>Definition:</b> <a href="UpdateFields_8h_source.html#l00402">UpdateFields.h:402</a></div></div>
<div class="ttc" id="aUtil_8cpp_html_a6ae07d2bb0593d8339e65c136f63ecc0"><div class="ttname"><a href="Util_8cpp.html#a6ae07d2bb0593d8339e65c136f63ecc0">irand</a></div><div class="ttdeci">int32 irand(int32 min, int32 max)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8cpp_source.html#l00068">Util.cpp:68</a></div></div>
<div class="ttc" id="aUtil_8cpp_html_ab17def34ccbbd868dc87a16bf35acdbd"><div class="ttname"><a href="Util_8cpp.html#ab17def34ccbbd868dc87a16bf35acdbd">urand</a></div><div class="ttdeci">uint32 urand(uint32 min, uint32 max)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8cpp_source.html#l00074">Util.cpp:74</a></div></div>
<div class="ttc" id="aUtil_8cpp_html_af00c37ad9baddfa7ea23f49f27762de8"><div class="ttname"><a href="Util_8cpp.html#af00c37ad9baddfa7ea23f49f27762de8">rand_norm_f</a></div><div class="ttdeci">float rand_norm_f()</div><div class="ttdef"><b>Definition:</b> <a href="Util_8cpp_source.html#l00104">Util.cpp:104</a></div></div>
<div class="ttc" id="aUtil_8h_html"><div class="ttname"><a href="Util_8h.html">Util.h</a></div></div>
<div class="ttc" id="aUtil_8h_html_a50320d4edff86db31b25138ae72161ad"><div class="ttname"><a href="Util_8h.html#a50320d4edff86db31b25138ae72161ad">roll_chance_i</a></div><div class="ttdeci">bool roll_chance_i(int chance)</div><div class="ttdef"><b>Definition:</b> <a href="Util_8h_source.html#l00087">Util.h:87</a></div></div>
<div class="ttc" id="aVMapFactory_8h_html"><div class="ttname"><a href="VMapFactory_8h.html">VMapFactory.h</a></div></div>
<div class="ttc" id="aVehicle_8h_html"><div class="ttname"><a href="Vehicle_8h.html">Vehicle.h</a></div><div class="ttdoc">This file contains the headers for the functionality required by Vehicles.</div></div>
<div class="ttc" id="aWorldPacket_8h_html"><div class="ttname"><a href="WorldPacket_8h.html">WorldPacket.h</a></div></div>
<div class="ttc" id="aWorldSession_8h_html"><div class="ttname"><a href="WorldSession_8h.html">WorldSession.h</a></div></div>
<div class="ttc" id="aWorld_8h_html"><div class="ttname"><a href="World_8h.html">World.h</a></div></div>
<div class="ttc" id="aclassAchievementMgr_html_a78368ea82c1c770933b636e1a2343e8e"><div class="ttname"><a href="classAchievementMgr.html#a78368ea82c1c770933b636e1a2343e8e">AchievementMgr::UpdateAchievementCriteria</a></div><div class="ttdeci">void UpdateAchievementCriteria(AchievementCriteriaTypes type, uint32 miscvalue1=0, uint32 miscvalue2=0, Unit *unit=nullptr, uint32 time=0)</div><div class="ttdoc">this function will be called whenever the user might have done a criteria relevant action</div><div class="ttdef"><b>Definition:</b> <a href="AchievementMgr_8cpp_source.html#l00911">AchievementMgr.cpp:911</a></div></div>
<div class="ttc" id="aclassAura_html"><div class="ttname"><a href="classAura.html">Aura</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00277">SpellAuras.h:278</a></div></div>
<div class="ttc" id="aclassAura_html_a147025fb57da9da66ff1ca2ed6d9331e"><div class="ttname"><a href="classAura.html#a147025fb57da9da66ff1ca2ed6d9331e">Aura::GetHolder</a></div><div class="ttdeci">SpellAuraHolder * GetHolder()</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00528">SpellAuras.h:528</a></div></div>
<div class="ttc" id="aclassAura_html_a2ed87e20905a61440fd9b0420182eb0a"><div class="ttname"><a href="classAura.html#a2ed87e20905a61440fd9b0420182eb0a">Aura::GetSpellProto</a></div><div class="ttdeci">SpellEntry const  * GetSpellProto() const</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00470">SpellAuras.h:470</a></div></div>
<div class="ttc" id="aclassAura_html_abc74e38ede7bee870179bd17df589f7f"><div class="ttname"><a href="classAura.html#abc74e38ede7bee870179bd17df589f7f">Aura::CalculateAuraEffectValue</a></div><div class="ttdeci">static uint32 CalculateAuraEffectValue(Unit *caster, Unit *target, SpellEntry const *spellProto, SpellEffectIndex effIdx, uint32 value)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8cpp_source.html#l11469">SpellAuras.cpp:11469</a></div></div>
<div class="ttc" id="aclassBasicEvent_html"><div class="ttname"><a href="classBasicEvent.html">BasicEvent</a></div><div class="ttdef"><b>Definition:</b> <a href="EventProcessor_8h_source.html#l00028">EventProcessor.h:29</a></div></div>
<div class="ttc" id="aclassBattleGround_html"><div class="ttname"><a href="classBattleGround.html">BattleGround</a></div><div class="ttdef"><b>Definition:</b> <a href="BattleGround_8h_source.html#l00334">BattleGround.h:335</a></div></div>
<div class="ttc" id="aclassByteBufferException_html"><div class="ttname"><a href="classByteBufferException.html">ByteBufferException</a></div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00026">ByteBuffer.h:27</a></div></div>
<div class="ttc" id="aclassByteBuffer_html"><div class="ttname"><a href="classByteBuffer.html">ByteBuffer</a></div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00049">ByteBuffer.h:50</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a1c6679ea7a9b1eb27762460f87b25836"><div class="ttname"><a href="classByteBuffer.html#a1c6679ea7a9b1eb27762460f87b25836">ByteBuffer::put</a></div><div class="ttdeci">void put(size_t pos, T value)</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00105">ByteBuffer.h:105</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a1e1a47f362861d8cd61cdf27f7eb1812"><div class="ttname"><a href="classByteBuffer.html#a1e1a47f362861d8cd61cdf27f7eb1812">ByteBuffer::rpos</a></div><div class="ttdeci">size_t rpos() const</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00272">ByteBuffer.h:272</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a2dd5e1c2c674c3a0a4c368f6fa833dd6"><div class="ttname"><a href="classByteBuffer.html#a2dd5e1c2c674c3a0a4c368f6fa833dd6">ByteBuffer::appendPackGUID</a></div><div class="ttdeci">void appendPackGUID(uint64 guid)</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00430">ByteBuffer.h:430</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_a822527905d8efa5938e6a9f1adde97fd"><div class="ttname"><a href="classByteBuffer.html#a822527905d8efa5938e6a9f1adde97fd">ByteBuffer::wpos</a></div><div class="ttdeci">size_t wpos() const</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00280">ByteBuffer.h:280</a></div></div>
<div class="ttc" id="aclassByteBuffer_html_ac06a598447807d32f6594a97a32bce94"><div class="ttname"><a href="classByteBuffer.html#ac06a598447807d32f6594a97a32bce94">ByteBuffer::size</a></div><div class="ttdeci">size_t size() const</div><div class="ttdef"><b>Definition:</b> <a href="ByteBuffer_8h_source.html#l00365">ByteBuffer.h:365</a></div></div>
<div class="ttc" id="aclassChainHealingFullHealth_html"><div class="ttname"><a href="classChainHealingFullHealth.html">ChainHealingFullHealth</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01886">Spell.cpp:1887</a></div></div>
<div class="ttc" id="aclassChainHealingFullHealth_html_a4657de755e44fff4b7c1ebb58dd0d526"><div class="ttname"><a href="classChainHealingFullHealth.html#a4657de755e44fff4b7c1ebb58dd0d526">ChainHealingFullHealth::operator()</a></div><div class="ttdeci">bool operator()(const Unit *Target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01892">Spell.cpp:1892</a></div></div>
<div class="ttc" id="aclassChainHealingFullHealth_html_a508d9e1afb737ddb09df7e0a3b7cbafd"><div class="ttname"><a href="classChainHealingFullHealth.html#a508d9e1afb737ddb09df7e0a3b7cbafd">ChainHealingFullHealth::MainTarget</a></div><div class="ttdeci">const Unit * MainTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01889">Spell.cpp:1889</a></div></div>
<div class="ttc" id="aclassChainHealingFullHealth_html_a888ab51ccd8d272c47ce9288b5782936"><div class="ttname"><a href="classChainHealingFullHealth.html#a888ab51ccd8d272c47ce9288b5782936">ChainHealingFullHealth::ChainHealingFullHealth</a></div><div class="ttdeci">ChainHealingFullHealth(const Unit *Target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01890">Spell.cpp:1890</a></div></div>
<div class="ttc" id="aclassChatHandler_html"><div class="ttname"><a href="classChatHandler.html">ChatHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="Chat_8h_source.html#l00080">Chat.h:81</a></div></div>
<div class="ttc" id="aclassChatHandler_html_ae6e3e55f3307001fe04387f2f9e80074"><div class="ttname"><a href="classChatHandler.html#ae6e3e55f3307001fe04387f2f9e80074">ChatHandler::FindCommand</a></div><div class="ttdeci">ChatCommand const  * FindCommand(char const *text)</div><div class="ttdoc">Search (sub)command for command line available for chat handler access level.</div><div class="ttdef"><b>Definition:</b> <a href="Chat_8cpp_source.html#l01327">Chat.cpp:1327</a></div></div>
<div class="ttc" id="aclassCombatManager_html_af07085c25f35ca9e97119b313810e433"><div class="ttname"><a href="classCombatManager.html#af07085c25f35ca9e97119b313810e433">CombatManager::TriggerCombatTimer</a></div><div class="ttdeci">void TriggerCombatTimer(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="CombatManager_8cpp_source.html#l00184">CombatManager.cpp:184</a></div></div>
<div class="ttc" id="aclassCorpse_html"><div class="ttname"><a href="classCorpse.html">Corpse</a></div><div class="ttdef"><b>Definition:</b> <a href="Corpse_8h_source.html#l00049">Corpse.h:50</a></div></div>
<div class="ttc" id="aclassCorpse_html_a62cde64257532bb8db3d052c9a2c9965"><div class="ttname"><a href="classCorpse.html#a62cde64257532bb8db3d052c9a2c9965">Corpse::GetOwnerGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetOwnerGuid() const override</div><div class="ttdef"><b>Definition:</b> <a href="Corpse_8h_source.html#l00067">Corpse.h:67</a></div></div>
<div class="ttc" id="aclassCreature_html"><div class="ttname"><a href="classCreature.html">Creature</a></div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00544">Creature.h:545</a></div></div>
<div class="ttc" id="aclassCreature_html_a013409bd4b6d0286c0243cfff4221e0d"><div class="ttname"><a href="classCreature.html#a013409bd4b6d0286c0243cfff4221e0d">Creature::GetCreatureInfo</a></div><div class="ttdeci">CreatureInfo const  * GetCreatureInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00680">Creature.h:680</a></div></div>
<div class="ttc" id="aclassCreature_html_a026fb9fce8e9e74991097c7b626d38e3"><div class="ttname"><a href="classCreature.html#a026fb9fce8e9e74991097c7b626d38e3">Creature::AI</a></div><div class="ttdeci">virtual UnitAI * AI() override</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00632">Creature.h:632</a></div></div>
<div class="ttc" id="aclassCreature_html_a1b5958a0bdca7d2c4079acbb1c2ce873"><div class="ttname"><a href="classCreature.html#a1b5958a0bdca7d2c4079acbb1c2ce873">Creature::HasBeenHitBySpell</a></div><div class="ttdeci">bool HasBeenHitBySpell(uint32 spellId)</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8cpp_source.html#l03026">Creature.cpp:3026</a></div></div>
<div class="ttc" id="aclassCreature_html_a4104af1a1e3d70a82cd92d16f8378147"><div class="ttname"><a href="classCreature.html#a4104af1a1e3d70a82cd92d16f8378147">Creature::GetLootStatus</a></div><div class="ttdeci">CreatureLootStatus GetLootStatus() const</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00702">Creature.h:702</a></div></div>
<div class="ttc" id="aclassCreature_html_a5645c3877ec9f0e68c8e26b76cebcf68"><div class="ttname"><a href="classCreature.html#a5645c3877ec9f0e68c8e26b76cebcf68">Creature::IsPet</a></div><div class="ttdeci">bool IsPet() const</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00572">Creature.h:572</a></div></div>
<div class="ttc" id="aclassCreature_html_a95420bfae733fac3cc9939e3cbd94862"><div class="ttname"><a href="classCreature.html#a95420bfae733fac3cc9939e3cbd94862">Creature::IsImmuneToSpell</a></div><div class="ttdeci">bool IsImmuneToSpell(SpellEntry const *spellInfo, bool castOnSelf, uint8 effectMask, WorldObject const *caster) override</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8cpp_source.html#l01960">Creature.cpp:1960</a></div></div>
<div class="ttc" id="aclassDungeonMap_html"><div class="ttname"><a href="classDungeonMap.html">DungeonMap</a></div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00576">Map.h:577</a></div></div>
<div class="ttc" id="aclassDynamicObject_html"><div class="ttname"><a href="classDynamicObject.html">DynamicObject</a></div><div class="ttdef"><b>Definition:</b> <a href="DynamicObject_8h_source.html#l00037">DynamicObject.h:38</a></div></div>
<div class="ttc" id="aclassEventProcessor_html_a0ecdf822624a632b7b3fad1e66228cfb"><div class="ttname"><a href="classEventProcessor.html#a0ecdf822624a632b7b3fad1e66228cfb">EventProcessor::AddEvent</a></div><div class="ttdeci">void AddEvent(BasicEvent *Event, uint64 e_time, bool set_addtime=true)</div><div class="ttdef"><b>Definition:</b> <a href="EventProcessor_8cpp_source.html#l00101">EventProcessor.cpp:101</a></div></div>
<div class="ttc" id="aclassEventProcessor_html_a1a92f983f1dd415146c2875f80cba433"><div class="ttname"><a href="classEventProcessor.html#a1a92f983f1dd415146c2875f80cba433">EventProcessor::CalculateTime</a></div><div class="ttdeci">uint64 CalculateTime(uint64 t_offset) const</div><div class="ttdef"><b>Definition:</b> <a href="EventProcessor_8cpp_source.html#l00124">EventProcessor.cpp:124</a></div></div>
<div class="ttc" id="aclassEventProcessor_html_a920fa690fba2ad9af993763052169f94"><div class="ttname"><a href="classEventProcessor.html#a920fa690fba2ad9af993763052169f94">EventProcessor::ModifyEventTime</a></div><div class="ttdeci">void ModifyEventTime(BasicEvent *event, uint64 msTime)</div><div class="ttdef"><b>Definition:</b> <a href="EventProcessor_8cpp_source.html#l00110">EventProcessor.cpp:110</a></div></div>
<div class="ttc" id="aclassGameObject_html"><div class="ttname"><a href="classGameObject.html">GameObject</a></div><div class="ttdef"><b>Definition:</b> <a href="GameObject_8h_source.html#l00740">GameObject.h:741</a></div></div>
<div class="ttc" id="aclassGameObject_html_a08fe8b2e3a798c80f5ca914be099b75d"><div class="ttname"><a href="classGameObject.html#a08fe8b2e3a798c80f5ca914be099b75d">GameObject::GetOwner</a></div><div class="ttdeci">Unit * GetOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="GameObject_8cpp_source.html#l01031">GameObject.cpp:1031</a></div></div>
<div class="ttc" id="aclassGameObject_html_aca53c235c050cbf14158a9071647b9c5"><div class="ttname"><a href="classGameObject.html#aca53c235c050cbf14158a9071647b9c5">GameObject::GetLootState</a></div><div class="ttdeci">LootState GetLootState() const</div><div class="ttdef"><b>Definition:</b> <a href="GameObject_8h_source.html#l00847">GameObject.h:847</a></div></div>
<div class="ttc" id="aclassGenericTransport_html"><div class="ttname"><a href="classGenericTransport.html">GenericTransport</a></div><div class="ttdef"><b>Definition:</b> <a href="Transports_8h_source.html#l00030">Transports.h:31</a></div></div>
<div class="ttc" id="aclassGroupReference_html"><div class="ttname"><a href="classGroupReference.html">GroupReference</a></div><div class="ttdef"><b>Definition:</b> <a href="GroupReference_8h_source.html#l00027">GroupReference.h:28</a></div></div>
<div class="ttc" id="aclassGroupReference_html_a05b946c0952db094a696093283308cb1"><div class="ttname"><a href="classGroupReference.html#a05b946c0952db094a696093283308cb1">GroupReference::next</a></div><div class="ttdeci">GroupReference * next()</div><div class="ttdef"><b>Definition:</b> <a href="GroupReference_8h_source.html#l00037">GroupReference.h:37</a></div></div>
<div class="ttc" id="aclassGroup_html"><div class="ttname"><a href="classGroup.html">Group</a></div><div class="ttdoc">request member stats checken</div><div class="ttdef"><b>Definition:</b> <a href="Group_8h_source.html#l00122">Group.h:123</a></div></div>
<div class="ttc" id="aclassGroup_html_a39cc0707e5c157b6ff4851e133b0a9dc"><div class="ttname"><a href="classGroup.html#a39cc0707e5c157b6ff4851e133b0a9dc">Group::GetFirstMember</a></div><div class="ttdeci">GroupReference * GetFirstMember()</div><div class="ttdef"><b>Definition:</b> <a href="Group_8h_source.html#l00200">Group.h:200</a></div></div>
<div class="ttc" id="aclassGroup_html_ab58ef93f327bc8a3e328ee48231aa331"><div class="ttname"><a href="classGroup.html#ab58ef93f327bc8a3e328ee48231aa331">Group::IsMember</a></div><div class="ttdeci">bool IsMember(ObjectGuid guid) const</div><div class="ttdef"><b>Definition:</b> <a href="Group_8h_source.html#l00171">Group.h:171</a></div></div>
<div class="ttc" id="aclassHostileRefManager_html_a073f0560d2543944b684dc8fb581abd2"><div class="ttname"><a href="classHostileRefManager.html#a073f0560d2543944b684dc8fb581abd2">HostileRefManager::threatAssist</a></div><div class="ttdeci">void threatAssist(Unit *victim, float threat, SpellEntry const *threatSpell=nullptr, bool singleTarget=false, bool ignoreTimer=false)</div><div class="ttdef"><b>Definition:</b> <a href="HostileRefManager_8cpp_source.html#l00041">HostileRefManager.cpp:41</a></div></div>
<div class="ttc" id="aclassItem_html"><div class="ttname"><a href="classItem.html">Item</a></div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00271">Item.h:272</a></div></div>
<div class="ttc" id="aclassItem_html_a01443ad39de8bab4cd61c71e4a7f35bd"><div class="ttname"><a href="classItem.html#a01443ad39de8bab4cd61c71e4a7f35bd">Item::SetUsedInSpell</a></div><div class="ttdeci">void SetUsedInSpell(bool state)</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00388">Item.h:388</a></div></div>
<div class="ttc" id="aclassItem_html_a02ee6e52edbee35375b164767b94b0c9"><div class="ttname"><a href="classItem.html#a02ee6e52edbee35375b164767b94b0c9">Item::SetState</a></div><div class="ttdeci">void SetState(ItemUpdateState state, Player *forplayer=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Item_8cpp_source.html#l00750">Item.cpp:750</a></div></div>
<div class="ttc" id="aclassItem_html_a04019a011a5f4df849f39b413df68295"><div class="ttname"><a href="classItem.html#a04019a011a5f4df849f39b413df68295">Item::GetSlot</a></div><div class="ttdeci">uint8 GetSlot() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00319">Item.h:319</a></div></div>
<div class="ttc" id="aclassItem_html_a0e05db2244d937cb00e786abc2484229"><div class="ttname"><a href="classItem.html#a0e05db2244d937cb00e786abc2484229">Item::GetOwnerGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetOwnerGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00283">Item.h:283</a></div></div>
<div class="ttc" id="aclassItem_html_a1835a0d8efcb30778b0fc7c3a4531aba"><div class="ttname"><a href="classItem.html#a1835a0d8efcb30778b0fc7c3a4531aba">Item::SetSpellCharges</a></div><div class="ttdeci">void SetSpellCharges(uint8 index, int32 value)</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00356">Item.h:356</a></div></div>
<div class="ttc" id="aclassItem_html_a345485448a4b18c8ef2e8805f16ce458"><div class="ttname"><a href="classItem.html#a345485448a4b18c8ef2e8805f16ce458">Item::GetSpellCharges</a></div><div class="ttdeci">int32 GetSpellCharges(uint8 index=0) const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00355">Item.h:355</a></div></div>
<div class="ttc" id="aclassItem_html_a4b75fbb438b16f2594f5de570047ae05"><div class="ttname"><a href="classItem.html#a4b75fbb438b16f2594f5de570047ae05">Item::HasTemporaryLoot</a></div><div class="ttdeci">bool HasTemporaryLoot() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00362">Item.h:362</a></div></div>
<div class="ttc" id="aclassItem_html_a624d681e272089b22f37cfe66b114dc1"><div class="ttname"><a href="classItem.html#a624d681e272089b22f37cfe66b114dc1">Item::IsPotion</a></div><div class="ttdeci">bool IsPotion() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00380">Item.h:380</a></div></div>
<div class="ttc" id="aclassItem_html_a832970d43976538c4092cf5d09706546"><div class="ttname"><a href="classItem.html#a832970d43976538c4092cf5d09706546">Item::GetOwner</a></div><div class="ttdeci">Player * GetOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8cpp_source.html#l00582">Item.cpp:582</a></div></div>
<div class="ttc" id="aclassItem_html_a9f88246dc5897db068da95ed1f473eec"><div class="ttname"><a href="classItem.html#a9f88246dc5897db068da95ed1f473eec">Item::IsInTrade</a></div><div class="ttdeci">bool IsInTrade() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00305">Item.h:305</a></div></div>
<div class="ttc" id="aclassItem_html_ab83f9f8737df779b6ae7aae91cbc1f2c"><div class="ttname"><a href="classItem.html#ab83f9f8737df779b6ae7aae91cbc1f2c">Item::IsFitToSpellRequirements</a></div><div class="ttdeci">bool IsFitToSpellRequirements(SpellEntry const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8cpp_source.html#l00910">Item.cpp:910</a></div></div>
<div class="ttc" id="aclassItem_html_acfce1d883f464dc73696f17c62d5ba5c"><div class="ttname"><a href="classItem.html#acfce1d883f464dc73696f17c62d5ba5c">Item::GetCount</a></div><div class="ttdeci">uint32 GetCount() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00312">Item.h:312</a></div></div>
<div class="ttc" id="aclassItem_html_adb534f04ac50d00b4b5c8e8fa74d668a"><div class="ttname"><a href="classItem.html#adb534f04ac50d00b4b5c8e8fa74d668a">Item::GetProto</a></div><div class="ttdeci">ItemPrototype const  * GetProto() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8cpp_source.html#l00577">Item.cpp:577</a></div></div>
<div class="ttc" id="aclassItem_html_ae6722dd0d72d33bc1840151549993f16"><div class="ttname"><a href="classItem.html#ae6722dd0d72d33bc1840151549993f16">Item::GetMaxStackCount</a></div><div class="ttdeci">uint32 GetMaxStackCount() const</div><div class="ttdef"><b>Definition:</b> <a href="Item_8h_source.html#l00314">Item.h:314</a></div></div>
<div class="ttc" id="aclassLootStore_html_abd45358d22bbb44f54743792a7fd0039"><div class="ttname"><a href="classLootStore.html#abd45358d22bbb44f54743792a7fd0039">LootStore::HaveLootFor</a></div><div class="ttdeci">bool HaveLootFor(uint32 loot_id) const</div><div class="ttdef"><b>Definition:</b> <a href="LootMgr_8h_source.html#l00238">LootMgr.h:238</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AllCreatureEntriesWithLiveStateInObjectRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1AllCreatureEntriesWithLiveStateInObjectRangeCheck.html">MaNGOS::AllCreatureEntriesWithLiveStateInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l01451">GridNotifiers.h:1452</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AllCreatureEntriesWithLiveStateInObjectRangeCheck_html_a8c990ac643b2051328700e32d8660cf8"><div class="ttname"><a href="classMaNGOS_1_1AllCreatureEntriesWithLiveStateInObjectRangeCheck.html#a8c990ac643b2051328700e32d8660cf8">MaNGOS::AllCreatureEntriesWithLiveStateInObjectRangeCheck::FoundOutOfRange</a></div><div class="ttdeci">bool FoundOutOfRange() const</div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l01467">GridNotifiers.h:1467</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AllCreaturesOfEntryInRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1AllCreaturesOfEntryInRangeCheck.html">MaNGOS::AllCreaturesOfEntryInRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l01482">GridNotifiers.h:1483</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AllGameObjectEntriesListInObjectRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1AllGameObjectEntriesListInObjectRangeCheck.html">MaNGOS::AllGameObjectEntriesListInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00770">GridNotifiers.h:771</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AllGameObjectEntriesListInPosRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1AllGameObjectEntriesListInPosRangeCheck.html">MaNGOS::AllGameObjectEntriesListInPosRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00823">GridNotifiers.h:824</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AnyFriendlyOrGroupMemberUnitInUnitRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1AnyFriendlyOrGroupMemberUnitInUnitRangeCheck.html">MaNGOS::AnyFriendlyOrGroupMemberUnitInUnitRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l01178">GridNotifiers.h:1179</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1AnyPlayerInObjectRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1AnyPlayerInObjectRangeCheck.html">MaNGOS::AnyPlayerInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l01525">GridNotifiers.h:1526</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1GameObjectFocusCheck_html"><div class="ttname"><a href="classMaNGOS_1_1GameObjectFocusCheck.html">MaNGOS::GameObjectFocusCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00694">GridNotifiers.h:695</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1GameObjectTypeInPosRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1GameObjectTypeInPosRangeCheck.html">MaNGOS::GameObjectTypeInPosRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00908">GridNotifiers.h:909</a></div></div>
<div class="ttc" id="aclassMaNGOS_1_1NearestCreatureEntryWithLiveStateInObjectRangeCheck_html"><div class="ttname"><a href="classMaNGOS_1_1NearestCreatureEntryWithLiveStateInObjectRangeCheck.html">MaNGOS::NearestCreatureEntryWithLiveStateInObjectRangeCheck</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l01414">GridNotifiers.h:1415</a></div></div>
<div class="ttc" id="aclassMap_html"><div class="ttname"><a href="classMap.html">Map</a></div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00117">Map.h:118</a></div></div>
<div class="ttc" id="aclassMap_html_a0c80d50b012dc8d560e256201970f3b3"><div class="ttname"><a href="classMap.html#a0c80d50b012dc8d560e256201970f3b3">Map::IsDungeon</a></div><div class="ttdeci">bool IsDungeon() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00227">Map.h:227</a></div></div>
<div class="ttc" id="aclassMap_html_a0ec55b30f6494c6fe1e19b51c2e17ebb"><div class="ttname"><a href="classMap.html#a0ec55b30f6494c6fe1e19b51c2e17ebb">Map::GetGameObject</a></div><div class="ttdeci">GameObject * GetGameObject(ObjectGuid guid)</div><div class="ttdoc">Function return gameobject that in world at CURRENT map.</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02270">Map.cpp:2270</a></div></div>
<div class="ttc" id="aclassMap_html_a21da1922573a3ebf32e7bac056c7ee65"><div class="ttname"><a href="classMap.html#a21da1922573a3ebf32e7bac056c7ee65">Map::GetTransport</a></div><div class="ttdeci">GenericTransport * GetTransport(ObjectGuid guid)</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l00106">Map.cpp:106</a></div></div>
<div class="ttc" id="aclassMap_html_a3fb76b11cc6e62eb9745a585eb497a5f"><div class="ttname"><a href="classMap.html#a3fb76b11cc6e62eb9745a585eb497a5f">Map::GetDynamicObject</a></div><div class="ttdeci">DynamicObject * GetDynamicObject(ObjectGuid guid)</div><div class="ttdoc">Function return dynamic object that in world at CURRENT map.</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02280">Map.cpp:2280</a></div></div>
<div class="ttc" id="aclassMap_html_a42612925011d01e872fad7e915a8ba2a"><div class="ttname"><a href="classMap.html#a42612925011d01e872fad7e915a8ba2a">Map::GetCorpse</a></div><div class="ttdeci">Corpse * GetCorpse(ObjectGuid guid) const</div><div class="ttdoc">Function return corpse that at CURRENT map.</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02241">Map.cpp:2241</a></div></div>
<div class="ttc" id="aclassMap_html_a5044d60cdc782574e3f2c3ae5181f14d"><div class="ttname"><a href="classMap.html#a5044d60cdc782574e3f2c3ae5181f14d">Map::GetTerrain</a></div><div class="ttdeci">const TerrainInfo * GetTerrain() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00328">Map.h:328</a></div></div>
<div class="ttc" id="aclassMap_html_a512201251b4b320f7f1171a04031e201"><div class="ttname"><a href="classMap.html#a512201251b4b320f7f1171a04031e201">Map::GetGameObjects</a></div><div class="ttdeci">std::vector&lt; GameObject * &gt; const  * GetGameObjects(std::string stringId) const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02388">Map.cpp:2388</a></div></div>
<div class="ttc" id="aclassMap_html_a556d2eafa563b4a5de4957de28e369b3"><div class="ttname"><a href="classMap.html#a556d2eafa563b4a5de4957de28e369b3">Map::IsRaid</a></div><div class="ttdeci">bool IsRaid() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00228">Map.h:228</a></div></div>
<div class="ttc" id="aclassMap_html_a5d623b174d4deaae0093e80de4cc1423"><div class="ttname"><a href="classMap.html#a5d623b174d4deaae0093e80de4cc1423">Map::GetHitPosition</a></div><div class="ttdeci">bool GetHitPosition(float srcX, float srcY, float srcZ, float &amp;destX, float &amp;destY, float &amp;destZ, uint32 phasemask, float modifyDist) const</div><div class="ttdoc">get the hit position and return true if we hit something (in this case the dest position will hold th...</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02583">Map.cpp:2583</a></div></div>
<div class="ttc" id="aclassMap_html_a753346ed8fd6a52a17aa1bccb0652990"><div class="ttname"><a href="classMap.html#a753346ed8fd6a52a17aa1bccb0652990">Map::GetCurrentMSTime</a></div><div class="ttdeci">uint32 GetCurrentMSTime() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l00081">Map.cpp:81</a></div></div>
<div class="ttc" id="aclassMap_html_a7c6017ca4c2a442952e50597d6ce0be5"><div class="ttname"><a href="classMap.html#a7c6017ca4c2a442952e50597d6ce0be5">Map::GetPet</a></div><div class="ttdeci">Pet * GetPet(ObjectGuid guid)</div><div class="ttdoc">Function return pet that in world at CURRENT map.</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02229">Map.cpp:2229</a></div></div>
<div class="ttc" id="aclassMap_html_a7f47c1b7efbaada5de480afb5d9c48a1"><div class="ttname"><a href="classMap.html#a7f47c1b7efbaada5de480afb5d9c48a1">Map::GetWorldObject</a></div><div class="ttdeci">WorldObject * GetWorldObject(ObjectGuid guid)</div><div class="ttdoc">Function return world object in world at CURRENT map, so any except transports.</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02304">Map.cpp:2304</a></div></div>
<div class="ttc" id="aclassMap_html_a9bd1fe5bb4a9f00fd1d4ed5d729dbf8d"><div class="ttname"><a href="classMap.html#a9bd1fe5bb4a9f00fd1d4ed5d729dbf8d">Map::GetCreatures</a></div><div class="ttdeci">std::vector&lt; Creature * &gt; const  * GetCreatures(std::string stringId) const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02383">Map.cpp:2383</a></div></div>
<div class="ttc" id="aclassMap_html_aa2cb60c143addea3312e37ad92ebdbbb"><div class="ttname"><a href="classMap.html#aa2cb60c143addea3312e37ad92ebdbbb">Map::SpawnedCountForEntry</a></div><div class="ttdeci">uint32 SpawnedCountForEntry(uint32 entry)</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02893">Map.cpp:2893</a></div></div>
<div class="ttc" id="aclassMap_html_ab43d810423c37ee09da95346fae09f32"><div class="ttname"><a href="classMap.html#ab43d810423c37ee09da95346fae09f32">Map::GetUnit</a></div><div class="ttdeci">Unit * GetUnit(ObjectGuid guid)</div><div class="ttdoc">Function return unit in world at CURRENT map.</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02293">Map.cpp:2293</a></div></div>
<div class="ttc" id="aclassMap_html_ac0203ff0d2b298c2e4fe6513756e1022"><div class="ttname"><a href="classMap.html#ac0203ff0d2b298c2e4fe6513756e1022">Map::GetHeightInRange</a></div><div class="ttdeci">bool GetHeightInRange(uint32 phasemask, float x, float y, float &amp;z, float maxSearchDist=4.0f) const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02608">Map.cpp:2608</a></div></div>
<div class="ttc" id="aclassMap_html_ace981bca7a407e53d8f3506b5eecb2da"><div class="ttname"><a href="classMap.html#ace981bca7a407e53d8f3506b5eecb2da">Map::GetDifficulty</a></div><div class="ttdeci">Difficulty GetDifficulty() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00216">Map.h:216</a></div></div>
<div class="ttc" id="aclassMap_html_ad4a998ad26db4bc8b571189e6d3f5d32"><div class="ttname"><a href="classMap.html#ad4a998ad26db4bc8b571189e6d3f5d32">Map::IsMountAllowed</a></div><div class="ttdeci">bool IsMountAllowed() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02860">Map.cpp:2860</a></div></div>
<div class="ttc" id="aclassMap_html_ae312641f498f3df725b4156156b7f012"><div class="ttname"><a href="classMap.html#ae312641f498f3df725b4156156b7f012">Map::GetCreature</a></div><div class="ttdeci">Creature * GetCreature(ObjectGuid guid)</div><div class="ttdoc">Function return creature (non-pet and then most summoned by spell creatures) that in world at CURRENT...</div><div class="ttdef"><b>Definition:</b> <a href="Map_8cpp_source.html#l02219">Map.cpp:2219</a></div></div>
<div class="ttc" id="aclassMap_html_afd94bb4369509da2eaa0d461df6e43c2"><div class="ttname"><a href="classMap.html#afd94bb4369509da2eaa0d461df6e43c2">Map::GetVisibilityDistance</a></div><div class="ttdeci">float GetVisibilityDistance() const</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00163">Map.h:163</a></div></div>
<div class="ttc" id="aclassMovementInfo_html_af0b95ddc9ba7d602a37c310fea0bda18"><div class="ttname"><a href="classMovementInfo.html#af0b95ddc9ba7d602a37c310fea0bda18">MovementInfo::HasMovementFlag</a></div><div class="ttdeci">bool HasMovementFlag(MovementFlags f) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00845">Object.h:845</a></div></div>
<div class="ttc" id="aclassObjectAccessor_html_a0d4a6323d8cf6690976731f16a588fe8"><div class="ttname"><a href="classObjectAccessor.html#a0d4a6323d8cf6690976731f16a588fe8">ObjectAccessor::GetCorpseInMap</a></div><div class="ttdeci">static Corpse * GetCorpseInMap(ObjectGuid guid, uint32 mapid)</div><div class="ttdef"><b>Definition:</b> <a href="ObjectAccessor_8cpp_source.html#l00091">ObjectAccessor.cpp:91</a></div></div>
<div class="ttc" id="aclassObjectAccessor_html_a1d732416b400b09f3f723ccbd0f3a287"><div class="ttname"><a href="classObjectAccessor.html#a1d732416b400b09f3f723ccbd0f3a287">ObjectAccessor::GetUnit</a></div><div class="ttdeci">static Unit * GetUnit(WorldObject const &amp;u, ObjectGuid guid)</div><div class="ttdef"><b>Definition:</b> <a href="ObjectAccessor_8cpp_source.html#l00077">ObjectAccessor.cpp:77</a></div></div>
<div class="ttc" id="aclassObjectAccessor_html_a959bcb90b71aacbb8560642c86c3ab63"><div class="ttname"><a href="classObjectAccessor.html#a959bcb90b71aacbb8560642c86c3ab63">ObjectAccessor::FindPlayer</a></div><div class="ttdeci">static Player * FindPlayer(ObjectGuid guid, bool inWorld=true)</div><div class="ttdef"><b>Definition:</b> <a href="ObjectAccessor_8cpp_source.html#l00102">ObjectAccessor.cpp:102</a></div></div>
<div class="ttc" id="aclassObjectGuid_html"><div class="ttname"><a href="classObjectGuid.html">ObjectGuid</a></div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00087">ObjectGuid.h:88</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a07e7802fc81a89510d4286ecf52ddb08"><div class="ttname"><a href="classObjectGuid.html#a07e7802fc81a89510d4286ecf52ddb08">ObjectGuid::WriteAsPacked</a></div><div class="ttdeci">PackedGuid WriteAsPacked() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00259">ObjectGuid.h:259</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a0eb47d3c61516f4242e8599b55ae755e"><div class="ttname"><a href="classObjectGuid.html#a0eb47d3c61516f4242e8599b55ae755e">ObjectGuid::GetString</a></div><div class="ttdeci">std::string GetString() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8cpp_source.html#l00047">ObjectGuid.cpp:47</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a65626f4640cb4f79c66ce9d5dda8ab27"><div class="ttname"><a href="classObjectGuid.html#a65626f4640cb4f79c66ce9d5dda8ab27">ObjectGuid::GetRawValue</a></div><div class="ttdeci">uint64 GetRawValue() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00109">ObjectGuid.h:109</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a6a398c7516c608d7b64c85b9dc08114e"><div class="ttname"><a href="classObjectGuid.html#a6a398c7516c608d7b64c85b9dc08114e">ObjectGuid::IsUnit</a></div><div class="ttdeci">bool IsUnit() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00136">ObjectGuid.h:136</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a919e658ac950dcb1ce6195a72f824705"><div class="ttname"><a href="classObjectGuid.html#a919e658ac950dcb1ce6195a72f824705">ObjectGuid::IsDynamicObject</a></div><div class="ttdeci">bool IsDynamicObject() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00139">ObjectGuid.h:139</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_a97277f64de28fdef0e9f821fcd8a20a9"><div class="ttname"><a href="classObjectGuid.html#a97277f64de28fdef0e9f821fcd8a20a9">ObjectGuid::IsGameObject</a></div><div class="ttdeci">bool IsGameObject() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00138">ObjectGuid.h:138</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_ade14ec1d80126d20f64db8f9adaf0ef8"><div class="ttname"><a href="classObjectGuid.html#ade14ec1d80126d20f64db8f9adaf0ef8">ObjectGuid::IsCreatureOrVehicle</a></div><div class="ttdeci">bool IsCreatureOrVehicle() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00133">ObjectGuid.h:133</a></div></div>
<div class="ttc" id="aclassObjectGuid_html_af2b5cd8ff82b26233adb50a1d8b6cbd9"><div class="ttname"><a href="classObjectGuid.html#af2b5cd8ff82b26233adb50a1d8b6cbd9">ObjectGuid::ReadAsPacked</a></div><div class="ttdeci">PackedGuidReader ReadAsPacked()</div><div class="ttdef"><b>Definition:</b> <a href="ObjectGuid_8h_source.html#l00102">ObjectGuid.h:102</a></div></div>
<div class="ttc" id="aclassObjectMgr_html_a04b135181eba4a7d564400855d9aeebf"><div class="ttname"><a href="classObjectMgr.html#a04b135181eba4a7d564400855d9aeebf">ObjectMgr::GetInstanceTemplate</a></div><div class="ttdeci">static InstanceTemplate const  * GetInstanceTemplate(uint32 map)</div><div class="ttdoc">Wrapper for sInstanceTemplate.LookupEntry.</div><div class="ttdef"><b>Definition:</b> <a href="ObjectMgr_8cpp_source.html#l04545">ObjectMgr.cpp:4545</a></div></div>
<div class="ttc" id="aclassObjectMgr_html_a85a1155c667c781dff3258c751fcde60"><div class="ttname"><a href="classObjectMgr.html#a85a1155c667c781dff3258c751fcde60">ObjectMgr::GetItemPrototype</a></div><div class="ttdeci">static ItemPrototype const  * GetItemPrototype(uint32 id)</div><div class="ttdoc">Wrapper for sItemStorage.LookupEntry.</div><div class="ttdef"><b>Definition:</b> <a href="ObjectMgr_8cpp_source.html#l04544">ObjectMgr.cpp:4544</a></div></div>
<div class="ttc" id="aclassObject_html_a1b9ed00e8d7ac5fed698ef6431905296"><div class="ttname"><a href="classObject.html#a1b9ed00e8d7ac5fed698ef6431905296">Object::IsPlayer</a></div><div class="ttdeci">bool IsPlayer() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00637">Object.h:637</a></div></div>
<div class="ttc" id="aclassObject_html_a4777844356842a389621c1bad1433109"><div class="ttname"><a href="classObject.html#a4777844356842a389621c1bad1433109">Object::GetGUIDLow</a></div><div class="ttdeci">uint32 GetGUIDLow() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00410">Object.h:410</a></div></div>
<div class="ttc" id="aclassObject_html_a5c2f31b9fb0a083ff4caca3de93fac90"><div class="ttname"><a href="classObject.html#a5c2f31b9fb0a083ff4caca3de93fac90">Object::GetGuidStr</a></div><div class="ttdeci">std::string GetGuidStr() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00414">Object.h:414</a></div></div>
<div class="ttc" id="aclassObject_html_a5f4cb5fb092b0178b1bd59a850d79de5"><div class="ttname"><a href="classObject.html#a5f4cb5fb092b0178b1bd59a850d79de5">Object::IsUnit</a></div><div class="ttdeci">bool IsUnit() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00639">Object.h:639</a></div></div>
<div class="ttc" id="aclassObject_html_a65ccb03ef30ffbb9456d7a0a9ad1fa29"><div class="ttname"><a href="classObject.html#a65ccb03ef30ffbb9456d7a0a9ad1fa29">Object::GetDbGuid</a></div><div class="ttdeci">uint32 GetDbGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00413">Object.h:413</a></div></div>
<div class="ttc" id="aclassObject_html_a7e985367f6a9997544bbc18253f3563d"><div class="ttname"><a href="classObject.html#a7e985367f6a9997544bbc18253f3563d">Object::GetTypeId</a></div><div class="ttdeci">uint8 GetTypeId() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00426">Object.h:426</a></div></div>
<div class="ttc" id="aclassObject_html_a85475682d62e51bfaf2133b51d41a619"><div class="ttname"><a href="classObject.html#a85475682d62e51bfaf2133b51d41a619">Object::IsGameObject</a></div><div class="ttdeci">bool IsGameObject() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00640">Object.h:640</a></div></div>
<div class="ttc" id="aclassObject_html_a8acb91caf94322dc0289d3e60eb8e0e7"><div class="ttname"><a href="classObject.html#a8acb91caf94322dc0289d3e60eb8e0e7">Object::IsInWorld</a></div><div class="ttdeci">const bool &amp; IsInWorld() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00391">Object.h:391</a></div></div>
<div class="ttc" id="aclassObject_html_aa627fe2967ed0e0ed1d8aeeb4365a961"><div class="ttname"><a href="classObject.html#aa627fe2967ed0e0ed1d8aeeb4365a961">Object::GetEntry</a></div><div class="ttdeci">uint32 GetEntry() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00416">Object.h:416</a></div></div>
<div class="ttc" id="aclassObject_html_aacc8ee332f66effdc0d77c126dae1961"><div class="ttname"><a href="classObject.html#aacc8ee332f66effdc0d77c126dae1961">Object::IsCreature</a></div><div class="ttdeci">bool IsCreature() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00638">Object.h:638</a></div></div>
<div class="ttc" id="aclassObject_html_acbbf66178b2c9ec6d5d44d80b43abfb6"><div class="ttname"><a href="classObject.html#acbbf66178b2c9ec6d5d44d80b43abfb6">Object::GetInt32Value</a></div><div class="ttdeci">const int32 &amp; GetInt32Value(uint16 index) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00449">Object.h:449</a></div></div>
<div class="ttc" id="aclassObject_html_acf64820d3725a37cef2c63f0baa820e7"><div class="ttname"><a href="classObject.html#acf64820d3725a37cef2c63f0baa820e7">Object::HasFlag</a></div><div class="ttdeci">bool HasFlag(uint16 index, uint32 flag) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00524">Object.h:524</a></div></div>
<div class="ttc" id="aclassObject_html_ad4b3f372b6700cd50e1eb7ef238cf3be"><div class="ttname"><a href="classObject.html#ad4b3f372b6700cd50e1eb7ef238cf3be">Object::GetPackGUID</a></div><div class="ttdeci">PackedGuid const  &amp; GetPackGUID() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00412">Object.h:412</a></div></div>
<div class="ttc" id="aclassObject_html_ad86e87ac77905e1436571475e6c426a1"><div class="ttname"><a href="classObject.html#ad86e87ac77905e1436571475e6c426a1">Object::m_loot</a></div><div class="ttdeci">Loot * m_loot</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00635">Object.h:635</a></div></div>
<div class="ttc" id="aclassObject_html_adc7e9b205f35f9894ec9a4f0ec0871f9"><div class="ttname"><a href="classObject.html#adc7e9b205f35f9894ec9a4f0ec0871f9">Object::SetUInt32Value</a></div><div class="ttdeci">void SetUInt32Value(uint16 index, uint32 value)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01011">Object.cpp:1011</a></div></div>
<div class="ttc" id="aclassObject_html_ae70d868c6ec2c0d3849a48c6e75da5aa"><div class="ttname"><a href="classObject.html#ae70d868c6ec2c0d3849a48c6e75da5aa">Object::GetFloatValue</a></div><div class="ttdeci">const float &amp; GetFloatValue(uint16 index) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00467">Object.h:467</a></div></div>
<div class="ttc" id="aclassObject_html_ae7e0c11556aeda48ab347a56b6b7bd6a"><div class="ttname"><a href="classObject.html#ae7e0c11556aeda48ab347a56b6b7bd6a">Object::GetObjectGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetObjectGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00409">Object.h:409</a></div></div>
<div class="ttc" id="aclassObject_html_aebc9e7589e372ab99544e474c07609f0"><div class="ttname"><a href="classObject.html#aebc9e7589e372ab99544e474c07609f0">Object::GetUInt32Value</a></div><div class="ttdeci">const uint32 &amp; GetUInt32Value(uint16 index) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00455">Object.h:455</a></div></div>
<div class="ttc" id="aclassPathFinder_html"><div class="ttname"><a href="classPathFinder.html">PathFinder</a></div><div class="ttdef"><b>Definition:</b> <a href="PathFinder_8h_source.html#l00067">PathFinder.h:68</a></div></div>
<div class="ttc" id="aclassPathFinder_html_a16f97a42236045337ddc92d3b6d7f556"><div class="ttname"><a href="classPathFinder.html#a16f97a42236045337ddc92d3b6d7f556">PathFinder::getPathType</a></div><div class="ttdeci">PathType getPathType() const</div><div class="ttdef"><b>Definition:</b> <a href="PathFinder_8h_source.html#l00091">PathFinder.h:91</a></div></div>
<div class="ttc" id="aclassPathFinder_html_a493fa952a7a3a66f8c7598fe47a1c8e4"><div class="ttname"><a href="classPathFinder.html#a493fa952a7a3a66f8c7598fe47a1c8e4">PathFinder::setPathLengthLimit</a></div><div class="ttdeci">void setPathLengthLimit(float distance)</div><div class="ttdef"><b>Definition:</b> <a href="PathFinder_8h_source.html#l00083">PathFinder.h:83</a></div></div>
<div class="ttc" id="aclassPathFinder_html_a82f17d19c5123e2b113026961580c7d2"><div class="ttname"><a href="classPathFinder.html#a82f17d19c5123e2b113026961580c7d2">PathFinder::calculate</a></div><div class="ttdeci">bool calculate(float destX, float destY, float destZ, bool forceDest=false, bool straightLine=false)</div><div class="ttdef"><b>Definition:</b> <a href="PathFinder_8cpp_source.html#l00078">PathFinder.cpp:78</a></div></div>
<div class="ttc" id="aclassPet_html"><div class="ttname"><a href="classPet.html">Pet</a></div><div class="ttdef"><b>Definition:</b> <a href="Pet_8h_source.html#l00139">Pet.h:140</a></div></div>
<div class="ttc" id="aclassPet_html_a14dac45e5b46ed30df4713f98a69bece"><div class="ttname"><a href="classPet.html#a14dac45e5b46ed30df4713f98a69bece">Pet::HaveInDiet</a></div><div class="ttdeci">bool HaveInDiet(ItemPrototype const *item) const</div><div class="ttdef"><b>Definition:</b> <a href="Pet_8cpp_source.html#l01289">Pet.cpp:1289</a></div></div>
<div class="ttc" id="aclassPet_html_ad5eaac78f6eace6db0d40d2f388c90f5"><div class="ttname"><a href="classPet.html#ad5eaac78f6eace6db0d40d2f388c90f5">Pet::GetCurrentFoodBenefitLevel</a></div><div class="ttdeci">uint32 GetCurrentFoodBenefitLevel(uint32 itemlevel) const</div><div class="ttdef"><b>Definition:</b> <a href="Pet_8cpp_source.html#l01307">Pet.cpp:1307</a></div></div>
<div class="ttc" id="aclassPet_html_aff5ffb9a757e225ce15e00e718a335d9"><div class="ttname"><a href="classPet.html#aff5ffb9a757e225ce15e00e718a335d9">Pet::TryLoadFromDB</a></div><div class="ttdeci">static SpellCastResult TryLoadFromDB(Unit *owner, uint32 petentry=0, uint32 petnumber=0, bool current=false, PetType mandatoryPetType=MAX_PET_TYPE)</div><div class="ttdef"><b>Definition:</b> <a href="Pet_8cpp_source.html#l00074">Pet.cpp:74</a></div></div>
<div class="ttc" id="aclassPlayer_html"><div class="ttname"><a href="classPlayer.html">Player</a></div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01063">Player.h:1064</a></div></div>
<div class="ttc" id="aclassPlayer_html_a026e2788ccea4b7fd6b69be8cc0a0f4a"><div class="ttname"><a href="classPlayer.html#a026e2788ccea4b7fd6b69be8cc0a0f4a">Player::IsInGroup</a></div><div class="ttdeci">bool IsInGroup(Unit const *other, bool party=false, bool ignoreCharms=false) const override</div><div class="ttdoc">[Serverside] Group: Extension for players, ignoring charms also ignores PC flag presence for UI PoV</div><div class="ttdef"><b>Definition:</b> <a href="Relations_8cpp_source.html#l01039">Relations.cpp:1039</a></div></div>
<div class="ttc" id="aclassPlayer_html_a032cedc4c5b8ec826bfbd36c309da5a4"><div class="ttname"><a href="classPlayer.html#a032cedc4c5b8ec826bfbd36c309da5a4">Player::UpdatePvP</a></div><div class="ttdeci">void UpdatePvP(bool state, bool overriding=false)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l20672">Player.cpp:20672</a></div></div>
<div class="ttc" id="aclassPlayer_html_a05e3496384aaffb6cd16f560bd36d29c"><div class="ttname"><a href="classPlayer.html#a05e3496384aaffb6cd16f560bd36d29c">Player::RegenerateAll</a></div><div class="ttdeci">void RegenerateAll(uint32 diff=REGEN_TIME_FULL)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l02415">Player.cpp:2415</a></div></div>
<div class="ttc" id="aclassPlayer_html_a0bb44a15011105880e352426c8756c97"><div class="ttname"><a href="classPlayer.html#a0bb44a15011105880e352426c8756c97">Player::RemoveSpellMods</a></div><div class="ttdeci">void RemoveSpellMods(std::set&lt; SpellModifierPair &gt; &amp;usedAuraCharges)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l19680">Player.cpp:19680</a></div></div>
<div class="ttc" id="aclassPlayer_html_a1c212b8f9ae8b1a38a41f9c7db005dca"><div class="ttname"><a href="classPlayer.html#a1c212b8f9ae8b1a38a41f9c7db005dca">Player::GetSession</a></div><div class="ttdeci">WorldSession * GetSession() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01932">Player.h:1932</a></div></div>
<div class="ttc" id="aclassPlayer_html_a215e25644bd2d843ab3782f5a8beca9f"><div class="ttname"><a href="classPlayer.html#a215e25644bd2d843ab3782f5a8beca9f">Player::ResetSpellModsDueToCanceledSpell</a></div><div class="ttdeci">void ResetSpellModsDueToCanceledSpell(std::set&lt; SpellModifierPair &gt; &amp;usedAuraCharges)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l19700">Player.cpp:19700</a></div></div>
<div class="ttc" id="aclassPlayer_html_a2a17a4e404276def5918ada66ed0f1f4"><div class="ttname"><a href="classPlayer.html#a2a17a4e404276def5918ada66ed0f1f4">Player::GetItemByEntry</a></div><div class="ttdeci">Item * GetItemByEntry(uint32 item) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l09405">Player.cpp:9405</a></div></div>
<div class="ttc" id="aclassPlayer_html_a2d88517ac7f496c6a7f05eeaafe3a0a5"><div class="ttname"><a href="classPlayer.html#a2d88517ac7f496c6a7f05eeaafe3a0a5">Player::DestroyItemCount</a></div><div class="ttdeci">void DestroyItemCount(uint32 item, uint32 count, bool update, bool unequip_check=false, bool inBankAlso=false)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l11891">Player.cpp:11891</a></div></div>
<div class="ttc" id="aclassPlayer_html_a31676c416fec6c27ec5f3449b1a1de46"><div class="ttname"><a href="classPlayer.html#a31676c416fec6c27ec5f3449b1a1de46">Player::SetRuneCooldown</a></div><div class="ttdeci">void SetRuneCooldown(uint8 index, uint16 cooldown)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02476">Player.h:2476</a></div></div>
<div class="ttc" id="aclassPlayer_html_a37acea1f67951ec8b125cae412ddbe4e"><div class="ttname"><a href="classPlayer.html#a37acea1f67951ec8b125cae412ddbe4e">Player::CanTameExoticPets</a></div><div class="ttdeci">bool CanTameExoticPets() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02106">Player.h:2106</a></div></div>
<div class="ttc" id="aclassPlayer_html_a3acf7eadb0ec1ae686858ea11ee87302"><div class="ttname"><a href="classPlayer.html#a3acf7eadb0ec1ae686858ea11ee87302">Player::GetGroup</a></div><div class="ttdeci">Group * GetGroup()</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02444">Player.h:2444</a></div></div>
<div class="ttc" id="aclassPlayer_html_a476849b867b48d2e7d8fbbb2178a7ed7"><div class="ttname"><a href="classPlayer.html#a476849b867b48d2e7d8fbbb2178a7ed7">Player::DurabilityPointLossForEquipSlot</a></div><div class="ttdeci">void DurabilityPointLossForEquipSlot(EquipmentSlots slot)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l05111">Player.cpp:5111</a></div></div>
<div class="ttc" id="aclassPlayer_html_a48da370a4f54c57756a87ab7ccffdf36"><div class="ttname"><a href="classPlayer.html#a48da370a4f54c57756a87ab7ccffdf36">Player::GetRuneBaseCooldown</a></div><div class="ttdeci">uint32 GetRuneBaseCooldown(uint8 index)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l23039">Player.cpp:23039</a></div></div>
<div class="ttc" id="aclassPlayer_html_a535278fda7e3c98dcc5f1f28d1c0c6fe"><div class="ttname"><a href="classPlayer.html#a535278fda7e3c98dcc5f1f28d1c0c6fe">Player::IsInDuelWith</a></div><div class="ttdeci">bool IsInDuelWith(Player const *player) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01819">Player.h:1819</a></div></div>
<div class="ttc" id="aclassPlayer_html_a543ac618fb8aaec4fc23bdfb92b29733"><div class="ttname"><a href="classPlayer.html#a543ac618fb8aaec4fc23bdfb92b29733">Player::GetSpellModSpell</a></div><div class="ttdeci">Spell * GetSpellModSpell()</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02573">Player.h:2573</a></div></div>
<div class="ttc" id="aclassPlayer_html_a626160ad35021711783bd86f733cb284"><div class="ttname"><a href="classPlayer.html#a626160ad35021711783bd86f733cb284">Player::HasItemTotemCategory</a></div><div class="ttdeci">bool HasItemTotemCategory(uint32 TotemCategory) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l09872">Player.cpp:9872</a></div></div>
<div class="ttc" id="aclassPlayer_html_a6608e0d531ea6565e894dd6a01b482b7"><div class="ttname"><a href="classPlayer.html#a6608e0d531ea6565e894dd6a01b482b7">Player::GetRunesState</a></div><div class="ttdeci">uint8 GetRunesState() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02468">Player.h:2468</a></div></div>
<div class="ttc" id="aclassPlayer_html_a6a09c85604274c12a16c1ff805cfb786"><div class="ttname"><a href="classPlayer.html#a6a09c85604274c12a16c1ff805cfb786">Player::RestoreBaseRune</a></div><div class="ttdeci">void RestoreBaseRune(uint8 index)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l22899">Player.cpp:22899</a></div></div>
<div class="ttc" id="aclassPlayer_html_a6e31b8016173bc5f6f4e00279032a474"><div class="ttname"><a href="classPlayer.html#a6e31b8016173bc5f6f4e00279032a474">Player::SetLastPotionId</a></div><div class="ttdeci">void SetLastPotionId(uint32 itemId)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02536">Player.h:2536</a></div></div>
<div class="ttc" id="aclassPlayer_html_a6fa4db05df1d6e6cd7b680b045e383ab"><div class="ttname"><a href="classPlayer.html#a6fa4db05df1d6e6cd7b680b045e383ab">Player::IsInHighLiquid</a></div><div class="ttdeci">bool IsInHighLiquid() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02296">Player.h:2296</a></div></div>
<div class="ttc" id="aclassPlayer_html_a9cf10b1ea6187be4cd0facfd5c691c6d"><div class="ttname"><a href="classPlayer.html#a9cf10b1ea6187be4cd0facfd5c691c6d">Player::UpdateAchievementCriteria</a></div><div class="ttdeci">void UpdateAchievementCriteria(AchievementCriteriaTypes type, uint32 miscvalue1=0, uint32 miscvalue2=0, Unit *unit=nullptr, uint32 time=0)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l23436">Player.cpp:23436</a></div></div>
<div class="ttc" id="aclassPlayer_html_a9ddba282e25d1585271207900b33e25f"><div class="ttname"><a href="classPlayer.html#a9ddba282e25d1585271207900b33e25f">Player::GetWeaponForAttack</a></div><div class="ttdeci">Item * GetWeaponForAttack(WeaponAttackType attackType) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01270">Player.h:1270</a></div></div>
<div class="ttc" id="aclassPlayer_html_a9df30430ce60344703a33ae012e92531"><div class="ttname"><a href="classPlayer.html#a9df30430ce60344703a33ae012e92531">Player::GetCurrentRune</a></div><div class="ttdeci">RuneType GetCurrentRune(uint8 index) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02470">Player.h:2470</a></div></div>
<div class="ttc" id="aclassPlayer_html_a9f23cae8a3da0345a05c2a2bfedc2fe2"><div class="ttname"><a href="classPlayer.html#a9f23cae8a3da0345a05c2a2bfedc2fe2">Player::IsGameMaster</a></div><div class="ttdeci">bool IsGameMaster() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01137">Player.h:1137</a></div></div>
<div class="ttc" id="aclassPlayer_html_ab44cedcf193c8807967a7126bb38de3b"><div class="ttname"><a href="classPlayer.html#ab44cedcf193c8807967a7126bb38de3b">Player::SendEquipError</a></div><div class="ttdeci">void SendEquipError(InventoryResult msg, Item *pItem, Item *pItem2=nullptr, uint32 itemid=0) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l12645">Player.cpp:12645</a></div></div>
<div class="ttc" id="aclassPlayer_html_ab563068f1495ca11652bef21caf63da3"><div class="ttname"><a href="classPlayer.html#ab563068f1495ca11652bef21caf63da3">Player::HasItemCount</a></div><div class="ttdeci">bool HasItemCount(uint32 item, uint32 count, bool inBankAlso=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l09675">Player.cpp:9675</a></div></div>
<div class="ttc" id="aclassPlayer_html_ab65ebe29bf60f3b6144070a461976f9a"><div class="ttname"><a href="classPlayer.html#ab65ebe29bf60f3b6144070a461976f9a">Player::SetSpellModSpell</a></div><div class="ttdeci">void SetSpellModSpell(Spell *spell)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l25347">Player.cpp:25347</a></div></div>
<div class="ttc" id="aclassPlayer_html_aba46f31b2dbdee8ef622f8be4a605ad1"><div class="ttname"><a href="classPlayer.html#aba46f31b2dbdee8ef622f8be4a605ad1">Player::GetAreaTriggerLockStatus</a></div><div class="ttdeci">AreaLockStatus GetAreaTriggerLockStatus(AreaTrigger const *at, Difficulty difficulty, uint32 &amp;miscRequirement, bool forceAllChecks=false)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l24651">Player.cpp:24651</a></div></div>
<div class="ttc" id="aclassPlayer_html_abd27766d244dff1de0e26608a5bf3160"><div class="ttname"><a href="classPlayer.html#abd27766d244dff1de0e26608a5bf3160">Player::GetItemByLimitedCategory</a></div><div class="ttdeci">Item * GetItemByLimitedCategory(uint32 limitedCategory) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l09425">Player.cpp:9425</a></div></div>
<div class="ttc" id="aclassPlayer_html_ac23afe6cea3000024eb546a42d52e6ef"><div class="ttname"><a href="classPlayer.html#ac23afe6cea3000024eb546a42d52e6ef">Player::GetTradeData</a></div><div class="ttdeci">TradeData * GetTradeData() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01390">Player.h:1390</a></div></div>
<div class="ttc" id="aclassPlayer_html_ac6351ac9ee0e10224edb31cef32292e9"><div class="ttname"><a href="classPlayer.html#ac6351ac9ee0e10224edb31cef32292e9">Player::GetAchievementMgr</a></div><div class="ttdeci">AchievementMgr const  &amp; GetAchievementMgr() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02488">Player.h:2488</a></div></div>
<div class="ttc" id="aclassPlayer_html_ac803ce7abf2d0990d93db9969f24f567"><div class="ttname"><a href="classPlayer.html#ac803ce7abf2d0990d93db9969f24f567">Player::GetRuneCooldown</a></div><div class="ttdeci">uint16 GetRuneCooldown(uint8 index) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02471">Player.h:2471</a></div></div>
<div class="ttc" id="aclassPlayer_html_acda80b2f5f4e3a9b2e14609a45c0d22b"><div class="ttname"><a href="classPlayer.html#acda80b2f5f4e3a9b2e14609a45c0d22b">Player::GetSkillValue</a></div><div class="ttdeci">uint16 GetSkillValue(uint16 id) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02002">Player.h:2002</a></div></div>
<div class="ttc" id="aclassPlayer_html_ad0c3acee78cdc94d2fea28c2a1671286"><div class="ttname"><a href="classPlayer.html#ad0c3acee78cdc94d2fea28c2a1671286">Player::SendPetTameFailure</a></div><div class="ttdeci">void SendPetTameFailure(PetTameFailureReason reason) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l14272">Player.cpp:14272</a></div></div>
<div class="ttc" id="aclassPlayer_html_ad2debe6316c3b6ebab131713336f3284"><div class="ttname"><a href="classPlayer.html#ad2debe6316c3b6ebab131713336f3284">Player::GetSubGroup</a></div><div class="ttdeci">uint8 GetSubGroup() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02448">Player.h:2448</a></div></div>
<div class="ttc" id="aclassPlayer_html_add3944b50311b59aded74efda7fea752"><div class="ttname"><a href="classPlayer.html#add3944b50311b59aded74efda7fea752">Player::GetSpellModOwner</a></div><div class="ttdeci">Player * GetSpellModOwner() const override</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01179">Player.h:1179</a></div></div>
<div class="ttc" id="aclassPlayer_html_adf5d2bf68d3caad2202caeb25daadc8e"><div class="ttname"><a href="classPlayer.html#adf5d2bf68d3caad2202caeb25daadc8e">Player::GetItemByGuid</a></div><div class="ttdeci">Item * GetItemByGuid(ObjectGuid guid) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l09445">Player.cpp:9445</a></div></div>
<div class="ttc" id="aclassPlayer_html_ae0022e08b3e294bf9baa7a1fea848504"><div class="ttname"><a href="classPlayer.html#ae0022e08b3e294bf9baa7a1fea848504">Player::SetCooldownEventOnLeaveCombatSpellId</a></div><div class="ttdeci">void SetCooldownEventOnLeaveCombatSpellId(uint32 spellId)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02537">Player.h:2537</a></div></div>
<div class="ttc" id="aclassPlayer_html_ae6a51221f478bb16c116402295880786"><div class="ttname"><a href="classPlayer.html#ae6a51221f478bb16c116402295880786">Player::CanNoReagentCast</a></div><div class="ttdeci">bool CanNoReagentCast(SpellEntry const *spellInfo) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l22014">Player.cpp:22014</a></div></div>
<div class="ttc" id="aclassPlayer_html_af059a10625d50ca7674771ea1c1c4c4c"><div class="ttname"><a href="classPlayer.html#af059a10625d50ca7674771ea1c1c4c4c">Player::CanStoreNewItem</a></div><div class="ttdeci">InventoryResult CanStoreNewItem(uint8 bag, uint8 slot, ItemPosCountVec &amp;dest, uint32 item, uint32 count, uint32 *no_space_count=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01293">Player.h:1293</a></div></div>
<div class="ttc" id="aclassPlayer_html_af79d4d1f2be3a95ee1b31c7966b71d32"><div class="ttname"><a href="classPlayer.html#af79d4d1f2be3a95ee1b31c7966b71d32">Player::GetSelectionGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetSelectionGuid() const override</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01637">Player.h:1637</a></div></div>
<div class="ttc" id="aclassPlayer_html_af890a4dc7cf4546a399bf05b3fb26c31"><div class="ttname"><a href="classPlayer.html#af890a4dc7cf4546a399bf05b3fb26c31">Player::GetBoundInstance</a></div><div class="ttdeci">InstancePlayerBind * GetBoundInstance(uint32 mapid, Difficulty difficulty, bool withExpired=false)</div><div class="ttdef"><b>Definition:</b> <a href="Player_8cpp_source.html#l17822">Player.cpp:17822</a></div></div>
<div class="ttc" id="aclassPlayer_html_afc860537b2180ddf911cd3a752bb7b79"><div class="ttname"><a href="classPlayer.html#afc860537b2180ddf911cd3a752bb7b79">Player::IsGhouled</a></div><div class="ttdeci">bool IsGhouled() const</div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l02518">Player.h:2518</a></div></div>
<div class="ttc" id="aclassPrioritizeHealthUnitWraper_html"><div class="ttname"><a href="classPrioritizeHealthUnitWraper.html">PrioritizeHealthUnitWraper</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00080">Spell.cpp:81</a></div></div>
<div class="ttc" id="aclassPrioritizeHealthUnitWraper_html_a04f435d35010336810210a886f40c62b"><div class="ttname"><a href="classPrioritizeHealthUnitWraper.html#a04f435d35010336810210a886f40c62b">PrioritizeHealthUnitWraper::getPercent</a></div><div class="ttdeci">uint32 getPercent() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00088">Spell.cpp:88</a></div></div>
<div class="ttc" id="aclassPrioritizeHealthUnitWraper_html_a25c4252f3068e7a7eebac88bca031482"><div class="ttname"><a href="classPrioritizeHealthUnitWraper.html#a25c4252f3068e7a7eebac88bca031482">PrioritizeHealthUnitWraper::PrioritizeHealthUnitWraper</a></div><div class="ttdeci">PrioritizeHealthUnitWraper(Unit *unit)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00083">Spell.cpp:83</a></div></div>
<div class="ttc" id="aclassPrioritizeHealthUnitWraper_html_a4925f46cf9cd6677361f8bb41e12c18f"><div class="ttname"><a href="classPrioritizeHealthUnitWraper.html#a4925f46cf9cd6677361f8bb41e12c18f">PrioritizeHealthUnitWraper::i_percent</a></div><div class="ttdeci">uint32 i_percent</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00091">Spell.cpp:91</a></div></div>
<div class="ttc" id="aclassPrioritizeHealthUnitWraper_html_a5e9eca412b08d7e420d5c2afd51ffce4"><div class="ttname"><a href="classPrioritizeHealthUnitWraper.html#a5e9eca412b08d7e420d5c2afd51ffce4">PrioritizeHealthUnitWraper::getUnit</a></div><div class="ttdeci">Unit * getUnit() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00087">Spell.cpp:87</a></div></div>
<div class="ttc" id="aclassPrioritizeHealthUnitWraper_html_a92e33dcab8a31dc09617e1b2540cce99"><div class="ttname"><a href="classPrioritizeHealthUnitWraper.html#a92e33dcab8a31dc09617e1b2540cce99">PrioritizeHealthUnitWraper::i_unit</a></div><div class="ttdeci">Unit * i_unit</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00090">Spell.cpp:90</a></div></div>
<div class="ttc" id="aclassPrioritizeManaUnitWraper_html"><div class="ttname"><a href="classPrioritizeManaUnitWraper.html">PrioritizeManaUnitWraper</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00055">Spell.cpp:56</a></div></div>
<div class="ttc" id="aclassPrioritizeManaUnitWraper_html_a16aeddc2f6a641306b52cb105487add5"><div class="ttname"><a href="classPrioritizeManaUnitWraper.html#a16aeddc2f6a641306b52cb105487add5">PrioritizeManaUnitWraper::i_unit</a></div><div class="ttdeci">Unit * i_unit</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00066">Spell.cpp:66</a></div></div>
<div class="ttc" id="aclassPrioritizeManaUnitWraper_html_a2eede6fcfaaa8ec2de5e8b21bedccf77"><div class="ttname"><a href="classPrioritizeManaUnitWraper.html#a2eede6fcfaaa8ec2de5e8b21bedccf77">PrioritizeManaUnitWraper::i_percent</a></div><div class="ttdeci">uint32 i_percent</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00067">Spell.cpp:67</a></div></div>
<div class="ttc" id="aclassPrioritizeManaUnitWraper_html_a4421ed0010cf68678c74a981a1233d90"><div class="ttname"><a href="classPrioritizeManaUnitWraper.html#a4421ed0010cf68678c74a981a1233d90">PrioritizeManaUnitWraper::getUnit</a></div><div class="ttdeci">Unit * getUnit() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00063">Spell.cpp:63</a></div></div>
<div class="ttc" id="aclassPrioritizeManaUnitWraper_html_a7f67bddd3e776bfc46ef0b57b790c0d0"><div class="ttname"><a href="classPrioritizeManaUnitWraper.html#a7f67bddd3e776bfc46ef0b57b790c0d0">PrioritizeManaUnitWraper::PrioritizeManaUnitWraper</a></div><div class="ttdeci">PrioritizeManaUnitWraper(Unit *unit)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00058">Spell.cpp:58</a></div></div>
<div class="ttc" id="aclassPrioritizeManaUnitWraper_html_ad51e2fcd204e05972936f0ad1283b076"><div class="ttname"><a href="classPrioritizeManaUnitWraper.html#ad51e2fcd204e05972936f0ad1283b076">PrioritizeManaUnitWraper::getPercent</a></div><div class="ttdeci">uint32 getPercent() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00064">Spell.cpp:64</a></div></div>
<div class="ttc" id="aclassSQLMultiStorage_1_1SQLMSIteratorBounds_html"><div class="ttname"><a href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html">SQLMultiStorage::SQLMSIteratorBounds</a></div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00215">SQLStorage.h:216</a></div></div>
<div class="ttc" id="aclassSQLMultiStorage_1_1SQLMSIteratorBounds_html_a6f0cd7b17726b3b4f003018567b11479"><div class="ttname"><a href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#a6f0cd7b17726b3b4f003018567b11479">SQLMultiStorage::SQLMSIteratorBounds::second</a></div><div class="ttdeci">const SQLMultiSIterator&lt; T &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00221">SQLStorage.h:221</a></div></div>
<div class="ttc" id="aclassSQLMultiStorage_1_1SQLMSIteratorBounds_html_af6d445d47e80acc0a6134bcd1bfef7cb"><div class="ttname"><a href="classSQLMultiStorage_1_1SQLMSIteratorBounds.html#af6d445d47e80acc0a6134bcd1bfef7cb">SQLMultiStorage::SQLMSIteratorBounds::first</a></div><div class="ttdeci">const SQLMultiSIterator&lt; T &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00220">SQLStorage.h:220</a></div></div>
<div class="ttc" id="aclassSQLMultiStorage_1_1SQLMultiSIterator_html"><div class="ttname"><a href="classSQLMultiStorage_1_1SQLMultiSIterator.html">SQLMultiStorage::SQLMultiSIterator</a></div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00194">SQLStorage.h:195</a></div></div>
<div class="ttc" id="aclassSQLMultiStorage_html_a737fa961049b08dd90e981c45d40ff0b"><div class="ttname"><a href="classSQLMultiStorage.html#a737fa961049b08dd90e981c45d40ff0b">SQLMultiStorage::getBounds</a></div><div class="ttdeci">SQLMSIteratorBounds&lt; T &gt; getBounds(uint32 key) const</div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00228">SQLStorage.h:228</a></div></div>
<div class="ttc" id="aclassSQLStorage_html_ace42ec0424ef41d187eb7c1bdcfa8c62"><div class="ttname"><a href="classSQLStorage.html#ace42ec0424ef41d187eb7c1bdcfa8c62">SQLStorage::LookupEntry</a></div><div class="ttdeci">T const  * LookupEntry(uint32 id) const</div><div class="ttdef"><b>Definition:</b> <a href="SQLStorage_8h_source.html#l00113">SQLStorage.h:113</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html"><div class="ttname"><a href="classSpellAuraHolder.html">SpellAuraHolder</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00092">SpellAuras.h:93</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_a04ea541571f23194212875bf5a412476"><div class="ttname"><a href="classSpellAuraHolder.html#a04ea541571f23194212875bf5a412476">SpellAuraHolder::SetAuraDuration</a></div><div class="ttdeci">void SetAuraDuration(int32 duration)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00159">SpellAuras.h:159</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_a1fd2e2389179ee0daeb7cdbb3a67a294"><div class="ttname"><a href="classSpellAuraHolder.html#a1fd2e2389179ee0daeb7cdbb3a67a294">SpellAuraHolder::GetSpellProto</a></div><div class="ttdeci">SpellEntry const  * GetSpellProto() const</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00120">SpellAuras.h:120</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_a2424ccc610b10ff5e89e86d46522c178"><div class="ttname"><a href="classSpellAuraHolder.html#a2424ccc610b10ff5e89e86d46522c178">SpellAuraHolder::GetCasterGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetCasterGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00124">SpellAuras.h:124</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_a28a84093e48130837d9a199e4ba50ede"><div class="ttname"><a href="classSpellAuraHolder.html#a28a84093e48130837d9a199e4ba50ede">SpellAuraHolder::setDiminishGroup</a></div><div class="ttdeci">void setDiminishGroup(DiminishingGroup group)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00109">SpellAuras.h:109</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_a31ef95e4dcce0b52bace3fc8c5c4049d"><div class="ttname"><a href="classSpellAuraHolder.html#a31ef95e4dcce0b52bace3fc8c5c4049d">SpellAuraHolder::IsPositive</a></div><div class="ttdeci">bool IsPositive() const</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8cpp_source.html#l11259">SpellAuras.cpp:11259</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_ab092e45184bc9f7b8c897578567fe5d2"><div class="ttname"><a href="classSpellAuraHolder.html#ab092e45184bc9f7b8c897578567fe5d2">SpellAuraHolder::SetState</a></div><div class="ttdeci">void SetState(SpellAuraHolderState state)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00122">SpellAuras.h:122</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_ab71e0b6735bb181565ca094ac1d0d0e5"><div class="ttname"><a href="classSpellAuraHolder.html#ab71e0b6735bb181565ca094ac1d0d0e5">SpellAuraHolder::SetAuraMaxDuration</a></div><div class="ttdeci">void SetAuraMaxDuration(int32 duration)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8cpp_source.html#l11147">SpellAuras.cpp:11147</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_ab7f8cf8e30f83ace3f9b6771e945d51a"><div class="ttname"><a href="classSpellAuraHolder.html#ab7f8cf8e30f83ace3f9b6771e945d51a">SpellAuraHolder::IsEmptyHolder</a></div><div class="ttdeci">bool IsEmptyHolder() const</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8cpp_source.html#l11268">SpellAuras.cpp:11268</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_ae5e37b35a05d2fef0061c637816f1774"><div class="ttname"><a href="classSpellAuraHolder.html#ae5e37b35a05d2fef0061c637816f1774">SpellAuraHolder::SetHeartbeatResist</a></div><div class="ttdeci">void SetHeartbeatResist(uint32 chance, int32 originalDuration, uint32 drLevel)</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8cpp_source.html#l11399">SpellAuras.cpp:11399</a></div></div>
<div class="ttc" id="aclassSpellAuraHolder_html_af69c8cd9624dc41a345e775c075518c3"><div class="ttname"><a href="classSpellAuraHolder.html#af69c8cd9624dc41a345e775c075518c3">SpellAuraHolder::GetAuraMaxDuration</a></div><div class="ttdeci">int32 GetAuraMaxDuration() const</div><div class="ttdef"><b>Definition:</b> <a href="SpellAuras_8h_source.html#l00156">SpellAuras.h:156</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html"><div class="ttname"><a href="classSpellCastTargets.html">SpellCastTargets</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00112">Spell.h:113</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a124b2fcc6764bd9bcd5e16d352e51c48"><div class="ttname"><a href="classSpellCastTargets.html#a124b2fcc6764bd9bcd5e16d352e51c48">SpellCastTargets::getUnitTarget</a></div><div class="ttdeci">Unit * getUnitTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00158">Spell.h:158</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a15c7d327f5afb62081a3b8893d62f1cb"><div class="ttname"><a href="classSpellCastTargets.html#a15c7d327f5afb62081a3b8893d62f1cb">SpellCastTargets::m_srcPos</a></div><div class="ttdeci">Position m_srcPos</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00205">Spell.h:205</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a18f1ccb896d907c949744401f31d4780"><div class="ttname"><a href="classSpellCastTargets.html#a18f1ccb896d907c949744401f31d4780">SpellCastTargets::getDestTransportGuid</a></div><div class="ttdeci">ObjectGuid getDestTransportGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00188">Spell.h:188</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a23b37368504caddfb397425514312cc7"><div class="ttname"><a href="classSpellCastTargets.html#a23b37368504caddfb397425514312cc7">SpellCastTargets::m_srcTransportPos</a></div><div class="ttdeci">Position m_srcTransportPos</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00206">Spell.h:206</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a251b411d756aee45e9ecea9fcbd676ad"><div class="ttname"><a href="classSpellCastTargets.html#a251b411d756aee45e9ecea9fcbd676ad">SpellCastTargets::m_destTransportPos</a></div><div class="ttdeci">Position m_destTransportPos</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00208">Spell.h:208</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a297f5f21dc92d6e3e950ad03dc81ca6c"><div class="ttname"><a href="classSpellCastTargets.html#a297f5f21dc92d6e3e950ad03dc81ca6c">SpellCastTargets::m_srcTransportGUID</a></div><div class="ttdeci">ObjectGuid m_srcTransportGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00227">Spell.h:227</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a31496bc8861793d11f83b216c94a81e8"><div class="ttname"><a href="classSpellCastTargets.html#a31496bc8861793d11f83b216c94a81e8">SpellCastTargets::getSource</a></div><div class="ttdeci">void getSource(float &amp;x, float &amp;y, float &amp;z) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00166">Spell.h:166</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a357429830fcc4577ac9bafbcb6d4db37"><div class="ttname"><a href="classSpellCastTargets.html#a357429830fcc4577ac9bafbcb6d4db37">SpellCastTargets::m_CorpseTargetGUID</a></div><div class="ttdeci">ObjectGuid m_CorpseTargetGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00225">Spell.h:225</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a4e128d2ee02535f2020ceb4309dc8b09"><div class="ttname"><a href="classSpellCastTargets.html#a4e128d2ee02535f2020ceb4309dc8b09">SpellCastTargets::getItemTarget</a></div><div class="ttdeci">Item * getItemTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00185">Spell.h:185</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a524a7750c6c3fa3532d38cc94583b13d"><div class="ttname"><a href="classSpellCastTargets.html#a524a7750c6c3fa3532d38cc94583b13d">SpellCastTargets::read</a></div><div class="ttdeci">void read(ByteBuffer &amp;data, Unit *caster)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00251">Spell.cpp:251</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a5b90d90b2ea07ecd4308a5eb1697d93f"><div class="ttname"><a href="classSpellCastTargets.html#a5b90d90b2ea07ecd4308a5eb1697d93f">SpellCastTargets::m_destPos</a></div><div class="ttdeci">Position m_destPos</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00207">Spell.h:207</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a5ddeb0e96775789e553286c9cc879c27"><div class="ttname"><a href="classSpellCastTargets.html#a5ddeb0e96775789e553286c9cc879c27">SpellCastTargets::setItemTarget</a></div><div class="ttdeci">void setItemTarget(Item *item)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00178">Spell.cpp:178</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a5f5f01751fab6066b430d427466121c1"><div class="ttname"><a href="classSpellCastTargets.html#a5f5f01751fab6066b430d427466121c1">SpellCastTargets::setCorpseTarget</a></div><div class="ttdeci">void setCorpseTarget(Corpse *corpse)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00198">Spell.cpp:198</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a62e4f91dc75aad55879fc4ea1346abaa"><div class="ttname"><a href="classSpellCastTargets.html#a62e4f91dc75aad55879fc4ea1346abaa">SpellCastTargets::getCorpseTarget</a></div><div class="ttdeci">Corpse * getCorpseTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00181">Spell.h:181</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a668ddc424939e93a1f7f3eff97d02138"><div class="ttname"><a href="classSpellCastTargets.html#a668ddc424939e93a1f7f3eff97d02138">SpellCastTargets::m_GOTargetGUID</a></div><div class="ttdeci">ObjectGuid m_GOTargetGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00224">Spell.h:224</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a68372d026b0fbe7825ce7bccd0782094"><div class="ttname"><a href="classSpellCastTargets.html#a68372d026b0fbe7825ce7bccd0782094">SpellCastTargets::getGOTarget</a></div><div class="ttdeci">GameObject * getGOTarget() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00177">Spell.h:177</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a689c7eccebe061bf922feefa6f2b573a"><div class="ttname"><a href="classSpellCastTargets.html#a689c7eccebe061bf922feefa6f2b573a">SpellCastTargets::m_unitTarget</a></div><div class="ttdeci">Unit * m_unitTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00217">Spell.h:217</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a714e30a9388d264afdc0972bc0effa11"><div class="ttname"><a href="classSpellCastTargets.html#a714e30a9388d264afdc0972bc0effa11">SpellCastTargets::getDestination</a></div><div class="ttdeci">void getDestination(float &amp;x, float &amp;y, float &amp;z) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00163">Spell.h:163</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a7980149cc7e517022ee042846ad7176a"><div class="ttname"><a href="classSpellCastTargets.html#a7980149cc7e517022ee042846ad7176a">SpellCastTargets::m_strTarget</a></div><div class="ttdeci">std::string m_strTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00209">Spell.h:209</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a7a028a5091990652b82e27148eeba0e7"><div class="ttname"><a href="classSpellCastTargets.html#a7a028a5091990652b82e27148eeba0e7">SpellCastTargets::m_speed</a></div><div class="ttdeci">float m_speed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00231">Spell.h:231</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a85fac9724b195534fd0348be2937c331"><div class="ttname"><a href="classSpellCastTargets.html#a85fac9724b195534fd0348be2937c331">SpellCastTargets::setGOTarget</a></div><div class="ttdeci">void setGOTarget(GameObject *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00171">Spell.cpp:171</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a865d258a598ff7453e85649e527bc44b"><div class="ttname"><a href="classSpellCastTargets.html#a865d258a598ff7453e85649e527bc44b">SpellCastTargets::write</a></div><div class="ttdeci">void write(ByteBuffer &amp;data) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00310">Spell.cpp:310</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a872c670896e98cb2ca74948e0639ba15"><div class="ttname"><a href="classSpellCastTargets.html#a872c670896e98cb2ca74948e0639ba15">SpellCastTargets::getItemTargetEntry</a></div><div class="ttdeci">uint32 getItemTargetEntry() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00186">Spell.h:186</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a8e006f10fb11d63e09434d7b3209380e"><div class="ttname"><a href="classSpellCastTargets.html#a8e006f10fb11d63e09434d7b3209380e">SpellCastTargets::m_elevation</a></div><div class="ttdeci">float m_elevation</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00231">Spell.h:231</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a98eee6778ea2cc05bd0073affde7f37d"><div class="ttname"><a href="classSpellCastTargets.html#a98eee6778ea2cc05bd0073affde7f37d">SpellCastTargets::getCorpseTargetGuid</a></div><div class="ttdeci">ObjectGuid getCorpseTargetGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00180">Spell.h:180</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a9a158dafda49be13e98bba20a2a77921"><div class="ttname"><a href="classSpellCastTargets.html#a9a158dafda49be13e98bba20a2a77921">SpellCastTargets::m_targetMask</a></div><div class="ttdeci">uint32 m_targetMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00211">Spell.h:211</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a9cb16be0359aa807f6ac5496a7e546d9"><div class="ttname"><a href="classSpellCastTargets.html#a9cb16be0359aa807f6ac5496a7e546d9">SpellCastTargets::getSpeed</a></div><div class="ttdeci">float getSpeed() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00172">Spell.h:172</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_a9e422f810ddd52b534f8b6f032989da1"><div class="ttname"><a href="classSpellCastTargets.html#a9e422f810ddd52b534f8b6f032989da1">SpellCastTargets::setDestination</a></div><div class="ttdeci">void setDestination(float x, float y, float z)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00149">Spell.cpp:149</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_aad1e5665df55c46726ccec3fee8c8ceb"><div class="ttname"><a href="classSpellCastTargets.html#aad1e5665df55c46726ccec3fee8c8ceb">SpellCastTargets::m_destTransportGUID</a></div><div class="ttdeci">ObjectGuid m_destTransportGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00228">Spell.h:228</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_aae040bf9308a0ee63208cdb6cd15580b"><div class="ttname"><a href="classSpellCastTargets.html#aae040bf9308a0ee63208cdb6cd15580b">SpellCastTargets::SpellCastTargets</a></div><div class="ttdeci">SpellCastTargets()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00117">Spell.cpp:117</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_ab2f9a145d69bbf6620fbfa199c94fe55"><div class="ttname"><a href="classSpellCastTargets.html#ab2f9a145d69bbf6620fbfa199c94fe55">SpellCastTargets::setUnitTarget</a></div><div class="ttdeci">void setUnitTarget(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00138">Spell.cpp:138</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_ab3bf003f250e2d77bf1905e4c8b81244"><div class="ttname"><a href="classSpellCastTargets.html#ab3bf003f250e2d77bf1905e4c8b81244">SpellCastTargets::~SpellCastTargets</a></div><div class="ttdeci">~SpellCastTargets()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00134">Spell.cpp:134</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_abc3b7a3ec80b2a67157e4578b027339e"><div class="ttname"><a href="classSpellCastTargets.html#abc3b7a3ec80b2a67157e4578b027339e">SpellCastTargets::m_itemTargetGUID</a></div><div class="ttdeci">ObjectGuid m_itemTargetGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00226">Spell.h:226</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_abccd1fec97295c282e888a31df1abe77"><div class="ttname"><a href="classSpellCastTargets.html#abccd1fec97295c282e888a31df1abe77">SpellCastTargets::getElevation</a></div><div class="ttdeci">float getElevation() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00169">Spell.h:169</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_ac6ff9f0e2814bcdb4b2e36798724252e"><div class="ttname"><a href="classSpellCastTargets.html#ac6ff9f0e2814bcdb4b2e36798724252e">SpellCastTargets::updateTradeSlotItem</a></div><div class="ttdeci">void updateTradeSlotItem()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00192">Spell.h:192</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_aca34f267418ee0bfae1d6e19b2cebc45"><div class="ttname"><a href="classSpellCastTargets.html#aca34f267418ee0bfae1d6e19b2cebc45">SpellCastTargets::m_itemTargetEntry</a></div><div class="ttdeci">uint32 m_itemTargetEntry</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00229">Spell.h:229</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_acba7dabf3692dcf95a31ad1ed6a5089b"><div class="ttname"><a href="classSpellCastTargets.html#acba7dabf3692dcf95a31ad1ed6a5089b">SpellCastTargets::Update</a></div><div class="ttdeci">void Update(WorldObject *caster)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00204">Spell.cpp:204</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_ad4fc13d480005a5a843343337609d610"><div class="ttname"><a href="classSpellCastTargets.html#ad4fc13d480005a5a843343337609d610">SpellCastTargets::m_GOTarget</a></div><div class="ttdeci">GameObject * m_GOTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00218">Spell.h:218</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_ad566bd3a4d9d077fbcfdd1de2baab0d7"><div class="ttname"><a href="classSpellCastTargets.html#ad566bd3a4d9d077fbcfdd1de2baab0d7">SpellCastTargets::getUnitTargetGuid</a></div><div class="ttdeci">ObjectGuid getUnitTargetGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00157">Spell.h:157</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_ae03a7a2663dc534b43ab15970b7f38f9"><div class="ttname"><a href="classSpellCastTargets.html#ae03a7a2663dc534b43ab15970b7f38f9">SpellCastTargets::m_unitTargetGUID</a></div><div class="ttdeci">ObjectGuid m_unitTargetGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00223">Spell.h:223</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_aebd9cd7110f9711cd2bd94e154920cd6"><div class="ttname"><a href="classSpellCastTargets.html#aebd9cd7110f9711cd2bd94e154920cd6">SpellCastTargets::getItemTargetGuid</a></div><div class="ttdeci">ObjectGuid getItemTargetGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00184">Spell.h:184</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_af17d6161f1bf74aa8c13c30885dcdbeb"><div class="ttname"><a href="classSpellCastTargets.html#af17d6161f1bf74aa8c13c30885dcdbeb">SpellCastTargets::setTradeItemTarget</a></div><div class="ttdeci">void setTradeItemTarget(Player *caster)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00189">Spell.cpp:189</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_af50c56408314351ab31dad61da35d2f8"><div class="ttname"><a href="classSpellCastTargets.html#af50c56408314351ab31dad61da35d2f8">SpellCastTargets::m_CorpseTarget</a></div><div class="ttdeci">Corpse * m_CorpseTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00220">Spell.h:220</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_afa341e13427e2d645c72fb04c55b7922"><div class="ttname"><a href="classSpellCastTargets.html#afa341e13427e2d645c72fb04c55b7922">SpellCastTargets::setSource</a></div><div class="ttdeci">void setSource(float x, float y, float z)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00163">Spell.cpp:163</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_afc4c8855afe9f06c6b4f15a8ba9bc928"><div class="ttname"><a href="classSpellCastTargets.html#afc4c8855afe9f06c6b4f15a8ba9bc928">SpellCastTargets::m_itemTarget</a></div><div class="ttdeci">Item * m_itemTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00219">Spell.h:219</a></div></div>
<div class="ttc" id="aclassSpellCastTargets_html_afd911e74e902f7a8f255b0b92937bc61"><div class="ttname"><a href="classSpellCastTargets.html#afd911e74e902f7a8f255b0b92937bc61">SpellCastTargets::m_mapId</a></div><div class="ttdeci">uint32 m_mapId</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00213">Spell.h:213</a></div></div>
<div class="ttc" id="aclassSpellEvent_html"><div class="ttname"><a href="classSpellEvent.html">SpellEvent</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00319">Spell.h:320</a></div></div>
<div class="ttc" id="aclassSpellEvent_html_a01f8ea354ef70d0a2ee7b88b8dd9f68e"><div class="ttname"><a href="classSpellEvent.html#a01f8ea354ef70d0a2ee7b88b8dd9f68e">SpellEvent::~SpellEvent</a></div><div class="ttdeci">virtual ~SpellEvent()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08486">Spell.cpp:8486</a></div></div>
<div class="ttc" id="aclassSpellEvent_html_a13088218be78a1d47ee1ab82adc2a4b2"><div class="ttname"><a href="classSpellEvent.html#a13088218be78a1d47ee1ab82adc2a4b2">SpellEvent::IsDeletable</a></div><div class="ttdeci">virtual bool IsDeletable() const override</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08595">Spell.cpp:8595</a></div></div>
<div class="ttc" id="aclassSpellEvent_html_a22cce1d722f5086932ae3e97c58d2921"><div class="ttname"><a href="classSpellEvent.html#a22cce1d722f5086932ae3e97c58d2921">SpellEvent::m_Spell</a></div><div class="ttdeci">Spell * m_Spell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00331">Spell.h:331</a></div></div>
<div class="ttc" id="aclassSpellEvent_html_a80c41e5e456ff336bb10e97bf7d2d1e5"><div class="ttname"><a href="classSpellEvent.html#a80c41e5e456ff336bb10e97bf7d2d1e5">SpellEvent::Abort</a></div><div class="ttdeci">virtual void Abort(uint64 e_time) override</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08588">Spell.cpp:8588</a></div></div>
<div class="ttc" id="aclassSpellEvent_html_abca64eb7d39df9788cef9df7e8634368"><div class="ttname"><a href="classSpellEvent.html#abca64eb7d39df9788cef9df7e8634368">SpellEvent::SpellEvent</a></div><div class="ttdeci">SpellEvent(Spell *spell)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08481">Spell.cpp:8481</a></div></div>
<div class="ttc" id="aclassSpellEvent_html_aca4a3938f7b68ffb40cb4d9becb21537"><div class="ttname"><a href="classSpellEvent.html#aca4a3938f7b68ffb40cb4d9becb21537">SpellEvent::Execute</a></div><div class="ttdeci">virtual bool Execute(uint64 e_time, uint32 p_time) override</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08502">Spell.cpp:8502</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a02d04282fcdf49f6480098cdfdc54837"><div class="ttname"><a href="classSpellLog.html#a02d04282fcdf49f6480098cdfdc54837">SpellLog::m_currentEffect</a></div><div class="ttdeci">uint32 m_currentEffect</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00316">Spell.h:316</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a201d26c46c6496801d03362aa9e79255"><div class="ttname"><a href="classSpellLog.html#a201d26c46c6496801d03362aa9e79255">SpellLog::SetCurrentEffect</a></div><div class="ttdeci">void SetCurrentEffect(uint32 effect)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00384">Spell.cpp:384</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a234368e990a795b9af41ba158e4d9db4"><div class="ttname"><a href="classSpellLog.html#a234368e990a795b9af41ba158e4d9db4">SpellLog::SendToSet</a></div><div class="ttdeci">void SendToSet()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00402">Spell.cpp:402</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a2f0110d6d4dec153f336825cfb1c2197"><div class="ttname"><a href="classSpellLog.html#a2f0110d6d4dec153f336825cfb1c2197">SpellLog::FinalizePrevious</a></div><div class="ttdeci">void FinalizePrevious()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00374">Spell.cpp:374</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a4430d5157d7e0c6c13e38919f3863e42"><div class="ttname"><a href="classSpellLog.html#a4430d5157d7e0c6c13e38919f3863e42">SpellLog::m_spellLogDataTargetsCounter</a></div><div class="ttdeci">uint32 m_spellLogDataTargetsCounter</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00315">Spell.h:315</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a6bd272f573b8e217c6ea18843236ccdf"><div class="ttname"><a href="classSpellLog.html#a6bd272f573b8e217c6ea18843236ccdf">SpellLog::Initialize</a></div><div class="ttdeci">void Initialize()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00363">Spell.cpp:363</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a7800e73549c607ca1b70613daf6c5a54"><div class="ttname"><a href="classSpellLog.html#a7800e73549c607ca1b70613daf6c5a54">SpellLog::m_spellLogDataEffectsCounterPos</a></div><div class="ttdeci">size_t m_spellLogDataEffectsCounterPos</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00312">Spell.h:312</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a7ac0fa4871d3636945d23b5e99cc9e32"><div class="ttname"><a href="classSpellLog.html#a7ac0fa4871d3636945d23b5e99cc9e32">SpellLog::m_spellLogData</a></div><div class="ttdeci">WorldPacket m_spellLogData</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00311">Spell.h:311</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a7b5701412168f4838480cd9a4d2f187f"><div class="ttname"><a href="classSpellLog.html#a7b5701412168f4838480cd9a4d2f187f">SpellLog::m_spell</a></div><div class="ttdeci">Spell * m_spell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00310">Spell.h:310</a></div></div>
<div class="ttc" id="aclassSpellLog_html_a82417543f128da7458422ff92fd63dbf"><div class="ttname"><a href="classSpellLog.html#a82417543f128da7458422ff92fd63dbf">SpellLog::m_spellLogDataTargetsCounterPos</a></div><div class="ttdeci">size_t m_spellLogDataTargetsCounterPos</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00314">Spell.h:314</a></div></div>
<div class="ttc" id="aclassSpellLog_html_aa9f2bd5847231a14665c02e66a304346"><div class="ttname"><a href="classSpellLog.html#aa9f2bd5847231a14665c02e66a304346">SpellLog::m_spellLogDataEffectsCounter</a></div><div class="ttdeci">uint32 m_spellLogDataEffectsCounter</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00313">Spell.h:313</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html"><div class="ttname"><a href="classSpellModRAII.html">SpellModRAII</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00334">Spell.h:335</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_a20687bd4166920cdb7989253e9ff000b"><div class="ttname"><a href="classSpellModRAII.html#a20687bd4166920cdb7989253e9ff000b">SpellModRAII::SpellModRAII</a></div><div class="ttdeci">SpellModRAII(Spell *spell, Player *modOwner, bool success=false, bool onlySave=false)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09929">Spell.cpp:9929</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_a23f3fd7bed5c18dde8d1ee3182389e01"><div class="ttname"><a href="classSpellModRAII.html#a23f3fd7bed5c18dde8d1ee3182389e01">SpellModRAII::m_spell</a></div><div class="ttdeci">Spell * m_spell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00341">Spell.h:341</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_a348fe871eb808be6f115674b363cafd0"><div class="ttname"><a href="classSpellModRAII.html#a348fe871eb808be6f115674b363cafd0">SpellModRAII::~SpellModRAII</a></div><div class="ttdeci">~SpellModRAII()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09935">Spell.cpp:9935</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_a875c8198a0c35a08aee6d482a98a408a"><div class="ttname"><a href="classSpellModRAII.html#a875c8198a0c35a08aee6d482a98a408a">SpellModRAII::m_modOwner</a></div><div class="ttdeci">Player * m_modOwner</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00342">Spell.h:342</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_a8b770a4d2aa3a8c23d5c324c5e1f5f87"><div class="ttname"><a href="classSpellModRAII.html#a8b770a4d2aa3a8c23d5c324c5e1f5f87">SpellModRAII::m_onlySave</a></div><div class="ttdeci">bool m_onlySave</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00344">Spell.h:344</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_aae2aecd7b406edaa84c61a2c6ff20a26"><div class="ttname"><a href="classSpellModRAII.html#aae2aecd7b406edaa84c61a2c6ff20a26">SpellModRAII::SetSuccess</a></div><div class="ttdeci">void SetSuccess()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00338">Spell.h:338</a></div></div>
<div class="ttc" id="aclassSpellModRAII_html_af7936f9aab357d4d25d2436178fa06ca"><div class="ttname"><a href="classSpellModRAII.html#af7936f9aab357d4d25d2436178fa06ca">SpellModRAII::m_success</a></div><div class="ttdeci">bool m_success</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00343">Spell.h:343</a></div></div>
<div class="ttc" id="aclassSpellScriptMgr_html"><div class="ttname"><a href="classSpellScriptMgr.html">SpellScriptMgr</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellScript_8h_source.html#l00140">SpellScript.h:141</a></div></div>
<div class="ttc" id="aclassSpellTargetMgr_html_a7cbcb402c05cdbe0f5cb24423e1cce21"><div class="ttname"><a href="classSpellTargetMgr.html#a7cbcb402c05cdbe0f5cb24423e1cce21">SpellTargetMgr::GetSpellTargetingData</a></div><div class="ttdeci">static SpellTargetingData &amp; GetSpellTargetingData(uint32 spellId)</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8cpp_source.html#l00317">SpellTargets.cpp:317</a></div></div>
<div class="ttc" id="aclassSpellTargetMgr_html_a97e1223049b826364a522110f5c7ff3f"><div class="ttname"><a href="classSpellTargetMgr.html#a97e1223049b826364a522110f5c7ff3f">SpellTargetMgr::GetJumpRadius</a></div><div class="ttdeci">static float GetJumpRadius(uint32 spellId)</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8cpp_source.html#l00585">SpellTargets.cpp:585</a></div></div>
<div class="ttc" id="aclassSpellTargetMgr_html_ab4551e29aa15b717b702b6abc3d05b2b"><div class="ttname"><a href="classSpellTargetMgr.html#ab4551e29aa15b717b702b6abc3d05b2b">SpellTargetMgr::CanEffectBeFilledWithMask</a></div><div class="ttdeci">static bool CanEffectBeFilledWithMask(uint32 spellId, uint32 effIdx, uint32 mask)</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8cpp_source.html#l00555">SpellTargets.cpp:555</a></div></div>
<div class="ttc" id="aclassSpell_html"><div class="ttname"><a href="classSpell.html">Spell</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00398">Spell.h:399</a></div></div>
<div class="ttc" id="aclassSpell_html_a00dbf3e8c4ec3aa165e7bddb7cfeecd8"><div class="ttname"><a href="classSpell.html#a00dbf3e8c4ec3aa165e7bddb7cfeecd8">Spell::UpdatePointers</a></div><div class="ttdeci">void UpdatePointers()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08242">Spell.cpp:8242</a></div></div>
<div class="ttc" id="aclassSpell_html_a0170aeace8c572eb70d4436c8b93fe4c"><div class="ttname"><a href="classSpell.html#a0170aeace8c572eb70d4436c8b93fe4c">Spell::SendInterrupted</a></div><div class="ttdeci">void SendInterrupted(SpellCastResult result) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04848">Spell.cpp:4848</a></div></div>
<div class="ttc" id="aclassSpell_html_a04adccf710024da5871ed1f1dfd8fe4a"><div class="ttname"><a href="classSpell.html#a04adccf710024da5871ed1f1dfd8fe4a">Spell::corpseTarget</a></div><div class="ttdeci">Corpse * corpseTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00959">Spell.h:959</a></div></div>
<div class="ttc" id="aclassSpell_html_a0543a24550bc5092b4c2060430290d0f"><div class="ttname"><a href="classSpell.html#a0543a24550bc5092b4c2060430290d0f">Spell::m_forwardedCastItemGuid</a></div><div class="ttdeci">ObjectGuid m_forwardedCastItemGuid</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00914">Spell.h:914</a></div></div>
<div class="ttc" id="aclassSpell_html_a08f2d24b9c2b77d5638a8f7d8aa4d4a1"><div class="ttname"><a href="classSpell.html#a08f2d24b9c2b77d5638a8f7d8aa4d4a1">Spell::m_petCast</a></div><div class="ttdeci">bool m_petCast</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00651">Spell.h:651</a></div></div>
<div class="ttc" id="aclassSpell_html_a0af004d00c37bf3849719452e2b9deaa"><div class="ttname"><a href="classSpell.html#a0af004d00c37bf3849719452e2b9deaa">Spell::cast</a></div><div class="ttdeci">SpellCastResult cast(bool skipCheck=false)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03485">Spell.cpp:3485</a></div></div>
<div class="ttc" id="aclassSpell_html_a0b4cba9e81d9533c5acc442797c7df85"><div class="ttname"><a href="classSpell.html#a0b4cba9e81d9533c5acc442797c7df85">Spell::OnAfterHit</a></div><div class="ttdeci">void OnAfterHit()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09898">Spell.cpp:9898</a></div></div>
<div class="ttc" id="aclassSpell_html_a0bf8e3d48d88a395dfb6ecec3684284f"><div class="ttname"><a href="classSpell.html#a0bf8e3d48d88a395dfb6ecec3684284f">Spell::CheckSpellCancelsFear</a></div><div class="ttdeci">bool CheckSpellCancelsFear(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07318">Spell.cpp:7318</a></div></div>
<div class="ttc" id="aclassSpell_html_a0c1365668be6064fbd231e068c77686a"><div class="ttname"><a href="classSpell.html#a0c1365668be6064fbd231e068c77686a">Spell::m_duration</a></div><div class="ttdeci">int32 m_duration</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00925">Spell.h:925</a></div></div>
<div class="ttc" id="aclassSpell_html_a0e7f35f88f4bad9f5599c67fde08f98a"><div class="ttname"><a href="classSpell.html#a0e7f35f88f4bad9f5599c67fde08f98a">Spell::gameObjTarget</a></div><div class="ttdeci">GameObject * gameObjTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00958">Spell.h:958</a></div></div>
<div class="ttc" id="aclassSpell_html_a0f13cd88cfc58640ca705d6b1a72d2e0"><div class="ttname"><a href="classSpell.html#a0f13cd88cfc58640ca705d6b1a72d2e0">Spell::SetTotalTargetValueModifier</a></div><div class="ttdeci">void SetTotalTargetValueModifier(float modifier)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09924">Spell.cpp:9924</a></div></div>
<div class="ttc" id="aclassSpell_html_a10c2de905868b3a6ce5346d27686f9f6"><div class="ttname"><a href="classSpell.html#a10c2de905868b3a6ce5346d27686f9f6">Spell::m_timer</a></div><div class="ttdeci">uint32 m_timer</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01052">Spell.h:1052</a></div></div>
<div class="ttc" id="aclassSpell_html_a10c83ebca0cec17982c4e6a849ec668f"><div class="ttname"><a href="classSpell.html#a10c83ebca0cec17982c4e6a849ec668f">Spell::m_referencedFromCurrentSpell</a></div><div class="ttdeci">bool m_referencedFromCurrentSpell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00949">Spell.h:949</a></div></div>
<div class="ttc" id="aclassSpell_html_a116a31dab3f9eef313ac5b624214c59f"><div class="ttname"><a href="classSpell.html#a116a31dab3f9eef313ac5b624214c59f">Spell::AddDestExecution</a></div><div class="ttdeci">void AddDestExecution(SpellEffectIndex effIndex)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01249">Spell.cpp:1249</a></div></div>
<div class="ttc" id="aclassSpell_html_a11b87f50b82300c30c1d17dd079c1fd5"><div class="ttname"><a href="classSpell.html#a11b87f50b82300c30c1d17dd079c1fd5">Spell::m_triggerAutorepeat</a></div><div class="ttdeci">bool m_triggerAutorepeat</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00649">Spell.h:649</a></div></div>
<div class="ttc" id="aclassSpell_html_a136f21422b9570b3573ad35e400de4a5"><div class="ttname"><a href="classSpell.html#a136f21422b9570b3573ad35e400de4a5">Spell::AddPrecastSpell</a></div><div class="ttdeci">void AddPrecastSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00731">Spell.h:731</a></div></div>
<div class="ttc" id="aclassSpell_html_a13c8ce3196151883d5daf89a3f82bff9"><div class="ttname"><a href="classSpell.html#a13c8ce3196151883d5daf89a3f82bff9">Spell::m_triggeredByAuraSpell</a></div><div class="ttdeci">SpellEntry const  * m_triggeredByAuraSpell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01080">Spell.h:1080</a></div></div>
<div class="ttc" id="aclassSpell_html_a15299304003f041f28de7a0fd992c735"><div class="ttname"><a href="classSpell.html#a15299304003f041f28de7a0fd992c735">Spell::m_originalCaster</a></div><div class="ttdeci">Unit * m_originalCaster</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00918">Spell.h:918</a></div></div>
<div class="ttc" id="aclassSpell_html_a155729c79b2273c8aa062c13e8dd4e08"><div class="ttname"><a href="classSpell.html#a155729c79b2273c8aa062c13e8dd4e08">Spell::StopCast</a></div><div class="ttdeci">void StopCast(SpellCastResult castResult)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09407">Spell.cpp:9407</a></div></div>
<div class="ttc" id="aclassSpell_html_a1703a94b2f16ff98d1483f62eac36a20"><div class="ttname"><a href="classSpell.html#a1703a94b2f16ff98d1483f62eac36a20">Spell::m_destTargetInfo</a></div><div class="ttdeci">DestTargetInfo m_destTargetInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01011">Spell.h:1011</a></div></div>
<div class="ttc" id="aclassSpell_html_a180d44289121f790927b13253164d1b2"><div class="ttname"><a href="classSpell.html#a180d44289121f790927b13253164d1b2">Spell::m_reflectable</a></div><div class="ttdeci">bool m_reflectable</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00926">Spell.h:926</a></div></div>
<div class="ttc" id="aclassSpell_html_a1878cf5afd3ac0ce5c0db53ebe61f201"><div class="ttname"><a href="classSpell.html#a1878cf5afd3ac0ce5c0db53ebe61f201">Spell::CalculateDelayMomentForDst</a></div><div class="ttdeci">uint64 CalculateDelayMomentForDst() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01265">Spell.cpp:1265</a></div></div>
<div class="ttc" id="aclassSpell_html_a18b664a798ce529bb5742222ef87da01"><div class="ttname"><a href="classSpell.html#a18b664a798ce529bb5742222ef87da01">Spell::CheckSpellCancelsStun</a></div><div class="ttdeci">bool CheckSpellCancelsStun(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07300">Spell.cpp:7300</a></div></div>
<div class="ttc" id="aclassSpell_html_a19aea7e498ef7d2582a047b22ba6eb1d"><div class="ttname"><a href="classSpell.html#a19aea7e498ef7d2582a047b22ba6eb1d">Spell::AddGOTarget</a></div><div class="ttdeci">void AddGOTarget(GameObject *target, uint8 effectMask)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01154">Spell.cpp:1154</a></div></div>
<div class="ttc" id="aclassSpell_html_a1eccb88ab5fe5367817bcbbdbb368b81"><div class="ttname"><a href="classSpell.html#a1eccb88ab5fe5367817bcbbdbb368b81">Spell::m_maxRange</a></div><div class="ttdeci">float m_maxRange</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00929">Spell.h:929</a></div></div>
<div class="ttc" id="aclassSpell_html_a1efb9631f004c31d06b0552c2edbc10f"><div class="ttname"><a href="classSpell.html#a1efb9631f004c31d06b0552c2edbc10f">Spell::SendChannelStart</a></div><div class="ttdeci">void SendChannelStart(uint32 duration)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04917">Spell.cpp:4917</a></div></div>
<div class="ttc" id="aclassSpell_html_a1f5dac6a66009db412f1a37b7e7b6c7e"><div class="ttname"><a href="classSpell.html#a1f5dac6a66009db412f1a37b7e7b6c7e">Spell::ProcReflectProcs</a></div><div class="ttdeci">void ProcReflectProcs(TargetInfo &amp;targetInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09146">Spell.cpp:9146</a></div></div>
<div class="ttc" id="aclassSpell_html_a1f60430046b242448bfe6509aa1e333d"><div class="ttname"><a href="classSpell.html#a1f60430046b242448bfe6509aa1e333d">Spell::DoAllTargetlessEffects</a></div><div class="ttdeci">void DoAllTargetlessEffects(bool dest)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01642">Spell.cpp:1642</a></div></div>
<div class="ttc" id="aclassSpell_html_a20e082dbb8f2742409b11338bd65b025"><div class="ttname"><a href="classSpell.html#a20e082dbb8f2742409b11338bd65b025">Spell::ProcessAOECaps</a></div><div class="ttdeci">void ProcessAOECaps()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03974">Spell.cpp:3974</a></div></div>
<div class="ttc" id="aclassSpell_html_a21ad65d1dbdf61469baa14a0e49887b6"><div class="ttname"><a href="classSpell.html#a21ad65d1dbdf61469baa14a0e49887b6">Spell::m_delayStart</a></div><div class="ttdeci">uint64 m_delayStart</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00944">Spell.h:944</a></div></div>
<div class="ttc" id="aclassSpell_html_a22f76da795704e74f5447bbaebe02d9c"><div class="ttname"><a href="classSpell.html#a22f76da795704e74f5447bbaebe02d9c">Spell::m_targets</a></div><div class="ttdeci">SpellCastTargets m_targets</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00641">Spell.h:641</a></div></div>
<div class="ttc" id="aclassSpell_html_a2391bf1bfb54f70998c4374d59eb308c"><div class="ttname"><a href="classSpell.html#a2391bf1bfb54f70998c4374d59eb308c">Spell::SpellStart</a></div><div class="ttdeci">SpellCastResult SpellStart(SpellCastTargets const *targets, Aura *triggeredByAura=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03305">Spell.cpp:3305</a></div></div>
<div class="ttc" id="aclassSpell_html_a23f8bfc484051a1ac749f0dfec7c866d"><div class="ttname"><a href="classSpell.html#a23f8bfc484051a1ac749f0dfec7c866d">Spell::SendCastResult</a></div><div class="ttdeci">static void SendCastResult(Player const *caster, SpellEntry const *spellInfo, uint8 cast_count, SpellCastResult result, bool isPetCastResult=false, uint32 param1=0, uint32 param2=0)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04392">Spell.cpp:4392</a></div></div>
<div class="ttc" id="aclassSpell_html_a2802c4efcae1cb5ad2b5a1fbe12d59b7"><div class="ttname"><a href="classSpell.html#a2802c4efcae1cb5ad2b5a1fbe12d59b7">Spell::m_ignoreHitResult</a></div><div class="ttdeci">bool m_ignoreHitResult</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00645">Spell.h:645</a></div></div>
<div class="ttc" id="aclassSpell_html_a2941b12142e64ef7dbba66ad38faac48"><div class="ttname"><a href="classSpell.html#a2941b12142e64ef7dbba66ad38faac48">Spell::m_auraScript</a></div><div class="ttdeci">AuraScript * m_auraScript</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01048">Spell.h:1048</a></div></div>
<div class="ttc" id="aclassSpell_html_a2999180c9cb3caf82303f88dd2f3e6e3"><div class="ttname"><a href="classSpell.html#a2999180c9cb3caf82303f88dd2f3e6e3">Spell::m_clientCast</a></div><div class="ttdeci">bool m_clientCast</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00662">Spell.h:662</a></div></div>
<div class="ttc" id="aclassSpell_html_a2eb2ffd80a6c5b4240b778464662add7"><div class="ttname"><a href="classSpell.html#a2eb2ffd80a6c5b4240b778464662add7">Spell::m_trueCaster</a></div><div class="ttdeci">WorldObject * m_trueCaster</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01097">Spell.h:1097</a></div></div>
<div class="ttc" id="aclassSpell_html_a2f18d1c37d38e7ca03c9dddb8879f651"><div class="ttname"><a href="classSpell.html#a2f18d1c37d38e7ca03c9dddb8879f651">Spell::RecalculateDelayMomentForDest</a></div><div class="ttdeci">void RecalculateDelayMomentForDest()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01290">Spell.cpp:1290</a></div></div>
<div class="ttc" id="aclassSpell_html_a30ad9ebc3e466447c7a4a5c3343476df"><div class="ttname"><a href="classSpell.html#a30ad9ebc3e466447c7a4a5c3343476df">Spell::SelectMountByAreaAndSkill</a></div><div class="ttdeci">static void SelectMountByAreaAndSkill(Unit *target, SpellEntry const *parentSpell, uint32 spellId75, uint32 spellId150, uint32 spellId225, uint32 spellId300, uint32 spellIdSpecial)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08859">Spell.cpp:8859</a></div></div>
<div class="ttc" id="aclassSpell_html_a321d6f8758262f8e47955c53a6f55329"><div class="ttname"><a href="classSpell.html#a321d6f8758262f8e47955c53a6f55329">Spell::FillRaidOrPartyTargets</a></div><div class="ttdeci">void FillRaidOrPartyTargets(UnitList &amp;targetUnitMap, Unit *member, Unit *center, float radius, bool raid, bool withPets, bool withcaster) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08703">Spell.cpp:8703</a></div></div>
<div class="ttc" id="aclassSpell_html_a323570cf86a1b20a8e64a9db971cab8c"><div class="ttname"><a href="classSpell.html#a323570cf86a1b20a8e64a9db971cab8c">Spell::handle_immediate</a></div><div class="ttdeci">void handle_immediate()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03817">Spell.cpp:3817</a></div></div>
<div class="ttc" id="aclassSpell_html_a3244e8c8f24aa8fdaec7b236a9532724"><div class="ttname"><a href="classSpell.html#a3244e8c8f24aa8fdaec7b236a9532724">Spell::SendSpellGo</a></div><div class="ttdeci">void SendSpellGo()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04545">Spell.cpp:4545</a></div></div>
<div class="ttc" id="aclassSpell_html_a3255c4ac70b615c4bbb9f77305038ac0"><div class="ttname"><a href="classSpell.html#a3255c4ac70b615c4bbb9f77305038ac0">Spell::damagePerEffect</a></div><div class="ttdeci">int32 damagePerEffect[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00969">Spell.h:969</a></div></div>
<div class="ttc" id="aclassSpell_html_a3265dd73fd4d1e72de3ca47f4a2e8b3f"><div class="ttname"><a href="classSpell.html#a3265dd73fd4d1e72de3ca47f4a2e8b3f">Spell::m_usedAuraCharges</a></div><div class="ttdeci">std::set&lt; SpellModifierPair &gt; m_usedAuraCharges</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00743">Spell.h:743</a></div></div>
<div class="ttc" id="aclassSpell_html_a3378c5e643dbbde893606505c42817b5"><div class="ttname"><a href="classSpell.html#a3378c5e643dbbde893606505c42817b5">Spell::IsAutoRepeat</a></div><div class="ttdeci">bool IsAutoRepeat() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00670">Spell.h:670</a></div></div>
<div class="ttc" id="aclassSpell_html_a33a3b5316aef596513c831765ece5cae"><div class="ttname"><a href="classSpell.html#a33a3b5316aef596513c831765ece5cae">Spell::m_effectTriggerChance</a></div><div class="ttdeci">int32 m_effectTriggerChance[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01049">Spell.h:1049</a></div></div>
<div class="ttc" id="aclassSpell_html_a33c6addb2f24e2bb07610004409c0686"><div class="ttname"><a href="classSpell.html#a33c6addb2f24e2bb07610004409c0686">Spell::damage</a></div><div class="ttdeci">int32 damage</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00961">Spell.h:961</a></div></div>
<div class="ttc" id="aclassSpell_html_a3708df24a12e888277bf67285487118e"><div class="ttname"><a href="classSpell.html#a3708df24a12e888277bf67285487118e">Spell::prepareDataForTriggerSystem</a></div><div class="ttdeci">void prepareDataForTriggerSystem()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00857">Spell.cpp:857</a></div></div>
<div class="ttc" id="aclassSpell_html_a389780258153b86d112f9628100d419a"><div class="ttname"><a href="classSpell.html#a389780258153b86d112f9628100d419a">Spell::IsAliveUnitPresentInTargetList</a></div><div class="ttdeci">bool IsAliveUnitPresentInTargetList()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01817">Spell.cpp:1817</a></div></div>
<div class="ttc" id="aclassSpell_html_a39bddfec4b1d97d380972515a7d26314"><div class="ttname"><a href="classSpell.html#a39bddfec4b1d97d380972515a7d26314">Spell::TakeReagents</a></div><div class="ttdeci">void TakeReagents()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05261">Spell.cpp:5261</a></div></div>
<div class="ttc" id="aclassSpell_html_a3a4197aaeee37c45d2d5bcd915475f1e"><div class="ttname"><a href="classSpell.html#a3a4197aaeee37c45d2d5bcd915475f1e">Spell::GetPrefilledUnitTargetOrUnitTarget</a></div><div class="ttdeci">Unit * GetPrefilledUnitTargetOrUnitTarget(SpellEffectIndex effIndex) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05487">Spell.cpp:5487</a></div></div>
<div class="ttc" id="aclassSpell_html_a3ae4f6a6ff1cf1d52d5e2dce4bcd43fa"><div class="ttname"><a href="classSpell.html#a3ae4f6a6ff1cf1d52d5e2dce4bcd43fa">Spell::m_ignoreConcurrentCasts</a></div><div class="ttdeci">bool m_ignoreConcurrentCasts</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00656">Spell.h:656</a></div></div>
<div class="ttc" id="aclassSpell_html_a3ae62069047a5c7606f932e95d144562"><div class="ttname"><a href="classSpell.html#a3ae62069047a5c7606f932e95d144562">Spell::OnSuccessfulStart</a></div><div class="ttdeci">void OnSuccessfulStart()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09428">Spell.cpp:9428</a></div></div>
<div class="ttc" id="aclassSpell_html_a3b98230b66cde204babd4bf0f3a73789"><div class="ttname"><a href="classSpell.html#a3b98230b66cde204babd4bf0f3a73789">Spell::CheckPower</a></div><div class="ttdeci">SpellCastResult CheckPower(bool strict)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07588">Spell.cpp:7588</a></div></div>
<div class="ttc" id="aclassSpell_html_a3baff69e3d6bff9c02248e290cfb2e30"><div class="ttname"><a href="classSpell.html#a3baff69e3d6bff9c02248e290cfb2e30">Spell::OnCast</a></div><div class="ttdeci">void OnCast()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09886">Spell.cpp:9886</a></div></div>
<div class="ttc" id="aclassSpell_html_a3bcd646cc44a9b80aa804f984c289cf3"><div class="ttname"><a href="classSpell.html#a3bcd646cc44a9b80aa804f984c289cf3">Spell::GetCaster</a></div><div class="ttdeci">Unit * GetCaster() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00714">Spell.h:714</a></div></div>
<div class="ttc" id="aclassSpell_html_a3ca8244d8c6cdc28ca9e8af8553e168f"><div class="ttname"><a href="classSpell.html#a3ca8244d8c6cdc28ca9e8af8553e168f">Spell::m_negativeEffectMask</a></div><div class="ttdeci">uint8 m_negativeEffectMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00979">Spell.h:979</a></div></div>
<div class="ttc" id="aclassSpell_html_a3e313035ac36249f3be6bab84b9e6863"><div class="ttname"><a href="classSpell.html#a3e313035ac36249f3be6bab84b9e6863">Spell::m_spellInfo</a></div><div class="ttdeci">SpellEntry const  * m_spellInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00636">Spell.h:636</a></div></div>
<div class="ttc" id="aclassSpell_html_a3ed06c7cdee02042bd42e23a21733bdd"><div class="ttname"><a href="classSpell.html#a3ed06c7cdee02042bd42e23a21733bdd">Spell::IsNeedSendToClient</a></div><div class="ttdeci">bool IsNeedSendToClient() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08447">Spell.cpp:8447</a></div></div>
<div class="ttc" id="aclassSpell_html_a3fa9f05760646da14b7d71ad748d0447"><div class="ttname"><a href="classSpell.html#a3fa9f05760646da14b7d71ad748d0447">Spell::RegisterAuraProc</a></div><div class="ttdeci">void RegisterAuraProc(Aura *aura)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08926">Spell.cpp:8926</a></div></div>
<div class="ttc" id="aclassSpell_html_a45908b2e73c10613e29719e547d527b6"><div class="ttname"><a href="classSpell.html#a45908b2e73c10613e29719e547d527b6">Spell::GetTriggeredByAuraSpellInfo</a></div><div class="ttdeci">SpellEntry const  * GetTriggeredByAuraSpellInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00708">Spell.h:708</a></div></div>
<div class="ttc" id="aclassSpell_html_a4678d2bf3013f3bef4c29e6b11245b3c"><div class="ttname"><a href="classSpell.html#a4678d2bf3013f3bef4c29e6b11245b3c">Spell::_handle_finish_phase</a></div><div class="ttdeci">void _handle_finish_phase()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03959">Spell.cpp:3959</a></div></div>
<div class="ttc" id="aclassSpell_html_a46b8816abad5c0aae8a298a8bec372b7"><div class="ttname"><a href="classSpell.html#a46b8816abad5c0aae8a298a8bec372b7">Spell::CalculateSpellEffectValue</a></div><div class="ttdeci">int32 CalculateSpellEffectValue(SpellEffectIndex i, Unit *target, bool maximum=false, bool finalUse=true)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00570">Spell.h:570</a></div></div>
<div class="ttc" id="aclassSpell_html_a477d202997ee1650e937c3b6804f93e1"><div class="ttname"><a href="classSpell.html#a477d202997ee1650e937c3b6804f93e1">Spell::IsMeleeAttackResetSpell</a></div><div class="ttdeci">bool IsMeleeAttackResetSpell() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00691">Spell.h:691</a></div></div>
<div class="ttc" id="aclassSpell_html_a48371fc36b56594c7ec8df04292b195b"><div class="ttname"><a href="classSpell.html#a48371fc36b56594c7ec8df04292b195b">Spell::SetExecutedCurrently</a></div><div class="ttdeci">void SetExecutedCurrently(bool yes)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00697">Spell.h:697</a></div></div>
<div class="ttc" id="aclassSpell_html_a4986ebfcda20fa5c4f3e3eb369879f34"><div class="ttname"><a href="classSpell.html#a4986ebfcda20fa5c4f3e3eb369879f34">Spell::OnCheckTarget</a></div><div class="ttdeci">bool OnCheckTarget(GameObject *target, SpellEffectIndex eff) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09591">Spell.cpp:9591</a></div></div>
<div class="ttc" id="aclassSpell_html_a49eda4ec0b6d63e0a4f54b67aff5549b"><div class="ttname"><a href="classSpell.html#a49eda4ec0b6d63e0a4f54b67aff5549b">Spell::SetSpellStartTravelling</a></div><div class="ttdeci">void SetSpellStartTravelling(uint32 time)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00702">Spell.h:702</a></div></div>
<div class="ttc" id="aclassSpell_html_a4aeb2f8c87142d7dc0a88f89b41eedad"><div class="ttname"><a href="classSpell.html#a4aeb2f8c87142d7dc0a88f89b41eedad">Spell::CheckVehicle</a></div><div class="ttdeci">static SpellCastResult CheckVehicle(Unit const *caster, SpellEntry const &amp;spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09950">Spell.cpp:9950</a></div></div>
<div class="ttc" id="aclassSpell_html_a4af287958e9bb23bebda37a5c7d72ee6"><div class="ttname"><a href="classSpell.html#a4af287958e9bb23bebda37a5c7d72ee6">Spell::m_travellingStart</a></div><div class="ttdeci">uint32 m_travellingStart</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00946">Spell.h:946</a></div></div>
<div class="ttc" id="aclassSpell_html_a4b89533356cf0fe417a3e646c30e5a04"><div class="ttname"><a href="classSpell.html#a4b89533356cf0fe417a3e646c30e5a04">Spell::m_delayAtDamageCount</a></div><div class="ttdeci">uint8 m_delayAtDamageCount</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00933">Spell.h:933</a></div></div>
<div class="ttc" id="aclassSpell_html_a4ba53019f02abcaff8db6e21aaf4a78e"><div class="ttname"><a href="classSpell.html#a4ba53019f02abcaff8db6e21aaf4a78e">Spell::m_UniqueItemInfo</a></div><div class="ttdeci">ItemTargetList m_UniqueItemInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01009">Spell.h:1009</a></div></div>
<div class="ttc" id="aclassSpell_html_a4cc21b731b4fa349649e5cf4f895b266"><div class="ttname"><a href="classSpell.html#a4cc21b731b4fa349649e5cf4f895b266">Spell::FillRaidOrPartyHealthPriorityTargets</a></div><div class="ttdeci">void FillRaidOrPartyHealthPriorityTargets(UnitList &amp;targetUnitMap, Unit *member, Unit *center, float radius, uint32 count, bool raid, bool withPets, bool withCaster)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08752">Spell.cpp:8752</a></div></div>
<div class="ttc" id="aclassSpell_html_a4d19acd2e823d1a1c47eab609393fc53"><div class="ttname"><a href="classSpell.html#a4d19acd2e823d1a1c47eab609393fc53">Spell::CheckSpellScriptTargets</a></div><div class="ttdeci">static void CheckSpellScriptTargets(SQLMultiStorage::SQLMSIteratorBounds&lt; SpellTargetEntry &gt; &amp;bounds, UnitList &amp;tempTargetUnitMap, UnitList &amp;targetUnitMap, SpellEffectIndex effIndex)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03231">Spell.cpp:3231</a></div></div>
<div class="ttc" id="aclassSpell_html_a4d820016ef9a87e1742734b8d7b45dfa"><div class="ttname"><a href="classSpell.html#a4d820016ef9a87e1742734b8d7b45dfa">Spell::IsSpellRequiringAmmo</a></div><div class="ttdeci">bool IsSpellRequiringAmmo() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00677">Spell.h:677</a></div></div>
<div class="ttc" id="aclassSpell_html_a4eefd51eef23ff7d5914b6c041fab41d"><div class="ttname"><a href="classSpell.html#a4eefd51eef23ff7d5914b6c041fab41d">Spell::m_UniqueGOTargetInfo</a></div><div class="ttdeci">GOTargetList m_UniqueGOTargetInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01008">Spell.h:1008</a></div></div>
<div class="ttc" id="aclassSpell_html_a4f8c2ec4d79161f96c94196e2628e15b"><div class="ttname"><a href="classSpell.html#a4f8c2ec4d79161f96c94196e2628e15b">Spell::OnRadiusCalculate</a></div><div class="ttdeci">void OnRadiusCalculate(SpellEffectIndex effIndex, bool targetB, float &amp;radius)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09579">Spell.cpp:9579</a></div></div>
<div class="ttc" id="aclassSpell_html_a4fd1b8c716c40489fbb4e4b57290d410"><div class="ttname"><a href="classSpell.html#a4fd1b8c716c40489fbb4e4b57290d410">Spell::CheckSpellCancelsConfuse</a></div><div class="ttdeci">bool CheckSpellCancelsConfuse(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07323">Spell.cpp:7323</a></div></div>
<div class="ttc" id="aclassSpell_html_a5003eeaba08c841f12b72a3010420eec"><div class="ttname"><a href="classSpell.html#a5003eeaba08c841f12b72a3010420eec">Spell::IsDelayedSpell</a></div><div class="ttdeci">bool IsDelayedSpell() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08799">Spell.cpp:8799</a></div></div>
<div class="ttc" id="aclassSpell_html_a504753412a8af2e23f05313bbb5b6e66"><div class="ttname"><a href="classSpell.html#a504753412a8af2e23f05313bbb5b6e66">Spell::m_delayMoment</a></div><div class="ttdeci">uint64 m_delayMoment</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00945">Spell.h:945</a></div></div>
<div class="ttc" id="aclassSpell_html_a50a90dcb7f36854aff094c5b4fe45aa0"><div class="ttname"><a href="classSpell.html#a50a90dcb7f36854aff094c5b4fe45aa0">Spell::GetCastingObject</a></div><div class="ttdeci">WorldObject * GetCastingObject() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08774">Spell.cpp:8774</a></div></div>
<div class="ttc" id="aclassSpell_html_a516f3d4404f0ca2010d21d8c64d478ee"><div class="ttname"><a href="classSpell.html#a516f3d4404f0ca2010d21d8c64d478ee">Spell::CheckItems</a></div><div class="ttdeci">SpellCastResult CheckItems()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07661">Spell.cpp:7661</a></div></div>
<div class="ttc" id="aclassSpell_html_a52c455dff0b1da39744da634d9f6be8d"><div class="ttname"><a href="classSpell.html#a52c455dff0b1da39744da634d9f6be8d">Spell::GetAffectiveCaster</a></div><div class="ttdeci">Unit * GetAffectiveCaster() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00718">Spell.h:718</a></div></div>
<div class="ttc" id="aclassSpell_html_a538a5dba7f22c362a76d40252ae3dfd1"><div class="ttname"><a href="classSpell.html#a538a5dba7f22c362a76d40252ae3dfd1">Spell::m_attackType</a></div><div class="ttdeci">WeaponAttackType m_attackType</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00922">Spell.h:922</a></div></div>
<div class="ttc" id="aclassSpell_html_a5467441e13fb75e103e32f4975528c41"><div class="ttname"><a href="classSpell.html#a5467441e13fb75e103e32f4975528c41">Spell::m_UniqueTargetInfo</a></div><div class="ttdeci">TargetList m_UniqueTargetInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01007">Spell.h:1007</a></div></div>
<div class="ttc" id="aclassSpell_html_a564ed70ad4ac1567e58df40f8b8dd151"><div class="ttname"><a href="classSpell.html#a564ed70ad4ac1567e58df40f8b8dd151">Spell::AddTriggeredSpell</a></div><div class="ttdeci">void AddTriggeredSpell(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00730">Spell.h:730</a></div></div>
<div class="ttc" id="aclassSpell_html_a566fd7627f0840d8a2cc69fbdc9d4c25"><div class="ttname"><a href="classSpell.html#a566fd7627f0840d8a2cc69fbdc9d4c25">Spell::m_creationTime</a></div><div class="ttdeci">uint32 m_creationTime</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01053">Spell.h:1053</a></div></div>
<div class="ttc" id="aclassSpell_html_a57f1e6a4a1de4ae2f42961b618aa0aa1"><div class="ttname"><a href="classSpell.html#a57f1e6a4a1de4ae2f42961b618aa0aa1">Spell::PrepareMasksForProcSystem</a></div><div class="ttdeci">void PrepareMasksForProcSystem(uint8 effectMask, uint32 &amp;procAttacker, uint32 &amp;procVictim, WorldObject *caster, WorldObject *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00879">Spell.cpp:879</a></div></div>
<div class="ttc" id="aclassSpell_html_a587554773427224df51cbce7a50b9d2c"><div class="ttname"><a href="classSpell.html#a587554773427224df51cbce7a50b9d2c">Spell::m_spellState</a></div><div class="ttdeci">uint32 m_spellState</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01051">Spell.h:1051</a></div></div>
<div class="ttc" id="aclassSpell_html_a5b4dffb90b14a8a2eb8382827fad0f94"><div class="ttname"><a href="classSpell.html#a5b4dffb90b14a8a2eb8382827fad0f94">Spell::GetSpellSpeed</a></div><div class="ttdeci">float GetSpellSpeed() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08786">Spell.cpp:8786</a></div></div>
<div class="ttc" id="aclassSpell_html_a5b4ebeb10ad576a529d0556064930297"><div class="ttname"><a href="classSpell.html#a5b4ebeb10ad576a529d0556064930297">Spell::m_originalCasterGUID</a></div><div class="ttdeci">ObjectGuid m_originalCasterGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00916">Spell.h:916</a></div></div>
<div class="ttc" id="aclassSpell_html_a5df90e7aa2cdd206ade4afdacdf679c0"><div class="ttname"><a href="classSpell.html#a5df90e7aa2cdd206ade4afdacdf679c0">Spell::m_ignoreRoot</a></div><div class="ttdeci">bool m_ignoreRoot</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00665">Spell.h:665</a></div></div>
<div class="ttc" id="aclassSpell_html_a5e4e64d34f282231e10ec16596700432"><div class="ttname"><a href="classSpell.html#a5e4e64d34f282231e10ec16596700432">Spell::m_castPositionZ</a></div><div class="ttdeci">float m_castPositionZ</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01058">Spell.h:1058</a></div></div>
<div class="ttc" id="aclassSpell_html_a5fd7b2fa3f7559c425c367852e187846"><div class="ttname"><a href="classSpell.html#a5fd7b2fa3f7559c425c367852e187846">Spell::GetCastTime</a></div><div class="ttdeci">int32 GetCastTime() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00668">Spell.h:668</a></div></div>
<div class="ttc" id="aclassSpell_html_a6032f8f164df1d6fc2607e4ca5c35ce5"><div class="ttname"><a href="classSpell.html#a6032f8f164df1d6fc2607e4ca5c35ce5">Spell::IsDeletable</a></div><div class="ttdeci">bool IsDeletable() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00695">Spell.h:695</a></div></div>
<div class="ttc" id="aclassSpell_html_a6128294a5ab1a765cc51d55c31edb3f4"><div class="ttname"><a href="classSpell.html#a6128294a5ab1a765cc51d55c31edb3f4">Spell::CleanupTargetList</a></div><div class="ttdeci">void CleanupTargetList()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00965">Spell.cpp:965</a></div></div>
<div class="ttc" id="aclassSpell_html_a61b0b397250bb79024c8657e28323879"><div class="ttname"><a href="classSpell.html#a61b0b397250bb79024c8657e28323879">Spell::m_casttime</a></div><div class="ttdeci">int32 m_casttime</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00924">Spell.h:924</a></div></div>
<div class="ttc" id="aclassSpell_html_a626975cd2349dcc40c11fac67440f6df"><div class="ttname"><a href="classSpell.html#a626975cd2349dcc40c11fac67440f6df">Spell::Prepare</a></div><div class="ttdeci">void Prepare()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03342">Spell.cpp:3342</a></div></div>
<div class="ttc" id="aclassSpell_html_a642a91a2145c8f2f87024110fe93d036"><div class="ttname"><a href="classSpell.html#a642a91a2145c8f2f87024110fe93d036">Spell::m_spellEvent</a></div><div class="ttdeci">SpellEvent * m_spellEvent</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01082">Spell.h:1082</a></div></div>
<div class="ttc" id="aclassSpell_html_a654c6400b8537dd520231fe998080855"><div class="ttname"><a href="classSpell.html#a654c6400b8537dd520231fe998080855">Spell::m_param2</a></div><div class="ttdeci">uint32 m_param2</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01090">Spell.h:1090</a></div></div>
<div class="ttc" id="aclassSpell_html_a657688194c718b1e193bfa0b9caac645"><div class="ttname"><a href="classSpell.html#a657688194c718b1e193bfa0b9caac645">Spell::m_canTrigger</a></div><div class="ttdeci">bool m_canTrigger</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00978">Spell.h:978</a></div></div>
<div class="ttc" id="aclassSpell_html_a65a4dec4a0f7978e9d70e204c81336aa"><div class="ttname"><a href="classSpell.html#a65a4dec4a0f7978e9d70e204c81336aa">Spell::FillFromTargetFlags</a></div><div class="ttdeci">void FillFromTargetFlags(TempTargetingData &amp;targetingData, SpellEffectIndex effIndex)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09353">Spell.cpp:9353</a></div></div>
<div class="ttc" id="aclassSpell_html_a6634a11a4bb1806304a33e3bc10b7c28"><div class="ttname"><a href="classSpell.html#a6634a11a4bb1806304a33e3bc10b7c28">Spell::itemTarget</a></div><div class="ttdeci">Item * itemTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00957">Spell.h:957</a></div></div>
<div class="ttc" id="aclassSpell_html_a68b7071f7708ddf46cb20e2e76e414ad"><div class="ttname"><a href="classSpell.html#a68b7071f7708ddf46cb20e2e76e414ad">Spell::HandleThreatSpells</a></div><div class="ttdeci">void HandleThreatSpells()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05311">Spell.cpp:5311</a></div></div>
<div class="ttc" id="aclassSpell_html_a6997d5f606e25d2380de24ef96825257"><div class="ttname"><a href="classSpell.html#a6997d5f606e25d2380de24ef96825257">Spell::m_cast_count</a></div><div class="ttdeci">uint8 m_cast_count</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00639">Spell.h:639</a></div></div>
<div class="ttc" id="aclassSpell_html_a69d7714c4cbd81d3dbe8e16cc8cb74a3"><div class="ttname"><a href="classSpell.html#a69d7714c4cbd81d3dbe8e16cc8cb74a3">Spell::m_damage</a></div><div class="ttdeci">int32 m_damage</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00967">Spell.h:967</a></div></div>
<div class="ttc" id="aclassSpell_html_a6aedd6eccb2dc430c199cb5144c5e6f4"><div class="ttname"><a href="classSpell.html#a6aedd6eccb2dc430c199cb5144c5e6f4">Spell::m_resetLeash</a></div><div class="ttdeci">bool m_resetLeash</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00659">Spell.h:659</a></div></div>
<div class="ttc" id="aclassSpell_html_a6b2f1ff698d8d27a90461ed99fb51500"><div class="ttname"><a href="classSpell.html#a6b2f1ff698d8d27a90461ed99fb51500">Spell::TakeAmmo</a></div><div class="ttdeci">void TakeAmmo() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05223">Spell.cpp:5223</a></div></div>
<div class="ttc" id="aclassSpell_html_a6bd7f2b3578de307b5564396c4170b99"><div class="ttname"><a href="classSpell.html#a6bd7f2b3578de307b5564396c4170b99">Spell::CanSpellDiminish</a></div><div class="ttdeci">bool CanSpellDiminish() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01794">Spell.cpp:1794</a></div></div>
<div class="ttc" id="aclassSpell_html_a6c3094450c157ad61c00375270392d5c"><div class="ttname"><a href="classSpell.html#a6c3094450c157ad61c00375270392d5c">Spell::OnEffectExecute</a></div><div class="ttdeci">void OnEffectExecute(SpellEffectIndex effIndex)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09573">Spell.cpp:9573</a></div></div>
<div class="ttc" id="aclassSpell_html_a6f5ff9846deb35f126543a513a1eb0d7"><div class="ttname"><a href="classSpell.html#a6f5ff9846deb35f126543a513a1eb0d7">Spell::FilterTargetMap</a></div><div class="ttdeci">void FilterTargetMap(UnitList &amp;filterUnitList, SpellTargetFilterScheme scheme, uint32 chainTargetCount)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09162">Spell.cpp:9162</a></div></div>
<div class="ttc" id="aclassSpell_html_a6fbd0a36487bc7e0b088d044d667c4c1"><div class="ttname"><a href="classSpell.html#a6fbd0a36487bc7e0b088d044d667c4c1">Spell::m_damagePerEffect</a></div><div class="ttdeci">int32 m_damagePerEffect[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00970">Spell.h:970</a></div></div>
<div class="ttc" id="aclassSpell_html_a6fea183fab3cd5f8946923c3d8909f5a"><div class="ttname"><a href="classSpell.html#a6fea183fab3cd5f8946923c3d8909f5a">Spell::getState</a></div><div class="ttdeci">uint32 getState() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00578">Spell.h:578</a></div></div>
<div class="ttc" id="aclassSpell_html_a704340f3b83f142c160ec6bd60773386"><div class="ttname"><a href="classSpell.html#a704340f3b83f142c160ec6bd60773386">Spell::GetCone</a></div><div class="ttdeci">float GetCone()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09138">Spell.cpp:9138</a></div></div>
<div class="ttc" id="aclassSpell_html_a704cd4f425ebf48be2bed2fd22b22571"><div class="ttname"><a href="classSpell.html#a704cd4f425ebf48be2bed2fd22b22571">Spell::CastTriggerSpells</a></div><div class="ttdeci">void CastTriggerSpells()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05472">Spell.cpp:5472</a></div></div>
<div class="ttc" id="aclassSpell_html_a70b015d3289a781f9f7097e6581cadf5"><div class="ttname"><a href="classSpell.html#a70b015d3289a781f9f7097e6581cadf5">Spell::m_executedCurrently</a></div><div class="ttdeci">bool m_executedCurrently</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00950">Spell.h:950</a></div></div>
<div class="ttc" id="aclassSpell_html_a719bf842069982303be22a15c9794531"><div class="ttname"><a href="classSpell.html#a719bf842069982303be22a15c9794531">Spell::m_ignoreOwnerLevel</a></div><div class="ttdeci">bool m_ignoreOwnerLevel</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00666">Spell.h:666</a></div></div>
<div class="ttc" id="aclassSpell_html_a72d630ee8147b4197d46503dd2c9ed34"><div class="ttname"><a href="classSpell.html#a72d630ee8147b4197d46503dd2c9ed34">Spell::m_castPositionX</a></div><div class="ttdeci">float m_castPositionX</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01056">Spell.h:1056</a></div></div>
<div class="ttc" id="aclassSpell_html_a747ae7c3474dbad2d6a676c8e0d31cf3"><div class="ttname"><a href="classSpell.html#a747ae7c3474dbad2d6a676c8e0d31cf3">Spell::CanExecuteTriggersOnHit</a></div><div class="ttdeci">bool CanExecuteTriggersOnHit(uint8 effMask, SpellEntry const *triggeredByAura, bool auraTarget) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08810">Spell.cpp:8810</a></div></div>
<div class="ttc" id="aclassSpell_html_a76540a74641e4815f72a2c92dba1d32c"><div class="ttname"><a href="classSpell.html#a76540a74641e4815f72a2c92dba1d32c">Spell::SetTargetMap</a></div><div class="ttdeci">void SetTargetMap(SpellEffectIndex effIndex, uint32 targetMode, bool targetB, TempTargetingData &amp;targetingData)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01912">Spell.cpp:1912</a></div></div>
<div class="ttc" id="aclassSpell_html_a77286525a5c1dd28a09c9fc5f903f554"><div class="ttname"><a href="classSpell.html#a77286525a5c1dd28a09c9fc5f903f554">Spell::IsEffectWithImplementedMultiplier</a></div><div class="ttdeci">bool IsEffectWithImplementedMultiplier(uint32 effectId) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09386">Spell.cpp:9386</a></div></div>
<div class="ttc" id="aclassSpell_html_a775626fa420464863cbc05128381c5ba"><div class="ttname"><a href="classSpell.html#a775626fa420464863cbc05128381c5ba">Spell::m_damageMultipliers</a></div><div class="ttdeci">float m_damageMultipliers[3]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00953">Spell.h:953</a></div></div>
<div class="ttc" id="aclassSpell_html_a796b5e725da29b9ce14918bd8f671a1e"><div class="ttname"><a href="classSpell.html#a796b5e725da29b9ce14918bd8f671a1e">Spell::AddItemTarget</a></div><div class="ttdeci">void AddItemTarget(Item *item, uint8 effectMask)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01229">Spell.cpp:1229</a></div></div>
<div class="ttc" id="aclassSpell_html_a7a1b42fb496a662f928a3f3f2e738bcc"><div class="ttname"><a href="classSpell.html#a7a1b42fb496a662f928a3f3f2e738bcc">Spell::m_castPositionY</a></div><div class="ttdeci">float m_castPositionY</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01057">Spell.h:1057</a></div></div>
<div class="ttc" id="aclassSpell_html_a7a47bc93770ce6f8ce6e9366bf5de5d6"><div class="ttname"><a href="classSpell.html#a7a47bc93770ce6f8ce6e9366bf5de5d6">Spell::HandleEffect</a></div><div class="ttdeci">void HandleEffect(Unit *unitTarget, Item *itemTarget, GameObject *GOTarget, SpellEffectIndex effIdx, float damageMultiplier=1.0)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05399">Spell.cpp:5399</a></div></div>
<div class="ttc" id="aclassSpell_html_a7b886ab94bb32bd1d8261a34e2b07241"><div class="ttname"><a href="classSpell.html#a7b886ab94bb32bd1d8261a34e2b07241">Spell::FillUnitTargets</a></div><div class="ttdeci">bool FillUnitTargets(TempTargetingData &amp;targetingData, SpellTargetingData &amp;data, uint32 i)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00794">Spell.cpp:794</a></div></div>
<div class="ttc" id="aclassSpell_html_a7bdeaabf8fa127e4269e683c2bd76499"><div class="ttname"><a href="classSpell.html#a7bdeaabf8fa127e4269e683c2bd76499">Spell::m_castOrientation</a></div><div class="ttdeci">float m_castOrientation</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01059">Spell.h:1059</a></div></div>
<div class="ttc" id="aclassSpell_html_a7d4e1605d2b58a6614b2fe5db9a96e95"><div class="ttname"><a href="classSpell.html#a7d4e1605d2b58a6614b2fe5db9a96e95">Spell::AddUnitTarget</a></div><div class="ttdeci">void AddUnitTarget(Unit *target, uint8 effectMask, CheckException exception=EXCEPTION_NONE)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00973">Spell.cpp:973</a></div></div>
<div class="ttc" id="aclassSpell_html_a7da231eced52ed2408fd513a0668d5bc"><div class="ttname"><a href="classSpell.html#a7da231eced52ed2408fd513a0668d5bc">Spell::m_procOnceHolder</a></div><div class="ttdeci">std::set&lt; Aura * &gt; m_procOnceHolder</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01066">Spell.h:1066</a></div></div>
<div class="ttc" id="aclassSpell_html_a7e2f06d9f8d074db174bce10f2c5165e"><div class="ttname"><a href="classSpell.html#a7e2f06d9f8d074db174bce10f2c5165e">Spell::_handle_immediate_phase</a></div><div class="ttdeci">void _handle_immediate_phase()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03901">Spell.cpp:3901</a></div></div>
<div class="ttc" id="aclassSpell_html_a7e93f29ca09727fabcd6d4445029ca4a"><div class="ttname"><a href="classSpell.html#a7e93f29ca09727fabcd6d4445029ca4a">Spell::SendSpellCooldown</a></div><div class="ttdeci">void SendSpellCooldown()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04010">Spell.cpp:4010</a></div></div>
<div class="ttc" id="aclassSpell_html_a80a8c95f25b8275f1d2b50a8155dd52e"><div class="ttname"><a href="classSpell.html#a80a8c95f25b8275f1d2b50a8155dd52e">Spell::CheckTargetCreatureType</a></div><div class="ttdeci">static bool CheckTargetCreatureType(Unit *target, SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08249">Spell.cpp:8249</a></div></div>
<div class="ttc" id="aclassSpell_html_a80d021c71f13bcf84ed30fdf87a62031"><div class="ttname"><a href="classSpell.html#a80d021c71f13bcf84ed30fdf87a62031">Spell::PreCastCheck</a></div><div class="ttdeci">SpellCastResult PreCastCheck(Aura *triggeredByAura=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03289">Spell.cpp:3289</a></div></div>
<div class="ttc" id="aclassSpell_html_a8159f0f9fef838bc5f506d3e6950e71c"><div class="ttname"><a href="classSpell.html#a8159f0f9fef838bc5f506d3e6950e71c">Spell::m_itemCastSpell</a></div><div class="ttdeci">bool m_itemCastSpell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00913">Spell.h:913</a></div></div>
<div class="ttc" id="aclassSpell_html_a840b081d5abbcaeda47b522fbdd36e62"><div class="ttname"><a href="classSpell.html#a840b081d5abbcaeda47b522fbdd36e62">Spell::m_ignoreCastTime</a></div><div class="ttdeci">bool m_ignoreCastTime</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00646">Spell.h:646</a></div></div>
<div class="ttc" id="aclassSpell_html_a84132b0daaea7cd01095c64dce0ab385"><div class="ttname"><a href="classSpell.html#a84132b0daaea7cd01095c64dce0ab385">Spell::SendSpellStart</a></div><div class="ttdeci">void SendSpellStart() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04481">Spell.cpp:4481</a></div></div>
<div class="ttc" id="aclassSpell_html_a8425d18c430e7f6f47cc66f8576b62df"><div class="ttname"><a href="classSpell.html#a8425d18c430e7f6f47cc66f8576b62df">Spell::m_notifyAI</a></div><div class="ttdeci">bool m_notifyAI</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00652">Spell.h:652</a></div></div>
<div class="ttc" id="aclassSpell_html_a84f13461f1f94ff882b111cd926b0b23"><div class="ttname"><a href="classSpell.html#a84f13461f1f94ff882b111cd926b0b23">Spell::m_caster</a></div><div class="ttdeci">Unit * m_caster</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00911">Spell.h:911</a></div></div>
<div class="ttc" id="aclassSpell_html_a8595ca62f33802afbbc63c35448ec52e"><div class="ttname"><a href="classSpell.html#a8595ca62f33802afbbc63c35448ec52e">Spell::GetAffectiveCasterObject</a></div><div class="ttdeci">WorldObject * GetAffectiveCasterObject() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08757">Spell.cpp:8757</a></div></div>
<div class="ttc" id="aclassSpell_html_a86aa78d62024c54252d387e9e230878c"><div class="ttname"><a href="classSpell.html#a86aa78d62024c54252d387e9e230878c">Spell::m_ignoreUnselectableTarget</a></div><div class="ttdeci">bool m_ignoreUnselectableTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00647">Spell.h:647</a></div></div>
<div class="ttc" id="aclassSpell_html_a8894a2448ad80db750cad4d2a3912641"><div class="ttname"><a href="classSpell.html#a8894a2448ad80db750cad4d2a3912641">Spell::GetPhaseMaskOverride</a></div><div class="ttdeci">uint32 GetPhaseMaskOverride()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09916">Spell.cpp:9916</a></div></div>
<div class="ttc" id="aclassSpell_html_a8b9ac3ab5007aba016972ab1e2e0d12c"><div class="ttname"><a href="classSpell.html#a8b9ac3ab5007aba016972ab1e2e0d12c">Spell::FillRaidOrPartyManaPriorityTargets</a></div><div class="ttdeci">void FillRaidOrPartyManaPriorityTargets(UnitList &amp;targetUnitMap, Unit *member, Unit *center, float radius, uint32 count, bool raid, bool withPets, bool withCaster)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08747">Spell.cpp:8747</a></div></div>
<div class="ttc" id="aclassSpell_html_a8de51903353a2351a520711b9b9a187f"><div class="ttname"><a href="classSpell.html#a8de51903353a2351a520711b9b9a187f">Spell::m_spellFlags</a></div><div class="ttdeci">uint8 m_spellFlags</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00927">Spell.h:927</a></div></div>
<div class="ttc" id="aclassSpell_html_a8de82de2d1fc29d0874f2ad183f8f2a7"><div class="ttname"><a href="classSpell.html#a8de82de2d1fc29d0874f2ad183f8f2a7">Spell::HaveTargetsForEffect</a></div><div class="ttdeci">bool HaveTargetsForEffect(SpellEffectIndex effect) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08464">Spell.cpp:8464</a></div></div>
<div class="ttc" id="aclassSpell_html_a8e022f35193d932a94db798657f2328a"><div class="ttname"><a href="classSpell.html#a8e022f35193d932a94db798657f2328a">Spell::GetSpellScript</a></div><div class="ttdeci">SpellScript * GetSpellScript() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00834">Spell.h:834</a></div></div>
<div class="ttc" id="aclassSpell_html_a90f0bd6624e63ad55052e7974f7c7cdf"><div class="ttname"><a href="classSpell.html#a90f0bd6624e63ad55052e7974f7c7cdf">Spell::CheckTarget</a></div><div class="ttdeci">bool CheckTarget(Unit *target, SpellEffectIndex eff, bool targetB, CheckException exception=EXCEPTION_NONE) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08277">Spell.cpp:8277</a></div></div>
<div class="ttc" id="aclassSpell_html_a92c4c13e99061c50fcc9eccef232e0c8"><div class="ttname"><a href="classSpell.html#a92c4c13e99061c50fcc9eccef232e0c8">Spell::SetCastItem</a></div><div class="ttdeci">void SetCastItem(Item *item)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04003">Spell.cpp:4003</a></div></div>
<div class="ttc" id="aclassSpell_html_a947de48edc8fd21483f27a59e9ffcb35"><div class="ttname"><a href="classSpell.html#a947de48edc8fd21483f27a59e9ffcb35">Spell::m_healing</a></div><div class="ttdeci">int32 m_healing</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00971">Spell.h:971</a></div></div>
<div class="ttc" id="aclassSpell_html_a9561e3f1de1cc6181818781b26fc1335"><div class="ttname"><a href="classSpell.html#a9561e3f1de1cc6181818781b26fc1335">Spell::SetOverridenSpeed</a></div><div class="ttdeci">void SetOverridenSpeed(float newSpeed)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09416">Spell.cpp:9416</a></div></div>
<div class="ttc" id="aclassSpell_html_a9572cd3b12252c7c177b0f6151a1c57b"><div class="ttname"><a href="classSpell.html#a9572cd3b12252c7c177b0f6151a1c57b">Spell::SetDelayStart</a></div><div class="ttdeci">void SetDelayStart(uint64 m_time)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00700">Spell.h:700</a></div></div>
<div class="ttc" id="aclassSpell_html_a95aee0efa022cac01f221d3435736f38"><div class="ttname"><a href="classSpell.html#a95aee0efa022cac01f221d3435736f38">Spell::m_doNotProc</a></div><div class="ttdeci">bool m_doNotProc</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00650">Spell.h:650</a></div></div>
<div class="ttc" id="aclassSpell_html_a95c30c2702c0b125c21ab71bdf9ba743"><div class="ttname"><a href="classSpell.html#a95c30c2702c0b125c21ab71bdf9ba743">Spell::CalculatePowerCost</a></div><div class="ttdeci">static uint32 CalculatePowerCost(SpellEntry const *spellInfo, Unit *caster, Spell *spell=nullptr, Item *castItem=nullptr, bool finalUse=false)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07514">Spell.cpp:7514</a></div></div>
<div class="ttc" id="aclassSpell_html_a97631df87d99fcf61c1eba094122ff76"><div class="ttname"><a href="classSpell.html#a97631df87d99fcf61c1eba094122ff76">Spell::m_glyphIndex</a></div><div class="ttdeci">uint32 m_glyphIndex</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00640">Spell.h:640</a></div></div>
<div class="ttc" id="aclassSpell_html_a978925571c86e6661d55b69cb93b95b8"><div class="ttname"><a href="classSpell.html#a978925571c86e6661d55b69cb93b95b8">Spell::FillAreaTargets</a></div><div class="ttdeci">void FillAreaTargets(UnitList &amp;targetUnitMap, float radius, float cone, SpellNotifyPushType pushType, SpellTargets spellTargets, WorldObject *originalCaster=nullptr)</div><div class="ttdoc">Fill target list by units around (x,y) points at radius distance.</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08697">Spell.cpp:8697</a></div></div>
<div class="ttc" id="aclassSpell_html_a98e6d38fef38925272ed77fae54903b2"><div class="ttname"><a href="classSpell.html#a98e6d38fef38925272ed77fae54903b2">Spell::handle_delayed</a></div><div class="ttdeci">uint64 handle_delayed(uint64 t_offset)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03838">Spell.cpp:3838</a></div></div>
<div class="ttc" id="aclassSpell_html_a99fe4ec78e157666a7fefdb8fce5342b"><div class="ttname"><a href="classSpell.html#a99fe4ec78e157666a7fefdb8fce5342b">Spell::GetOldRuneState</a></div><div class="ttdeci">uint8 GetOldRuneState() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00881">Spell.h:881</a></div></div>
<div class="ttc" id="aclassSpell_html_a9b11d1180294970c027d069197dd57c7"><div class="ttname"><a href="classSpell.html#a9b11d1180294970c027d069197dd57c7">Spell::m_hideInCombatLog</a></div><div class="ttdeci">bool m_hideInCombatLog</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00658">Spell.h:658</a></div></div>
<div class="ttc" id="aclassSpell_html_a9b65eb8aa8619909c395167731696193"><div class="ttname"><a href="classSpell.html#a9b65eb8aa8619909c395167731696193">Spell::m_spellScript</a></div><div class="ttdeci">SpellScript * m_spellScript</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01047">Spell.h:1047</a></div></div>
<div class="ttc" id="aclassSpell_html_a9bbf21780bd930bcb9855935743bec2f"><div class="ttname"><a href="classSpell.html#a9bbf21780bd930bcb9855935743bec2f">Spell::m_updated</a></div><div class="ttdeci">bool m_updated</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01054">Spell.h:1054</a></div></div>
<div class="ttc" id="aclassSpell_html_a9bc6be667fcb649021e8c4b8d6a0cc1f"><div class="ttname"><a href="classSpell.html#a9bc6be667fcb649021e8c4b8d6a0cc1f">Spell::m_preCastSpells</a></div><div class="ttdeci">SpellInfoList m_preCastSpells</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01043">Spell.h:1043</a></div></div>
<div class="ttc" id="aclassSpell_html_a9ce48dbc3b6abee433f9bf1dc97b29a6"><div class="ttname"><a href="classSpell.html#a9ce48dbc3b6abee433f9bf1dc97b29a6">Spell::GetCurrentContainer</a></div><div class="ttdeci">CurrentSpellTypes GetCurrentContainer() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08266">Spell.cpp:8266</a></div></div>
<div class="ttc" id="aclassSpell_html_aa07f3acb2d2da2ebf812fd54b06d42bf"><div class="ttname"><a href="classSpell.html#aa07f3acb2d2da2ebf812fd54b06d42bf">Spell::m_affectedTargetCount</a></div><div class="ttdeci">uint32 m_affectedTargetCount</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01061">Spell.h:1061</a></div></div>
<div class="ttc" id="aclassSpell_html_aa160274138dbebf153c189d8f4cdb59c"><div class="ttname"><a href="classSpell.html#aa160274138dbebf153c189d8f4cdb59c">Spell::unitTarget</a></div><div class="ttdeci">Unit * unitTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00956">Spell.h:956</a></div></div>
<div class="ttc" id="aclassSpell_html_aa19f9a8629e5ff119c87c8308c8d08d6"><div class="ttname"><a href="classSpell.html#aa19f9a8629e5ff119c87c8308c8d08d6">Spell::Delayed</a></div><div class="ttdeci">void Delayed()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08134">Spell.cpp:8134</a></div></div>
<div class="ttc" id="aclassSpell_html_aa1e44566b72ceb6915fc6ea3d2f92f26"><div class="ttname"><a href="classSpell.html#aa1e44566b72ceb6915fc6ea3d2f92f26">Spell::m_runesStateAfterCast</a></div><div class="ttdeci">uint8 m_runesStateAfterCast</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00931">Spell.h:931</a></div></div>
<div class="ttc" id="aclassSpell_html_aa1eef1b2b1d1aec52584b95b9217b6fa"><div class="ttname"><a href="classSpell.html#aa1eef1b2b1d1aec52584b95b9217b6fa">Spell::m_spellSchoolMask</a></div><div class="ttdeci">SpellSchoolMask m_spellSchoolMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00921">Spell.h:921</a></div></div>
<div class="ttc" id="aclassSpell_html_aa26b218c5d3d4b1e5ff494b2806641f2"><div class="ttname"><a href="classSpell.html#aa26b218c5d3d4b1e5ff494b2806641f2">Spell::IsAuraProcced</a></div><div class="ttdeci">bool IsAuraProcced(Aura *aura)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08931">Spell.cpp:8931</a></div></div>
<div class="ttc" id="aclassSpell_html_aa2b31e212fc2a2b6608c464b428976d1"><div class="ttname"><a href="classSpell.html#aa2b31e212fc2a2b6608c464b428976d1">Spell::m_ignoreCosts</a></div><div class="ttdeci">bool m_ignoreCosts</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00654">Spell.h:654</a></div></div>
<div class="ttc" id="aclassSpell_html_aa50ac7bf59f5e8ff2afca8de8d29fb28"><div class="ttname"><a href="classSpell.html#aa50ac7bf59f5e8ff2afca8de8d29fb28">Spell::cancel</a></div><div class="ttdeci">void cancel()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03421">Spell.cpp:3421</a></div></div>
<div class="ttc" id="aclassSpell_html_aa6aca574b2e1959895ddfb2ec61050fb"><div class="ttname"><a href="classSpell.html#aa6aca574b2e1959895ddfb2ec61050fb">Spell::CheckSpellCancelsCharm</a></div><div class="ttdeci">bool CheckSpellCancelsCharm(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07293">Spell.cpp:7293</a></div></div>
<div class="ttc" id="aclassSpell_html_aa6e5caa381a17c50d7c128fb14421b9e"><div class="ttname"><a href="classSpell.html#aa6e5caa381a17c50d7c128fb14421b9e">Spell::m_powerCost</a></div><div class="ttdeci">uint32 m_powerCost</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00923">Spell.h:923</a></div></div>
<div class="ttc" id="aclassSpell_html_aa71dc8b206bd72b5cd4d8682eaf0c6c2"><div class="ttname"><a href="classSpell.html#aa71dc8b206bd72b5cd4d8682eaf0c6c2">Spell::SendChannelUpdate</a></div><div class="ttdeci">void SendChannelUpdate(uint32 time, uint32 lastTick=0) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04865">Spell.cpp:4865</a></div></div>
<div class="ttc" id="aclassSpell_html_aa85563fe5bc694dfe0ac0a9ce6053ce6"><div class="ttname"><a href="classSpell.html#aa85563fe5bc694dfe0ac0a9ce6053ce6">Spell::IsInterruptible</a></div><div class="ttdeci">bool IsInterruptible() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08921">Spell.cpp:8921</a></div></div>
<div class="ttc" id="aclassSpell_html_aa8e6aa618e1613121d1c3a8438ae8b32"><div class="ttname"><a href="classSpell.html#aa8e6aa618e1613121d1c3a8438ae8b32">Spell::CheckSpellCancelsAuraEffect</a></div><div class="ttdeci">bool CheckSpellCancelsAuraEffect(AuraType auraType, uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07266">Spell.cpp:7266</a></div></div>
<div class="ttc" id="aclassSpell_html_aa9f3502112045494cd74493b114dd92e"><div class="ttname"><a href="classSpell.html#aa9f3502112045494cd74493b114dd92e">Spell::GetMinMaxRange</a></div><div class="ttdeci">std::pair&lt; float, float &gt; GetMinMaxRange(bool strict)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07360">Spell.cpp:7360</a></div></div>
<div class="ttc" id="aclassSpell_html_aaa462a3042ec64054da97bab0f0186a8"><div class="ttname"><a href="classSpell.html#aaa462a3042ec64054da97bab0f0186a8">Spell::m_absorb</a></div><div class="ttdeci">int32 m_absorb</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00968">Spell.h:968</a></div></div>
<div class="ttc" id="aclassSpell_html_aad27fceb9d17a8be41a82ff91990750a"><div class="ttname"><a href="classSpell.html#aad27fceb9d17a8be41a82ff91990750a">Spell::AddCorpseTarget</a></div><div class="ttdeci">void AddCorpseTarget(Corpse *target, uint8 effectMask)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01208">Spell.cpp:1208</a></div></div>
<div class="ttc" id="aclassSpell_html_aad28cf5dd3755b514793c6befa52844b"><div class="ttname"><a href="classSpell.html#aad28cf5dd3755b514793c6befa52844b">Spell::m_targetlessMask</a></div><div class="ttdeci">uint32 m_targetlessMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01010">Spell.h:1010</a></div></div>
<div class="ttc" id="aclassSpell_html_aae8b05fa2c3fad700a3dca8c4d154e94"><div class="ttname"><a href="classSpell.html#aae8b05fa2c3fad700a3dca8c4d154e94">Spell::FillTargetMap</a></div><div class="ttdeci">void FillTargetMap()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00591">Spell.cpp:591</a></div></div>
<div class="ttc" id="aclassSpell_html_aaf9581e80903c8fb7f96ea3e1d9e0173"><div class="ttname"><a href="classSpell.html#aaf9581e80903c8fb7f96ea3e1d9e0173">Spell::IsChannelActive</a></div><div class="ttdeci">bool IsChannelActive() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00690">Spell.h:690</a></div></div>
<div class="ttc" id="aclassSpell_html_ab00bfde34dc5dcdc6e1035608e14c067"><div class="ttname"><a href="classSpell.html#ab00bfde34dc5dcdc6e1035608e14c067">Spell::~Spell</a></div><div class="ttdeci">virtual ~Spell()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00565">Spell.cpp:565</a></div></div>
<div class="ttc" id="aclassSpell_html_ab0dff4108f46be429308f82a301e310e"><div class="ttname"><a href="classSpell.html#ab0dff4108f46be429308f82a301e310e">Spell::m_chainTargetCount</a></div><div class="ttdeci">uint32 m_chainTargetCount[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01062">Spell.h:1062</a></div></div>
<div class="ttc" id="aclassSpell_html_ab191335cf0379cfc4483c6404eebd285"><div class="ttname"><a href="classSpell.html#ab191335cf0379cfc4483c6404eebd285">Spell::TakePower</a></div><div class="ttdeci">void TakePower()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05092">Spell.cpp:5092</a></div></div>
<div class="ttc" id="aclassSpell_html_ab1dea568ff32c16850a58cf34aa5b5ea"><div class="ttname"><a href="classSpell.html#ab1dea568ff32c16850a58cf34aa5b5ea">Spell::CheckPetCast</a></div><div class="ttdeci">SpellCastResult CheckPetCast(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07082">Spell.cpp:7082</a></div></div>
<div class="ttc" id="aclassSpell_html_ab1e0f40468f5a385b5d6bf22afb55459"><div class="ttname"><a href="classSpell.html#ab1e0f40468f5a385b5d6bf22afb55459">Spell::OnCheckCast</a></div><div class="ttdeci">SpellCastResult OnCheckCast(bool strict)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09465">Spell.cpp:9465</a></div></div>
<div class="ttc" id="aclassSpell_html_ab226199131a3f1c8ce11239ac01c3617"><div class="ttname"><a href="classSpell.html#ab226199131a3f1c8ce11239ac01c3617">Spell::m_spellLog</a></div><div class="ttdeci">SpellLog m_spellLog</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01086">Spell.h:1086</a></div></div>
<div class="ttc" id="aclassSpell_html_ab2a42ecc2773f29d512625f1fb2ab17d"><div class="ttname"><a href="classSpell.html#ab2a42ecc2773f29d512625f1fb2ab17d">Spell::CheckCast</a></div><div class="ttdeci">SpellCastResult CheckCast(bool strict)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05496">Spell.cpp:5496</a></div></div>
<div class="ttc" id="aclassSpell_html_ab3aee301de963366979fe898f74576f4"><div class="ttname"><a href="classSpell.html#ab3aee301de963366979fe898f74576f4">Spell::m_overridenSpeed</a></div><div class="ttdeci">float m_overridenSpeed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01094">Spell.h:1094</a></div></div>
<div class="ttc" id="aclassSpell_html_ab3d3ccf4db3daa4de3bdfd7fe3371eae"><div class="ttname"><a href="classSpell.html#ab3d3ccf4db3daa4de3bdfd7fe3371eae">Spell::m_triggeredBySpellInfo</a></div><div class="ttdeci">SpellEntry const  * m_triggeredBySpellInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00637">Spell.h:637</a></div></div>
<div class="ttc" id="aclassSpell_html_ab3ffd4cc75d8108d2602ae767ea3d5df"><div class="ttname"><a href="classSpell.html#ab3ffd4cc75d8108d2602ae767ea3d5df">Spell::CheckOrTakeRunePower</a></div><div class="ttdeci">SpellCastResult CheckOrTakeRunePower(bool take)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05125">Spell.cpp:5125</a></div></div>
<div class="ttc" id="aclassSpell_html_ab59bbf4428bcb938c7e9af5a6ee9812a"><div class="ttname"><a href="classSpell.html#ab59bbf4428bcb938c7e9af5a6ee9812a">Spell::ReSetTimer</a></div><div class="ttdeci">void ReSetTimer()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00672">Spell.h:672</a></div></div>
<div class="ttc" id="aclassSpell_html_ab6bdcd5cfae7ac3b6f848f04bc193573"><div class="ttname"><a href="classSpell.html#ab6bdcd5cfae7ac3b6f848f04bc193573">Spell::IsTriggeredSpellWithRedundantCastTime</a></div><div class="ttdeci">bool IsTriggeredSpellWithRedundantCastTime() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08459">Spell.cpp:8459</a></div></div>
<div class="ttc" id="aclassSpell_html_ab74dcb259c27daf0a123cc30049d1b37"><div class="ttname"><a href="classSpell.html#ab74dcb259c27daf0a123cc30049d1b37">Spell::m_TriggerSpells</a></div><div class="ttdeci">SpellInfoList m_TriggerSpells</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01042">Spell.h:1042</a></div></div>
<div class="ttc" id="aclassSpell_html_ab86f89e84f40ab4d68ec2226be0656f3"><div class="ttname"><a href="classSpell.html#ab86f89e84f40ab4d68ec2226be0656f3">Spell::CheckScriptTargeting</a></div><div class="ttdeci">SpellCastResult CheckScriptTargeting(SpellEffectIndex effIndex, uint32 chainTargets, float radius, uint32 targetMode, UnitList &amp;tempUnitList, GameObjectList &amp;tempGOList)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l03007">Spell.cpp:3007</a></div></div>
<div class="ttc" id="aclassSpell_html_abc73b50115c6fa2ad0b3aa51668a2cec"><div class="ttname"><a href="classSpell.html#abc73b50115c6fa2ad0b3aa51668a2cec">Spell::IsValidDeadOrAliveTarget</a></div><div class="ttdeci">bool IsValidDeadOrAliveTarget(Unit const *unit) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01850">Spell.cpp:1850</a></div></div>
<div class="ttc" id="aclassSpell_html_abd4373f5c04145f12de7e58a03811d09"><div class="ttname"><a href="classSpell.html#abd4373f5c04145f12de7e58a03811d09">Spell::m_ignoreUnattackableTarget</a></div><div class="ttdeci">bool m_ignoreUnattackableTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00648">Spell.h:648</a></div></div>
<div class="ttc" id="aclassSpell_html_abd83294e164945d1a6af5c268f610da5"><div class="ttname"><a href="classSpell.html#abd83294e164945d1a6af5c268f610da5">Spell::WriteAmmoToPacket</a></div><div class="ttdeci">void WriteAmmoToPacket(WorldPacket &amp;data) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04685">Spell.cpp:4685</a></div></div>
<div class="ttc" id="aclassSpell_html_abda3f9b5419e0fb41b50f52e27a7fc80"><div class="ttname"><a href="classSpell.html#abda3f9b5419e0fb41b50f52e27a7fc80">Spell::m_effectSkillInfo</a></div><div class="ttdeci">EffectSkillInfo m_effectSkillInfo[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01075">Spell.h:1075</a></div></div>
<div class="ttc" id="aclassSpell_html_abdba7f18e2606cd1e2e8d8004cc2b30b"><div class="ttname"><a href="classSpell.html#abdba7f18e2606cd1e2e8d8004cc2b30b">Spell::m_spellAuraHolder</a></div><div class="ttdeci">SpellAuraHolder * m_spellAuraHolder</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00960">Spell.h:960</a></div></div>
<div class="ttc" id="aclassSpell_html_abdd0530fa6e4eca6c67f818cfa4817c2"><div class="ttname"><a href="classSpell.html#abdd0530fa6e4eca6c67f818cfa4817c2">Spell::m_IsTriggeredSpell</a></div><div class="ttdeci">bool m_IsTriggeredSpell</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00644">Spell.h:644</a></div></div>
<div class="ttc" id="aclassSpell_html_abe31237cfa9f26394765589cd7c3a58c"><div class="ttname"><a href="classSpell.html#abe31237cfa9f26394765589cd7c3a58c">Spell::isDelayableNoMore</a></div><div class="ttdeci">bool isDelayableNoMore()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00934">Spell.h:934</a></div></div>
<div class="ttc" id="aclassSpell_html_abe41422e439fe882c04760475e3c3072"><div class="ttname"><a href="classSpell.html#abe41422e439fe882c04760475e3c3072">Spell::ProcSpellAuraTriggers</a></div><div class="ttdeci">void ProcSpellAuraTriggers()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08821">Spell.cpp:8821</a></div></div>
<div class="ttc" id="aclassSpell_html_abe5d2483c52b087c98e7f7b1c49606ad"><div class="ttname"><a href="classSpell.html#abe5d2483c52b087c98e7f7b1c49606ad">Spell::GetTrueCaster</a></div><div class="ttdeci">WorldObject * GetTrueCaster() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00889">Spell.h:889</a></div></div>
<div class="ttc" id="aclassSpell_html_ac34348062658c54529e2d7f0e108e739"><div class="ttname"><a href="classSpell.html#ac34348062658c54529e2d7f0e108e739">Spell::ResetEffectDamageAndHeal</a></div><div class="ttdeci">void ResetEffectDamageAndHeal()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08804">Spell.cpp:8804</a></div></div>
<div class="ttc" id="aclassSpell_html_ac3945af8d47c78ea50cbbaf97205fc6e"><div class="ttname"><a href="classSpell.html#ac3945af8d47c78ea50cbbaf97205fc6e">Spell::CalculateSpellEffectDamage</a></div><div class="ttdeci">int32 CalculateSpellEffectDamage(Unit *unitTarget, int32 damage)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07485">Spell.cpp:7485</a></div></div>
<div class="ttc" id="aclassSpell_html_ac5331b13cbc4d1bc6ce1d68878f7a529"><div class="ttname"><a href="classSpell.html#ac5331b13cbc4d1bc6ce1d68878f7a529">Spell::FindCorpseUsing</a></div><div class="ttdeci">WorldObject * FindCorpseUsing()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00572">Spell.cpp:572</a></div></div>
<div class="ttc" id="aclassSpell_html_ac63ea9310b09ececfc1eac19133abce1"><div class="ttname"><a href="classSpell.html#ac63ea9310b09ececfc1eac19133abce1">Spell::m_applyMultiplierMask</a></div><div class="ttdeci">uint8 m_applyMultiplierMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00952">Spell.h:952</a></div></div>
<div class="ttc" id="aclassSpell_html_ac6c221b279935d9dfdf840f569f62954"><div class="ttname"><a href="classSpell.html#ac6c221b279935d9dfdf840f569f62954">Spell::m_currentBasePoints</a></div><div class="ttdeci">int32 m_currentBasePoints[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00638">Spell.h:638</a></div></div>
<div class="ttc" id="aclassSpell_html_ac93ca9fa6252919df20e2467214fdec5"><div class="ttname"><a href="classSpell.html#ac93ca9fa6252919df20e2467214fdec5">Spell::GetNewRuneState</a></div><div class="ttdeci">uint8 GetNewRuneState() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00882">Spell.h:882</a></div></div>
<div class="ttc" id="aclassSpell_html_ac99404294f7725f4bd29e70e015e3d47"><div class="ttname"><a href="classSpell.html#ac99404294f7725f4bd29e70e015e3d47">Spell::InitializeDamageMultipliers</a></div><div class="ttdeci">void InitializeDamageMultipliers()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01799">Spell.cpp:1799</a></div></div>
<div class="ttc" id="aclassSpell_html_acc435ce7ca5fc0510122e720a6aea580"><div class="ttname"><a href="classSpell.html#acc435ce7ca5fc0510122e720a6aea580">Spell::update</a></div><div class="ttdeci">void update(uint32 difftime)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04052">Spell.cpp:4052</a></div></div>
<div class="ttc" id="aclassSpell_html_acd106ca9dbe908ea1329c05d1fdbffc4"><div class="ttname"><a href="classSpell.html#acd106ca9dbe908ea1329c05d1fdbffc4">Spell::GetDelayStart</a></div><div class="ttdeci">uint64 GetDelayStart() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00699">Spell.h:699</a></div></div>
<div class="ttc" id="aclassSpell_html_acea3bdaa6677657550f09f940ad96da9"><div class="ttname"><a href="classSpell.html#acea3bdaa6677657550f09f940ad96da9">Spell::m_jumpRadius</a></div><div class="ttdeci">float m_jumpRadius</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01063">Spell.h:1063</a></div></div>
<div class="ttc" id="aclassSpell_html_ad06c46067af46fe82c9ec46352ab7ca8"><div class="ttname"><a href="classSpell.html#ad06c46067af46fe82c9ec46352ab7ca8">Spell::CheckAndAddMagnetTarget</a></div><div class="ttdeci">bool CheckAndAddMagnetTarget(Unit *unitTarget, SpellEffectIndex effIndex, bool targetB, TempTargetingData &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01898">Spell.cpp:1898</a></div></div>
<div class="ttc" id="aclassSpell_html_ad09bb0bd6239b8282599e37bad943ad2"><div class="ttname"><a href="classSpell.html#ad09bb0bd6239b8282599e37bad943ad2">Spell::OnHit</a></div><div class="ttdeci">void OnHit(SpellMissInfo missInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09892">Spell.cpp:9892</a></div></div>
<div class="ttc" id="aclassSpell_html_ad211ab1945462c7724e025b88b0c2135"><div class="ttname"><a href="classSpell.html#ad211ab1945462c7724e025b88b0c2135">Spell::m_CastItem</a></div><div class="ttdeci">Item * m_CastItem</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00912">Spell.h:912</a></div></div>
<div class="ttc" id="aclassSpell_html_ad2832707179efc7ca28956afe5fa77a8"><div class="ttname"><a href="classSpell.html#ad2832707179efc7ca28956afe5fa77a8">Spell::ExecuteEffects</a></div><div class="ttdeci">void ExecuteEffects(Unit *unitTarget, Item *itemTarget, GameObject *GOTarget, uint32 effectMask)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05377">Spell.cpp:5377</a></div></div>
<div class="ttc" id="aclassSpell_html_ad2c181118cb5bf43cdbdf18729358bc3"><div class="ttname"><a href="classSpell.html#ad2c181118cb5bf43cdbdf18729358bc3">Spell::CheckSpellCancelsSilence</a></div><div class="ttdeci">bool CheckSpellCancelsSilence(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07306">Spell.cpp:7306</a></div></div>
<div class="ttc" id="aclassSpell_html_ad3059c20d67c7b1325c545ac188c74d5"><div class="ttname"><a href="classSpell.html#ad3059c20d67c7b1325c545ac188c74d5">Spell::m_healingPerEffect</a></div><div class="ttdeci">int32 m_healingPerEffect[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00972">Spell.h:972</a></div></div>
<div class="ttc" id="aclassSpell_html_ad39149ba8f34185ed6c52c5782881250"><div class="ttname"><a href="classSpell.html#ad39149ba8f34185ed6c52c5782881250">Spell::GetDelayMoment</a></div><div class="ttdeci">uint64 GetDelayMoment() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00701">Spell.h:701</a></div></div>
<div class="ttc" id="aclassSpell_html_ad496cad5a2082b8d8b4afa249855417a"><div class="ttname"><a href="classSpell.html#ad496cad5a2082b8d8b4afa249855417a">Spell::m_ignoreGCD</a></div><div class="ttdeci">bool m_ignoreGCD</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00653">Spell.h:653</a></div></div>
<div class="ttc" id="aclassSpell_html_ad827f88458117266b82decb339b9ff88"><div class="ttname"><a href="classSpell.html#ad827f88458117266b82decb339b9ff88">Spell::TakeCastItem</a></div><div class="ttdeci">void TakeCastItem()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05027">Spell.cpp:5027</a></div></div>
<div class="ttc" id="aclassSpell_html_ad93507f6abc44a9a3334f3e9a5cc8825"><div class="ttname"><a href="classSpell.html#ad93507f6abc44a9a3334f3e9a5cc8825">Spell::ClearCastItem</a></div><div class="ttdeci">void ClearCastItem()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08936">Spell.cpp:8936</a></div></div>
<div class="ttc" id="aclassSpell_html_ad94f7eb8b77b07d58a37e9cb4dd5605c"><div class="ttname"><a href="classSpell.html#ad94f7eb8b77b07d58a37e9cb4dd5605c">Spell::CheckSpellCancelsPacify</a></div><div class="ttdeci">bool CheckSpellCancelsPacify(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07312">Spell.cpp:7312</a></div></div>
<div class="ttc" id="aclassSpell_html_ad98b19601a903f26b44cd7e30e347d27"><div class="ttname"><a href="classSpell.html#ad98b19601a903f26b44cd7e30e347d27">Spell::GetSpellRangeAndRadius</a></div><div class="ttdeci">void GetSpellRangeAndRadius(SpellEffectIndex effIndex, float &amp;radius, bool targetB, uint32 &amp;effectChainTarget)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08944">Spell.cpp:8944</a></div></div>
<div class="ttc" id="aclassSpell_html_adba11b52d6d255e575600716d9c87ec5"><div class="ttname"><a href="classSpell.html#adba11b52d6d255e575600716d9c87ec5">Spell::m_partialApplicationMask</a></div><div class="ttdeci">uint32 m_partialApplicationMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01013">Spell.h:1013</a></div></div>
<div class="ttc" id="aclassSpell_html_adcb37c1f1904971b48304f6d18d48ee5"><div class="ttname"><a href="classSpell.html#adcb37c1f1904971b48304f6d18d48ee5">Spell::m_needAliveTargetMask</a></div><div class="ttdeci">uint8 m_needAliveTargetMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00781">Spell.h:781</a></div></div>
<div class="ttc" id="aclassSpell_html_ade05873e2d5e60d68fed60995ef56bc4"><div class="ttname"><a href="classSpell.html#ade05873e2d5e60d68fed60995ef56bc4">Spell::m_filteringScheme</a></div><div class="ttdeci">SpellTargetFilterScheme m_filteringScheme[MAX_EFFECT_INDEX][2]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01064">Spell.h:1064</a></div></div>
<div class="ttc" id="aclassSpell_html_ae031e444535b6a6ad619b430fb4fdc7f"><div class="ttname"><a href="classSpell.html#ae031e444535b6a6ad619b430fb4fdc7f">Spell::OnInit</a></div><div class="ttdeci">void OnInit()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09422">Spell.cpp:9422</a></div></div>
<div class="ttc" id="aclassSpell_html_ae13ca73b08aafc7636ee0449c186b0ab"><div class="ttname"><a href="classSpell.html#ae13ca73b08aafc7636ee0449c186b0ab">Spell::IsRangedSpell</a></div><div class="ttdeci">bool IsRangedSpell() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00673">Spell.h:673</a></div></div>
<div class="ttc" id="aclassSpell_html_ae21b0dbb08c6a06f834049d8407dfd8b"><div class="ttname"><a href="classSpell.html#ae21b0dbb08c6a06f834049d8407dfd8b">Spell::WriteSpellGoTargets</a></div><div class="ttdeci">void WriteSpellGoTargets(WorldPacket &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04769">Spell.cpp:4769</a></div></div>
<div class="ttc" id="aclassSpell_html_ae4cc49a92d3376183bbe01b2d021dfb1"><div class="ttname"><a href="classSpell.html#ae4cc49a92d3376183bbe01b2d021dfb1">Spell::OnSummon</a></div><div class="ttdeci">void OnSummon(GameObject *summon)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09904">Spell.cpp:9904</a></div></div>
<div class="ttc" id="aclassSpell_html_ae502baf883564a71b59dc74e23a5a73a"><div class="ttname"><a href="classSpell.html#ae502baf883564a71b59dc74e23a5a73a">Spell::m_param1</a></div><div class="ttdeci">uint32 m_param1</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01089">Spell.h:1089</a></div></div>
<div class="ttc" id="aclassSpell_html_ae56cd0dc9a0fcece5365d59925da40f1"><div class="ttname"><a href="classSpell.html#ae56cd0dc9a0fcece5365d59925da40f1">Spell::CastPreCastSpells</a></div><div class="ttdeci">void CastPreCastSpells(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l05481">Spell.cpp:5481</a></div></div>
<div class="ttc" id="aclassSpell_html_ae7ef00105b47529bb50b1c669aabb283"><div class="ttname"><a href="classSpell.html#ae7ef00105b47529bb50b1c669aabb283">Spell::m_overrideSpeed</a></div><div class="ttdeci">bool m_overrideSpeed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01093">Spell.h:1093</a></div></div>
<div class="ttc" id="aclassSpell_html_ae81fe2336f8471249bbb9b2ed273702d"><div class="ttname"><a href="classSpell.html#ae81fe2336f8471249bbb9b2ed273702d">Spell::OnDestTarget</a></div><div class="ttdeci">void OnDestTarget()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09585">Spell.cpp:9585</a></div></div>
<div class="ttc" id="aclassSpell_html_ae9198fc52a22dbc82ad69b1c32d884e7"><div class="ttname"><a href="classSpell.html#ae9198fc52a22dbc82ad69b1c32d884e7">Spell::DelayedChannel</a></div><div class="ttdeci">void DelayedChannel()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08179">Spell.cpp:8179</a></div></div>
<div class="ttc" id="aclassSpell_html_aea24ad8716a09b612bf4856b99c9c978"><div class="ttname"><a href="classSpell.html#aea24ad8716a09b612bf4856b99c9c978">Spell::CanOpenLock</a></div><div class="ttdeci">SpellCastResult CanOpenLock(SpellEffectIndex effIndex, uint32 lockid, SkillType &amp;skillId, int32 &amp;reqSkillValue, int32 &amp;skillValue)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08600">Spell.cpp:8600</a></div></div>
<div class="ttc" id="aclassSpell_html_aea2657881d1a997c81f1cffefd1b2abd"><div class="ttname"><a href="classSpell.html#aea2657881d1a997c81f1cffefd1b2abd">Spell::m_scriptValue</a></div><div class="ttdeci">uint64 m_scriptValue</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01046">Spell.h:1046</a></div></div>
<div class="ttc" id="aclassSpell_html_aebdf5cc0847865b97bf8f4b06a5921f6"><div class="ttname"><a href="classSpell.html#aebdf5cc0847865b97bf8f4b06a5921f6">Spell::Spell</a></div><div class="ttdeci">Spell(WorldObject *caster, SpellEntry const *info, uint32 triggeredFlags, ObjectGuid originalCasterGUID=ObjectGuid(), SpellEntry const *triggeredBy=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00421">Spell.cpp:421</a></div></div>
<div class="ttc" id="aclassSpell_html_aed032ab41978b3a3e9e61fc630186a93"><div class="ttname"><a href="classSpell.html#aed032ab41978b3a3e9e61fc630186a93">Spell::GetUsableHealthStoneItemType</a></div><div class="ttdeci">uint32 GetUsableHealthStoneItemType(Unit *unitTarget)</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffects_8cpp_source.html#l13114">SpellEffects.cpp:13114</a></div></div>
<div class="ttc" id="aclassSpell_html_aed136ecf494e152f6953aac8db6cdf4c"><div class="ttname"><a href="classSpell.html#aed136ecf494e152f6953aac8db6cdf4c">Spell::m_uniqueCorpseTargetInfo</a></div><div class="ttdeci">CorpseTargetList m_uniqueCorpseTargetInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01012">Spell.h:1012</a></div></div>
<div class="ttc" id="aclassSpell_html_aeea292e4bbbeb073f624dabda6420903"><div class="ttname"><a href="classSpell.html#aeea292e4bbbeb073f624dabda6420903">Spell::m_healthLeech</a></div><div class="ttdeci">int32 m_healthLeech</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00973">Spell.h:973</a></div></div>
<div class="ttc" id="aclassSpell_html_aeef1431d123d73b176f47567a0e01647"><div class="ttname"><a href="classSpell.html#aeef1431d123d73b176f47567a0e01647">Spell::m_ignoreCooldowns</a></div><div class="ttdeci">bool m_ignoreCooldowns</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00655">Spell.h:655</a></div></div>
<div class="ttc" id="aclassSpell_html_af0af54631e2f159c5a70092bafac71c6"><div class="ttname"><a href="classSpell.html#af0af54631e2f159c5a70092bafac71c6">Spell::finish</a></div><div class="ttdeci">void finish(bool ok=true)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l04246">Spell.cpp:4246</a></div></div>
<div class="ttc" id="aclassSpell_html_af0b413dbd852a160c567fc28dc985983"><div class="ttname"><a href="classSpell.html#af0b413dbd852a160c567fc28dc985983">Spell::DoSpellHitOnUnit</a></div><div class="ttdeci">void DoSpellHitOnUnit(Unit *unit, uint32 effectMask, TargetInfo *target, bool isReflected=true)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01491">Spell.cpp:1491</a></div></div>
<div class="ttc" id="aclassSpell_html_af181a3684cada28607db5b669cb05365"><div class="ttname"><a href="classSpell.html#af181a3684cada28607db5b669cb05365">Spell::HandleImmediateEffectExecution</a></div><div class="ttdeci">void HandleImmediateEffectExecution(TargetInfo *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01750">Spell.cpp:1750</a></div></div>
<div class="ttc" id="aclassSpell_html_af20339d17376838e640f9cc2f9b01308"><div class="ttname"><a href="classSpell.html#af20339d17376838e640f9cc2f9b01308">Spell::m_eventTarget</a></div><div class="ttdeci">WorldObject * m_eventTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00964">Spell.h:964</a></div></div>
<div class="ttc" id="aclassSpell_html_af29009de4460469d4a4157fa1eda8173"><div class="ttname"><a href="classSpell.html#af29009de4460469d4a4157fa1eda8173">Spell::CheckRange</a></div><div class="ttdeci">SpellCastResult CheckRange(bool strict)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07420">Spell.cpp:7420</a></div></div>
<div class="ttc" id="aclassSpell_html_af4432b3a613d924a4bdc8f68e9c99dac"><div class="ttname"><a href="classSpell.html#af4432b3a613d924a4bdc8f68e9c99dac">Spell::UpdateOriginalCasterPointer</a></div><div class="ttdeci">void UpdateOriginalCasterPointer()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08226">Spell.cpp:8226</a></div></div>
<div class="ttc" id="aclassSpell_html_af471902fa858fc71b299d69d88272be5"><div class="ttname"><a href="classSpell.html#af471902fa858fc71b299d69d88272be5">Spell::CheckCasterAuras</a></div><div class="ttdeci">SpellCastResult CheckCasterAuras(uint32 &amp;param1) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07168">Spell.cpp:7168</a></div></div>
<div class="ttc" id="aclassSpell_html_af6bea341ebc74608726857671d92bb6d"><div class="ttname"><a href="classSpell.html#af6bea341ebc74608726857671d92bb6d">Spell::m_runesState</a></div><div class="ttdeci">uint8 m_runesState</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00930">Spell.h:930</a></div></div>
<div class="ttc" id="aclassSpell_html_af84a8ccfbfa113458cd96927a0bd65d6"><div class="ttname"><a href="classSpell.html#af84a8ccfbfa113458cd96927a0bd65d6">Spell::IgnoreItemRequirements</a></div><div class="ttdeci">bool IgnoreItemRequirements() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07636">Spell.cpp:7636</a></div></div>
<div class="ttc" id="aclassSpell_html_af880d166ee53ab6614c4bd885fa6e466"><div class="ttname"><a href="classSpell.html#af880d166ee53ab6614c4bd885fa6e466">Spell::m_needSpellLog</a></div><div class="ttdeci">bool m_needSpellLog</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00951">Spell.h:951</a></div></div>
<div class="ttc" id="aclassSpell_html_af8ae043215e1e85e6e67b934ae91d896"><div class="ttname"><a href="classSpell.html#af8ae043215e1e85e6e67b934ae91d896">Spell::m_ignoreCasterAuraState</a></div><div class="ttdeci">bool m_ignoreCasterAuraState</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00657">Spell.h:657</a></div></div>
<div class="ttc" id="aclassSpell_html_af8de4da19951058b9debc1521bb5b954"><div class="ttname"><a href="classSpell.html#af8de4da19951058b9debc1521bb5b954">Spell::GetAffectiveCasterOrOwner</a></div><div class="ttdeci">Unit * GetAffectiveCasterOrOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l08769">Spell.cpp:8769</a></div></div>
<div class="ttc" id="aclassSpell_html_af8e7a207583b68ff524b4372e995664a"><div class="ttname"><a href="classSpell.html#af8e7a207583b68ff524b4372e995664a">Spell::m_autoRepeat</a></div><div class="ttdeci">bool m_autoRepeat</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00928">Spell.h:928</a></div></div>
<div class="ttc" id="aclassSpell_html_af93fc378bb91e3d416c59835b3760d3d"><div class="ttname"><a href="classSpell.html#af93fc378bb91e3d416c59835b3760d3d">Spell::OnSuccessfulFinish</a></div><div class="ttdeci">void OnSuccessfulFinish()</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l09434">Spell.cpp:9434</a></div></div>
<div class="ttc" id="aclassSpell_html_af9fe4eb228aed83f869a8416dd2cb65f"><div class="ttname"><a href="classSpell.html#af9fe4eb228aed83f869a8416dd2cb65f">Spell::CanBeInterrupted</a></div><div class="ttdeci">bool CanBeInterrupted() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00748">Spell.h:748</a></div></div>
<div class="ttc" id="aclassSpell_html_afbeb295ad7652c0abf129066e76a4a10"><div class="ttname"><a href="classSpell.html#afbeb295ad7652c0abf129066e76a4a10">Spell::m_channelOnly</a></div><div class="ttdeci">bool m_channelOnly</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00660">Spell.h:660</a></div></div>
<div class="ttc" id="aclassSpell_html_afecdd65c73b267d8cb2b9525bed5f851"><div class="ttname"><a href="classSpell.html#afecdd65c73b267d8cb2b9525bed5f851">Spell::DoAllEffectOnTarget</a></div><div class="ttdeci">void DoAllEffectOnTarget(TargetInfo *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01296">Spell.cpp:1296</a></div></div>
<div class="ttc" id="aclassSpell_html_aff5477a54c2dfe98575d5ea12984b86f"><div class="ttname"><a href="classSpell.html#aff5477a54c2dfe98575d5ea12984b86f">Spell::CanAutoCast</a></div><div class="ttdeci">bool CanAutoCast(Unit *target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l07328">Spell.cpp:7328</a></div></div>
<div class="ttc" id="aclassTerrainInfo_html_a6d518fd6e2d4279f300ac47da1a88007"><div class="ttname"><a href="classTerrainInfo.html#a6d518fd6e2d4279f300ac47da1a88007">TerrainInfo::IsInWater</a></div><div class="ttdeci">bool IsInWater(float x, float y, float z, GridMapLiquidData *data=nullptr, float min_depth=2.0f) const</div><div class="ttdef"><b>Definition:</b> <a href="GridMap_8cpp_source.html#l01188">GridMap.cpp:1188</a></div></div>
<div class="ttc" id="aclassTerrainInfo_html_a88601853eed2beb56da806fea75059cf"><div class="ttname"><a href="classTerrainInfo.html#a88601853eed2beb56da806fea75059cf">TerrainInfo::IsOutdoors</a></div><div class="ttdeci">bool IsOutdoors(float x, float y, float z) const</div><div class="ttdef"><b>Definition:</b> <a href="GridMap_8cpp_source.html#l00930">GridMap.cpp:930</a></div></div>
<div class="ttc" id="aclassTerrainInfo_html_ac6bd8033260237f0ce549c986e79d9a5"><div class="ttname"><a href="classTerrainInfo.html#ac6bd8033260237f0ce549c986e79d9a5">TerrainInfo::GetWaterLevel</a></div><div class="ttdeci">float GetWaterLevel(float x, float y, float z, float *pGround=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="GridMap_8cpp_source.html#l01390">GridMap.cpp:1390</a></div></div>
<div class="ttc" id="aclassThreatManager_html_a646910563d1b3943c276f5efe1561bfd"><div class="ttname"><a href="classThreatManager.html#a646910563d1b3943c276f5efe1561bfd">ThreatManager::getThreatList</a></div><div class="ttdeci">ThreatList const  &amp; getThreatList() const</div><div class="ttdef"><b>Definition:</b> <a href="ThreatManager_8h_source.html#l00238">ThreatManager.h:238</a></div></div>
<div class="ttc" id="aclassTradeData_html"><div class="ttname"><a href="classTradeData.html">TradeData</a></div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l01014">Player.h:1015</a></div></div>
<div class="ttc" id="aclassTransportInfo_html_a314642719fc92ee528c2abb228b3a105"><div class="ttname"><a href="classTransportInfo.html#a314642719fc92ee528c2abb228b3a105">TransportInfo::GetTransport</a></div><div class="ttdeci">WorldObject * GetTransport() const</div><div class="ttdef"><b>Definition:</b> <a href="TransportSystem_8h_source.html#l00106">TransportSystem.h:106</a></div></div>
<div class="ttc" id="aclassTransportInfo_html_a49d85ec7bb9bb57bee44f01d1b0a9d87"><div class="ttname"><a href="classTransportInfo.html#a49d85ec7bb9bb57bee44f01d1b0a9d87">TransportInfo::HasOnBoard</a></div><div class="ttdeci">bool HasOnBoard(WorldObject const *passenger) const</div><div class="ttdef"><b>Definition:</b> <a href="TransportSystem_8h_source.html#l00113">TransportSystem.h:113</a></div></div>
<div class="ttc" id="aclassTransportInfo_html_a88b1b9802b42096a12aad50157cf7031"><div class="ttname"><a href="classTransportInfo.html#a88b1b9802b42096a12aad50157cf7031">TransportInfo::IsOnVehicle</a></div><div class="ttdeci">bool IsOnVehicle() const</div><div class="ttdef"><b>Definition:</b> <a href="TransportSystem_8h_source.html#l00110">TransportSystem.h:110</a></div></div>
<div class="ttc" id="aclassUnitAI_html_a15986c0151cfab77feb24aac3cb22474"><div class="ttname"><a href="classUnitAI.html#a15986c0151cfab77feb24aac3cb22474">UnitAI::OnChannelStateChange</a></div><div class="ttdeci">virtual void OnChannelStateChange(Spell const *spell, bool state, WorldObject *target=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="UnitAI_8cpp_source.html#l00439">UnitAI.cpp:439</a></div></div>
<div class="ttc" id="aclassUnitAI_html_a1c25fa7bf81045336e3f2977f94b7c03"><div class="ttname"><a href="classUnitAI.html#a1c25fa7bf81045336e3f2977f94b7c03">UnitAI::SpellHitTarget</a></div><div class="ttdeci">virtual void SpellHitTarget(Unit *target, const SpellEntry *spellInfo, SpellMissInfo)</div><div class="ttdoc">Called when spell hits creature's target.</div><div class="ttdef"><b>Definition:</b> <a href="UnitAI_8h_source.html#l00248">UnitAI.h:248</a></div></div>
<div class="ttc" id="aclassUnitAI_html_a3dc9c4944fab218d9a215df9dbb7fa35"><div class="ttname"><a href="classUnitAI.html#a3dc9c4944fab218d9a215df9dbb7fa35">UnitAI::OnSpellCastStateChange</a></div><div class="ttdeci">virtual void OnSpellCastStateChange(Spell const *spell, bool state, WorldObject *target=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="UnitAI_8cpp_source.html#l00355">UnitAI.cpp:355</a></div></div>
<div class="ttc" id="aclassUnitAI_html_a4b46371e7ac4e6ae944a5e1d2d9c7293"><div class="ttname"><a href="classUnitAI.html#a4b46371e7ac4e6ae944a5e1d2d9c7293">UnitAI::GetScriptData</a></div><div class="ttdeci">virtual uint32 GetScriptData()</div><div class="ttdoc">== Data Fetch bind ==============================</div><div class="ttdef"><b>Definition:</b> <a href="UnitAI_8h_source.html#l00286">UnitAI.h:286</a></div></div>
<div class="ttc" id="aclassUnitAI_html_a60339f23985eaf04df5eee4fb9fc9e9b"><div class="ttname"><a href="classUnitAI.html#a60339f23985eaf04df5eee4fb9fc9e9b">UnitAI::SpellHit</a></div><div class="ttdeci">virtual void SpellHit(Unit *, const SpellEntry *)</div><div class="ttdoc">Called when hit by a spell.</div><div class="ttdef"><b>Definition:</b> <a href="UnitAI_8h_source.html#l00241">UnitAI.h:241</a></div></div>
<div class="ttc" id="aclassUnitAI_html_aeb4a9728df30ea71cde347892f8888c4"><div class="ttname"><a href="classUnitAI.html#aeb4a9728df30ea71cde347892f8888c4">UnitAI::OnSpellCooldownAdded</a></div><div class="ttdeci">virtual void OnSpellCooldownAdded(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="UnitAI_8cpp_source.html#l00977">UnitAI.cpp:977</a></div></div>
<div class="ttc" id="aclassUnit_html"><div class="ttname"><a href="classUnit.html">Unit</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01147">Unit.h:1148</a></div></div>
<div class="ttc" id="aclassUnit_html_a01b2890f9e1c804dd31b5849575f99bf"><div class="ttname"><a href="classUnit.html#a01b2890f9e1c804dd31b5849575f99bf">Unit::IsImmuneToSpell</a></div><div class="ttdeci">virtual bool IsImmuneToSpell(SpellEntry const *spellInfo, bool castOnSelf, uint8 effectMask, WorldObject const *caster)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l09122">Unit.cpp:9122</a></div></div>
<div class="ttc" id="aclassUnit_html_a02109da9ef731973d5ac8a24ffaca075"><div class="ttname"><a href="classUnit.html#a02109da9ef731973d5ac8a24ffaca075">Unit::CanAssistSpell</a></div><div class="ttdeci">virtual bool CanAssistSpell(Unit const *target, SpellEntry const *spellInfo=nullptr) const override</div><div class="ttdoc">[Serverside] Assistance: Unit can target a target with a helpful spell</div><div class="ttdef"><b>Definition:</b> <a href="Relations_8cpp_source.html#l01280">Relations.cpp:1280</a></div></div>
<div class="ttc" id="aclassUnit_html_a033d2ead3d0eca2389e5e522b4bb6b10"><div class="ttname"><a href="classUnit.html#a033d2ead3d0eca2389e5e522b4bb6b10">Unit::CalculateAuraDuration</a></div><div class="ttdeci">int32 CalculateAuraDuration(SpellEntry const *spellProto, uint32 effectMask, int32 duration, Unit const *caster)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10813">Unit.cpp:10813</a></div></div>
<div class="ttc" id="aclassUnit_html_a0414b693087d7f3acc4a13eadb619660"><div class="ttname"><a href="classUnit.html#a0414b693087d7f3acc4a13eadb619660">Unit::IsVehicle</a></div><div class="ttdeci">bool IsVehicle() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01532">Unit.h:1532</a></div></div>
<div class="ttc" id="aclassUnit_html_a08cbed215e32eaeb4d9716da830e72b8"><div class="ttname"><a href="classUnit.html#a08cbed215e32eaeb4d9716da830e72b8">Unit::CanAttack</a></div><div class="ttdeci">bool CanAttack(Unit const *unit, bool ignoreUntargetable=false) const</div><div class="ttdoc">Opposition: Unit treats another unit as an enemy it can attack (generic)</div><div class="ttdef"><b>Definition:</b> <a href="Relations_8cpp_source.html#l00357">Relations.cpp:357</a></div></div>
<div class="ttc" id="aclassUnit_html_a0d3beff329102d154c2f4a7e7221cea1"><div class="ttname"><a href="classUnit.html#a0d3beff329102d154c2f4a7e7221cea1">Unit::GetMasterGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetMasterGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01933">Unit.h:1933</a></div></div>
<div class="ttc" id="aclassUnit_html_a0d74177af4f180c8ec0af151313189c6"><div class="ttname"><a href="classUnit.html#a0d74177af4f180c8ec0af151313189c6">Unit::GetDiminishing</a></div><div class="ttdeci">DiminishingLevels GetDiminishing(DiminishingGroup group)</div><div class="ttdoc">Gets the current DiminishingLevels for the given group.</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10888">Unit.cpp:10888</a></div></div>
<div class="ttc" id="aclassUnit_html_a0e30ad1b4802103bac5736d0486c021c"><div class="ttname"><a href="classUnit.html#a0e30ad1b4802103bac5736d0486c021c">Unit::SetLastManaUse</a></div><div class="ttdeci">void SetLastManaUse()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02345">Unit.h:2345</a></div></div>
<div class="ttc" id="aclassUnit_html_a11e78cce4735a7862255a86005e67e82"><div class="ttname"><a href="classUnit.html#a11e78cce4735a7862255a86005e67e82">Unit::ApplyDiminishingToDuration</a></div><div class="ttdeci">void ApplyDiminishingToDuration(DiminishingGroup group, int32 &amp;duration, Unit *caster, DiminishingLevels Level, bool isReflected, SpellEntry const *spellInfo, bool hasAuraScript)</div><div class="ttdoc">Calculates how long the duration of a spell should be considering diminishing returns,...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10938">Unit.cpp:10938</a></div></div>
<div class="ttc" id="aclassUnit_html_a12a39cbef65b5c19ecbcf3296dc82d11"><div class="ttname"><a href="classUnit.html#a12a39cbef65b5c19ecbcf3296dc82d11">Unit::ProcDamageAndSpell</a></div><div class="ttdeci">static void ProcDamageAndSpell(ProcSystemArguments &amp;&amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="UnitAuraProcHandler_8cpp_source.html#l00470">UnitAuraProcHandler.cpp:470</a></div></div>
<div class="ttc" id="aclassUnit_html_a13049af5fc1e99bf71e9a6c5a04cf10e"><div class="ttname"><a href="classUnit.html#a13049af5fc1e99bf71e9a6c5a04cf10e">Unit::AttackStop</a></div><div class="ttdeci">bool AttackStop(bool targetSwitch=false, bool includingCast=false, bool includingCombo=false, bool clientInitiated=false)</div><div class="ttdoc">Stops attacking whatever we are attacking at the moment and tells the Unit we are attacking that we a...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07560">Unit.cpp:7560</a></div></div>
<div class="ttc" id="aclassUnit_html_a15935c3f574e8b3e72952561c75e6faf"><div class="ttname"><a href="classUnit.html#a15935c3f574e8b3e72952561c75e6faf">Unit::SetFacingTo</a></div><div class="ttdeci">void SetFacingTo(float ori)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05379">Unit.cpp:5379</a></div></div>
<div class="ttc" id="aclassUnit_html_a169ef33de0d0e646b4fe7d1d6d01444d"><div class="ttname"><a href="classUnit.html#a169ef33de0d0e646b4fe7d1d6d01444d">Unit::addUnitState</a></div><div class="ttdeci">void addUnitState(uint32 f)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01381">Unit.h:1381</a></div></div>
<div class="ttc" id="aclassUnit_html_a1a38bdc4f3c0a9b9cfa22f51365e37a4"><div class="ttname"><a href="classUnit.html#a1a38bdc4f3c0a9b9cfa22f51365e37a4">Unit::RemoveAurasDueToSpell</a></div><div class="ttdeci">void RemoveAurasDueToSpell(uint32 spellId, SpellAuraHolder *except=nullptr, AuraRemoveMode mode=AURA_REMOVE_BY_DEFAULT)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06262">Unit.cpp:6262</a></div></div>
<div class="ttc" id="aclassUnit_html_a1b7f920f1194c4aab9d600bce2e9f9c2"><div class="ttname"><a href="classUnit.html#a1b7f920f1194c4aab9d600bce2e9f9c2">Unit::getThreatManager</a></div><div class="ttdeci">ThreatManager &amp; getThreatManager()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02185">Unit.h:2185</a></div></div>
<div class="ttc" id="aclassUnit_html_a1ba95f0ad9e204ab1c36f1608e62434b"><div class="ttname"><a href="classUnit.html#a1ba95f0ad9e204ab1c36f1608e62434b">Unit::RemoveAurasWithInterruptFlags</a></div><div class="ttdeci">void RemoveAurasWithInterruptFlags(uint32 flags)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06299">Unit.cpp:6299</a></div></div>
<div class="ttc" id="aclassUnit_html_a211876b6b1dcea2eedcc52e754093d70"><div class="ttname"><a href="classUnit.html#a211876b6b1dcea2eedcc52e754093d70">Unit::CastSpell</a></div><div class="ttdeci">SpellCastResult CastSpell(Unit *Victim, uint32 spellId, uint32 triggeredFlags, Item *castItem=nullptr, Aura *triggeredByAura=nullptr, ObjectGuid originalCaster=ObjectGuid(), SpellEntry const *triggeredBy=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l01479">Unit.cpp:1479</a></div></div>
<div class="ttc" id="aclassUnit_html_a21ddd10a4ef054d9ed31ff7b296dffcb"><div class="ttname"><a href="classUnit.html#a21ddd10a4ef054d9ed31ff7b296dffcb">Unit::CalcArmorReducedDamage</a></div><div class="ttdeci">static float CalcArmorReducedDamage(WorldObject *attacker, Unit *victim, const float damage)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l02458">Unit.cpp:2458</a></div></div>
<div class="ttc" id="aclassUnit_html_a22379af759e2f2948923cf84f773799d"><div class="ttname"><a href="classUnit.html#a22379af759e2f2948923cf84f773799d">Unit::SetInFront</a></div><div class="ttdeci">void SetInFront(Unit const *target)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05374">Unit.cpp:5374</a></div></div>
<div class="ttc" id="aclassUnit_html_a22ae6db8535f6286991968288ab5ee78"><div class="ttname"><a href="classUnit.html#a22ae6db8535f6286991968288ab5ee78">Unit::HasAuraTypeWithMiscvalue</a></div><div class="ttdeci">bool HasAuraTypeWithMiscvalue(AuraType auraType, int32 miscvalue) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06683">Unit.cpp:6683</a></div></div>
<div class="ttc" id="aclassUnit_html_a23de96036018133a5d20a1cd2e678f3b"><div class="ttname"><a href="classUnit.html#a23de96036018133a5d20a1cd2e678f3b">Unit::CalculateAbsorbResistBlock</a></div><div class="ttdeci">void CalculateAbsorbResistBlock(Unit *caster, SpellNonMeleeDamage *spellDamageInfo, SpellEntry const *spellProto, WeaponAttackType attType=BASE_ATTACK)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l03048">Unit.cpp:3048</a></div></div>
<div class="ttc" id="aclassUnit_html_a23f974c6e648ec1c037d93458d96a8ab"><div class="ttname"><a href="classUnit.html#a23f974c6e648ec1c037d93458d96a8ab">Unit::IsNoWeaponShapeShift</a></div><div class="ttdeci">bool IsNoWeaponShapeShift() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l13129">Unit.cpp:13129</a></div></div>
<div class="ttc" id="aclassUnit_html_a24402cfa3abfe3a1dc98c3cdf1145ece"><div class="ttname"><a href="classUnit.html#a24402cfa3abfe3a1dc98c3cdf1145ece">Unit::GetAurasByType</a></div><div class="ttdeci">AuraList const  &amp; GetAurasByType(AuraType type) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02225">Unit.h:2225</a></div></div>
<div class="ttc" id="aclassUnit_html_a2b5b1c6d16de917e5356d9f1708178b4"><div class="ttname"><a href="classUnit.html#a2b5b1c6d16de917e5356d9f1708178b4">Unit::AuraList</a></div><div class="ttdeci">std::list&lt; Aura * &gt; AuraList</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01155">Unit.h:1155</a></div></div>
<div class="ttc" id="aclassUnit_html_a2bfc129a8ad6c9fa8ca94a0ed3c877fc"><div class="ttname"><a href="classUnit.html#a2bfc129a8ad6c9fa8ca94a0ed3c877fc">Unit::GetBeneficiary</a></div><div class="ttdeci">Unit * GetBeneficiary() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07724">Unit.cpp:7724</a></div></div>
<div class="ttc" id="aclassUnit_html_a30903f223f0668c6beae4a350d49a43a"><div class="ttname"><a href="classUnit.html#a30903f223f0668c6beae4a350d49a43a">Unit::GetCollisionHeight</a></div><div class="ttdeci">float GetCollisionHeight() const override</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l14253">Unit.cpp:14253</a></div></div>
<div class="ttc" id="aclassUnit_html_a32d1bc7bcf268626c01fece7409da915"><div class="ttname"><a href="classUnit.html#a32d1bc7bcf268626c01fece7409da915">Unit::GetMaster</a></div><div class="ttdeci">Unit * GetMaster(WorldObject const *pov=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07956">Unit.cpp:7956</a></div></div>
<div class="ttc" id="aclassUnit_html_a330a0f343946954a1996ee04cb9c6e3c"><div class="ttname"><a href="classUnit.html#a330a0f343946954a1996ee04cb9c6e3c">Unit::GetRangedDamageSchoolMask</a></div><div class="ttdeci">SpellSchoolMask GetRangedDamageSchoolMask(bool first=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02141">Unit.h:2141</a></div></div>
<div class="ttc" id="aclassUnit_html_a373a25c8d6ff3ca2f5653267c1269ad4"><div class="ttname"><a href="classUnit.html#a373a25c8d6ff3ca2f5653267c1269ad4">Unit::GetShapeshiftForm</a></div><div class="ttdeci">ShapeshiftForm GetShapeshiftForm() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02081">Unit.h:2081</a></div></div>
<div class="ttc" id="aclassUnit_html_a3ab5e0391df86f60b87c859c3ae64526"><div class="ttname"><a href="classUnit.html#a3ab5e0391df86f60b87c859c3ae64526">Unit::DoExtraAttacks</a></div><div class="ttdeci">void DoExtraAttacks(Unit *pVictim)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l03192">Unit.cpp:3192</a></div></div>
<div class="ttc" id="aclassUnit_html_a3d16a6eaa62aaad0ea31a39230b044eb"><div class="ttname"><a href="classUnit.html#a3d16a6eaa62aaad0ea31a39230b044eb">Unit::CalculateHealAbsorb</a></div><div class="ttdeci">void CalculateHealAbsorb(uint32 heal, uint32 *absorb)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l03068">Unit.cpp:3068</a></div></div>
<div class="ttc" id="aclassUnit_html_a3e205a20504de0ff1b2fcab7a8b0784e"><div class="ttname"><a href="classUnit.html#a3e205a20504de0ff1b2fcab7a8b0784e">Unit::SpellDamageBonusTaken</a></div><div class="ttdeci">uint32 SpellDamageBonusTaken(Unit *caster, SpellSchoolMask schoolMask, SpellEntry const *spellProto, uint32 pdamage, DamageEffectType damagetype, uint32 stack=1)</div><div class="ttdoc">Calculates target part of spell damage bonuses, will be called on each tick for periodic damage over ...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l08685">Unit.cpp:8685</a></div></div>
<div class="ttc" id="aclassUnit_html_a3fb2f210c37c2fe4b78abb0c9ab5f822"><div class="ttname"><a href="classUnit.html#a3fb2f210c37c2fe4b78abb0c9ab5f822">Unit::RemoveCreature</a></div><div class="ttdeci">void RemoveCreature(uint32 spellId, bool del)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07015">Unit.cpp:7015</a></div></div>
<div class="ttc" id="aclassUnit_html_a3fc13158f07e653acbf26ac015e9c248"><div class="ttname"><a href="classUnit.html#a3fc13158f07e653acbf26ac015e9c248">Unit::ClearComboPoints</a></div><div class="ttdeci">void ClearComboPoints()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l14413">Unit.cpp:14413</a></div></div>
<div class="ttc" id="aclassUnit_html_a435dd4706662b27b8e2885db11f788bb"><div class="ttname"><a href="classUnit.html#a435dd4706662b27b8e2885db11f788bb">Unit::IsInDisallowedMountForm</a></div><div class="ttdeci">bool IsInDisallowedMountForm() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02087">Unit.h:2087</a></div></div>
<div class="ttc" id="aclassUnit_html_a4380e734c7b5bff2ef337acc09973574"><div class="ttname"><a href="classUnit.html#a4380e734c7b5bff2ef337acc09973574">Unit::MeleeDamageBonusDone</a></div><div class="ttdeci">uint32 MeleeDamageBonusDone(Unit *victim, uint32 damage, WeaponAttackType attType, SpellSchoolMask schoolMask, SpellEntry const *spellProto=nullptr, DamageEffectType damagetype=DIRECT_DAMAGE, uint32 stack=1, bool flat=true)</div><div class="ttdoc">Calculates caster part of melee damage bonuses, also includes different bonuses dependent from target...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l09264">Unit.cpp:9264</a></div></div>
<div class="ttc" id="aclassUnit_html_a45bee1c004336ebfbadbde232797f559"><div class="ttname"><a href="classUnit.html#a45bee1c004336ebfbadbde232797f559">Unit::GetPet</a></div><div class="ttdeci">Pet * GetPet() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07997">Unit.cpp:7997</a></div></div>
<div class="ttc" id="aclassUnit_html_a45d6ec1693da1f1240b8569dd1b31d50"><div class="ttname"><a href="classUnit.html#a45d6ec1693da1f1240b8569dd1b31d50">Unit::HasAffectedAura</a></div><div class="ttdeci">bool HasAffectedAura(AuraType auraType, SpellEntry const *spellProto) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06692">Unit.cpp:6692</a></div></div>
<div class="ttc" id="aclassUnit_html_a48f6b76622c977dc6110c8f427781286"><div class="ttname"><a href="classUnit.html#a48f6b76622c977dc6110c8f427781286">Unit::RemoveAurasByCasterSpell</a></div><div class="ttdeci">void RemoveAurasByCasterSpell(uint32 spellId, ObjectGuid casterGuid, AuraRemoveMode mode=AURA_REMOVE_BY_DEFAULT)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06025">Unit.cpp:6025</a></div></div>
<div class="ttc" id="aclassUnit_html_a48fcb3d403534171f69d0be3b6003762"><div class="ttname"><a href="classUnit.html#a48fcb3d403534171f69d0be3b6003762">Unit::IsPvP</a></div><div class="ttdeci">bool IsPvP() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01500">Unit.h:1500</a></div></div>
<div class="ttc" id="aclassUnit_html_a4ae648f71881fd67bcdd861ec4ef2363"><div class="ttname"><a href="classUnit.html#a4ae648f71881fd67bcdd861ec4ef2363">Unit::GetPowerType</a></div><div class="ttdeci">Powers GetPowerType() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01417">Unit.h:1417</a></div></div>
<div class="ttc" id="aclassUnit_html_a4aefdbd94d5d5957bac3c0c5b0defc4c"><div class="ttname"><a href="classUnit.html#a4aefdbd94d5d5957bac3c0c5b0defc4c">Unit::hasUnitState</a></div><div class="ttdeci">bool hasUnitState(uint32 f) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01382">Unit.h:1382</a></div></div>
<div class="ttc" id="aclassUnit_html_a4b052589656cff0d352200a8817af23d"><div class="ttname"><a href="classUnit.html#a4b052589656cff0d352200a8817af23d">Unit::CalculateCritAmount</a></div><div class="ttdeci">uint32 CalculateCritAmount(const Unit *victim, uint32 amount, const SpellEntry *entry, bool heal=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l04341">Unit.cpp:4341</a></div></div>
<div class="ttc" id="aclassUnit_html_a5173c1774b09b42c409bf31280c37d36"><div class="ttname"><a href="classUnit.html#a5173c1774b09b42c409bf31280c37d36">Unit::GetMaxHealth</a></div><div class="ttdeci">uint32 GetMaxHealth() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01408">Unit.h:1408</a></div></div>
<div class="ttc" id="aclassUnit_html_a54a4815c604d6106323225732d74a7c2"><div class="ttname"><a href="classUnit.html#a54a4815c604d6106323225732d74a7c2">Unit::IsImmuneToSpellEffect</a></div><div class="ttdeci">virtual bool IsImmuneToSpellEffect(SpellEntry const *spellInfo, SpellEffectIndex index, bool castOnSelf) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l09166">Unit.cpp:9166</a></div></div>
<div class="ttc" id="aclassUnit_html_a5581f255ed1a06845549822b93734a8a"><div class="ttname"><a href="classUnit.html#a5581f255ed1a06845549822b93734a8a">Unit::GetTotemGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetTotemGuid(TotemSlot slot) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01970">Unit.h:1970</a></div></div>
<div class="ttc" id="aclassUnit_html_a57870b79c2a356567afd5febedf79a61"><div class="ttname"><a href="classUnit.html#a57870b79c2a356567afd5febedf79a61">Unit::GetPetGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetPetGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01927">Unit.h:1927</a></div></div>
<div class="ttc" id="aclassUnit_html_a5861302a7c0e64113cfc5bc6d5660fa4"><div class="ttname"><a href="classUnit.html#a5861302a7c0e64113cfc5bc6d5660fa4">Unit::IsClientControlled</a></div><div class="ttdeci">bool IsClientControlled(Player const *exactClient=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07738">Unit.cpp:7738</a></div></div>
<div class="ttc" id="aclassUnit_html_a58a507ebe628930b8a506144b364d84b"><div class="ttname"><a href="classUnit.html#a58a507ebe628930b8a506144b364d84b">Unit::getClass</a></div><div class="ttdeci">uint8 getClass() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01394">Unit.h:1394</a></div></div>
<div class="ttc" id="aclassUnit_html_a598220bd7032e604abfdb838b9d60f66"><div class="ttname"><a href="classUnit.html#a598220bd7032e604abfdb838b9d60f66">Unit::IsTaxiFlying</a></div><div class="ttdeci">bool IsTaxiFlying() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01705">Unit.h:1705</a></div></div>
<div class="ttc" id="aclassUnit_html_a59c69d64e6062cd5d429791a5ce986d6"><div class="ttname"><a href="classUnit.html#a59c69d64e6062cd5d429791a5ce986d6">Unit::FindGuardianWithEntry</a></div><div class="ttdeci">Pet * FindGuardianWithEntry(uint32 entry)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l08059">Unit.cpp:8059</a></div></div>
<div class="ttc" id="aclassUnit_html_a5a5e8db4955d382177621efa3c711a3d"><div class="ttname"><a href="classUnit.html#a5a5e8db4955d382177621efa3c711a3d">Unit::RemoveGameObject</a></div><div class="ttdeci">void RemoveGameObject(GameObject *gameObj, bool del, bool removeAura=true)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06942">Unit.cpp:6942</a></div></div>
<div class="ttc" id="aclassUnit_html_a5adeb5739c9662a46819362c9c9aad63"><div class="ttname"><a href="classUnit.html#a5adeb5739c9662a46819362c9c9aad63">Unit::IsSpellProccingHappening</a></div><div class="ttdeci">bool IsSpellProccingHappening() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02539">Unit.h:2539</a></div></div>
<div class="ttc" id="aclassUnit_html_a5ea3f54af571493f7889220724667189"><div class="ttname"><a href="classUnit.html#a5ea3f54af571493f7889220724667189">Unit::IsAlive</a></div><div class="ttdeci">bool IsAlive() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01895">Unit.h:1895</a></div></div>
<div class="ttc" id="aclassUnit_html_a5eb92537f6b7ef74746508c7c5790933"><div class="ttname"><a href="classUnit.html#a5eb92537f6b7ef74746508c7c5790933">Unit::IsAOEImmune</a></div><div class="ttdeci">bool IsAOEImmune() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02170">Unit.h:2170</a></div></div>
<div class="ttc" id="aclassUnit_html_a5f8e38db03da1828c7f5447548b393e3"><div class="ttname"><a href="classUnit.html#a5f8e38db03da1828c7f5447548b393e3">Unit::GetCombatReach</a></div><div class="ttdeci">float GetCombatReach() const override</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01171">Unit.h:1171</a></div></div>
<div class="ttc" id="aclassUnit_html_a6089f0c7239aabba634f5833e99c2e9f"><div class="ttname"><a href="classUnit.html#a6089f0c7239aabba634f5833e99c2e9f">Unit::SpellHitResult</a></div><div class="ttdeci">static SpellMissInfo SpellHitResult(WorldObject *caster, Unit *victim, SpellEntry const *spell, uint8 effectMask, bool reflectable=false, bool reflected=false, uint32 *heartbeatResistChance=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l03411">Unit.cpp:3411</a></div></div>
<div class="ttc" id="aclassUnit_html_a6120cbb5ad78aba476d2542776adbb8f"><div class="ttname"><a href="classUnit.html#a6120cbb5ad78aba476d2542776adbb8f">Unit::HasCharmer</a></div><div class="ttdeci">bool HasCharmer(ObjectGuid const &amp;exactGuid) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01905">Unit.h:1905</a></div></div>
<div class="ttc" id="aclassUnit_html_a618359e05114a5682c9205d03a70f5bd"><div class="ttname"><a href="classUnit.html#a618359e05114a5682c9205d03a70f5bd">Unit::CanEnterCombat</a></div><div class="ttdeci">bool CanEnterCombat() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02516">Unit.h:2516</a></div></div>
<div class="ttc" id="aclassUnit_html_a62196e93f86fd56823e665abd41864db"><div class="ttname"><a href="classUnit.html#a62196e93f86fd56823e665abd41864db">Unit::IsPlayerControlled</a></div><div class="ttdeci">bool IsPlayerControlled() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01497">Unit.h:1497</a></div></div>
<div class="ttc" id="aclassUnit_html_a640729ba10ac4fab61d1eb89cc38e762"><div class="ttname"><a href="classUnit.html#a640729ba10ac4fab61d1eb89cc38e762">Unit::GetComboTargetGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetComboTargetGuid() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02563">Unit.h:2563</a></div></div>
<div class="ttc" id="aclassUnit_html_a647422f3abc64359e7daf9930acf2c55"><div class="ttname"><a href="classUnit.html#a647422f3abc64359e7daf9930acf2c55">Unit::SelectMagnetTarget</a></div><div class="ttdeci">Unit * SelectMagnetTarget(Unit *victim, Spell *spell=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l08179">Unit.cpp:8179</a></div></div>
<div class="ttc" id="aclassUnit_html_a6535c9c8175652b8497b1615147636ac"><div class="ttname"><a href="classUnit.html#a6535c9c8175652b8497b1615147636ac">Unit::GetControllingPlayer</a></div><div class="ttdeci">Player const  * GetControllingPlayer(bool ignoreCharms=false) const</div><div class="ttdoc">Controlling player: get which player is the &quot;master&quot; of the unit gameplay-wise.</div><div class="ttdef"><b>Definition:</b> <a href="Relations_8cpp_source.html#l00072">Relations.cpp:72</a></div></div>
<div class="ttc" id="aclassUnit_html_a6591e720a2cfa309b6d693231b1fdbc0"><div class="ttname"><a href="classUnit.html#a6591e720a2cfa309b6d693231b1fdbc0">Unit::ModifyPower</a></div><div class="ttdeci">int32 ModifyPower(Powers power, int32 dVal)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10039">Unit.cpp:10039</a></div></div>
<div class="ttc" id="aclassUnit_html_a66120644adf09a45c139d48d4e4dce5b"><div class="ttname"><a href="classUnit.html#a66120644adf09a45c139d48d4e4dce5b">Unit::IsStandState</a></div><div class="ttdeci">bool IsStandState() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l12264">Unit.cpp:12264</a></div></div>
<div class="ttc" id="aclassUnit_html_a671aa59743c8e3919295551a5f113ce1"><div class="ttname"><a href="classUnit.html#a671aa59743c8e3919295551a5f113ce1">Unit::HasStealthAura</a></div><div class="ttdeci">bool HasStealthAura() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01774">Unit.h:1774</a></div></div>
<div class="ttc" id="aclassUnit_html_a69603536f743327afeb8e05f18751fd5"><div class="ttname"><a href="classUnit.html#a69603536f743327afeb8e05f18751fd5">Unit::DealDamageMods</a></div><div class="ttdeci">static void DealDamageMods(Unit *dealer, Unit *victim, uint32 &amp;damage, uint32 *absorb, DamageEffectType damagetype, SpellEntry const *spellProto=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00794">Unit.cpp:794</a></div></div>
<div class="ttc" id="aclassUnit_html_a6a942f7bfc8e8ea98ab52a0172970a35"><div class="ttname"><a href="classUnit.html#a6a942f7bfc8e8ea98ab52a0172970a35">Unit::GetCurrentSpell</a></div><div class="ttdeci">Spell * GetCurrentSpell(CurrentSpellTypes spellType) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02076">Unit.h:2076</a></div></div>
<div class="ttc" id="aclassUnit_html_a6d1af92863df5e94a0d4431c454f5b2d"><div class="ttname"><a href="classUnit.html#a6d1af92863df5e94a0d4431c454f5b2d">Unit::GetOwnerGuid</a></div><div class="ttdeci">ObjectGuid const  &amp; GetOwnerGuid() const override</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01924">Unit.h:1924</a></div></div>
<div class="ttc" id="aclassUnit_html_a6d62b1278097a22ea1ac17edf8b3203e"><div class="ttname"><a href="classUnit.html#a6d62b1278097a22ea1ac17edf8b3203e">Unit::HasChannelObject</a></div><div class="ttdeci">bool HasChannelObject(ObjectGuid const &amp;exactGuid=ObjectGuid()) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01909">Unit.h:1909</a></div></div>
<div class="ttc" id="aclassUnit_html_a71a4aa9c406af1ebf0c0eb7d77db04f6"><div class="ttname"><a href="classUnit.html#a71a4aa9c406af1ebf0c0eb7d77db04f6">Unit::GetCombatManager</a></div><div class="ttdeci">CombatManager &amp; GetCombatManager()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02194">Unit.h:2194</a></div></div>
<div class="ttc" id="aclassUnit_html_a71eb7e701f65d94e214db3eccf3b5b5e"><div class="ttname"><a href="classUnit.html#a71eb7e701f65d94e214db3eccf3b5b5e">Unit::RemoveSpellsCausingAura</a></div><div class="ttdeci">void RemoveSpellsCausingAura(AuraType auraType)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00738">Unit.cpp:738</a></div></div>
<div class="ttc" id="aclassUnit_html_a7329a53873078dc2ba6fd815f88e90b0"><div class="ttname"><a href="classUnit.html#a7329a53873078dc2ba6fd815f88e90b0">Unit::GetVehicleInfo</a></div><div class="ttdeci">VehicleInfo * GetVehicleInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01531">Unit.h:1531</a></div></div>
<div class="ttc" id="aclassUnit_html_a73967a331de4701d8202f10fce96550b"><div class="ttname"><a href="classUnit.html#a73967a331de4701d8202f10fce96550b">Unit::m_extraAttacks</a></div><div class="ttdeci">uint32 m_extraAttacks</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01291">Unit.h:1291</a></div></div>
<div class="ttc" id="aclassUnit_html_a74941197e0d88770ff7ae3d5f5d735f0"><div class="ttname"><a href="classUnit.html#a74941197e0d88770ff7ae3d5f5d735f0">Unit::IsFlying</a></div><div class="ttdeci">virtual bool IsFlying() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02490">Unit.h:2490</a></div></div>
<div class="ttc" id="aclassUnit_html_a78f36dfd898563ca5f10a8e3f0d9739e"><div class="ttname"><a href="classUnit.html#a78f36dfd898563ca5f10a8e3f0d9739e">Unit::HasTarget</a></div><div class="ttdeci">bool HasTarget(ObjectGuid const &amp;exactGuid=ObjectGuid()) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01908">Unit.h:1908</a></div></div>
<div class="ttc" id="aclassUnit_html_a7a2d19989c95ebef07fa00acf3ac9a0d"><div class="ttname"><a href="classUnit.html#a7a2d19989c95ebef07fa00acf3ac9a0d">Unit::SetChannelObject</a></div><div class="ttdeci">void SetChannelObject(WorldObject *object)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01920">Unit.h:1920</a></div></div>
<div class="ttc" id="aclassUnit_html_a7b9262f2f3fb35fed66a1807edcd7fc0"><div class="ttname"><a href="classUnit.html#a7b9262f2f3fb35fed66a1807edcd7fc0">Unit::GetSpellAuraHolderMap</a></div><div class="ttdeci">SpellAuraHolderMap &amp; GetSpellAuraHolderMap()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02223">Unit.h:2223</a></div></div>
<div class="ttc" id="aclassUnit_html_a7e54441e936d60c8d5debbf0f64b8d9c"><div class="ttname"><a href="classUnit.html#a7e54441e936d60c8d5debbf0f64b8d9c">Unit::GetLevel</a></div><div class="ttdeci">uint32 GetLevel() const override</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01391">Unit.h:1391</a></div></div>
<div class="ttc" id="aclassUnit_html_a80140b04cc4277697de8f853e7da90e8"><div class="ttname"><a href="classUnit.html#a80140b04cc4277697de8f853e7da90e8">Unit::GetCreatureType</a></div><div class="ttdeci">uint32 GetCreatureType() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l11040">Unit.cpp:11040</a></div></div>
<div class="ttc" id="aclassUnit_html_a81ad6a307a801355b33808d2f1e1ceee"><div class="ttname"><a href="classUnit.html#a81ad6a307a801355b33808d2f1e1ceee">Unit::RemoveAuraStack</a></div><div class="ttdeci">void RemoveAuraStack(uint32 spellId, int32 modifier=-1)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06212">Unit.cpp:6212</a></div></div>
<div class="ttc" id="aclassUnit_html_a81f3332259cc30966e133c4e3c60b159"><div class="ttname"><a href="classUnit.html#a81f3332259cc30966e133c4e3c60b159">Unit::SetCurrentCastedSpell</a></div><div class="ttdeci">void SetCurrentCastedSpell(Spell *pSpell)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05135">Unit.cpp:5135</a></div></div>
<div class="ttc" id="aclassUnit_html_a82ab342b3d9aef32e6fe61405eff82f3"><div class="ttname"><a href="classUnit.html#a82ab342b3d9aef32e6fe61405eff82f3">Unit::IsDead</a></div><div class="ttdeci">bool IsDead() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01896">Unit.h:1896</a></div></div>
<div class="ttc" id="aclassUnit_html_a85b1c936a9aff94dd00fb845f875e01e"><div class="ttname"><a href="classUnit.html#a85b1c936a9aff94dd00fb845f875e01e">Unit::IncrDiminishing</a></div><div class="ttdeci">void IncrDiminishing(DiminishingGroup group, bool pvp)</div><div class="ttdoc">Increases the level of the DiminishingGroup by one level up until DIMINISHING_LEVEL_IMMUNE where the ...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10916">Unit.cpp:10916</a></div></div>
<div class="ttc" id="aclassUnit_html_a87b4688e7aef0ea4562efb17f01971de"><div class="ttname"><a href="classUnit.html#a87b4688e7aef0ea4562efb17f01971de">Unit::GetAura</a></div><div class="ttdeci">Aura * GetAura(uint32 spellId, SpellEffectIndex effindex)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06705">Unit.cpp:6705</a></div></div>
<div class="ttc" id="aclassUnit_html_a89e8ca73fb924186a39d05a9789f6e15"><div class="ttname"><a href="classUnit.html#a89e8ca73fb924186a39d05a9789f6e15">Unit::getHostileRefManager</a></div><div class="ttdeci">HostileRefManager &amp; getHostileRefManager()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02189">Unit.h:2189</a></div></div>
<div class="ttc" id="aclassUnit_html_a8ae08365d2c318258d41e5f96fda5c3a"><div class="ttname"><a href="classUnit.html#a8ae08365d2c318258d41e5f96fda5c3a">Unit::clearUnitState</a></div><div class="ttdeci">void clearUnitState(uint32 f)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01383">Unit.h:1383</a></div></div>
<div class="ttc" id="aclassUnit_html_a8be0778766438c8076a946f3cd275406"><div class="ttname"><a href="classUnit.html#a8be0778766438c8076a946f3cd275406">Unit::CanHaveThreatList</a></div><div class="ttdeci">bool CanHaveThreatList(bool ignoreAliveState=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10605">Unit.cpp:10605</a></div></div>
<div class="ttc" id="aclassUnit_html_a8c4f494ad07fd452587995799a295199"><div class="ttname"><a href="classUnit.html#a8c4f494ad07fd452587995799a295199">Unit::hasOffhandWeaponForAttack</a></div><div class="ttdeci">bool hasOffhandWeaponForAttack() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01253">Unit.h:1253</a></div></div>
<div class="ttc" id="aclassUnit_html_a8f593b94abdf8507d7be268281111ea0"><div class="ttname"><a href="classUnit.html#a8f593b94abdf8507d7be268281111ea0">Unit::RollSpellCritOutcome</a></div><div class="ttdeci">static bool RollSpellCritOutcome(Unit *caster, const Unit *victim, SpellSchoolMask schoolMask, const SpellEntry *spell)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l04797">Unit.cpp:4797</a></div></div>
<div class="ttc" id="aclassUnit_html_a93f83fd909310de2c76382d00d7dbbf1"><div class="ttname"><a href="classUnit.html#a93f83fd909310de2c76382d00d7dbbf1">Unit::GetMaxPower</a></div><div class="ttdeci">uint32 GetMaxPower(Powers power) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01420">Unit.h:1420</a></div></div>
<div class="ttc" id="aclassUnit_html_a952ba21efc9b49995494c485733dabd8"><div class="ttname"><a href="classUnit.html#a952ba21efc9b49995494c485733dabd8">Unit::SetInCombatWithVictim</a></div><div class="ttdeci">void SetInCombatWithVictim(Unit *victim, bool touchOnly=false)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l09823">Unit.cpp:9823</a></div></div>
<div class="ttc" id="aclassUnit_html_a9556ed3ef1d6b11bc0a50966a4d38e70"><div class="ttname"><a href="classUnit.html#a9556ed3ef1d6b11bc0a50966a4d38e70">Unit::IsInWater</a></div><div class="ttdeci">virtual bool IsInWater() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05413">Unit.cpp:5413</a></div></div>
<div class="ttc" id="aclassUnit_html_a958172d6051b106e3b3c776e4f9f3952"><div class="ttname"><a href="classUnit.html#a958172d6051b106e3b3c776e4f9f3952">Unit::GetHealth</a></div><div class="ttdeci">uint32 GetHealth() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01407">Unit.h:1407</a></div></div>
<div class="ttc" id="aclassUnit_html_a959cfb5dafa2f964adb440d2b53c02f6"><div class="ttname"><a href="classUnit.html#a959cfb5dafa2f964adb440d2b53c02f6">Unit::ModifyHealth</a></div><div class="ttdeci">int32 ModifyHealth(int32 dVal)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10008">Unit.cpp:10008</a></div></div>
<div class="ttc" id="aclassUnit_html_a96443998b2a4b8ffd2af149939440837"><div class="ttname"><a href="classUnit.html#a96443998b2a4b8ffd2af149939440837">Unit::GetSpellRank</a></div><div class="ttdeci">virtual uint32 GetSpellRank(SpellEntry const *spellInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l14206">Unit.cpp:14206</a></div></div>
<div class="ttc" id="aclassUnit_html_a9678aa29c620e955f9a971c3c889c860"><div class="ttname"><a href="classUnit.html#a9678aa29c620e955f9a971c3c889c860">Unit::GetCreateHealth</a></div><div class="ttdeci">uint32 GetCreateHealth() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02048">Unit.h:2048</a></div></div>
<div class="ttc" id="aclassUnit_html_a987ecf860896e270fa44229a59ca3d64"><div class="ttname"><a href="classUnit.html#a987ecf860896e270fa44229a59ca3d64">Unit::IsIgnoreUnitState</a></div><div class="ttdeci">bool IsIgnoreUnitState(SpellEntry const *spell, IgnoreUnitState ignoreState) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l13087">Unit.cpp:13087</a></div></div>
<div class="ttc" id="aclassUnit_html_a9a22b23e02869d18b95c7493fb943ac8"><div class="ttname"><a href="classUnit.html#a9a22b23e02869d18b95c7493fb943ac8">Unit::GetChannelObject</a></div><div class="ttdeci">WorldObject * GetChannelObject(WorldObject const *pov=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07909">Unit.cpp:7909</a></div></div>
<div class="ttc" id="aclassUnit_html_a9aa5110031a70a1a839fd6a18368ff5b"><div class="ttname"><a href="classUnit.html#a9aa5110031a70a1a839fd6a18368ff5b">Unit::MeleeDamageBonusTaken</a></div><div class="ttdeci">uint32 MeleeDamageBonusTaken(Unit *caster, uint32 pdamage, WeaponAttackType attType, SpellSchoolMask schoolMask, SpellEntry const *spellProto=nullptr, DamageEffectType damagetype=DIRECT_DAMAGE, uint32 stack=1, bool flat=true)</div><div class="ttdoc">Calculates target part of melee damage bonuses, will be called on each tick for periodic damage over ...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l09531">Unit.cpp:9531</a></div></div>
<div class="ttc" id="aclassUnit_html_a9b2e89527196f64c5e3d48eb7d8bdfcf"><div class="ttname"><a href="classUnit.html#a9b2e89527196f64c5e3d48eb7d8bdfcf">Unit::AI</a></div><div class="ttdeci">virtual UnitAI * AI()</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02531">Unit.h:2531</a></div></div>
<div class="ttc" id="aclassUnit_html_a9cd076c7f1e10e71af51ffc1ea1f9136"><div class="ttname"><a href="classUnit.html#a9cd076c7f1e10e71af51ffc1ea1f9136">Unit::HasAuraType</a></div><div class="ttdeci">bool HasAuraType(AuraType auraType) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06678">Unit.cpp:6678</a></div></div>
<div class="ttc" id="aclassUnit_html_a9dfc2f86240462ac4fed816628251fc0"><div class="ttname"><a href="classUnit.html#a9dfc2f86240462ac4fed816628251fc0">Unit::IsAboveGround</a></div><div class="ttdeci">bool IsAboveGround(float diff=0.5f) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05428">Unit.cpp:5428</a></div></div>
<div class="ttc" id="aclassUnit_html_aa092f44b1d861f4e9c6adfb2a94b9b15"><div class="ttname"><a href="classUnit.html#aa092f44b1d861f4e9c6adfb2a94b9b15">Unit::CasterHitTargetWithSpell</a></div><div class="ttdeci">static void CasterHitTargetWithSpell(Unit *realCaster, Unit *target, SpellEntry const *spellInfo, bool triggered, bool success=true)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07185">Unit.cpp:7185</a></div></div>
<div class="ttc" id="aclassUnit_html_aa4192d3622a4c41d4c5a46a60209e62e"><div class="ttname"><a href="classUnit.html#aa4192d3622a4c41d4c5a46a60209e62e">Unit::GetAttackTime</a></div><div class="ttdeci">uint32 GetAttackTime(WeaponAttackType att) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01430">Unit.h:1430</a></div></div>
<div class="ttc" id="aclassUnit_html_aa480553e15719930865a6fab27c24302"><div class="ttname"><a href="classUnit.html#aa480553e15719930865a6fab27c24302">Unit::GetBeneficiaryPlayer</a></div><div class="ttdeci">Player * GetBeneficiaryPlayer() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07730">Unit.cpp:7730</a></div></div>
<div class="ttc" id="aclassUnit_html_aa8ff700c8aec70f3ab1e1385262959b1"><div class="ttname"><a href="classUnit.html#aa8ff700c8aec70f3ab1e1385262959b1">Unit::IsMounted</a></div><div class="ttdeci">bool IsMounted() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01526">Unit.h:1526</a></div></div>
<div class="ttc" id="aclassUnit_html_aa995aca7e6fe95e51400b6e8ec550837"><div class="ttname"><a href="classUnit.html#aa995aca7e6fe95e51400b6e8ec550837">Unit::DealHeal</a></div><div class="ttdeci">int32 DealHeal(Unit *pVictim, uint32 addhealth, SpellEntry const *spellProto, bool critical=false, uint32 absorb=0)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l08142">Unit.cpp:8142</a></div></div>
<div class="ttc" id="aclassUnit_html_aacd9531d802b8cd7fabaa515a8280388"><div class="ttname"><a href="classUnit.html#aacd9531d802b8cd7fabaa515a8280388">Unit::IsImmuneToDamage</a></div><div class="ttdeci">virtual bool IsImmuneToDamage(SpellSchoolMask meleeSchoolMask)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l09105">Unit.cpp:9105</a></div></div>
<div class="ttc" id="aclassUnit_html_aaf7877cad85523173a7bcd7af163e8cb"><div class="ttname"><a href="classUnit.html#aaf7877cad85523173a7bcd7af163e8cb">Unit::SendSpellNonMeleeDamageLog</a></div><div class="ttdeci">static void SendSpellNonMeleeDamageLog(SpellNonMeleeDamage *log)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07027">Unit.cpp:7027</a></div></div>
<div class="ttc" id="aclassUnit_html_ab0dc1a4e64a8e211c4a791c2570e4737"><div class="ttname"><a href="classUnit.html#ab0dc1a4e64a8e211c4a791c2570e4737">Unit::HasVisFlags</a></div><div class="ttdeci">bool HasVisFlags(uint8 flags)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01524">Unit.h:1524</a></div></div>
<div class="ttc" id="aclassUnit_html_ab5aafad1af4b12cba6e5b42460738a9e"><div class="ttname"><a href="classUnit.html#ab5aafad1af4b12cba6e5b42460738a9e">Unit::DealSpellDamage</a></div><div class="ttdeci">static void DealSpellDamage(Unit *affectiveCaster, SpellNonMeleeDamage *spellDamageInfo, bool durabilityLoss, bool resetLeash)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l01879">Unit.cpp:1879</a></div></div>
<div class="ttc" id="aclassUnit_html_ab7aa55eb03cc7e7d93894ccaf4e6f250"><div class="ttname"><a href="classUnit.html#ab7aa55eb03cc7e7d93894ccaf4e6f250">Unit::GetCharmer</a></div><div class="ttdeci">Unit * GetCharmer(WorldObject const *pov=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07822">Unit.cpp:7822</a></div></div>
<div class="ttc" id="aclassUnit_html_ab8ceebad76b0e65fa1f6c9031070a75c"><div class="ttname"><a href="classUnit.html#ab8ceebad76b0e65fa1f6c9031070a75c">Unit::GetCharm</a></div><div class="ttdeci">Unit * GetCharm(WorldObject const *pov=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07793">Unit.cpp:7793</a></div></div>
<div class="ttc" id="aclassUnit_html_aba59d4f43e3bef7a98ee904af4c60e73"><div class="ttname"><a href="classUnit.html#aba59d4f43e3bef7a98ee904af4c60e73">Unit::HasOverrideScript</a></div><div class="ttdeci">bool HasOverrideScript(uint32 id) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l14342">Unit.cpp:14342</a></div></div>
<div class="ttc" id="aclassUnit_html_abbbd9cc147469bc7f35075539bdf55a0"><div class="ttname"><a href="classUnit.html#abbbd9cc147469bc7f35075539bdf55a0">Unit::getClassMask</a></div><div class="ttdeci">uint32 getClassMask() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01395">Unit.h:1395</a></div></div>
<div class="ttc" id="aclassUnit_html_abc3ccbe4e8693ed5df548cbde2d94851"><div class="ttname"><a href="classUnit.html#abc3ccbe4e8693ed5df548cbde2d94851">Unit::CanReachWithMeleeAttack</a></div><div class="ttdeci">bool CanReachWithMeleeAttack(Unit const *pVictim, float flat_mod=0.0f) const</div><div class="ttdoc">Returns if the Unit can reach a victim with Melee Attack.</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00716">Unit.cpp:716</a></div></div>
<div class="ttc" id="aclassUnit_html_abe91abe7303db7af828a1e5044785295"><div class="ttname"><a href="classUnit.html#abe91abe7303db7af828a1e5044785295">Unit::HasCharm</a></div><div class="ttdeci">bool HasCharm(ObjectGuid const &amp;exactGuid=ObjectGuid()) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01904">Unit.h:1904</a></div></div>
<div class="ttc" id="aclassUnit_html_abefb328ba7a52fc7c5a16c60855b4d6a"><div class="ttname"><a href="classUnit.html#abefb328ba7a52fc7c5a16c60855b4d6a">Unit::GetMountID</a></div><div class="ttdeci">uint32 GetMountID() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01527">Unit.h:1527</a></div></div>
<div class="ttc" id="aclassUnit_html_ac02ccd551f5a7a64d197ceecfc3b3eee"><div class="ttname"><a href="classUnit.html#ac02ccd551f5a7a64d197ceecfc3b3eee">Unit::InterruptSpell</a></div><div class="ttdeci">void InterruptSpell(CurrentSpellTypes spellType, bool withDelayed=true, bool sendAutoRepeatCancelToClient=true)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05226">Unit.cpp:5226</a></div></div>
<div class="ttc" id="aclassUnit_html_ac5deedcb47695a681523e416b8456848"><div class="ttname"><a href="classUnit.html#ac5deedcb47695a681523e416b8456848">Unit::GetOwner</a></div><div class="ttdeci">Unit * GetOwner(WorldObject const *pov=nullptr, bool recursive=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07938">Unit.cpp:7938</a></div></div>
<div class="ttc" id="aclassUnit_html_ac6b72d2692bc7b4f8cbfccea9d40e520"><div class="ttname"><a href="classUnit.html#ac6b72d2692bc7b4f8cbfccea9d40e520">Unit::IsMoving</a></div><div class="ttdeci">bool IsMoving() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01868">Unit.h:1868</a></div></div>
<div class="ttc" id="aclassUnit_html_ac771f494288eae7dfad53907ec0fd7e3"><div class="ttname"><a href="classUnit.html#ac771f494288eae7dfad53907ec0fd7e3">Unit::IsVisibleForOrDetect</a></div><div class="ttdeci">bool IsVisibleForOrDetect(Unit const *u, WorldObject const *viewPoint, bool detect, bool inVisibleList=false, bool is3dDistance=true, bool spell=false, bool ignorePhase=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10070">Unit.cpp:10070</a></div></div>
<div class="ttc" id="aclassUnit_html_ac7ae0a42b6a31508ab24e2d1cf0bb983"><div class="ttname"><a href="classUnit.html#ac7ae0a42b6a31508ab24e2d1cf0bb983">Unit::GetSpellAuraHolder</a></div><div class="ttdeci">SpellAuraHolder * GetSpellAuraHolder(uint32 spellid) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l13139">Unit.cpp:13139</a></div></div>
<div class="ttc" id="aclassUnit_html_ac8514107959844cf3c748d30659241b6"><div class="ttname"><a href="classUnit.html#ac8514107959844cf3c748d30659241b6">Unit::HasAuraStateForCaster</a></div><div class="ttdeci">bool HasAuraStateForCaster(AuraState flag, ObjectGuid casterGuid) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07653">Unit.cpp:7653</a></div></div>
<div class="ttc" id="aclassUnit_html_aca7b70433ca6cf1a62190882b7077d2c"><div class="ttname"><a href="classUnit.html#aca7b70433ca6cf1a62190882b7077d2c">Unit::SpellDamageBonusDone</a></div><div class="ttdeci">uint32 SpellDamageBonusDone(Unit *victim, SpellSchoolMask schoolMask, SpellEntry const *spellProto, uint32 pdamage, DamageEffectType damagetype, uint32 stack=1)</div><div class="ttdoc">Calculates caster part of spell damage bonuses, also includes different bonuses dependent from target...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l08345">Unit.cpp:8345</a></div></div>
<div class="ttc" id="aclassUnit_html_acbcb021453f7b3ebce071a93ad539877"><div class="ttname"><a href="classUnit.html#acbcb021453f7b3ebce071a93ad539877">Unit::SendSpellMiss</a></div><div class="ttdeci">static void SendSpellMiss(WorldObject *caster, Unit *target, uint32 spellID, SpellMissInfo missInfo)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07141">Unit.cpp:7141</a></div></div>
<div class="ttc" id="aclassUnit_html_acce934b8f6ca08be9d7f7f7e773046d9"><div class="ttname"><a href="classUnit.html#acce934b8f6ca08be9d7f7f7e773046d9">Unit::GetDummyAura</a></div><div class="ttdeci">Aura * GetDummyAura(uint32 spell_id) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l12649">Unit.cpp:12649</a></div></div>
<div class="ttc" id="aclassUnit_html_acfffaa0b819e26d3586ccb46c13156ac"><div class="ttname"><a href="classUnit.html#acfffaa0b819e26d3586ccb46c13156ac">Unit::IsMovingForward</a></div><div class="ttdeci">bool IsMovingForward() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01870">Unit.h:1870</a></div></div>
<div class="ttc" id="aclassUnit_html_ad7e475d80b9af430cc076d7c01f967e9"><div class="ttname"><a href="classUnit.html#ad7e475d80b9af430cc076d7c01f967e9">Unit::GetPower</a></div><div class="ttdeci">uint32 GetPower(Powers power) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01419">Unit.h:1419</a></div></div>
<div class="ttc" id="aclassUnit_html_ad8ea13960b62a966b516a1929585ea7b"><div class="ttname"><a href="classUnit.html#ad8ea13960b62a966b516a1929585ea7b">Unit::GetTotalAuraModifier</a></div><div class="ttdeci">int32 GetTotalAuraModifier(AuraType auratype) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05441">Unit.cpp:5441</a></div></div>
<div class="ttc" id="aclassUnit_html_adaae3faffd48abb28c78f8dc1b6de40e"><div class="ttname"><a href="classUnit.html#adaae3faffd48abb28c78f8dc1b6de40e">Unit::GetCreatureTypeMask</a></div><div class="ttdeci">uint32 GetCreatureTypeMask() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01509">Unit.h:1509</a></div></div>
<div class="ttc" id="aclassUnit_html_adbad9a4cab962a2d72abbbc22d32f79d"><div class="ttname"><a href="classUnit.html#adbad9a4cab962a2d72abbbc22d32f79d">Unit::AddThreat</a></div><div class="ttdeci">void AddThreat(Unit *pVictim, float threat=0.0f, bool crit=false, SpellSchoolMask schoolMask=SPELL_SCHOOL_MASK_NONE, SpellEntry const *threatSpell=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l10651">Unit.cpp:10651</a></div></div>
<div class="ttc" id="aclassUnit_html_ae014a899d063f9eeb155e59a29e5c8b9"><div class="ttname"><a href="classUnit.html#ae014a899d063f9eeb155e59a29e5c8b9">Unit::GetClientControlling</a></div><div class="ttdeci">Player const  * GetClientControlling() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07765">Unit.cpp:7765</a></div></div>
<div class="ttc" id="aclassUnit_html_ae0ca62842bea9e94497c0200b37891d8"><div class="ttname"><a href="classUnit.html#ae0ca62842bea9e94497c0200b37891d8">Unit::GetCreateMana</a></div><div class="ttdeci">uint32 GetCreateMana() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02050">Unit.h:2050</a></div></div>
<div class="ttc" id="aclassUnit_html_ae1e6fbada450b9dc47424b2a20718ea5"><div class="ttname"><a href="classUnit.html#ae1e6fbada450b9dc47424b2a20718ea5">Unit::IsTrivialForTarget</a></div><div class="ttdeci">bool IsTrivialForTarget(Unit const *pov) const</div><div class="ttdoc">Trivial: Unit does not count as a worthy target for another unit.</div><div class="ttdef"><b>Definition:</b> <a href="Relations_8cpp_source.html#l00782">Relations.cpp:782</a></div></div>
<div class="ttc" id="aclassUnit_html_ae3c4d9c8d0f20933a40fb4498be62c29"><div class="ttname"><a href="classUnit.html#ae3c4d9c8d0f20933a40fb4498be62c29">Unit::GetHealthPercent</a></div><div class="ttdeci">float GetHealthPercent() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01409">Unit.h:1409</a></div></div>
<div class="ttc" id="aclassUnit_html_ae4a38d0c4dd65a2c51822fc8f605a1cc"><div class="ttname"><a href="classUnit.html#ae4a38d0c4dd65a2c51822fc8f605a1cc">Unit::GetRegenTimer</a></div><div class="ttdeci">uint32 GetRegenTimer() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02348">Unit.h:2348</a></div></div>
<div class="ttc" id="aclassUnit_html_ae5ea31897d0b7ba45822920e7d69e21d"><div class="ttname"><a href="classUnit.html#ae5ea31897d0b7ba45822920e7d69e21d">Unit::RemoveDynObject</a></div><div class="ttdeci">void RemoveDynObject(uint32 spellid)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06819">Unit.cpp:6819</a></div></div>
<div class="ttc" id="aclassUnit_html_ae74959b340f7d8d2874bc62a507b0d7e"><div class="ttname"><a href="classUnit.html#ae74959b340f7d8d2874bc62a507b0d7e">Unit::RemoveAurasOnCast</a></div><div class="ttdeci">void RemoveAurasOnCast(uint32 flag, SpellEntry const *castedSpellEntry)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06351">Unit.cpp:6351</a></div></div>
<div class="ttc" id="aclassUnit_html_ae7cb6d1cd6098219c4bf0ce064a34476"><div class="ttname"><a href="classUnit.html#ae7cb6d1cd6098219c4bf0ce064a34476">Unit::hasMainhandWeapon</a></div><div class="ttdeci">bool hasMainhandWeapon() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01244">Unit.h:1244</a></div></div>
<div class="ttc" id="aclassUnit_html_ae7f942c448b14628617639978bf6bd00"><div class="ttname"><a href="classUnit.html#ae7f942c448b14628617639978bf6bd00">Unit::resetAttackTimer</a></div><div class="ttdeci">void resetAttackTimer(WeaponAttackType type=BASE_ATTACK)</div><div class="ttdoc">Resets the attack timer to the base value decided by Unit::m_modAttackSpeedPct and Unit::GetAttackTim...</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l00711">Unit.cpp:711</a></div></div>
<div class="ttc" id="aclassUnit_html_aec7a5e4c0b6c77a57a2fb20b2c96ceb6"><div class="ttname"><a href="classUnit.html#aec7a5e4c0b6c77a57a2fb20b2c96ceb6">Unit::IsCrowdControlled</a></div><div class="ttdeci">bool IsCrowdControlled() const</div><div class="ttdoc">-------Various crowd control methods--------------</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02416">Unit.h:2416</a></div></div>
<div class="ttc" id="aclassUnit_html_aece2d5aca31571c643be33390ff1ef7a"><div class="ttname"><a href="classUnit.html#aece2d5aca31571c643be33390ff1ef7a">Unit::GetObjectBoundingRadius</a></div><div class="ttdeci">float GetObjectBoundingRadius() const override</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01170">Unit.h:1170</a></div></div>
<div class="ttc" id="aclassUnit_html_af0cab5ed9e6a02a565198db1d3db13a8"><div class="ttname"><a href="classUnit.html#af0cab5ed9e6a02a565198db1d3db13a8">Unit::IsNonMeleeSpellCasted</a></div><div class="ttdeci">bool IsNonMeleeSpellCasted(bool withDelayed, bool skipChanneled=false, bool skipAutorepeat=false, bool forMovement=false, bool forAutoIgnore=false, bool forEquip=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05267">Unit.cpp:5267</a></div></div>
<div class="ttc" id="aclassUnit_html_af3fdd69056fa0e608f38f5b7579a349e"><div class="ttname"><a href="classUnit.html#af3fdd69056fa0e608f38f5b7579a349e">Unit::AddSpellAuraHolder</a></div><div class="ttdeci">bool AddSpellAuraHolder(SpellAuraHolder *holder)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l05644">Unit.cpp:5644</a></div></div>
<div class="ttc" id="aclassUnit_html_af5be270efaac6557f4f394b7bcbbedcd"><div class="ttname"><a href="classUnit.html#af5be270efaac6557f4f394b7bcbbedcd">Unit::AddDelayedHolderDueToProc</a></div><div class="ttdeci">void AddDelayedHolderDueToProc(SpellAuraHolder *holder)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02540">Unit.h:2540</a></div></div>
<div class="ttc" id="aclassUnit_html_af5e75d013dfa8a8b888d7714992e3f2a"><div class="ttname"><a href="classUnit.html#af5e75d013dfa8a8b888d7714992e3f2a">Unit::IsInCombat</a></div><div class="ttdeci">bool IsInCombat() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01707">Unit.h:1707</a></div></div>
<div class="ttc" id="aclassUnit_html_af5f118a391194216cdd0ab4dcd2f48c3"><div class="ttname"><a href="classUnit.html#af5f118a391194216cdd0ab4dcd2f48c3">Unit::IsWalking</a></div><div class="ttdeci">bool IsWalking() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01872">Unit.h:1872</a></div></div>
<div class="ttc" id="aclassUnit_html_af79f29debc23c415fc9d3f2b02693552"><div class="ttname"><a href="classUnit.html#af79f29debc23c415fc9d3f2b02693552">Unit::HasAuraState</a></div><div class="ttdeci">bool HasAuraState(AuraState flag) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02281">Unit.h:2281</a></div></div>
<div class="ttc" id="aclassUnit_html_af7c17e4866662733d1f9e488d1eb9277"><div class="ttname"><a href="classUnit.html#af7c17e4866662733d1f9e488d1eb9277">Unit::GetVisibility</a></div><div class="ttdeci">UnitVisibility GetVisibility() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02152">Unit.h:2152</a></div></div>
<div class="ttc" id="aclassUnit_html_af873da0c7f334e3162d13ed19b32fc8b"><div class="ttname"><a href="classUnit.html#af873da0c7f334e3162d13ed19b32fc8b">Unit::GetTotalAttackPowerValue</a></div><div class="ttdeci">float GetTotalAttackPowerValue(WeaponAttackType attType) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l11258">Unit.cpp:11258</a></div></div>
<div class="ttc" id="aclassUnit_html_af8c91dcb86bd35e070c646e8baeaa4b4"><div class="ttname"><a href="classUnit.html#af8c91dcb86bd35e070c646e8baeaa4b4">Unit::GetVictim</a></div><div class="ttdeci">Unit * GetVictim() const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01368">Unit.h:1368</a></div></div>
<div class="ttc" id="aclassUnit_html_afb9b0972d880f4325cacf77b56af970f"><div class="ttname"><a href="classUnit.html#afb9b0972d880f4325cacf77b56af970f">Unit::GetDynObject</a></div><div class="ttdeci">DynamicObject * GetDynObject(uint32 spellId, SpellEffectIndex effIndex, Unit *target=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06850">Unit.cpp:6850</a></div></div>
<div class="ttc" id="aclassUnit_html_afc35f58684e81ba4956b79fc1434eb7b"><div class="ttname"><a href="classUnit.html#afc35f58684e81ba4956b79fc1434eb7b">Unit::IsInGroup</a></div><div class="ttdeci">virtual bool IsInGroup(Unit const *other, bool party=false, bool ignoreCharms=false) const</div><div class="ttdoc">Group: Unit counts as being placed in the same group (party or raid) with another unit (for gameplay ...</div><div class="ttdef"><b>Definition:</b> <a href="Relations_8cpp_source.html#l00827">Relations.cpp:827</a></div></div>
<div class="ttc" id="aclassUnit_html_afc3c9a652f2026707440d4e8bdd87930"><div class="ttname"><a href="classUnit.html#afc3c9a652f2026707440d4e8bdd87930">Unit::GetTarget</a></div><div class="ttdeci">Unit * GetTarget(WorldObject const *pov=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l07880">Unit.cpp:7880</a></div></div>
<div class="ttc" id="aclassUnit_html_affec6e6e8d949d59b14ab26d446451e9"><div class="ttname"><a href="classUnit.html#affec6e6e8d949d59b14ab26d446451e9">Unit::HasAura</a></div><div class="ttdeci">bool HasAura(uint32 spellId, SpellEffectIndex effIndex) const</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8cpp_source.html#l06743">Unit.cpp:6743</a></div></div>
<div class="ttc" id="aclassVMAP_1_1IVMapManager_html_a8133e2ccf88d4289a15d2b06c2fc5d09"><div class="ttname"><a href="classVMAP_1_1IVMapManager.html#a8133e2ccf88d4289a15d2b06c2fc5d09">VMAP::IVMapManager::isLineOfSightCalcEnabled</a></div><div class="ttdeci">bool isLineOfSightCalcEnabled() const</div><div class="ttdef"><b>Definition:</b> <a href="IVMapManager_8h_source.html#l00085">IVMapManager.h:85</a></div></div>
<div class="ttc" id="aclassVMAP_1_1VMapFactory_html_a4399cce3ece415fdddee4f9268eef318"><div class="ttname"><a href="classVMAP_1_1VMapFactory.html#a4399cce3ece415fdddee4f9268eef318">VMAP::VMapFactory::createOrGetVMapManager</a></div><div class="ttdeci">static IVMapManager * createOrGetVMapManager()</div><div class="ttdef"><b>Definition:</b> <a href="VMapFactory_8cpp_source.html#l00084">VMapFactory.cpp:84</a></div></div>
<div class="ttc" id="aclassVehicleInfo_html"><div class="ttname"><a href="classVehicleInfo.html">VehicleInfo</a></div><div class="ttdoc">A class to provide support for each vehicle.</div><div class="ttdef"><b>Definition:</b> <a href="Vehicle_8h_source.html#l00078">Vehicle.h:79</a></div></div>
<div class="ttc" id="aclassVisibilityData_html_abd5843be98f68600b1d2d33e4c79f989"><div class="ttname"><a href="classVisibilityData.html#abd5843be98f68600b1d2d33e4c79f989">VisibilityData::GetVisibilityDistance</a></div><div class="ttdeci">float GetVisibilityDistance() const</div><div class="ttdef"><b>Definition:</b> <a href="ObjectVisibility_8cpp_source.html#l00053">ObjectVisibility.cpp:53</a></div></div>
<div class="ttc" id="aclassWorldObject_html"><div class="ttname"><a href="classWorldObject.html">WorldObject</a></div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00946">Object.h:947</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a0288e97fcb616db1a040b76dd53e01e8"><div class="ttname"><a href="classWorldObject.html#a0288e97fcb616db1a040b76dd53e01e8">WorldObject::HasStringId</a></div><div class="ttdeci">bool HasStringId(std::string &amp;stringId) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01322">Object.cpp:1322</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a0725cae3f5e238dd7dbb15885cebc07c"><div class="ttname"><a href="classWorldObject.html#a0725cae3f5e238dd7dbb15885cebc07c">WorldObject::IsSpellReady</a></div><div class="ttdeci">bool IsSpellReady(SpellEntry const &amp;spellEntry, ItemPrototype const *itemProto=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02848">Object.cpp:2848</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a0a471b58ac8905281008aa4a730c4093"><div class="ttname"><a href="classWorldObject.html#a0a471b58ac8905281008aa4a730c4093">WorldObject::GetPhaseMask</a></div><div class="ttdeci">uint32 GetPhaseMask() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01047">Object.h:1047</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a0ad6f9e175dfd2cace9daf23c8b1d116"><div class="ttname"><a href="classWorldObject.html#a0ad6f9e175dfd2cace9daf23c8b1d116">WorldObject::HasGCD</a></div><div class="ttdeci">virtual bool HasGCD(SpellEntry const *spellEntry) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02754">Object.cpp:2754</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a0fb2dd50d97003331ae785f47767823d"><div class="ttname"><a href="classWorldObject.html#a0fb2dd50d97003331ae785f47767823d">WorldObject::IsWithinCombatDistInMap</a></div><div class="ttdeci">bool IsWithinCombatDistInMap(WorldObject const *obj, float dist2compare, bool is3D=true, bool ignorePhase=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01085">Object.h:1085</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a14343f33471333537df2c5ad4815d880"><div class="ttname"><a href="classWorldObject.html#a14343f33471333537df2c5ad4815d880">WorldObject::SetOrientation</a></div><div class="ttdeci">void SetOrientation(float orientation)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01383">Object.cpp:1383</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a175245431183066010c97936d9d901d7"><div class="ttname"><a href="classWorldObject.html#a175245431183066010c97936d9d901d7">WorldObject::AddCooldown</a></div><div class="ttdeci">virtual void AddCooldown(SpellEntry const &amp;spellEntry, ItemPrototype const *itemProto=nullptr, bool permanent=false, uint32 forcedDuration=0, bool ignoreCat=false)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02776">Object.cpp:2776</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a1aa5c63d01bca4b25f03a715554ea7a1"><div class="ttname"><a href="classWorldObject.html#a1aa5c63d01bca4b25f03a715554ea7a1">WorldObject::AddGCD</a></div><div class="ttdeci">virtual void AddGCD(SpellEntry const &amp;spellEntry, uint32 forcedDuration=0, bool updateClient=false)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02745">Object.cpp:2745</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a1cb0fbec598ac4d9d2507f9e575cfa37"><div class="ttname"><a href="classWorldObject.html#a1cb0fbec598ac4d9d2507f9e575cfa37">WorldObject::IsControlledByPlayer</a></div><div class="ttdeci">bool IsControlledByPlayer() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02688">Object.cpp:2688</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a26e87ddbab4b2f802e189ecb564e4400"><div class="ttname"><a href="classWorldObject.html#a26e87ddbab4b2f802e189ecb564e4400">WorldObject::IsWithinLOS</a></div><div class="ttdeci">bool IsWithinLOS(float ox, float oy, float oz, bool ignoreM2Model=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01551">Object.cpp:1551</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a30575160f50527439663406d3fa3991e"><div class="ttname"><a href="classWorldObject.html#a30575160f50527439663406d3fa3991e">WorldObject::DecreaseCastCounter</a></div><div class="ttdeci">void DecreaseCastCounter()</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01272">Object.h:1272</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a35e49e6fd39432117cdbacd76082287a"><div class="ttname"><a href="classWorldObject.html#a35e49e6fd39432117cdbacd76082287a">WorldObject::GetTerrain</a></div><div class="ttdeci">TerrainInfo const  * GetTerrain() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02155">Object.cpp:2155</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a3d968e0985931ee8bf2ebfd925e39563"><div class="ttname"><a href="classWorldObject.html#a3d968e0985931ee8bf2ebfd925e39563">WorldObject::IsFacingTargetsFront</a></div><div class="ttdeci">bool IsFacingTargetsFront(const WorldObject *target, float arc=M_PI_F) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01717">Object.cpp:1717</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a467ff0b4f5ae28f987aa368f1b095a7a"><div class="ttname"><a href="classWorldObject.html#a467ff0b4f5ae28f987aa368f1b095a7a">WorldObject::GetVisibilityData</a></div><div class="ttdeci">VisibilityData const  &amp; GetVisibilityData() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01227">Object.h:1227</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a485ded18163bda1b789be2283781780e"><div class="ttname"><a href="classWorldObject.html#a485ded18163bda1b789be2283781780e">WorldObject::GetMapId</a></div><div class="ttdeci">uint32 GetMapId() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01043">Object.h:1043</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a51ee0969c43fed32eacf1a56e24393eb"><div class="ttname"><a href="classWorldObject.html#a51ee0969c43fed32eacf1a56e24393eb">WorldObject::MovePositionToFirstCollision</a></div><div class="ttdeci">void MovePositionToFirstCollision(Position &amp;pos, float dist, float angle)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01815">Object.cpp:1815</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a5499518dd6ee5f72a817f6084727aaa7"><div class="ttname"><a href="classWorldObject.html#a5499518dd6ee5f72a817f6084727aaa7">WorldObject::RemoveSpellCooldown</a></div><div class="ttdeci">virtual void RemoveSpellCooldown(SpellEntry const &amp;spellEntry, bool updateClient=true)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02992">Object.cpp:2992</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a5cbbb61a820e361e86570a9e4440a121"><div class="ttname"><a href="classWorldObject.html#a5cbbb61a820e361e86570a9e4440a121">WorldObject::CanAssistSpell</a></div><div class="ttdeci">virtual bool CanAssistSpell(Unit const *, SpellEntry const *=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01223">Object.h:1223</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a5ccf191b3f924cd6af5a03e84e8f38d3"><div class="ttname"><a href="classWorldObject.html#a5ccf191b3f924cd6af5a03e84e8f38d3">WorldObject::IncrementDestLocCounter</a></div><div class="ttdeci">void IncrementDestLocCounter()</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01254">Object.h:1254</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a5e9a954bf661e8fb9a438be1d9894dac"><div class="ttname"><a href="classWorldObject.html#a5e9a954bf661e8fb9a438be1d9894dac">WorldObject::m_events</a></div><div class="ttdeci">EventProcessor m_events</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01265">Object.h:1265</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a67762eaa54f1dba00509f655e942e555"><div class="ttname"><a href="classWorldObject.html#a67762eaa54f1dba00509f655e942e555">WorldObject::CanAttackSpell</a></div><div class="ttdeci">virtual bool CanAttackSpell(Unit const *, SpellEntry const *=nullptr, bool=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01222">Object.h:1222</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a6cfca946eb93ed200cbda369751000bb"><div class="ttname"><a href="classWorldObject.html#a6cfca946eb93ed200cbda369751000bb">WorldObject::ResetGCD</a></div><div class="ttdeci">void ResetGCD(SpellEntry const *spellEntry=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l03002">Object.cpp:3002</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a6d6cc94b21f561fe7f46bc63177065c6"><div class="ttname"><a href="classWorldObject.html#a6d6cc94b21f561fe7f46bc63177065c6">WorldObject::GetFirstRandomAngleCollisionPosition</a></div><div class="ttdeci">Position GetFirstRandomAngleCollisionPosition(float dist, float angle)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01753">Object.cpp:1753</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a76c507a1b3adcebf2732572bc6b67fe0"><div class="ttname"><a href="classWorldObject.html#a76c507a1b3adcebf2732572bc6b67fe0">WorldObject::GetMap</a></div><div class="ttdeci">Map * GetMap() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01170">Object.h:1170</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a7c15606be3c15a33c98032fe4d190379"><div class="ttname"><a href="classWorldObject.html#a7c15606be3c15a33c98032fe4d190379">WorldObject::GetAngle</a></div><div class="ttdeci">float GetAngle(float x, float y) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01646">Object.cpp:1646</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a7f4ee8fde99df06076bdd19a3dd221a8"><div class="ttname"><a href="classWorldObject.html#a7f4ee8fde99df06076bdd19a3dd221a8">WorldObject::IsWithinLOSInMap</a></div><div class="ttdeci">bool IsWithinLOSInMap(const WorldObject *obj, bool ignoreM2Model=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01543">Object.cpp:1543</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a8655e3e9a37c11c4da647cd496f8f497"><div class="ttname"><a href="classWorldObject.html#a8655e3e9a37c11c4da647cd496f8f497">WorldObject::GetFirstCollisionPosition</a></div><div class="ttdeci">void GetFirstCollisionPosition(Position &amp;pos, float dist, float angle)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01034">Object.h:1034</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a87ee372cff9cd5f87dc4171ad3a7efef"><div class="ttname"><a href="classWorldObject.html#a87ee372cff9cd5f87dc4171ad3a7efef">WorldObject::GetTransport</a></div><div class="ttdeci">GenericTransport * GetTransport() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01239">Object.h:1239</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a8c065860771bc89789ff114c0b879657"><div class="ttname"><a href="classWorldObject.html#a8c065860771bc89789ff114c0b879657">WorldObject::GetClosePoint</a></div><div class="ttdeci">void GetClosePoint(float &amp;x, float &amp;y, float &amp;z, float bounding_radius, float distance2d=0.0f, float angle=0.0f, const WorldObject *obj=nullptr) const</div><div class="ttdoc">Gives a &quot;free&quot; spot for a searcher on the distance (including bounding-radius calculation)</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01003">Object.h:1003</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a902d498b61e1521f4abb69ce31da3880"><div class="ttname"><a href="classWorldObject.html#a902d498b61e1521f4abb69ce31da3880">WorldObject::GetDistance</a></div><div class="ttdeci">float GetDistance(const WorldObject *obj, bool is3D=true, DistanceCalculation distcalc=DIST_CALC_BOUNDING_RADIUS) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01416">Object.cpp:1416</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a912b62de052e01ee22d5035e54fa3792"><div class="ttname"><a href="classWorldObject.html#a912b62de052e01ee22d5035e54fa3792">WorldObject::GetSpellModOwner</a></div><div class="ttdeci">virtual Player * GetSpellModOwner() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01275">Object.h:1275</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a950bb10c341d39dff61c394009860ac3"><div class="ttname"><a href="classWorldObject.html#a950bb10c341d39dff61c394009860ac3">WorldObject::GetPositionY</a></div><div class="ttdeci">float GetPositionY() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00969">Object.h:969</a></div></div>
<div class="ttc" id="aclassWorldObject_html_a9c900e733e0e4b039682234dd9514a7e"><div class="ttname"><a href="classWorldObject.html#a9c900e733e0e4b039682234dd9514a7e">WorldObject::GetPositionZ</a></div><div class="ttdeci">float GetPositionZ() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00970">Object.h:970</a></div></div>
<div class="ttc" id="aclassWorldObject_html_aa61f3b716c5c149243ee668ceefd6e2b"><div class="ttname"><a href="classWorldObject.html#aa61f3b716c5c149243ee668ceefd6e2b">WorldObject::GetTransportInfo</a></div><div class="ttdeci">TransportInfo * GetTransportInfo() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00959">Object.h:959</a></div></div>
<div class="ttc" id="aclassWorldObject_html_aa66c526ae67a978c3c8abfef4e45df50"><div class="ttname"><a href="classWorldObject.html#aa66c526ae67a978c3c8abfef4e45df50">WorldObject::GetPositionX</a></div><div class="ttdeci">float GetPositionX() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00968">Object.h:968</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ab40a9c9bc4746738f352a493f889ffa6"><div class="ttname"><a href="classWorldObject.html#ab40a9c9bc4746738f352a493f889ffa6">WorldObject::GetCombinedCombatReach</a></div><div class="ttdeci">float GetCombinedCombatReach(WorldObject const *pVictim, bool forMeleeRange=true, float flat_mod=0.0f) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01900">Object.cpp:1900</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ab440853301a6657f9ab78a912260ad19"><div class="ttname"><a href="classWorldObject.html#ab440853301a6657f9ab78a912260ad19">WorldObject::GetNearPoint2d</a></div><div class="ttdeci">void GetNearPoint2d(float &amp;x, float &amp;y, float distance2d, float absAngle) const</div><div class="ttdoc">Gives a 2d-point in distance distance2d in direction absAngle around the current position (point-to-p...</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00979">Object.h:979</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ab6ca0a11a0d2bb8a7ec0110adb732857"><div class="ttname"><a href="classWorldObject.html#ab6ca0a11a0d2bb8a7ec0110adb732857">WorldObject::GetOrientation</a></div><div class="ttdeci">float GetOrientation() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00976">Object.h:976</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ac3a9048da8804951dcf3f639f4c957c5"><div class="ttname"><a href="classWorldObject.html#ac3a9048da8804951dcf3f639f4c957c5">WorldObject::IsSpellOnPermanentCooldown</a></div><div class="ttdeci">bool IsSpellOnPermanentCooldown(SpellEntry const &amp;spellEntry) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02900">Object.cpp:2900</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ac44de3d5f62990a31781ac8522ebeb68"><div class="ttname"><a href="classWorldObject.html#ac44de3d5f62990a31781ac8522ebeb68">WorldObject::IsFacingTargetsBack</a></div><div class="ttdeci">bool IsFacingTargetsBack(const WorldObject *target, float arc=M_PI_F) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01701">Object.cpp:1701</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ac6a93531977fc4f4bd5c245381883181"><div class="ttname"><a href="classWorldObject.html#ac6a93531977fc4f4bd5c245381883181">WorldObject::CalculateSpellEffectValue</a></div><div class="ttdeci">int32 CalculateSpellEffectValue(Unit const *target, SpellEntry const *spellProto, SpellEffectIndex effect_index, int32 const *basePoints=nullptr, bool maximum=false, bool finalUse=true) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l03118">Object.cpp:3118</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ad31c70778088c09b056d7c12ecb61e2a"><div class="ttname"><a href="classWorldObject.html#ad31c70778088c09b056d7c12ecb61e2a">WorldObject::IsWithinDist</a></div><div class="ttdeci">bool IsWithinDist(WorldObject const *obj, float dist2compare, bool is3D=true) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01095">Object.h:1095</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ad498d690fbe69bb99a8a2ffdcb2f5169"><div class="ttname"><a href="classWorldObject.html#ad498d690fbe69bb99a8a2ffdcb2f5169">WorldObject::GetZoneId</a></div><div class="ttdeci">uint32 GetZoneId() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01391">Object.cpp:1391</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ad7f9a1627d3568f34c381027145f39ee"><div class="ttname"><a href="classWorldObject.html#ad7f9a1627d3568f34c381027145f39ee">WorldObject::m_movementInfo</a></div><div class="ttdeci">MovementInfo m_movementInfo</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01242">Object.h:1242</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ae0338558ec4649199ff37b6ae422e0b2"><div class="ttname"><a href="classWorldObject.html#ae0338558ec4649199ff37b6ae422e0b2">WorldObject::HasInArc</a></div><div class="ttdeci">bool HasInArc(const WorldObject *target, float arc=M_PI_F) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01696">Object.cpp:1696</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ae09b9126882f6d2e0eb7d9bc3b1a11e9"><div class="ttname"><a href="classWorldObject.html#ae09b9126882f6d2e0eb7d9bc3b1a11e9">WorldObject::GetPosition</a></div><div class="ttdeci">void GetPosition(float &amp;x, float &amp;y, float &amp;z, GenericTransport *transport=nullptr) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02166">Object.cpp:2166</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ae1a8efe701e885f0ed1eaeb93bbece8e"><div class="ttname"><a href="classWorldObject.html#ae1a8efe701e885f0ed1eaeb93bbece8e">WorldObject::GetZoneAndAreaId</a></div><div class="ttdeci">void GetZoneAndAreaId(uint32 &amp;zoneid, uint32 &amp;areaid) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l01406">Object.cpp:1406</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ae8a0288e2dc30f6a70802970784f8f27"><div class="ttname"><a href="classWorldObject.html#ae8a0288e2dc30f6a70802970784f8f27">WorldObject::IsBoarded</a></div><div class="ttdeci">bool IsBoarded() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00960">Object.h:960</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ae8b3e48cdae0d8121ada8cd80fa29176"><div class="ttname"><a href="classWorldObject.html#ae8b3e48cdae0d8121ada8cd80fa29176">WorldObject::SendMessageToSet</a></div><div class="ttdeci">virtual void SendMessageToSet(WorldPacket const &amp;data, bool self) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l02072">Object.cpp:2072</a></div></div>
<div class="ttc" id="aclassWorldObject_html_ae93cbe6fc0feed133ffa419cf6771c19"><div class="ttname"><a href="classWorldObject.html#ae93cbe6fc0feed133ffa419cf6771c19">WorldObject::GetCombatReach</a></div><div class="ttdeci">virtual float GetCombatReach() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01024">Object.h:1024</a></div></div>
<div class="ttc" id="aclassWorldObject_html_aea0bc6446269c155fb3d9153e877588a"><div class="ttname"><a href="classWorldObject.html#aea0bc6446269c155fb3d9153e877588a">WorldObject::CheckAndIncreaseCastCounter</a></div><div class="ttdeci">bool CheckAndIncreaseCastCounter()</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l03309">Object.cpp:3309</a></div></div>
<div class="ttc" id="aclassWorldObject_html_aefb894f950c193c66d802e6f3c7313d3"><div class="ttname"><a href="classWorldObject.html#aefb894f950c193c66d802e6f3c7313d3">WorldObject::GetObjectBoundingRadius</a></div><div class="ttdeci">virtual float GetObjectBoundingRadius() const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01023">Object.h:1023</a></div></div>
<div class="ttc" id="aclassWorldObject_html_af64e9d16476e179813628d3bfda46059"><div class="ttname"><a href="classWorldObject.html#af64e9d16476e179813628d3bfda46059">WorldObject::GetDestLocCounter</a></div><div class="ttdeci">uint8 GetDestLocCounter()</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01253">Object.h:1253</a></div></div>
<div class="ttc" id="aclassWorldObject_html_afd0488a6497cff9e233990646ec78011"><div class="ttname"><a href="classWorldObject.html#afd0488a6497cff9e233990646ec78011">WorldObject::IsWithinDistInMap</a></div><div class="ttdeci">bool IsWithinDistInMap(WorldObject const *obj, float dist2compare, bool is3D=true, bool ignorePhase=false) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l01100">Object.h:1100</a></div></div>
<div class="ttc" id="aclassWorldPacket_html"><div class="ttname"><a href="classWorldPacket.html">WorldPacket</a></div><div class="ttdef"><b>Definition:</b> <a href="WorldPacket_8h_source.html#l00029">WorldPacket.h:30</a></div></div>
<div class="ttc" id="aclassWorldPacket_html_a59f4f321e9acdb083f31cc54f1203b21"><div class="ttname"><a href="classWorldPacket.html#a59f4f321e9acdb083f31cc54f1203b21">WorldPacket::Initialize</a></div><div class="ttdeci">void Initialize(Opcodes opcode, size_t newres=200)</div><div class="ttdef"><b>Definition:</b> <a href="WorldPacket_8h_source.html#l00046">WorldPacket.h:46</a></div></div>
<div class="ttc" id="aclassWorldSession_html_a15a10b125d9f54c3945a3daf319b228f"><div class="ttname"><a href="classWorldSession.html#a15a10b125d9f54c3945a3daf319b228f">WorldSession::SendPacket</a></div><div class="ttdeci">void SendPacket(WorldPacket const &amp;packet) const</div><div class="ttdoc">Send a packet to the client.</div><div class="ttdef"><b>Definition:</b> <a href="WorldSession_8cpp_source.html#l00202">WorldSession.cpp:202</a></div></div>
<div class="ttc" id="aclassWorldSession_html_a6518fa6d76b730689eb44f2256af3726"><div class="ttname"><a href="classWorldSession.html#a6518fa6d76b730689eb44f2256af3726">WorldSession::PlayerLoading</a></div><div class="ttdeci">bool PlayerLoading() const</div><div class="ttdef"><b>Definition:</b> <a href="WorldSession_8h_source.html#l00261">WorldSession.h:261</a></div></div>
<div class="ttc" id="aclassWorldSession_html_a90b597b1f9fd50438e1a555bd31aee54"><div class="ttname"><a href="classWorldSession.html#a90b597b1f9fd50438e1a555bd31aee54">WorldSession::GetRecruitingFriendId</a></div><div class="ttdeci">uint32 GetRecruitingFriendId() const</div><div class="ttdef"><b>Definition:</b> <a href="WorldSession_8h_source.html#l00482">WorldSession.h:482</a></div></div>
<div class="ttc" id="aclassWorld_html_ae1716f62b00fe8ba87a92850bf4d054c"><div class="ttname"><a href="classWorld.html#ae1716f62b00fe8ba87a92850bf4d054c">World::IsStopped</a></div><div class="ttdeci">static bool IsStopped()</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00591">World.h:591</a></div></div>
<div class="ttc" id="agroup__TransportSystem_html_ga072cf20fae85daa021188d1933cb193d"><div class="ttname"><a href="group__TransportSystem.html#ga072cf20fae85daa021188d1933cb193d">VehicleInfo::CanBoard</a></div><div class="ttdeci">bool CanBoard(Unit *passenger) const</div><div class="ttdoc">This function will check if a passenger can be boarded.</div><div class="ttdef"><b>Definition:</b> <a href="Vehicle_8cpp_source.html#l00484">Vehicle.cpp:484</a></div></div>
<div class="ttc" id="agroup__TransportSystem_html_ga29a9f9d1fcb4ec7d2d292379dad9ca69"><div class="ttname"><a href="group__TransportSystem.html#ga29a9f9d1fcb4ec7d2d292379dad9ca69">TransportBase::HasOnBoard</a></div><div class="ttdeci">bool HasOnBoard(WorldObject const *passenger) const</div><div class="ttdef"><b>Definition:</b> <a href="TransportSystem_8cpp_source.html#l00140">TransportSystem.cpp:140</a></div></div>
<div class="ttc" id="agroup__TransportSystem_html_ga2b0a1367e29e0733cd068edff0c2f0eb"><div class="ttname"><a href="group__TransportSystem.html#ga2b0a1367e29e0733cd068edff0c2f0eb">VehicleInfo::GetPassenger</a></div><div class="ttdeci">Unit * GetPassenger(uint8 seat) const</div><div class="ttdef"><b>Definition:</b> <a href="Vehicle_8cpp_source.html#l00517">Vehicle.cpp:517</a></div></div>
<div class="ttc" id="agroup__TransportSystem_html_gac3560ad689c70f8672b3f2e9bb675e54"><div class="ttname"><a href="group__TransportSystem.html#gac3560ad689c70f8672b3f2e9bb675e54">VehicleInfo::GetSeatForPassenger</a></div><div class="ttdeci">VehicleSeatEntry const  * GetSeatForPassenger(Unit const *passenger) const</div><div class="ttdef"><b>Definition:</b> <a href="Vehicle_8cpp_source.html#l00575">Vehicle.cpp:575</a></div></div>
<div class="ttc" id="agroup__game_html_gaa8baff9cbdf61bbb483c1e7ae739f930"><div class="ttname"><a href="group__game.html#gaa8baff9cbdf61bbb483c1e7ae739f930">DiminishingLevels</a></div><div class="ttdeci">DiminishingLevels</div><div class="ttdoc">The different available diminishing return levels.</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00601">Unit.h:602</a></div></div>
<div class="ttc" id="agroup__game_html_gab15b0fa4721a5e2edcc527603cab9006"><div class="ttname"><a href="group__game.html#gab15b0fa4721a5e2edcc527603cab9006">REGEN_TIME_PRECISE</a></div><div class="ttdeci">#define REGEN_TIME_PRECISE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01077">Unit.h:1077</a></div></div>
<div class="ttc" id="agroup__game_html_gab791040bd6d685b1fd2cfd12c96d0a1f"><div class="ttname"><a href="group__game.html#gab791040bd6d685b1fd2cfd12c96d0a1f">CurrentSpellTypes</a></div><div class="ttdeci">CurrentSpellTypes</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00860">Unit.h:861</a></div></div>
<div class="ttc" id="agroup__game_html_gafb539370dad036ff97905efdbb4270c0"><div class="ttname"><a href="group__game.html#gafb539370dad036ff97905efdbb4270c0">createProcExtendMask</a></div><div class="ttdeci">uint32 createProcExtendMask(SpellNonMeleeDamage *damageInfo, SpellMissInfo missCondition)</div><div class="ttdef"><b>Definition:</b> <a href="UnitAuraProcHandler_8cpp_source.html#l00363">UnitAuraProcHandler.cpp:363</a></div></div>
<div class="ttc" id="agroup__game_html_gga438f0aec316c954744ade1a737ec0a1da994d45dfc72710c872a9d657a380be69"><div class="ttname"><a href="group__game.html#gga438f0aec316c954744ade1a737ec0a1da994d45dfc72710c872a9d657a380be69">VISIBILITY_OFF</a></div><div class="ttdeci">@ VISIBILITY_OFF</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00492">Unit.h:492</a></div></div>
<div class="ttc" id="agroup__game_html_gga9a4f502870485ba32e759067c9adca94a132c6993498600b4a3cfda2b1639c166"><div class="ttname"><a href="group__game.html#gga9a4f502870485ba32e759067c9adca94a132c6993498600b4a3cfda2b1639c166">AURA_REMOVE_BY_CANCEL</a></div><div class="ttdeci">@ AURA_REMOVE_BY_CANCEL</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00277">Unit.h:277</a></div></div>
<div class="ttc" id="agroup__game_html_gga9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10"><div class="ttname"><a href="group__game.html#gga9a4f502870485ba32e759067c9adca94a9ca05b22853d12d44ac7e80a9e864a10">AURA_REMOVE_BY_EXPIRE</a></div><div class="ttdeci">@ AURA_REMOVE_BY_EXPIRE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00282">Unit.h:282</a></div></div>
<div class="ttc" id="agroup__game_html_ggaa8baff9cbdf61bbb483c1e7ae739f930a686cebb344da5f1a40407c2feb03d2da"><div class="ttname"><a href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a686cebb344da5f1a40407c2feb03d2da">DIMINISHING_LEVEL_1</a></div><div class="ttdeci">@ DIMINISHING_LEVEL_1</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00603">Unit.h:603</a></div></div>
<div class="ttc" id="agroup__game_html_ggaa8baff9cbdf61bbb483c1e7ae739f930a753de913b5eed5c74aaa9d3b567a3980"><div class="ttname"><a href="group__game.html#ggaa8baff9cbdf61bbb483c1e7ae739f930a753de913b5eed5c74aaa9d3b567a3980">DIMINISHING_LEVEL_IMMUNE</a></div><div class="ttdeci">@ DIMINISHING_LEVEL_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00607">Unit.h:606</a></div></div>
<div class="ttc" id="agroup__game_html_ggab791040bd6d685b1fd2cfd12c96d0a1fa960a792eef11d7eca70b058265e3cca6"><div class="ttname"><a href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fa960a792eef11d7eca70b058265e3cca6">CURRENT_CHANNELED_SPELL</a></div><div class="ttdeci">@ CURRENT_CHANNELED_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00865">Unit.h:865</a></div></div>
<div class="ttc" id="agroup__game_html_ggab791040bd6d685b1fd2cfd12c96d0a1fa9cbac6c5133585dece51a40e9c1908b0"><div class="ttname"><a href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fa9cbac6c5133585dece51a40e9c1908b0">CURRENT_GENERIC_SPELL</a></div><div class="ttdeci">@ CURRENT_GENERIC_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00863">Unit.h:863</a></div></div>
<div class="ttc" id="agroup__game_html_ggab791040bd6d685b1fd2cfd12c96d0a1fabf840fee2a2e133105c6a92a7b43a272"><div class="ttname"><a href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1fabf840fee2a2e133105c6a92a7b43a272">CURRENT_MELEE_SPELL</a></div><div class="ttdeci">@ CURRENT_MELEE_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00862">Unit.h:862</a></div></div>
<div class="ttc" id="agroup__game_html_ggab791040bd6d685b1fd2cfd12c96d0a1faf4d9017fa01b68842e61b948323e93c1"><div class="ttname"><a href="group__game.html#ggab791040bd6d685b1fd2cfd12c96d0a1faf4d9017fa01b68842e61b948323e93c1">CURRENT_AUTOREPEAT_SPELL</a></div><div class="ttdeci">@ CURRENT_AUTOREPEAT_SPELL</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00864">Unit.h:864</a></div></div>
<div class="ttc" id="agroup__game_html_ggac3ddc3a43d09c9614da506cc32d58a1fa32371c6eaf349ea13184f0734dba531a"><div class="ttname"><a href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1fa32371c6eaf349ea13184f0734dba531a">IGNORE_UNIT_TARGET_STATE</a></div><div class="ttdeci">@ IGNORE_UNIT_TARGET_STATE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01064">Unit.h:1064</a></div></div>
<div class="ttc" id="agroup__game_html_ggac3ddc3a43d09c9614da506cc32d58a1fa9ab5671633372236664220b6e7c55ebe"><div class="ttname"><a href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1fa9ab5671633372236664220b6e7c55ebe">IGNORE_UNIT_COMBAT_STATE</a></div><div class="ttdeci">@ IGNORE_UNIT_COMBAT_STATE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01065">Unit.h:1065</a></div></div>
<div class="ttc" id="agroup__game_html_ggac3ddc3a43d09c9614da506cc32d58a1faaf094ca60b104fc78b2b53be31de934c"><div class="ttname"><a href="group__game.html#ggac3ddc3a43d09c9614da506cc32d58a1faaf094ca60b104fc78b2b53be31de934c">IGNORE_UNIT_TARGET_NON_FROZEN</a></div><div class="ttdeci">@ IGNORE_UNIT_TARGET_NON_FROZEN</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l01066">Unit.h:1066</a></div></div>
<div class="ttc" id="agroup__game_html_ggae51d2ecb71f7a5cb3882982a622c9544a37563edfd6dad95b9c7ffaeff337f597"><div class="ttname"><a href="group__game.html#ggae51d2ecb71f7a5cb3882982a622c9544a37563edfd6dad95b9c7ffaeff337f597">UNIT_STAT_CHANNELING</a></div><div class="ttdeci">@ UNIT_STAT_CHANNELING</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00391">Unit.h:391</a></div></div>
<div class="ttc" id="agroup__game_html_ggae51d2ecb71f7a5cb3882982a622c9544a3b8c8f9de407420c730803e54454b841"><div class="ttname"><a href="group__game.html#ggae51d2ecb71f7a5cb3882982a622c9544a3b8c8f9de407420c730803e54454b841">UNIT_STAT_ROOT</a></div><div class="ttdeci">@ UNIT_STAT_ROOT</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00368">Unit.h:368</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552a20d03528858479b31941a42820257eeb"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a20d03528858479b31941a42820257eeb">UNIT_FLAG_STUNNED</a></div><div class="ttdeci">@ UNIT_FLAG_STUNNED</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00521">Unit.h:521</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552a5aa9f8e6a27782a3f628e9b44c9e6528"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a5aa9f8e6a27782a3f628e9b44c9e6528">UNIT_FLAG_UNTARGETABLE</a></div><div class="ttdeci">@ UNIT_FLAG_UNTARGETABLE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00519">Unit.h:519</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552a61338f487648d7d4fadaa8480d623593"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a61338f487648d7d4fadaa8480d623593">UNIT_FLAG_IMMUNE</a></div><div class="ttdeci">@ UNIT_FLAG_IMMUNE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00535">Unit.h:534</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552a6fe41521d08dba6583ba7bb9d45cef82"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a6fe41521d08dba6583ba7bb9d45cef82">UNIT_FLAG_PACIFIED</a></div><div class="ttdeci">@ UNIT_FLAG_PACIFIED</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00520">Unit.h:520</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552a889affbf3beefd9704c68058b2bc79e3"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a889affbf3beefd9704c68058b2bc79e3">UNIT_FLAG_CONFUSED</a></div><div class="ttdeci">@ UNIT_FLAG_CONFUSED</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00525">Unit.h:525</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552a8ad2e62c7207250ee894d9a30d6bf130"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552a8ad2e62c7207250ee894d9a30d6bf130">UNIT_FLAG_FLEEING</a></div><div class="ttdeci">@ UNIT_FLAG_FLEEING</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00526">Unit.h:526</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552aa65da9d539e832160f7097da6bd6c2c2"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552aa65da9d539e832160f7097da6bd6c2c2">UNIT_FLAG_UNINTERACTIBLE</a></div><div class="ttdeci">@ UNIT_FLAG_UNINTERACTIBLE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00528">Unit.h:528</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552ac5e049a6b427ad34206151958117403e"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac5e049a6b427ad34206151958117403e">UNIT_FLAG_SILENCED</a></div><div class="ttdeci">@ UNIT_FLAG_SILENCED</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00516">Unit.h:516</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ac75aa2eacc0e809ae582c85d245c1e4c">UNIT_FLAG_PLAYER_CONTROLLED</a></div><div class="ttdeci">@ UNIT_FLAG_PLAYER_CONTROLLED</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00506">Unit.h:506</a></div></div>
<div class="ttc" id="agroup__game_html_ggafaf72688a238d4ba16ba2ae1444cd552ad990ec1dc8c9d2fd611f145e9f752885"><div class="ttname"><a href="group__game.html#ggafaf72688a238d4ba16ba2ae1444cd552ad990ec1dc8c9d2fd611f145e9f752885">UNIT_FLAG_SKINNABLE</a></div><div class="ttdeci">@ UNIT_FLAG_SKINNABLE</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00529">Unit.h:529</a></div></div>
<div class="ttc" id="agroup__game_html_ggafb81d85f97b7b585d799a9c5e0e80e05acf622ff29910872498fde6f2e51a4919"><div class="ttname"><a href="group__game.html#ggafb81d85f97b7b585d799a9c5e0e80e05acf622ff29910872498fde6f2e51a4919">UNIT_VIS_FLAG_GHOST</a></div><div class="ttdeci">@ UNIT_VIS_FLAG_GHOST</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00124">Unit.h:124</a></div></div>
<div class="ttc" id="agroup__game_html_ggafd9f193edd86cc61d3f2413e3a1eaef5a75265f2aee2789b6ff926cb193a3954c"><div class="ttname"><a href="group__game.html#ggafd9f193edd86cc61d3f2413e3a1eaef5a75265f2aee2789b6ff926cb193a3954c">UNIT_FLAG2_ALLOW_CHEAT_SPELLS</a></div><div class="ttdeci">@ UNIT_FLAG2_ALLOW_CHEAT_SPELLS</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00557">Unit.h:557</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca29bc97615577d9b5ae49dfdcc0cd89c0"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca29bc97615577d9b5ae49dfdcc0cd89c0">SMSG_SPELL_FAILURE</a></div><div class="ttdeci">@ SMSG_SPELL_FAILURE</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00344">Opcodes.h:344</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca3c2614e3c2f2de0ab73cb59fcb74aa67"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca3c2614e3c2f2de0ab73cb59fcb74aa67">SMSG_SPELL_UPDATE_CHAIN_TARGETS</a></div><div class="ttdeci">@ SMSG_SPELL_UPDATE_CHAIN_TARGETS</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00853">Opcodes.h:853</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca5ad793f4246ce905e7c0e7461c1f8a6a"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca5ad793f4246ce905e7c0e7461c1f8a6a">SMSG_SPELLLOGEXECUTE</a></div><div class="ttdeci">@ SMSG_SPELLLOGEXECUTE</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00625">Opcodes.h:625</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca73deada371f16dfdd7a33852eeedf6d7"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca73deada371f16dfdd7a33852eeedf6d7">SMSG_SPELL_DELAYED</a></div><div class="ttdeci">@ SMSG_SPELL_DELAYED</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00519">Opcodes.h:519</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca791453a04d198ad003a1e894f8f1afdb"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca791453a04d198ad003a1e894f8f1afdb">MSG_CHANNEL_START</a></div><div class="ttdeci">@ MSG_CHANNEL_START</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00350">Opcodes.h:350</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca831df7c06a76c1d7d2ee0b93e4196bd8"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca831df7c06a76c1d7d2ee0b93e4196bd8">SMSG_NOTIFY_DEST_LOC_SPELL_CAST</a></div><div class="ttdeci">@ SMSG_NOTIFY_DEST_LOC_SPELL_CAST</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l01203">Opcodes.h:1203</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca894ec5b9322d0af11bb595ecdc682d0c"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca894ec5b9322d0af11bb595ecdc682d0c">MSG_CHANNEL_UPDATE</a></div><div class="ttdeci">@ MSG_CHANNEL_UPDATE</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00351">Opcodes.h:351</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002caca8c842ffb79613ffdbd170f8022690027"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002caca8c842ffb79613ffdbd170f8022690027">SMSG_SPELL_GO</a></div><div class="ttdeci">@ SMSG_SPELL_GO</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00343">Opcodes.h:343</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002cacaa825dfa6e5caf5277b9061d1d89b2c5e"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacaa825dfa6e5caf5277b9061d1d89b2c5e">SMSG_CAST_RESULT</a></div><div class="ttdeci">@ SMSG_CAST_RESULT</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00341">Opcodes.h:341</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002cacaafad81ba0b53d7dee67d2be33d440aa0"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacaafad81ba0b53d7dee67d2be33d440aa0">SMSG_SPELL_FAILED_OTHER</a></div><div class="ttdeci">@ SMSG_SPELL_FAILED_OTHER</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00715">Opcodes.h:715</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002cacad959b31adf2335af92f9a58c7240f305"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacad959b31adf2335af92f9a58c7240f305">SMSG_PET_CAST_FAILED</a></div><div class="ttdeci">@ SMSG_PET_CAST_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00349">Opcodes.h:349</a></div></div>
<div class="ttc" id="agroup__u2w_html_ggabeeee4622d9285fa92e9b61857002cacadcc6ea3886766911a099ffe2ea85b707"><div class="ttname"><a href="group__u2w.html#ggabeeee4622d9285fa92e9b61857002cacadcc6ea3886766911a099ffe2ea85b707">SMSG_SPELL_START</a></div><div class="ttdeci">@ SMSG_SPELL_START</div><div class="ttdef"><b>Definition:</b> <a href="Opcodes_8h_source.html#l00342">Opcodes.h:342</a></div></div>
<div class="ttc" id="agroup__world_html_ga05dfb35c344e5b947a19e4284e7f5fa7"><div class="ttname"><a href="group__world.html#ga05dfb35c344e5b947a19e4284e7f5fa7">sWorld</a></div><div class="ttdeci">#define sWorld</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00832">World.h:832</a></div></div>
<div class="ttc" id="agroup__world_html_gga0400d571bb6627ef2b170a4e0dc846cda0cb97e67445e4083344ab8e1f8792525"><div class="ttname"><a href="group__world.html#gga0400d571bb6627ef2b170a4e0dc846cda0cb97e67445e4083344ab8e1f8792525">CONFIG_BOOL_VMAP_INDOOR_CHECK</a></div><div class="ttdeci">@ CONFIG_BOOL_VMAP_INDOOR_CHECK</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00393">World.h:393</a></div></div>
<div class="ttc" id="agroup__world_html_ggad7288d27ab8a1132a5f30148c227f2bea1246d762d53d8197c3c4b7efb7fd2c73"><div class="ttname"><a href="group__world.html#ggad7288d27ab8a1132a5f30148c227f2bea1246d762d53d8197c3c4b7efb7fd2c73">CONFIG_FLOAT_RATE_POWER_RUNICPOWER_INCOME</a></div><div class="ttdeci">@ CONFIG_FLOAT_RATE_POWER_RUNICPOWER_INCOME</div><div class="ttdef"><b>Definition:</b> <a href="World_8h_source.html#l00248">World.h:248</a></div></div>
<div class="ttc" id="anamespaceMaNGOS_html_ae0f51133c9887d1ccc5b1dcc7e39f5e9"><div class="ttname"><a href="namespaceMaNGOS.html#ae0f51133c9887d1ccc5b1dcc7e39f5e9">MaNGOS::IsValidMapCoord</a></div><div class="ttdeci">bool IsValidMapCoord(float c)</div><div class="ttdef"><b>Definition:</b> <a href="GridDefines_8h_source.html#l00176">GridDefines.h:176</a></div></div>
<div class="ttc" id="astructAreaTrigger_html"><div class="ttname"><a href="structAreaTrigger.html">AreaTrigger</a></div><div class="ttdef"><b>Definition:</b> <a href="ObjectMgr_8h_source.html#l00086">ObjectMgr.h:87</a></div></div>
<div class="ttc" id="astructAuraCalcData_html"><div class="ttname"><a href="structAuraCalcData.html">AuraCalcData</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellScript_8h_source.html#l00077">SpellScript.h:78</a></div></div>
<div class="ttc" id="astructAuraScript_html_a200049c04ed6f2ce65168d5f3edf5d70"><div class="ttname"><a href="structAuraScript.html#a200049c04ed6f2ce65168d5f3edf5d70">AuraScript::OnAuraValueCalculate</a></div><div class="ttdeci">virtual int32 OnAuraValueCalculate(AuraCalcData &amp;, int32 value) const</div><div class="ttdef"><b>Definition:</b> <a href="SpellScript_8h_source.html#l00093">SpellScript.h:93</a></div></div>
<div class="ttc" id="astructCell_html_a07c1300d6a1d8ee38819103043b89b8f"><div class="ttname"><a href="structCell.html#a07c1300d6a1d8ee38819103043b89b8f">Cell::VisitAllObjects</a></div><div class="ttdeci">static void VisitAllObjects(const WorldObject *obj, T &amp;visitor, float radius, bool dont_load=true)</div><div class="ttdef"><b>Definition:</b> <a href="CellImpl_8h_source.html#l00197">CellImpl.h:197</a></div></div>
<div class="ttc" id="astructCell_html_a0a8ade7240c2a429df3d6a1de78b1881"><div class="ttname"><a href="structCell.html#a0a8ade7240c2a429df3d6a1de78b1881">Cell::VisitGridObjects</a></div><div class="ttdeci">static void VisitGridObjects(const WorldObject *obj, T &amp;visitor, float radius, bool dont_load=true)</div><div class="ttdef"><b>Definition:</b> <a href="CellImpl_8h_source.html#l00175">CellImpl.h:175</a></div></div>
<div class="ttc" id="astructCell_html_aaa71b83434fc3d01f05dfbde2030124e"><div class="ttname"><a href="structCell.html#aaa71b83434fc3d01f05dfbde2030124e">Cell::VisitWorldObjects</a></div><div class="ttdeci">static void VisitWorldObjects(const WorldObject *obj, T &amp;visitor, float radius, bool dont_load=true)</div><div class="ttdef"><b>Definition:</b> <a href="CellImpl_8h_source.html#l00186">CellImpl.h:186</a></div></div>
<div class="ttc" id="astructChainHealingOrder_html"><div class="ttname"><a href="structChainHealingOrder.html">ChainHealingOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01863">Spell.cpp:1864</a></div></div>
<div class="ttc" id="astructChainHealingOrder_html_a1a7f8e607cb96798badbfe3aba44bc46"><div class="ttname"><a href="structChainHealingOrder.html#a1a7f8e607cb96798badbfe3aba44bc46">ChainHealingOrder::ChainHealingHash</a></div><div class="ttdeci">int32 ChainHealingHash(Unit const *Target) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01872">Spell.cpp:1872</a></div></div>
<div class="ttc" id="astructChainHealingOrder_html_a225f1143167d0480852039d0bff91968"><div class="ttname"><a href="structChainHealingOrder.html#a225f1143167d0480852039d0bff91968">ChainHealingOrder::MainTarget</a></div><div class="ttdeci">const Unit * MainTarget</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01865">Spell.cpp:1865</a></div></div>
<div class="ttc" id="astructChainHealingOrder_html_a5377e9e938200c8c49b462d7ba5e7ebe"><div class="ttname"><a href="structChainHealingOrder.html#a5377e9e938200c8c49b462d7ba5e7ebe">ChainHealingOrder::operator()</a></div><div class="ttdeci">bool operator()(Unit const *_Left, Unit const *_Right) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01868">Spell.cpp:1868</a></div></div>
<div class="ttc" id="astructChainHealingOrder_html_ab54f807818bcf805e1d6b4ec729d1fff"><div class="ttname"><a href="structChainHealingOrder.html#ab54f807818bcf805e1d6b4ec729d1fff">ChainHealingOrder::ChainHealingOrder</a></div><div class="ttdeci">ChainHealingOrder(Unit const *Target)</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l01866">Spell.cpp:1866</a></div></div>
<div class="ttc" id="astructCreatureInfo_html_a0522fb9f0ed5b0181419a05c48488c36"><div class="ttname"><a href="structCreatureInfo.html#a0522fb9f0ed5b0181419a05c48488c36">CreatureInfo::IsExotic</a></div><div class="ttdeci">bool IsExotic() const</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00200">Creature.h:200</a></div></div>
<div class="ttc" id="astructCreatureInfo_html_a29c2544ffdafdff1fc3b382d44dd4474"><div class="ttname"><a href="structCreatureInfo.html#a29c2544ffdafdff1fc3b382d44dd4474">CreatureInfo::PickpocketLootId</a></div><div class="ttdeci">uint32 PickpocketLootId</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00148">Creature.h:148</a></div></div>
<div class="ttc" id="astructCreatureInfo_html_a4f708c2c90352dbcfd9bb23cb66238b3"><div class="ttname"><a href="structCreatureInfo.html#a4f708c2c90352dbcfd9bb23cb66238b3">CreatureInfo::isTameable</a></div><div class="ttdeci">bool isTameable(bool exotic) const</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00205">Creature.h:205</a></div></div>
<div class="ttc" id="astructCreatureInfo_html_a88de6cb7b80a9bcd956f0571a9584f67"><div class="ttname"><a href="structCreatureInfo.html#a88de6cb7b80a9bcd956f0571a9584f67">CreatureInfo::GetRequiredLootSkill</a></div><div class="ttdeci">SkillType GetRequiredLootSkill() const</div><div class="ttdef"><b>Definition:</b> <a href="Creature_8h_source.html#l00188">Creature.h:188</a></div></div>
<div class="ttc" id="astructGlyphPropertiesEntry_html"><div class="ttname"><a href="structGlyphPropertiesEntry.html">GlyphPropertiesEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01093">DBCStructure.h:1094</a></div></div>
<div class="ttc" id="astructGridMapLiquidData_html"><div class="ttname"><a href="structGridMapLiquidData.html">GridMapLiquidData</a></div><div class="ttdef"><b>Definition:</b> <a href="GridMapDefines_8h_source.html#l00078">GridMapDefines.h:79</a></div></div>
<div class="ttc" id="astructGridMapLiquidData_html_a01d18d12493aa275f6b4f7a7f273ceb2"><div class="ttname"><a href="structGridMapLiquidData.html#a01d18d12493aa275f6b4f7a7f273ceb2">GridMapLiquidData::level</a></div><div class="ttdeci">float level</div><div class="ttdef"><b>Definition:</b> <a href="GridMapDefines_8h_source.html#l00082">GridMapDefines.h:82</a></div></div>
<div class="ttc" id="astructGtNPCManaCostScalerEntry_html"><div class="ttname"><a href="structGtNPCManaCostScalerEntry.html">GtNPCManaCostScalerEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01190">DBCStructure.h:1191</a></div></div>
<div class="ttc" id="astructGtNPCManaCostScalerEntry_html_a4d2880eb4c15dca8148ee5aa21920e6d"><div class="ttname"><a href="structGtNPCManaCostScalerEntry.html#a4d2880eb4c15dca8148ee5aa21920e6d">GtNPCManaCostScalerEntry::ratio</a></div><div class="ttdeci">float ratio</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01192">DBCStructure.h:1192</a></div></div>
<div class="ttc" id="astructInstancePlayerBind_html"><div class="ttname"><a href="structInstancePlayerBind.html">InstancePlayerBind</a></div><div class="ttdef"><b>Definition:</b> <a href="Player_8h_source.html#l00888">Player.h:889</a></div></div>
<div class="ttc" id="astructInstanceTemplate_html"><div class="ttname"><a href="structInstanceTemplate.html">InstanceTemplate</a></div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00073">Map.h:74</a></div></div>
<div class="ttc" id="astructInstanceTemplate_html_aa3fadb2df1c8094a50db302c6c8de15b"><div class="ttname"><a href="structInstanceTemplate.html#aa3fadb2df1c8094a50db302c6c8de15b">InstanceTemplate::levelMin</a></div><div class="ttdeci">uint32 levelMin</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00078">Map.h:78</a></div></div>
<div class="ttc" id="astructInstanceTemplate_html_abb52f9da39919323cbdcbdf1e736ec00"><div class="ttname"><a href="structInstanceTemplate.html#abb52f9da39919323cbdcbdf1e736ec00">InstanceTemplate::levelMax</a></div><div class="ttdeci">uint32 levelMax</div><div class="ttdef"><b>Definition:</b> <a href="Map_8h_source.html#l00079">Map.h:79</a></div></div>
<div class="ttc" id="astructItemEntry_html"><div class="ttname"><a href="structItemEntry.html">ItemEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01246">DBCStructure.h:1247</a></div></div>
<div class="ttc" id="astructItemPrototype_html"><div class="ttname"><a href="structItemPrototype.html">ItemPrototype</a></div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00589">ItemPrototype.h:590</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a1818791c8035a7cd3cf441c79d34fb66"><div class="ttname"><a href="structItemPrototype.html#a1818791c8035a7cd3cf441c79d34fb66">ItemPrototype::Class</a></div><div class="ttdeci">uint32 Class</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00592">ItemPrototype.h:592</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a2b8cde54716446647b4cfef0c3cf61fe"><div class="ttname"><a href="structItemPrototype.html#a2b8cde54716446647b4cfef0c3cf61fe">ItemPrototype::IsVellum</a></div><div class="ttdeci">bool IsVellum() const</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00717">ItemPrototype.h:717</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a547d8fb983ba4c47d8803940a04fa521"><div class="ttname"><a href="structItemPrototype.html#a547d8fb983ba4c47d8803940a04fa521">ItemPrototype::DisplayInfoID</a></div><div class="ttdeci">uint32 DisplayInfoID</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00596">ItemPrototype.h:596</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a6b5f71419f275de1891c1464d72af61c"><div class="ttname"><a href="structItemPrototype.html#a6b5f71419f275de1891c1464d72af61c">ItemPrototype::ItemId</a></div><div class="ttdeci">uint32 ItemId</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00591">ItemPrototype.h:591</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a7a22f8ff5b6866d5d6da4ed241029877"><div class="ttname"><a href="structItemPrototype.html#a7a22f8ff5b6866d5d6da4ed241029877">ItemPrototype::DisenchantID</a></div><div class="ttdeci">uint32 DisenchantID</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00661">ItemPrototype.h:661</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a8eca0641dc694b14de2db0e23a341328"><div class="ttname"><a href="structItemPrototype.html#a8eca0641dc694b14de2db0e23a341328">ItemPrototype::ItemLevel</a></div><div class="ttdeci">uint32 ItemLevel</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00606">ItemPrototype.h:606</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a8fe5d2c25f9cf0dc186c1ce8533410db"><div class="ttname"><a href="structItemPrototype.html#a8fe5d2c25f9cf0dc186c1ce8533410db">ItemPrototype::ItemLimitCategory</a></div><div class="ttdeci">uint32 ItemLimitCategory</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00658">ItemPrototype.h:658</a></div></div>
<div class="ttc" id="astructItemPrototype_html_a912c943c6d40c3537c319eda5393604a"><div class="ttname"><a href="structItemPrototype.html#a912c943c6d40c3537c319eda5393604a">ItemPrototype::InventoryType</a></div><div class="ttdeci">uint32 InventoryType</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00603">ItemPrototype.h:603</a></div></div>
<div class="ttc" id="astructItemPrototype_html_ad09dd92ab1fcf2a86060fb36120459b3"><div class="ttname"><a href="structItemPrototype.html#ad09dd92ab1fcf2a86060fb36120459b3">ItemPrototype::SubClass</a></div><div class="ttdeci">uint32 SubClass</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00593">ItemPrototype.h:593</a></div></div>
<div class="ttc" id="astructItemPrototype_html_ad7684c702be4fdb4ce87d4a83092d215"><div class="ttname"><a href="structItemPrototype.html#ad7684c702be4fdb4ce87d4a83092d215">ItemPrototype::RequiredSkillRank</a></div><div class="ttdeci">uint32 RequiredSkillRank</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00609">ItemPrototype.h:609</a></div></div>
<div class="ttc" id="astructItemPrototype_html_ad84fbcdf7890c7bad885a8ae5a02f19e"><div class="ttname"><a href="structItemPrototype.html#ad84fbcdf7890c7bad885a8ae5a02f19e">ItemPrototype::Stackable</a></div><div class="ttdeci">int32 Stackable</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00616">ItemPrototype.h:616</a></div></div>
<div class="ttc" id="astructItemPrototype_html_ae86c1831acf411538d41b9015630c326"><div class="ttname"><a href="structItemPrototype.html#ae86c1831acf411538d41b9015630c326">ItemPrototype::Spells</a></div><div class="ttdeci">_Spell Spells[MAX_ITEM_PROTO_SPELLS]</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00633">ItemPrototype.h:633</a></div></div>
<div class="ttc" id="astructItemPrototype_html_af7a886f8c92b50336befba9567265017"><div class="ttname"><a href="structItemPrototype.html#af7a886f8c92b50336befba9567265017">ItemPrototype::Flags</a></div><div class="ttdeci">uint32 Flags</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00598">ItemPrototype.h:598</a></div></div>
<div class="ttc" id="astructItemPrototype_html_af8c932938fa05286e451a814bf226037"><div class="ttname"><a href="structItemPrototype.html#af8c932938fa05286e451a814bf226037">ItemPrototype::RequiredDisenchantSkill</a></div><div class="ttdeci">int32 RequiredDisenchantSkill</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00655">ItemPrototype.h:655</a></div></div>
<div class="ttc" id="astructLockEntry_html"><div class="ttname"><a href="structLockEntry.html">LockEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01443">DBCStructure.h:1444</a></div></div>
<div class="ttc" id="astructLockEntry_html_a39b0b548efd795c162926bddcdd301b5"><div class="ttname"><a href="structLockEntry.html#a39b0b548efd795c162926bddcdd301b5">LockEntry::Type</a></div><div class="ttdeci">uint32 Type[MAX_LOCK_CASE]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01446">DBCStructure.h:1446</a></div></div>
<div class="ttc" id="astructLockEntry_html_aa58e046529aae0d1d6201c08ec8107e2"><div class="ttname"><a href="structLockEntry.html#aa58e046529aae0d1d6201c08ec8107e2">LockEntry::Index</a></div><div class="ttdeci">uint32 Index[MAX_LOCK_CASE]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01447">DBCStructure.h:1447</a></div></div>
<div class="ttc" id="astructLockEntry_html_aed5e58cf605d3c28cd0d26015722be03"><div class="ttname"><a href="structLockEntry.html#aed5e58cf605d3c28cd0d26015722be03">LockEntry::Skill</a></div><div class="ttdeci">uint32 Skill[MAX_LOCK_CASE]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01448">DBCStructure.h:1448</a></div></div>
<div class="ttc" id="astructLowestHPNearestOrder_html"><div class="ttname"><a href="structLowestHPNearestOrder.html">LowestHPNearestOrder</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02918">Unit.h:2919</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1CreatureLastSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1CreatureLastSearcher.html">MaNGOS::CreatureLastSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00422">GridNotifiers.h:423</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1CreatureListSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1CreatureListSearcher.html">MaNGOS::CreatureListSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00437">GridNotifiers.h:438</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1GameObjectListSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1GameObjectListSearcher.html">MaNGOS::GameObjectListSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00336">GridNotifiers.h:337</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1GameObjectSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1GameObjectSearcher.html">MaNGOS::GameObjectSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00305">GridNotifiers.h:306</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1PlayerListSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1PlayerListSearcher.html">MaNGOS::PlayerListSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00488">GridNotifiers.h:489</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1SpellMessageDestLocDeliverer_html"><div class="ttname"><a href="structMaNGOS_1_1SpellMessageDestLocDeliverer.html">MaNGOS::SpellMessageDestLocDeliverer</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00119">GridNotifiers.h:120</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1SpellMessageDestLocDeliverer_html_a8c132c13b010975bbf96636c30ef5264"><div class="ttname"><a href="structMaNGOS_1_1SpellMessageDestLocDeliverer.html#a8c132c13b010975bbf96636c30ef5264">MaNGOS::SpellMessageDestLocDeliverer::StopAccumulating</a></div><div class="ttdeci">void StopAccumulating()</div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00128">GridNotifiers.h:128</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1SpellNotifierCreatureAndPlayer_html"><div class="ttname"><a href="structMaNGOS_1_1SpellNotifierCreatureAndPlayer.html">MaNGOS::SpellNotifierCreatureAndPlayer</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01145">Spell.h:1146</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1SpellNotifierCreatureAndPlayer_html_a8c674f90c3d5c58499705ea1843873dc"><div class="ttname"><a href="structMaNGOS_1_1SpellNotifierCreatureAndPlayer.html#a8c674f90c3d5c58499705ea1843873dc">MaNGOS::SpellNotifierCreatureAndPlayer::GetCenterX</a></div><div class="ttdeci">float GetCenterX() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01160">Spell.h:1160</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1SpellNotifierCreatureAndPlayer_html_ad0294a1224109c2aa306575e5105aece"><div class="ttname"><a href="structMaNGOS_1_1SpellNotifierCreatureAndPlayer.html#ad0294a1224109c2aa306575e5105aece">MaNGOS::SpellNotifierCreatureAndPlayer::GetCenterY</a></div><div class="ttdeci">float GetCenterY() const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01161">Spell.h:1161</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1UnitListSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1UnitListSearcher.html">MaNGOS::UnitListSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00388">GridNotifiers.h:389</a></div></div>
<div class="ttc" id="astructMaNGOS_1_1WorldObjectSearcher_html"><div class="ttname"><a href="structMaNGOS_1_1WorldObjectSearcher.html">MaNGOS::WorldObjectSearcher</a></div><div class="ttdef"><b>Definition:</b> <a href="GridNotifiers_8h_source.html#l00219">GridNotifiers.h:220</a></div></div>
<div class="ttc" id="astructMapEntry_html"><div class="ttname"><a href="structMapEntry.html">MapEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01460">DBCStructure.h:1461</a></div></div>
<div class="ttc" id="astructMapEntry_html_ad9902fc9b28ba9b555b45c0662aa0397"><div class="ttname"><a href="structMapEntry.html#ad9902fc9b28ba9b555b45c0662aa0397">MapEntry::IsDungeon</a></div><div class="ttdeci">bool IsDungeon() const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01487">DBCStructure.h:1487</a></div></div>
<div class="ttc" id="astructPosition_html"><div class="ttname"><a href="structPosition.html">Position</a></div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00330">Object.h:331</a></div></div>
<div class="ttc" id="astructPosition_html_a54a6182b5f7539295b32255808897d3f"><div class="ttname"><a href="structPosition.html#a54a6182b5f7539295b32255808897d3f">Position::y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00335">Object.h:335</a></div></div>
<div class="ttc" id="astructPosition_html_a5dc8c08d3d7209ba538ad21ba604aa44"><div class="ttname"><a href="structPosition.html#a5dc8c08d3d7209ba538ad21ba604aa44">Position::z</a></div><div class="ttdeci">float z</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00335">Object.h:335</a></div></div>
<div class="ttc" id="astructPosition_html_a8e82f7e85a5033b8415272d9a6af7c9c"><div class="ttname"><a href="structPosition.html#a8e82f7e85a5033b8415272d9a6af7c9c">Position::GetDistance</a></div><div class="ttdeci">float GetDistance(Position const &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l03255">Object.cpp:3255</a></div></div>
<div class="ttc" id="astructPosition_html_ab03b4a5c58b5d266e2505bffc906d21e"><div class="ttname"><a href="structPosition.html#ab03b4a5c58b5d266e2505bffc906d21e">Position::o</a></div><div class="ttdeci">float o</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00335">Object.h:335</a></div></div>
<div class="ttc" id="astructPosition_html_ad28cc6a9e6d05fdf8897c37642e70d33"><div class="ttname"><a href="structPosition.html#ad28cc6a9e6d05fdf8897c37642e70d33">Position::GetDistance2d</a></div><div class="ttdeci">float GetDistance2d(Position const &amp;other) const</div><div class="ttdef"><b>Definition:</b> <a href="Object_8cpp_source.html#l03267">Object.cpp:3267</a></div></div>
<div class="ttc" id="astructPosition_html_af684446cbf0f6d53386686283da6dcc6"><div class="ttname"><a href="structPosition.html#af684446cbf0f6d53386686283da6dcc6">Position::x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="Object_8h_source.html#l00335">Object.h:335</a></div></div>
<div class="ttc" id="astructPrioritizeHealth_html"><div class="ttname"><a href="structPrioritizeHealth.html">PrioritizeHealth</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00094">Spell.cpp:95</a></div></div>
<div class="ttc" id="astructPrioritizeHealth_html_a07abfec1d2f68355565460e6d474f2d3"><div class="ttname"><a href="structPrioritizeHealth.html#a07abfec1d2f68355565460e6d474f2d3">PrioritizeHealth::operator()</a></div><div class="ttdeci">int operator()(PrioritizeHealthUnitWraper const &amp;x, PrioritizeHealthUnitWraper const &amp;y) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00096">Spell.cpp:96</a></div></div>
<div class="ttc" id="astructPrioritizeMana_html"><div class="ttname"><a href="structPrioritizeMana.html">PrioritizeMana</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00070">Spell.cpp:71</a></div></div>
<div class="ttc" id="astructPrioritizeMana_html_aa182d20b982897154a7f72a84adb9051"><div class="ttname"><a href="structPrioritizeMana.html#aa182d20b982897154a7f72a84adb9051">PrioritizeMana::operator()</a></div><div class="ttdeci">int operator()(PrioritizeManaUnitWraper const &amp;x, PrioritizeManaUnitWraper const &amp;y) const</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8cpp_source.html#l00072">Spell.cpp:72</a></div></div>
<div class="ttc" id="astructProcSystemArguments_html"><div class="ttname"><a href="structProcSystemArguments.html">ProcSystemArguments</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00794">Unit.h:795</a></div></div>
<div class="ttc" id="astructSkillLineAbilityEntry_html"><div class="ttname"><a href="structSkillLineAbilityEntry.html">SkillLineAbilityEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01734">DBCStructure.h:1735</a></div></div>
<div class="ttc" id="astructSkillLineAbilityEntry_html_adff1e5a7840ae7a2337e10e67a189c60"><div class="ttname"><a href="structSkillLineAbilityEntry.html#adff1e5a7840ae7a2337e10e67a189c60">SkillLineAbilityEntry::skillId</a></div><div class="ttdeci">uint32 skillId</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01737">DBCStructure.h:1737</a></div></div>
<div class="ttc" id="astructSpellCategoryEntry_html"><div class="ttname"><a href="structSpellCategoryEntry.html">SpellCategoryEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02002">DBCStructure.h:2003</a></div></div>
<div class="ttc" id="astructSpellCone_html"><div class="ttname"><a href="structSpellCone.html">SpellCone</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02591">SpellMgr.h:2592</a></div></div>
<div class="ttc" id="astructSpellEffectInfo_html_a91328bac43e200011a7d32cc499d1158"><div class="ttname"><a href="structSpellEffectInfo.html#a91328bac43e200011a7d32cc499d1158">SpellEffectInfo::defaultTarget</a></div><div class="ttdeci">SpellTarget defaultTarget</div><div class="ttdef"><b>Definition:</b> <a href="SpellEffectDefines_8h_source.html#l00198">SpellEffectDefines.h:198</a></div></div>
<div class="ttc" id="astructSpellEntry_html"><div class="ttname"><a href="structSpellEntry.html">SpellEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01816">DBCStructure.h:1817</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a00a5387370626b3d3226aad2d6cbd1e7"><div class="ttname"><a href="structSpellEntry.html#a00a5387370626b3d3226aad2d6cbd1e7">SpellEntry::Mechanic</a></div><div class="ttdeci">uint32 Mechanic</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01821">DBCStructure.h:1821</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a020ee1d6b1ca360e2d73beb6741473bf"><div class="ttname"><a href="structSpellEntry.html#a020ee1d6b1ca360e2d73beb6741473bf">SpellEntry::EffectItemType</a></div><div class="ttdeci">uint32 EffectItemType[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01884">DBCStructure.h:1884</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a04f28f2ea6566ac47831c7b7489b80f9"><div class="ttname"><a href="structSpellEntry.html#a04f28f2ea6566ac47831c7b7489b80f9">SpellEntry::AreaGroupId</a></div><div class="ttdeci">int32 AreaGroupId</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01917">DBCStructure.h:1917</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a0bfb2cfeb7394ef0313a3517bb3f2607"><div class="ttname"><a href="structSpellEntry.html#a0bfb2cfeb7394ef0313a3517bb3f2607">SpellEntry::TargetAuraStateNot</a></div><div class="ttdeci">uint32 TargetAuraStateNot</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01839">DBCStructure.h:1839</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a0c3b77487bffa0d4e0da8e71cc7e5c4b"><div class="ttname"><a href="structSpellEntry.html#a0c3b77487bffa0d4e0da8e71cc7e5c4b">SpellEntry::runeCostID</a></div><div class="ttdeci">uint32 runeCostID</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01919">DBCStructure.h:1919</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a0fdf9afa2dbe95e2e8b2aeb31dc7dfa1"><div class="ttname"><a href="structSpellEntry.html#a0fdf9afa2dbe95e2e8b2aeb31dc7dfa1">SpellEntry::ReagentCount</a></div><div class="ttdeci">uint32 ReagentCount[MAX_SPELL_REAGENTS]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01868">DBCStructure.h:1868</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a127127a66b9f3a94038438a6f95a33bd"><div class="ttname"><a href="structSpellEntry.html#a127127a66b9f3a94038438a6f95a33bd">SpellEntry::EffectRadiusIndex</a></div><div class="ttdeci">uint32 EffectRadiusIndex[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01879">DBCStructure.h:1879</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a131e28e607f7dfea2b2aa1928050ecef"><div class="ttname"><a href="structSpellEntry.html#a131e28e607f7dfea2b2aa1928050ecef">SpellEntry::baseLevel</a></div><div class="ttdeci">uint32 baseLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01854">DBCStructure.h:1854</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a1a38754e34ac547b505c44daf69ef6d1"><div class="ttname"><a href="structSpellEntry.html#a1a38754e34ac547b505c44daf69ef6d1">SpellEntry::targetAuraSpell</a></div><div class="ttdeci">uint32 targetAuraSpell</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01841">DBCStructure.h:1841</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a1c912ec366db72086130df35f219f46b"><div class="ttname"><a href="structSpellEntry.html#a1c912ec366db72086130df35f219f46b">SpellEntry::Reagent</a></div><div class="ttdeci">int32 Reagent[MAX_SPELL_REAGENTS]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01867">DBCStructure.h:1867</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a1cc6fd3348e4f9c66a3b786b38937577"><div class="ttname"><a href="structSpellEntry.html#a1cc6fd3348e4f9c66a3b786b38937577">SpellEntry::speed</a></div><div class="ttdeci">float speed</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01863">DBCStructure.h:1863</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a1d14e6dd0b955eb76e4bb65171368518"><div class="ttname"><a href="structSpellEntry.html#a1d14e6dd0b955eb76e4bb65171368518">SpellEntry::EffectTriggerSpell</a></div><div class="ttdeci">uint32 EffectTriggerSpell[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01887">DBCStructure.h:1887</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a1fe21cdb9e2620e112b80009131cc79f"><div class="ttname"><a href="structSpellEntry.html#a1fe21cdb9e2620e112b80009131cc79f">SpellEntry::Effect</a></div><div class="ttdeci">uint32 Effect[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01872">DBCStructure.h:1872</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a20f6b67b5bdf42a1b90ef9efab48cc7d"><div class="ttname"><a href="structSpellEntry.html#a20f6b67b5bdf42a1b90ef9efab48cc7d">SpellEntry::EffectMiscValue</a></div><div class="ttdeci">int32 EffectMiscValue[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01885">DBCStructure.h:1885</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a2a1761914824472cbc7eb55293d1ff46"><div class="ttname"><a href="structSpellEntry.html#a2a1761914824472cbc7eb55293d1ff46">SpellEntry::EquippedItemClass</a></div><div class="ttdeci">int32 EquippedItemClass</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01869">DBCStructure.h:1869</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a2eddc830a14874e89224d76f7e94900a"><div class="ttname"><a href="structSpellEntry.html#a2eddc830a14874e89224d76f7e94900a">SpellEntry::IsFitToFamily</a></div><div class="ttdeci">bool IsFitToFamily(SpellFamily family, uint64 familyFlags, uint32 familyFlags2=0) const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01942">DBCStructure.h:1942</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a3649fd97627e9ff314d43ae63e6d05cb"><div class="ttname"><a href="structSpellEntry.html#a3649fd97627e9ff314d43ae63e6d05cb">SpellEntry::TargetCreatureType</a></div><div class="ttdeci">uint32 TargetCreatureType</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01833">DBCStructure.h:1833</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a39b26f93bb0f756875d72cb4338333c9"><div class="ttname"><a href="structSpellEntry.html#a39b26f93bb0f756875d72cb4338333c9">SpellEntry::SpellVisual</a></div><div class="ttdeci">uint32 SpellVisual[2]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01890">DBCStructure.h:1890</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a3d7ab889f71d22afbfb78329c4bb0f16"><div class="ttname"><a href="structSpellEntry.html#a3d7ab889f71d22afbfb78329c4bb0f16">SpellEntry::Totem</a></div><div class="ttdeci">uint32 Totem[MAX_SPELL_TOTEMS]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01866">DBCStructure.h:1866</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a43b825d0ab18a266e5ba77aa377f2abf"><div class="ttname"><a href="structSpellEntry.html#a43b825d0ab18a266e5ba77aa377f2abf">SpellEntry::CasterAuraState</a></div><div class="ttdeci">uint32 CasterAuraState</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01836">DBCStructure.h:1836</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a44ccfe3e8ec838d73c09d1e6aa261c19"><div class="ttname"><a href="structSpellEntry.html#a44ccfe3e8ec838d73c09d1e6aa261c19">SpellEntry::EffectChainTarget</a></div><div class="ttdeci">uint32 EffectChainTarget[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01883">DBCStructure.h:1883</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a46463db7a6fa059261dfa55a39a16281"><div class="ttname"><a href="structSpellEntry.html#a46463db7a6fa059261dfa55a39a16281">SpellEntry::SpellFamilyFlags</a></div><div class="ttdeci">ClassFamilyMask SpellFamilyFlags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01907">DBCStructure.h:1907</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a5c19327a3007d70a2404dba4deab3745"><div class="ttname"><a href="structSpellEntry.html#a5c19327a3007d70a2404dba4deab3745">SpellEntry::EffectMechanic</a></div><div class="ttdeci">uint32 EffectMechanic[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01876">DBCStructure.h:1876</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a5dc75f632a583e7d59c9fd780d939246"><div class="ttname"><a href="structSpellEntry.html#a5dc75f632a583e7d59c9fd780d939246">SpellEntry::InterruptFlags</a></div><div class="ttdeci">uint32 InterruptFlags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01847">DBCStructure.h:1847</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a6092f385a545aa33ba1e5ee28d21e92a"><div class="ttname"><a href="structSpellEntry.html#a6092f385a545aa33ba1e5ee28d21e92a">SpellEntry::Id</a></div><div class="ttdeci">uint32 Id</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01818">DBCStructure.h:1818</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a617fd6e64ab83548172c3029d1902328"><div class="ttname"><a href="structSpellEntry.html#a617fd6e64ab83548172c3029d1902328">SpellEntry::TargetAuraState</a></div><div class="ttdeci">uint32 TargetAuraState</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01837">DBCStructure.h:1837</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a624bafa9c5ef1f5bdfa1d45d67763118"><div class="ttname"><a href="structSpellEntry.html#a624bafa9c5ef1f5bdfa1d45d67763118">SpellEntry::excludeCasterAuraSpell</a></div><div class="ttdeci">uint32 excludeCasterAuraSpell</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01842">DBCStructure.h:1842</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a6d6f3c418ca9cd448e8e861c1324a93a"><div class="ttname"><a href="structSpellEntry.html#a6d6f3c418ca9cd448e8e861c1324a93a">SpellEntry::MaxAffectedTargets</a></div><div class="ttdeci">uint32 MaxAffectedTargets</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01908">DBCStructure.h:1908</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a6f908af779d48f0107cc905c5e97d457"><div class="ttname"><a href="structSpellEntry.html#a6f908af779d48f0107cc905c5e97d457">SpellEntry::CalculateSimpleValue</a></div><div class="ttdeci">int32 CalculateSimpleValue(SpellEffectIndex eff) const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01931">DBCStructure.h:1931</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a7a2226ccf62201d46c40b90ac7d35305"><div class="ttname"><a href="structSpellEntry.html#a7a2226ccf62201d46c40b90ac7d35305">SpellEntry::Attributes</a></div><div class="ttdeci">uint32 Attributes</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01822">DBCStructure.h:1822</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a800c4530cf509731e4c51d1c14e21c99"><div class="ttname"><a href="structSpellEntry.html#a800c4530cf509731e4c51d1c14e21c99">SpellEntry::StackAmount</a></div><div class="ttdeci">uint32 StackAmount</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01865">DBCStructure.h:1865</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a80a913517752997715c466105d227ad1"><div class="ttname"><a href="structSpellEntry.html#a80a913517752997715c466105d227ad1">SpellEntry::StartRecoveryTime</a></div><div class="ttdeci">uint32 StartRecoveryTime</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01904">DBCStructure.h:1904</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a879bfebf33dade7738722746a31bc78b"><div class="ttname"><a href="structSpellEntry.html#a879bfebf33dade7738722746a31bc78b">SpellEntry::DmgClass</a></div><div class="ttdeci">uint32 DmgClass</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01909">DBCStructure.h:1909</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a8e36fc5d26dd251ab1169ac80c68c80d"><div class="ttname"><a href="structSpellEntry.html#a8e36fc5d26dd251ab1169ac80c68c80d">SpellEntry::ChannelInterruptFlags</a></div><div class="ttdeci">uint32 ChannelInterruptFlags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01849">DBCStructure.h:1849</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a91a53f218d982cc7eefc77c0e4c5142a"><div class="ttname"><a href="structSpellEntry.html#a91a53f218d982cc7eefc77c0e4c5142a">SpellEntry::casterAuraSpell</a></div><div class="ttdeci">uint32 casterAuraSpell</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01840">DBCStructure.h:1840</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a91ae115a561280bfe2c6be98b91e5cd1"><div class="ttname"><a href="structSpellEntry.html#a91ae115a561280bfe2c6be98b91e5cd1">SpellEntry::Targets</a></div><div class="ttdeci">uint32 Targets</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01832">DBCStructure.h:1832</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a98564191a14bd1ababaef07a96fddfbb"><div class="ttname"><a href="structSpellEntry.html#a98564191a14bd1ababaef07a96fddfbb">SpellEntry::excludeTargetAuraSpell</a></div><div class="ttdeci">uint32 excludeTargetAuraSpell</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01843">DBCStructure.h:1843</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a9a00332818bed2bf6a28bad16d8b4acc"><div class="ttname"><a href="structSpellEntry.html#a9a00332818bed2bf6a28bad16d8b4acc">SpellEntry::manaCostPerlevel</a></div><div class="ttdeci">uint32 manaCostPerlevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01859">DBCStructure.h:1859</a></div></div>
<div class="ttc" id="astructSpellEntry_html_a9bc1d3daa3394463e7ce5cfb403b0a68"><div class="ttname"><a href="structSpellEntry.html#a9bc1d3daa3394463e7ce5cfb403b0a68">SpellEntry::EffectApplyAuraName</a></div><div class="ttdeci">uint32 EffectApplyAuraName[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01880">DBCStructure.h:1880</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aa1f607116227f95f1c499af5232aef93"><div class="ttname"><a href="structSpellEntry.html#aa1f607116227f95f1c499af5232aef93">SpellEntry::manaCost</a></div><div class="ttdeci">uint32 manaCost</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01858">DBCStructure.h:1858</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aa401405fe3221db2723b2b8e6fe48c9b"><div class="ttname"><a href="structSpellEntry.html#aa401405fe3221db2723b2b8e6fe48c9b">SpellEntry::spellLevel</a></div><div class="ttdeci">uint32 spellLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01855">DBCStructure.h:1855</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aa65895491d8fd7f44b5a86443c32f8be"><div class="ttname"><a href="structSpellEntry.html#aa65895491d8fd7f44b5a86443c32f8be">SpellEntry::EquippedItemSubClassMask</a></div><div class="ttdeci">int32 EquippedItemSubClassMask</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01870">DBCStructure.h:1870</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aa6e55236825637838639206a2231ceed"><div class="ttname"><a href="structSpellEntry.html#aa6e55236825637838639206a2231ceed">SpellEntry::DmgMultiplier</a></div><div class="ttdeci">float DmgMultiplier[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01912">DBCStructure.h:1912</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aa7850b90c4c8727ff1de8aa61a5296cb"><div class="ttname"><a href="structSpellEntry.html#aa7850b90c4c8727ff1de8aa61a5296cb">SpellEntry::powerType</a></div><div class="ttdeci">uint32 powerType</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01857">DBCStructure.h:1857</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aa8df07a2ebac695b4e72f5db374a451e"><div class="ttname"><a href="structSpellEntry.html#aa8df07a2ebac695b4e72f5db374a451e">SpellEntry::RequiresSpellFocus</a></div><div class="ttdeci">uint32 RequiresSpellFocus</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01834">DBCStructure.h:1834</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aadb41c294565428ff67a9a137d01465a"><div class="ttname"><a href="structSpellEntry.html#aadb41c294565428ff67a9a137d01465a">SpellEntry::SpellIconID</a></div><div class="ttdeci">uint32 SpellIconID</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01891">DBCStructure.h:1891</a></div></div>
<div class="ttc" id="astructSpellEntry_html_aae17bc4063479a0c5308b4e7c467e4d8"><div class="ttname"><a href="structSpellEntry.html#aae17bc4063479a0c5308b4e7c467e4d8">SpellEntry::rangeIndex</a></div><div class="ttdeci">uint32 rangeIndex</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01862">DBCStructure.h:1862</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ab0c175d928e13ac47a1a0125e16d048c"><div class="ttname"><a href="structSpellEntry.html#ab0c175d928e13ac47a1a0125e16d048c">SpellEntry::EffectMiscValueB</a></div><div class="ttdeci">int32 EffectMiscValueB[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01886">DBCStructure.h:1886</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ab5ca60f93e4b1792578dcb5fe6b259e9"><div class="ttname"><a href="structSpellEntry.html#ab5ca60f93e4b1792578dcb5fe6b259e9">SpellEntry::HasAttribute</a></div><div class="ttdeci">bool HasAttribute(SpellAttributes attribute) const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01957">DBCStructure.h:1957</a></div></div>
<div class="ttc" id="astructSpellEntry_html_abc406eb0bdad331a22c743708f5bf39c"><div class="ttname"><a href="structSpellEntry.html#abc406eb0bdad331a22c743708f5bf39c">SpellEntry::FacingCasterFlags</a></div><div class="ttdeci">uint32 FacingCasterFlags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01835">DBCStructure.h:1835</a></div></div>
<div class="ttc" id="astructSpellEntry_html_abe316061c52c1e6fdcc778232efac1ac"><div class="ttname"><a href="structSpellEntry.html#abe316061c52c1e6fdcc778232efac1ac">SpellEntry::MaxTargetLevel</a></div><div class="ttdeci">uint32 MaxTargetLevel</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01905">DBCStructure.h:1905</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ac1efa813941d492073f9a516e8dd91fe"><div class="ttname"><a href="structSpellEntry.html#ac1efa813941d492073f9a516e8dd91fe">SpellEntry::CasterAuraStateNot</a></div><div class="ttdeci">uint32 CasterAuraStateNot</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01838">DBCStructure.h:1838</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ac2d17132ffcbb75f8748f9c04930526d"><div class="ttname"><a href="structSpellEntry.html#ac2d17132ffcbb75f8748f9c04930526d">SpellEntry::PreventionType</a></div><div class="ttdeci">uint32 PreventionType</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01910">DBCStructure.h:1910</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ac553667d97b29d8ad7e682d4c55e4263"><div class="ttname"><a href="structSpellEntry.html#ac553667d97b29d8ad7e682d4c55e4263">SpellEntry::Category</a></div><div class="ttdeci">uint32 Category</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01819">DBCStructure.h:1819</a></div></div>
<div class="ttc" id="astructSpellEntry_html_accbc0425316d6848dbdd9f6bed9ec306"><div class="ttname"><a href="structSpellEntry.html#accbc0425316d6848dbdd9f6bed9ec306">SpellEntry::ManaCostPercentage</a></div><div class="ttdeci">uint32 ManaCostPercentage</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01902">DBCStructure.h:1902</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ae1fd8b21a122838fc9582e46bae6ba8d"><div class="ttname"><a href="structSpellEntry.html#ae1fd8b21a122838fc9582e46bae6ba8d">SpellEntry::EffectImplicitTargetA</a></div><div class="ttdeci">uint32 EffectImplicitTargetA[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01877">DBCStructure.h:1877</a></div></div>
<div class="ttc" id="astructSpellEntry_html_ae35b8dc7bc501d5466c150cc6ba8a763"><div class="ttname"><a href="structSpellEntry.html#ae35b8dc7bc501d5466c150cc6ba8a763">SpellEntry::IsFitToFamilyMask</a></div><div class="ttdeci">bool IsFitToFamilyMask(uint64 familyFlags, uint32 familyFlags2=0) const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01937">DBCStructure.h:1937</a></div></div>
<div class="ttc" id="astructSpellEntry_html_af004bac78646d8ec843a8200f914598a"><div class="ttname"><a href="structSpellEntry.html#af004bac78646d8ec843a8200f914598a">SpellEntry::EffectImplicitTargetB</a></div><div class="ttdeci">uint32 EffectImplicitTargetB[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01878">DBCStructure.h:1878</a></div></div>
<div class="ttc" id="astructSpellEntry_html_af1586de0e99ed09fbd805fa4a09f2c6c"><div class="ttname"><a href="structSpellEntry.html#af1586de0e99ed09fbd805fa4a09f2c6c">SpellEntry::SpellFamilyName</a></div><div class="ttdeci">uint32 SpellFamilyName</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01906">DBCStructure.h:1906</a></div></div>
<div class="ttc" id="astructSpellEntry_html_afaee718bd1e230dce004419da66f188e"><div class="ttname"><a href="structSpellEntry.html#afaee718bd1e230dce004419da66f188e">SpellEntry::SpellDifficultyId</a></div><div class="ttdeci">uint32 SpellDifficultyId</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01924">DBCStructure.h:1924</a></div></div>
<div class="ttc" id="astructSpellEntry_html_afd59039a969e14a54f39a372a6541d0b"><div class="ttname"><a href="structSpellEntry.html#afd59039a969e14a54f39a372a6541d0b">SpellEntry::TotemCategory</a></div><div class="ttdeci">uint32 TotemCategory[MAX_SPELL_TOTEM_CATEGORIES]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l01916">DBCStructure.h:1916</a></div></div>
<div class="ttc" id="astructSpellItemEnchantmentEntry_html"><div class="ttname"><a href="structSpellItemEnchantmentEntry.html">SpellItemEnchantmentEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02076">DBCStructure.h:2077</a></div></div>
<div class="ttc" id="astructSpellItemEnchantmentEntry_html_ac764d2273e6024588328b68b078c98c5"><div class="ttname"><a href="structSpellItemEnchantmentEntry.html#ac764d2273e6024588328b68b078c98c5">SpellItemEnchantmentEntry::flags</a></div><div class="ttdeci">uint32 flags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02087">DBCStructure.h:2087</a></div></div>
<div class="ttc" id="astructSpellNonMeleeDamage_html"><div class="ttname"><a href="structSpellNonMeleeDamage.html">SpellNonMeleeDamage</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00736">Unit.h:737</a></div></div>
<div class="ttc" id="astructSpellNonMeleeDamage_html_a324ea6c84e005487560de986dceffeba"><div class="ttname"><a href="structSpellNonMeleeDamage.html#a324ea6c84e005487560de986dceffeba">SpellNonMeleeDamage::target</a></div><div class="ttdeci">Unit * target</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00743">Unit.h:743</a></div></div>
<div class="ttc" id="astructSpellNonMeleeDamage_html_a3f99854d163cd672f881f721d5bc8a39"><div class="ttname"><a href="structSpellNonMeleeDamage.html#a3f99854d163cd672f881f721d5bc8a39">SpellNonMeleeDamage::HitInfo</a></div><div class="ttdeci">uint32 HitInfo</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00753">Unit.h:753</a></div></div>
<div class="ttc" id="astructSpellNonMeleeDamage_html_a47e66924ae869ce34bdf36a5ed50548b"><div class="ttname"><a href="structSpellNonMeleeDamage.html#a47e66924ae869ce34bdf36a5ed50548b">SpellNonMeleeDamage::damage</a></div><div class="ttdeci">uint32 damage</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00746">Unit.h:746</a></div></div>
<div class="ttc" id="astructSpellNonMeleeDamage_html_a485ee28c6a8cf32a22578e02633df75b"><div class="ttname"><a href="structSpellNonMeleeDamage.html#a485ee28c6a8cf32a22578e02633df75b">SpellNonMeleeDamage::absorb</a></div><div class="ttdeci">uint32 absorb</div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l00748">Unit.h:748</a></div></div>
<div class="ttc" id="astructSpellRangeEntry_html"><div class="ttname"><a href="structSpellRangeEntry.html">SpellRangeEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02023">DBCStructure.h:2024</a></div></div>
<div class="ttc" id="astructSpellRangeEntry_html_a12b3cb0e28ed0f47ff5ccea09fc8b860"><div class="ttname"><a href="structSpellRangeEntry.html#a12b3cb0e28ed0f47ff5ccea09fc8b860">SpellRangeEntry::Flags</a></div><div class="ttdeci">uint32 Flags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02030">DBCStructure.h:2030</a></div></div>
<div class="ttc" id="astructSpellRuneCostEntry_html"><div class="ttname"><a href="structSpellRuneCostEntry.html">SpellRuneCostEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02037">DBCStructure.h:2038</a></div></div>
<div class="ttc" id="astructSpellRuneCostEntry_html_a18c2e6daaaefe1c8be4a83c55a3670ff"><div class="ttname"><a href="structSpellRuneCostEntry.html#a18c2e6daaaefe1c8be4a83c55a3670ff">SpellRuneCostEntry::RuneCost</a></div><div class="ttdeci">uint32 RuneCost[3]</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02040">DBCStructure.h:2040</a></div></div>
<div class="ttc" id="astructSpellRuneCostEntry_html_a599b2089d52bf4a009c5fbac3b0d3279"><div class="ttname"><a href="structSpellRuneCostEntry.html#a599b2089d52bf4a009c5fbac3b0d3279">SpellRuneCostEntry::NoRuneCost</a></div><div class="ttdeci">bool NoRuneCost() const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02043">DBCStructure.h:2043</a></div></div>
<div class="ttc" id="astructSpellRuneCostEntry_html_a97da075ecd116ef27fd4265bb8380667"><div class="ttname"><a href="structSpellRuneCostEntry.html#a97da075ecd116ef27fd4265bb8380667">SpellRuneCostEntry::NoRunicPowerGain</a></div><div class="ttdeci">bool NoRunicPowerGain() const</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02044">DBCStructure.h:2044</a></div></div>
<div class="ttc" id="astructSpellRuneCostEntry_html_ac5f9c69d83ff9cf230124b9dad10008b"><div class="ttname"><a href="structSpellRuneCostEntry.html#ac5f9c69d83ff9cf230124b9dad10008b">SpellRuneCostEntry::runePowerGain</a></div><div class="ttdeci">uint32 runePowerGain</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02041">DBCStructure.h:2041</a></div></div>
<div class="ttc" id="astructSpellScript_html"><div class="ttname"><a href="structSpellScript.html">SpellScript</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellScript_8h_source.html#l00038">SpellScript.h:39</a></div></div>
<div class="ttc" id="astructSpellScript_html_acdfff6b3d3675c5234e3c9bfa939a6fa"><div class="ttname"><a href="structSpellScript.html#acdfff6b3d3675c5234e3c9bfa939a6fa">SpellScript::OnSpellCastResultOverride</a></div><div class="ttdeci">virtual void OnSpellCastResultOverride(SpellCastResult &amp;, uint32 &amp;, uint32 &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="SpellScript_8h_source.html#l00051">SpellScript.h:51</a></div></div>
<div class="ttc" id="astructSpellShapeshiftFormEntry_html"><div class="ttname"><a href="structSpellShapeshiftFormEntry.html">SpellShapeshiftFormEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02047">DBCStructure.h:2048</a></div></div>
<div class="ttc" id="astructSpellShapeshiftFormEntry_html_a026745f2ce754d754858d69ee219b518"><div class="ttname"><a href="structSpellShapeshiftFormEntry.html#a026745f2ce754d754858d69ee219b518">SpellShapeshiftFormEntry::flags1</a></div><div class="ttdeci">uint32 flags1</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02053">DBCStructure.h:2053</a></div></div>
<div class="ttc" id="astructSpellTargetEntry_html"><div class="ttname"><a href="structSpellTargetEntry.html">SpellTargetEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02571">SpellMgr.h:2572</a></div></div>
<div class="ttc" id="astructSpellTargetEntry_html_a5b55f617927e81360f6c524e2c66c02b"><div class="ttname"><a href="structSpellTargetEntry.html#a5b55f617927e81360f6c524e2c66c02b">SpellTargetEntry::type</a></div><div class="ttdeci">uint32 type</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02574">SpellMgr.h:2574</a></div></div>
<div class="ttc" id="astructSpellTargetEntry_html_aa98cb1c37e596c8d9d963983e2270727"><div class="ttname"><a href="structSpellTargetEntry.html#aa98cb1c37e596c8d9d963983e2270727">SpellTargetEntry::CanNotHitWithSpellEffect</a></div><div class="ttdeci">bool CanNotHitWithSpellEffect(SpellEffectIndex effect) const</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02578">SpellMgr.h:2578</a></div></div>
<div class="ttc" id="astructSpellTargetEntry_html_ad1a36a1a665637d605e3d46f880e34a3"><div class="ttname"><a href="structSpellTargetEntry.html#ad1a36a1a665637d605e3d46f880e34a3">SpellTargetEntry::targetEntry</a></div><div class="ttdeci">uint32 targetEntry</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02575">SpellMgr.h:2575</a></div></div>
<div class="ttc" id="astructSpellTargetInfo_html"><div class="ttname"><a href="structSpellTargetInfo.html">SpellTargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00032">SpellTargets.h:33</a></div></div>
<div class="ttc" id="astructSpellTargetInfo_html_a1ce8a11382a3a4e6d3239b45c5c27205"><div class="ttname"><a href="structSpellTargetInfo.html#a1ce8a11382a3a4e6d3239b45c5c27205">SpellTargetInfo::los</a></div><div class="ttdeci">SpellTargetLOS los</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00038">SpellTargets.h:38</a></div></div>
<div class="ttc" id="astructSpellTargetInfo_html_a5b9dd67836d431b8c7a569b64da5dbd8"><div class="ttname"><a href="structSpellTargetInfo.html#a5b9dd67836d431b8c7a569b64da5dbd8">SpellTargetInfo::filter</a></div><div class="ttdeci">SpellTargetFilter filter</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00036">SpellTargets.h:36</a></div></div>
<div class="ttc" id="astructSpellTargetInfo_html_a68c229e7f0563a90091445d626addca4"><div class="ttname"><a href="structSpellTargetInfo.html#a68c229e7f0563a90091445d626addca4">SpellTargetInfo::type</a></div><div class="ttdeci">SpellTargetImplicitType type</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00035">SpellTargets.h:35</a></div></div>
<div class="ttc" id="astructSpellTargetInfo_html_afff6bd3bc8a1439d5f21e1d019627d54"><div class="ttname"><a href="structSpellTargetInfo.html#afff6bd3bc8a1439d5f21e1d019627d54">SpellTargetInfo::enumerator</a></div><div class="ttdeci">SpellTargetEnumerator enumerator</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00037">SpellTargets.h:37</a></div></div>
<div class="ttc" id="astructSpellTargetPosition_html"><div class="ttname"><a href="structSpellTargetPosition.html">SpellTargetPosition</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02582">SpellMgr.h:2583</a></div></div>
<div class="ttc" id="astructSpellTargetingData_html"><div class="ttname"><a href="structSpellTargetingData.html">SpellTargetingData</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00045">SpellTargets.h:46</a></div></div>
<div class="ttc" id="astructSpellTargetingData_html_a05848478306b4108cfe4171a48016a94"><div class="ttname"><a href="structSpellTargetingData.html#a05848478306b4108cfe4171a48016a94">SpellTargetingData::filteringScheme</a></div><div class="ttdeci">SpellTargetFilterScheme filteringScheme[MAX_EFFECT_INDEX][2]</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00050">SpellTargets.h:50</a></div></div>
<div class="ttc" id="astructSpellTargetingData_html_a295e7a61f7d0d8cd040aa1445bf6c974"><div class="ttname"><a href="structSpellTargetingData.html#a295e7a61f7d0d8cd040aa1445bf6c974">SpellTargetingData::ignoredTargets</a></div><div class="ttdeci">std::pair&lt; bool, bool &gt; ignoredTargets[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00049">SpellTargets.h:49</a></div></div>
<div class="ttc" id="astructSpellTargetingData_html_ac2ccfeeaa07f2ed5c69bf76993bf3c2a"><div class="ttname"><a href="structSpellTargetingData.html#ac2ccfeeaa07f2ed5c69bf76993bf3c2a">SpellTargetingData::targetMask</a></div><div class="ttdeci">uint8 targetMask[MAX_EFFECT_INDEX][2]</div><div class="ttdef"><b>Definition:</b> <a href="SpellTargets_8h_source.html#l00048">SpellTargets.h:48</a></div></div>
<div class="ttc" id="astructSpellThreatEntry_html"><div class="ttname"><a href="structSpellThreatEntry.html">SpellThreatEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02546">SpellMgr.h:2547</a></div></div>
<div class="ttc" id="astructSpellThreatEntry_html_a37a1ab2189023660b7122b6d151147b5"><div class="ttname"><a href="structSpellThreatEntry.html#a37a1ab2189023660b7122b6d151147b5">SpellThreatEntry::threat</a></div><div class="ttdeci">uint16 threat</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02548">SpellMgr.h:2548</a></div></div>
<div class="ttc" id="astructSpellThreatEntry_html_af97fdc4231ddb87574a48565aa28182d"><div class="ttname"><a href="structSpellThreatEntry.html#af97fdc4231ddb87574a48565aa28182d">SpellThreatEntry::ap_bonus</a></div><div class="ttdeci">float ap_bonus</div><div class="ttdef"><b>Definition:</b> <a href="SpellMgr_8h_source.html#l02550">SpellMgr.h:2550</a></div></div>
<div class="ttc" id="astructSpell_1_1CorpseTargetInfo_html"><div class="ttname"><a href="structSpell_1_1CorpseTargetInfo.html">Spell::CorpseTargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00798">Spell.h:799</a></div></div>
<div class="ttc" id="astructSpell_1_1CorpseTargetInfo_html_a02b59cc49751fffe6def37668496f83e"><div class="ttname"><a href="structSpell_1_1CorpseTargetInfo.html#a02b59cc49751fffe6def37668496f83e">Spell::CorpseTargetInfo::effectMask</a></div><div class="ttdeci">uint8 effectMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00801">Spell.h:801</a></div></div>
<div class="ttc" id="astructSpell_1_1CorpseTargetInfo_html_adf8f4c3bb1600d001b685e3ace941709"><div class="ttname"><a href="structSpell_1_1CorpseTargetInfo.html#adf8f4c3bb1600d001b685e3ace941709">Spell::CorpseTargetInfo::corpseGUID</a></div><div class="ttdeci">ObjectGuid corpseGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00800">Spell.h:800</a></div></div>
<div class="ttc" id="astructSpell_1_1DestTargetInfo_html_a112ae46e01c2f1d9b531dc8ebb09b40d"><div class="ttname"><a href="structSpell_1_1DestTargetInfo.html#a112ae46e01c2f1d9b531dc8ebb09b40d">Spell::DestTargetInfo::effectMask</a></div><div class="ttdeci">uint32 effectMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00806">Spell.h:806</a></div></div>
<div class="ttc" id="astructSpell_1_1DestTargetInfo_html_ad9dbe39bea859de7b9a6b3e1efa060dd"><div class="ttname"><a href="structSpell_1_1DestTargetInfo.html#ad9dbe39bea859de7b9a6b3e1efa060dd">Spell::DestTargetInfo::effectMaskProcessed</a></div><div class="ttdeci">uint32 effectMaskProcessed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00808">Spell.h:808</a></div></div>
<div class="ttc" id="astructSpell_1_1DestTargetInfo_html_afcf5b0b073d46076b2bf21d7fde5e8cc"><div class="ttname"><a href="structSpell_1_1DestTargetInfo.html#afcf5b0b073d46076b2bf21d7fde5e8cc">Spell::DestTargetInfo::timeDelay</a></div><div class="ttdeci">uint64 timeDelay</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00807">Spell.h:807</a></div></div>
<div class="ttc" id="astructSpell_1_1EffectSkillInfo_html_a712ff9894f1286566d59d8b3e2367ef1"><div class="ttname"><a href="structSpell_1_1EffectSkillInfo.html#a712ff9894f1286566d59d8b3e2367ef1">Spell::EffectSkillInfo::skillId</a></div><div class="ttdeci">SkillType skillId</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01070">Spell.h:1070</a></div></div>
<div class="ttc" id="astructSpell_1_1EffectSkillInfo_html_aa38ce859b0ffcecf28251a391827de70"><div class="ttname"><a href="structSpell_1_1EffectSkillInfo.html#aa38ce859b0ffcecf28251a391827de70">Spell::EffectSkillInfo::reqSkillValue</a></div><div class="ttdeci">int32 reqSkillValue</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l01071">Spell.h:1071</a></div></div>
<div class="ttc" id="astructSpell_1_1GOTargetInfo_html"><div class="ttname"><a href="structSpell_1_1GOTargetInfo.html">Spell::GOTargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00784">Spell.h:785</a></div></div>
<div class="ttc" id="astructSpell_1_1GOTargetInfo_html_a07d70f3c2425f07a36db90e9fd5b3c97"><div class="ttname"><a href="structSpell_1_1GOTargetInfo.html#a07d70f3c2425f07a36db90e9fd5b3c97">Spell::GOTargetInfo::effectMask</a></div><div class="ttdeci">uint8 effectMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00788">Spell.h:788</a></div></div>
<div class="ttc" id="astructSpell_1_1GOTargetInfo_html_a619f98bf094d2667048204f733d64d0c"><div class="ttname"><a href="structSpell_1_1GOTargetInfo.html#a619f98bf094d2667048204f733d64d0c">Spell::GOTargetInfo::targetGUID</a></div><div class="ttdeci">ObjectGuid targetGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00786">Spell.h:786</a></div></div>
<div class="ttc" id="astructSpell_1_1GOTargetInfo_html_ab552326c0780fe62ff95b02249458492"><div class="ttname"><a href="structSpell_1_1GOTargetInfo.html#ab552326c0780fe62ff95b02249458492">Spell::GOTargetInfo::timeDelay</a></div><div class="ttdeci">uint64 timeDelay</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00787">Spell.h:787</a></div></div>
<div class="ttc" id="astructSpell_1_1GOTargetInfo_html_aedfa36678be863a558ecd0ecc07cc544"><div class="ttname"><a href="structSpell_1_1GOTargetInfo.html#aedfa36678be863a558ecd0ecc07cc544">Spell::GOTargetInfo::processed</a></div><div class="ttdeci">bool processed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00789">Spell.h:789</a></div></div>
<div class="ttc" id="astructSpell_1_1ItemTargetInfo_html"><div class="ttname"><a href="structSpell_1_1ItemTargetInfo.html">Spell::ItemTargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00792">Spell.h:793</a></div></div>
<div class="ttc" id="astructSpell_1_1ItemTargetInfo_html_a3161ec2ffdf794c000cc94b91519d009"><div class="ttname"><a href="structSpell_1_1ItemTargetInfo.html#a3161ec2ffdf794c000cc94b91519d009">Spell::ItemTargetInfo::effectMask</a></div><div class="ttdeci">uint8 effectMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00795">Spell.h:795</a></div></div>
<div class="ttc" id="astructSpell_1_1ItemTargetInfo_html_afce5eba99c3dc33698dd12af8432f357"><div class="ttname"><a href="structSpell_1_1ItemTargetInfo.html#afce5eba99c3dc33698dd12af8432f357">Spell::ItemTargetInfo::item</a></div><div class="ttdeci">Item * item</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00794">Spell.h:794</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html"><div class="ttname"><a href="structSpell_1_1TargetInfo.html">Spell::TargetInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00757">Spell.h:758</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a1813d779c7b7efea9cd44d8458252418"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a1813d779c7b7efea9cd44d8458252418">Spell::TargetInfo::damage</a></div><div class="ttdeci">uint32 damage</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00763">Spell.h:763</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a1c4c7b936702260fd43837d92419a6c6"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a1c4c7b936702260fd43837d92419a6c6">Spell::TargetInfo::HitInfo</a></div><div class="ttdeci">uint32 HitInfo</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00762">Spell.h:762</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a2465f3f2446585875bbe50050cd63f4b"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a2465f3f2446585875bbe50050cd63f4b">Spell::TargetInfo::heartbeatResistChance</a></div><div class="ttdeci">uint32 heartbeatResistChance</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00775">Spell.h:775</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a31c7a102ca04d466b72ce48cf24b9307"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a31c7a102ca04d466b72ce48cf24b9307">Spell::TargetInfo::effectMaskProcessed</a></div><div class="ttdeci">uint8 effectMaskProcessed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00769">Spell.h:769</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a37089a7b59855626751b9148d8a6a87c"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a37089a7b59855626751b9148d8a6a87c">Spell::TargetInfo::timeDelay</a></div><div class="ttdeci">uint64 timeDelay</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00760">Spell.h:760</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a47253df8c66cc18c8f78bf0e10d89c08"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a47253df8c66cc18c8f78bf0e10d89c08">Spell::TargetInfo::procReflect</a></div><div class="ttdeci">bool procReflect</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00772">Spell.h:772</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a4987528818ccf19954e185a828eabe60"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a4987528818ccf19954e185a828eabe60">Spell::TargetInfo::missCondition</a></div><div class="ttdeci">SpellMissInfo missCondition</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00765">Spell.h:765</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a6dec5ef782cb70c6e21c1c0db2d1f8c6"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a6dec5ef782cb70c6e21c1c0db2d1f8c6">Spell::TargetInfo::effectHitMask</a></div><div class="ttdeci">uint8 effectHitMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00767">Spell.h:767</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a8c21d234f8add978f80d9da1a0002657"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a8c21d234f8add978f80d9da1a0002657">Spell::TargetInfo::reflectResult</a></div><div class="ttdeci">SpellMissInfo reflectResult</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00766">Spell.h:766</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_a900f9a1e1ad7bcdf19bdadda3ad08cca"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#a900f9a1e1ad7bcdf19bdadda3ad08cca">Spell::TargetInfo::initialDelay</a></div><div class="ttdeci">uint64 initialDelay</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00761">Spell.h:761</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_aa7c1e254efc22ca527aced39915d8d98"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#aa7c1e254efc22ca527aced39915d8d98">Spell::TargetInfo::magnet</a></div><div class="ttdeci">bool magnet</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00771">Spell.h:771</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_aa8f8bf8d4b9d9cc597becabea53e37b0"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#aa8f8bf8d4b9d9cc597becabea53e37b0">Spell::TargetInfo::effectMask</a></div><div class="ttdeci">uint8 effectMask</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00768">Spell.h:768</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_aaa40ce5b41188d3d73fe1a40ad8e84d0"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#aaa40ce5b41188d3d73fe1a40ad8e84d0">Spell::TargetInfo::diminishGroup</a></div><div class="ttdeci">DiminishingGroup diminishGroup</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00779">Spell.h:779</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_ab0baeee8c145a4ff70c69e653fdd2ad5"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#ab0baeee8c145a4ff70c69e653fdd2ad5">Spell::TargetInfo::diminishDuration</a></div><div class="ttdeci">uint32 diminishDuration</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00777">Spell.h:777</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_ac264ddc84aa6e2370c9735cb2f7049a4"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#ac264ddc84aa6e2370c9735cb2f7049a4">Spell::TargetInfo::targetGUID</a></div><div class="ttdeci">ObjectGuid targetGUID</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00759">Spell.h:759</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_ac6915e29846a8cd9d9baeb3d960c0563"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#ac6915e29846a8cd9d9baeb3d960c0563">Spell::TargetInfo::effectDuration</a></div><div class="ttdeci">uint32 effectDuration</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00776">Spell.h:776</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_aca84f92c46288cc3c59914112a213345"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#aca84f92c46288cc3c59914112a213345">Spell::TargetInfo::diminishLevel</a></div><div class="ttdeci">DiminishingLevels diminishLevel</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00778">Spell.h:778</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_ad545fbf19e87de3bf7887abb2b61aa93"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#ad545fbf19e87de3bf7887abb2b61aa93">Spell::TargetInfo::executionless</a></div><div class="ttdeci">bool executionless</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00774">Spell.h:774</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_ae1661c7a29cbc96d5fc7136f23209ad0"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#ae1661c7a29cbc96d5fc7136f23209ad0">Spell::TargetInfo::processed</a></div><div class="ttdeci">bool processed</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00770">Spell.h:770</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_aea8200356339c1059bb2f0fdb58abaa9"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#aea8200356339c1059bb2f0fdb58abaa9">Spell::TargetInfo::healing</a></div><div class="ttdeci">uint32 healing</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00764">Spell.h:764</a></div></div>
<div class="ttc" id="astructSpell_1_1TargetInfo_html_af2cad39388e6d630ce32c5cec4327624"><div class="ttname"><a href="structSpell_1_1TargetInfo.html#af2cad39388e6d630ce32c5cec4327624">Spell::TargetInfo::isCrit</a></div><div class="ttdeci">bool isCrit</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00773">Spell.h:773</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetData_html"><div class="ttname"><a href="structSpell_1_1TempTargetData.html">Spell::TempTargetData</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00817">Spell.h:818</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetData_html_a08fca2887b9a0e66e0f86c054982c7b7"><div class="ttname"><a href="structSpell_1_1TempTargetData.html#a08fca2887b9a0e66e0f86c054982c7b7">Spell::TempTargetData::tmpGOList</a></div><div class="ttdeci">GameObjectList tmpGOList[2]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00820">Spell.h:820</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetData_html_a34837d8924cb2c54024f7512cc5ebfc0"><div class="ttname"><a href="structSpell_1_1TempTargetData.html#a34837d8924cb2c54024f7512cc5ebfc0">Spell::TempTargetData::tmpUnitList</a></div><div class="ttdeci">UnitList tmpUnitList[2]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00819">Spell.h:819</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetData_html_a97f400e188a5ec71230e0240da3452ef"><div class="ttname"><a href="structSpell_1_1TempTargetData.html#a97f400e188a5ec71230e0240da3452ef">Spell::TempTargetData::tempItemList</a></div><div class="ttdeci">std::list&lt; Item * &gt; tempItemList</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00821">Spell.h:821</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetData_html_ad710b44d1df09b198f609d9557212b99"><div class="ttname"><a href="structSpell_1_1TempTargetData.html#ad710b44d1df09b198f609d9557212b99">Spell::TempTargetData::tempCorpseList</a></div><div class="ttdeci">CorpseList tempCorpseList</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00822">Spell.h:822</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetingData_html"><div class="ttname"><a href="structSpell_1_1TempTargetingData.html">Spell::TempTargetingData</a></div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00824">Spell.h:825</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetingData_html_a0ad09d635967cf7104bffe86c545f52c"><div class="ttname"><a href="structSpell_1_1TempTargetingData.html#a0ad09d635967cf7104bffe86c545f52c">Spell::TempTargetingData::data</a></div><div class="ttdeci">TempTargetData data[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00826">Spell.h:826</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetingData_html_a2c03f3b6a2eef5380ea2c0514a9d0f3c"><div class="ttname"><a href="structSpell_1_1TempTargetingData.html#a2c03f3b6a2eef5380ea2c0514a9d0f3c">Spell::TempTargetingData::magnet</a></div><div class="ttdeci">bool magnet</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00828">Spell.h:828</a></div></div>
<div class="ttc" id="astructSpell_1_1TempTargetingData_html_ac4a6e7cf8c643599ddb37806b78894f2"><div class="ttname"><a href="structSpell_1_1TempTargetingData.html#ac4a6e7cf8c643599ddb37806b78894f2">Spell::TempTargetingData::chainTargetCount</a></div><div class="ttdeci">uint32 chainTargetCount[MAX_EFFECT_INDEX]</div><div class="ttdef"><b>Definition:</b> <a href="Spell_8h_source.html#l00827">Spell.h:827</a></div></div>
<div class="ttc" id="astructSummonPropertiesEntry_html"><div class="ttname"><a href="structSummonPropertiesEntry.html">SummonPropertiesEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02144">DBCStructure.h:2145</a></div></div>
<div class="ttc" id="astructSummonPropertiesEntry_html_ac93e8d8e555456ec9b7a9d38f15b55e0"><div class="ttname"><a href="structSummonPropertiesEntry.html#ac93e8d8e555456ec9b7a9d38f15b55e0">SummonPropertiesEntry::Group</a></div><div class="ttdeci">uint32 Group</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02147">DBCStructure.h:2147</a></div></div>
<div class="ttc" id="astructTargetDistanceOrderFarAway_html"><div class="ttname"><a href="structTargetDistanceOrderFarAway.html">TargetDistanceOrderFarAway</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02906">Unit.h:2907</a></div></div>
<div class="ttc" id="astructTargetDistanceOrderNear_html"><div class="ttname"><a href="structTargetDistanceOrderNear.html">TargetDistanceOrderNear</a></div><div class="ttdef"><b>Definition:</b> <a href="Unit_8h_source.html#l02891">Unit.h:2892</a></div></div>
<div class="ttc" id="astructVehicleSeatEntry_html"><div class="ttname"><a href="structVehicleSeatEntry.html">VehicleSeatEntry</a></div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02298">DBCStructure.h:2299</a></div></div>
<div class="ttc" id="astructVehicleSeatEntry_html_afe02aa891cad80dff89156d138bad691"><div class="ttname"><a href="structVehicleSeatEntry.html#afe02aa891cad80dff89156d138bad691">VehicleSeatEntry::m_flags</a></div><div class="ttdeci">uint32 m_flags</div><div class="ttdef"><b>Definition:</b> <a href="DBCStructure_8h_source.html#l02301">DBCStructure.h:2301</a></div></div>
<div class="ttc" id="astruct__Spell_html_a16909465a3a20dbab6e3ca2e3c807f17"><div class="ttname"><a href="struct__Spell.html#a16909465a3a20dbab6e3ca2e3c807f17">_Spell::SpellCharges</a></div><div class="ttdeci">int32 SpellCharges</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00571">ItemPrototype.h:571</a></div></div>
<div class="ttc" id="astruct__Spell_html_aed47853f0d0a19643f9667a8af115d4d"><div class="ttname"><a href="struct__Spell.html#aed47853f0d0a19643f9667a8af115d4d">_Spell::SpellId</a></div><div class="ttdeci">uint32 SpellId</div><div class="ttdef"><b>Definition:</b> <a href="ItemPrototype_8h_source.html#l00569">ItemPrototype.h:569</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_1699be727a800b1d059c6f7f2b91d2ee.html">game</a></li><li class="navelem"><a class="el" href="dir_de66b98668085f2af955d51777f9c67f.html">Spells</a></li><li class="navelem"><a class="el" href="Spell_8cpp.html">Spell.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
